import{P as gl}from"./vendor-plyr-D88RUDJp.js";/* empty css                     */import{aq as Ft,r as v,a as ne,ar as sa,d as oe,z as s,B as T,K as i,I as we,C as He,u as e,H as t,A as u,a0 as Le,_ as me,$ as d,D as w,F as ve,as as xr,e as pa,q as o,V as At,W as Ct,w as Te,m as wr,at as Go,au as ie,av as ot,aw as Ce,ax as f,ay as pe,az as la,j as kt,y as Dt,X as Ye,aA as tt,aB as $r,i as Vt,aC as Fn,aD as Bt,aE as aa,aF as fl,aG as Wo,S as Et,v as ls,aH as Ca,E as Ke,Y as yt,aI as ga,a8 as vl,aJ as bs,aK as Os,aL as Sr,G as es,aM as hl,aN as Kt,s as Tr,h as Oe,aO as Ps,aP as Ar,L as _l,aQ as Cr,k as ia,aR as Dr,aS as Lr,aT as Oo,aU as Ho,aV as Ko,aW as qo,aX as Qo,T as Cs,a1 as Ir,aY as Br,aZ as Mr,a_ as Er,l as jo,p as bl,f as Rr,a$ as Fr,b0 as Pr,b1 as Nr,b2 as zr}from"./vendor-vue-_6osIvT2.js";import{P as Ur}from"./vendor-msal-BGr3h9z7.js";import{a1 as Ra,aL as Or,cj as js,ck as ya,cl as jr,cm as Vr,cn as Gr,co as Wr,cp as Hr,cq as Kr,cr as qr,cs as Qr,ct as Jr,c8 as ko,cu as Xr,cv as Yr}from"./vendor-ORChIxer.js";import{c as Zr,a as oo,t as ec,d as us,b as tc,v as sc}from"./vendor-utils-DtILMzQO.js";import{t as ac,a as oc}from"./vendor-tailwind-ClyV-Nxn.js";import{e as nc,i as Ht}from"./i18n-BUL92CQe.js";import{x as $t,a as lc,Y as ic,D as rc,_ as cc,P as dc,E as uc,A as pc,b as mc,c as gc,O as fc,d as vc,M as hc,F as _c,e as bc,k as kc,L as zs,u as Da,f as yc,g as xc,h as wc,X as kl,i as $c,j as Sc,l as Tc,m as Ac,n as Cc,o as Dc,W as Lc,p as Ic,q as Bc,z as Mc,I as Pt,N as Ec,r as Rc,H as yl,K as Fc,C as xl,U as Pc,s as Nc,t as zc,v as Uc,G as Oc,w as jc,y as Vc,B as Gc,J as xa,S as wl,Q as Wc,R as Hc,T as Kc,V as qc,Z as Pn,$ as Qc,a0 as Jc,a1 as Xc,a2 as Yc,a3 as Zc,a4 as ed,a5 as td,a6 as $l,a7 as sd,a8 as ad,a9 as od,aa as Sl,ab as nd,ac as Tl,ad as ld,ae as Al,af as id,ag as Cl,ah as Dl,ai as rd,aj as cd,ak as dd,al as ud,am as pd,an as md,ao as gd,ap as fd,aq as vd,ar as hd,as as _d,at as bd,au as kd,av as yd,aw as xd,ax as wd,ay as $d,az as Sd,aA as Td,aB as Ad,aC as Cd,aD as Jo,aE as Ll,aF as Il,aG as Bl,aH as Dd,aI as Ld,aJ as Id,aK as Bd,aL as Md,aM as Ed,aN as Rd,aO as Fd,aP as Pd,aQ as Nd,aR as zd,aS as Ud,aT as Od,aU as jd,aV as Vd,aW as Gd,aX as Wd,aY as Hd,aZ as Kd,a_ as qd,a$ as Qd,b0 as Jd,b1 as Xd,b2 as Yd,b3 as Zd,b4 as eu,b5 as tu,b6 as su,b7 as au,b8 as ou,b9 as nu,ba as lu,bb as iu,bc as ru,bd as cu,be as du,bf as uu,bg as pu,bh as mu,bi as gu,bj as fu,bk as vu,bl as hu,bm as _u}from"./vendor-ui-BQ1sc1Nn.js";import{M as bu,m as ba,a as ku,k as Fa}from"./vendor-markdown-Cq7UwVHo.js";import{H as Nn,i as yu,u as xu,T as wu,e as $u,s as Su,g as Ml,c as zn,t as Tu,a as Au,b as Cu,d as Du,r as Lu,M as Iu,E as Bu,f as Mu,h as Eu,j as Ru,l as Fu,n as Pu,k as Nu,m as zu,o as Uu,p as Ou,q as ju,v as Vu,w as Gu,x as Wu,y as Hu}from"./vendor-milkdown-O5-RWlMO.js";import{r as El,u as Rl,$ as Ku,Z as qu}from"./vendor-office-pdf-Tz7bqfuM.js";import{C as Fl,R as Pl}from"./vendor-websockets-ByOGZsR8.js";import{u as Qu,a as Ju,b as Xu,c as Yu,F as Zu,E as ep,d as tp}from"./vendor-form-validation-C81jq9ix.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))c(r);new MutationObserver(r=>{for(const p of r)if(p.type==="childList")for(const m of p.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&c(m)}).observe(document,{childList:!0,subtree:!0});function a(r){const p={};return r.integrity&&(p.integrity=r.integrity),r.referrerPolicy&&(p.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?p.credentials="include":r.crossOrigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function c(r){if(r.ep)return;r.ep=!0;const p=a(r);fetch(r.href,p)}})();const Ta=n=>({id:n.id,createdBy:n.created_by,updatedBy:n.updated_by,createdAt:new Date(n.created_at),updatedAt:new Date(n.updated_at),fileName:n.file_name,status:n.status,fileExtension:n.file_extension}),sp=n=>({id:n.id,createdAt:new Date(n.created_at),updatedAt:new Date(n.updated_at),createdBy:n.created_by,updatedBy:n.updated_by,name:n.name,status:n.status,extension:n.extension}),Ot=Ft("msalStore",()=>{const n={auth:{clientId:"75bb3326-a75b-47b0-97f5-67638167d3b7",authority:"https://login.microsoftonline.com/f01e930a-b52e-42b1-b70f-a8882b5d043b/v2.0",redirectUri:"https://privategpt.fptconsulting.co.jp/auth",postLogoutRedirectUri:"/login",navigateToLoginRequestUrl:!1},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!0,secureCookies:!0},system:{loggerOptions:{loggerCallback:(y,I,C)=>{if(!C)switch(y){case Ra.Error:console.error("MSAL ERROR: ",I);return;case Ra.Warning:console.warn("MSAL WARNING: ",I);return;case Ra.Info:console.info("MSAL INFO: ",I);return;case Ra.Verbose:console.debug("MSAL DEBUG: ",I);return;default:console.warn("MSAL UNKNOWN LOG LEVEL:",I);return}}}}},l="api://fcj-hrapp/HrApp.User,email".split(","),a=new Ur(n),c=v(null),r=v(null),p=ne(()=>!!c.value),m=ne(()=>!!r.value),g=ne(()=>p.value&&m.value),h=async()=>{await a.initialize();const y=a.getAllAccounts()[0];try{y?(a.setActiveAccount(y),c.value=await a.acquireTokenSilent({account:y,scopes:l})):c.value=await a.handleRedirectPromise()}catch(I){console.log("initializeClient error: ",I),x()}},_=async()=>{try{const y=a.getAllAccounts();y.length>0?(a.setActiveAccount(y[0]),c.value=await a.acquireTokenSilent({redirectUri:n.auth.redirectUri,scopes:l})):await a.acquireTokenRedirect({redirectStartPage:location.href,redirectUri:n.auth.redirectUri,scopes:l})}catch(y){console.log("login error: ",y),x()}},x=async()=>{await a.clearCache()},b=async()=>{try{(await ma.get("/auth/verify")).status===200?r.value="OK":r.value=null}catch(y){r.value=null,console.log("checkAuthorization error: ",y),x()}},S=async()=>{await a.logoutRedirect()};return{isSecured:g,isAuthorized:m,isAuthenticated:p,authorizationResult:r,authenticationResult:c,initializeClient:h,login:_,checkAuthorization:b,logout:S,clearCache:x,getUserAccessToken:async()=>{try{const y=a.getAllAccounts();if(y.length>0){const I={account:y[0],scopes:l};return(await a.acquireTokenSilent(I)).accessToken}}catch(y){y instanceof Or?console.warn("TOKEN EXPIRED, NEED TO LOGIN AGAIN"):console.error("getUserAccessToken error: ",y),await S()}return null},msalInstance:a}}),it=js.create({baseURL:"https://privategpt.fptconsulting.co.jp/api/chat/v1",headers:{"Content-Type":"application/json"}});it.interceptors.request.use(async n=>{const l=Ot();await l.initializeClient();const a=await l.getUserAccessToken();return a&&(n.headers.Authorization=`Bearer ${a}`),n},n=>Promise.reject(n));const ma=js.create({...it.defaults,baseURL:"https://privategpt.fptconsulting.co.jp/api"});ma.interceptors.request.use(async n=>{const l=Ot();await l.initializeClient();const a=await l.getUserAccessToken();return a&&(n.headers.Authorization=`Bearer ${a}`),n},n=>Promise.reject(n));const Lt=(n,l)=>{const a=Number(n);return typeof n<"u"&&n!==""&&!isNaN(a)?a:l},ca=Lt("5",5),Va=Lt("1000",1e3),da=Lt("140000",14e4),Nl=Lt("5",5),yo=Lt("200",200),no=Lt("10",10),Ga=Lt("5",5),Wa=Lt("25",20),La=Lt("30",30),ap=Lt("$(VITE_CHAT_AGENT_RECENT_CONVERSATIONS_PAGE_SIZE)",4),Ha=Lt("10",5),Ka=Lt("50",20),zl=Lt("50",30),op=Lt(void 0,4),ja=Lt("100",100),Ul=Lt("3",5),As=Lt("20000",2e4),Pa=Lt("100000",2e4),Ns=Lt("6",6),fs=Lt("80",80),xo=Lt("20000",8e3),wo=Lt("100000",8e3),Ol=Lt("$(VITE_CHAT_MAX_PINNED_AGENTS)",20),jl=Lt("4000",4e3),Vl=Lt("2000",2e3),Ws=Lt("$(VITE_QMS_MESSAGE_FEEDBACK_MAX_CHARACTERS)",80),np=Lt("30000",3e4),lp="analytics",Rt=n=>{const l=n.lastIndexOf(".");return l<=0?"":n.slice(l+1)},lo=n=>{const l=["pdf","txt","pptx","xlsx","csv","md","docx","png","jpg","jpeg"],a=Rt(n).toLowerCase();for(const c of l)if(a===c)return!0;return!1},ip=n=>{const l=["pdf","txt","pptx","xlsx","csv","docx","md"],a=Rt(n).toLowerCase();for(const c of l)if(a===c)return!0;return!1},rp=n=>{const l=["pdf","txt","json","pptx","xlsx","csv","docx","md"],a=Rt(n).toLowerCase();for(const c of l)if(a===c)return!0;return!1},Is=Ft("fileStore",()=>{const n=v(null),l=v([]),a=v([]),c=v([]),r=v([]),p=v([]),m=v(0),g=U=>m.value+U>Ga||m.value+U+l.value.length>Wa,h=U=>{const E=lo(U.name),N=U.size<La*1024*1024;if(E&&N){const $={file:U,fileUrl:["png","jpg","jpeg"].includes(Rt(U.name))?URL.createObjectURL(U):"",fileId:"",isProcessing:null};a.value.push($)}return{isValidExtension:E,isValidSize:N,file:U}},_=()=>{p.value.forEach(U=>{l.value.push({fileId:U.fileId})})},x=async U=>{const E=r.value.findIndex(N=>U===N.id);p.value.splice(E,1),await it.delete(`/conversations/files/${U}`,{headers:{"Content-Type":"application/json"}}),r.value.splice(E,1),m.value--},b=async()=>{for(const U of a.value.slice())try{if(U.isProcessing)continue;U.isProcessing=!0;const E=new FormData;E.append("file",U.file);const N=await it.post("/conversations/files/upload",E,{headers:{"Content-Type":"multipart/form-data"}}),$=Ta(N.data);$.status==="UPLOADED"?U.fileId=$.id:(a.value=a.value.filter(R=>R.file!==U.file),m.value--)}catch(E){console.error(E),c.value.push(U),a.value=a.value.filter(N=>N.file!==U.file),m.value--}D.start()},D=sa(()=>{if(a.value.length!==0){for(const U of a.value.slice())U.isProcessing&&it.get(`/conversations/files/${U.fileId}`,{headers:{"Content-Type":"application/json"}}).then(E=>{const N=Ta(E.data);N.status==="FAILED"?(c.value.push(U),a.value=a.value.filter($=>$.fileId!==U.fileId),m.value--):N.status==="READY"&&(p.value.push({fileId:N.id,fileName:N.fileName}),r.value.push(N),a.value=a.value.filter($=>$.fileId!==U.fileId))}).catch(()=>{c.value.push(U),a.value=a.value.filter(E=>E.fileId!==U.fileId),m.value--});a.value.length>0&&D.start()}},5e3,{immediate:!1});return{uploadingFileCount:m,dropArea:n,selectedFiles:a,embedFailedFiles:c,contextFiles:r,readyFiles:p,attachments:l,wouldExceedUploadFileLimit:g,handleSingleFileUpload:h,changeToMetaData:_,uploadSelectedFiles:b,deleteReadyFile:x,downloadFile:async(U,E,N)=>{try{const $=await it.get(`/agents/${U}/files/${E}/download`,{responseType:"arraybuffer"});if($.status!==200)throw new Error(`Failed to fetch the file: ${$.statusText}`);const R=new Uint8Array($.data),B=new File([R],N,{type:$.headers["content-type"]||"application/octet-stream"}),j=window.URL.createObjectURL(B),ee=document.createElement("a");ee.href=j,ee.setAttribute("download",N),document.body.appendChild(ee),ee.click(),ee.remove(),window.URL.revokeObjectURL(j)}catch($){console.error($)}},getImageUrl:async U=>{try{const E=await it.get(`/static/images/${U}`,{responseType:"blob"});if(E.status!==200)throw new Error(`Failed to fetch the file: ${E.statusText}`);return URL.createObjectURL(E.data)}catch(E){console.error(E)}},clearState:()=>{l.value=[],a.value=[],c.value=[],r.value=[],p.value=[],m.value=0}}}),cp=n=>({id:n.id,displayName:n.display_name,description:n.description,displayGroup:n.display_group}),dp=n=>({id:n.id,createdAt:new Date(n.created_at),createdBy:n.created_by,updatedAt:new Date(n.updated_at),updatedBy:n.updated_by,name:n.name,description:n.description,avatar:n.avatar,owner:{id:n.owner.id,name:n.owner.name,email:n.owner.email},status:n.status,allowDownload:n.allow_download,verified:n.verified,showInstructions:n.show_instructions}),up=n=>({items:n.items.map(dp),total:n.total,offset:n.offset,limit:n.limit}),pp=n=>({rs:n.rs.map(({info:l,list:a})=>({info:cp(l),list:up(a)}))}),Na=n=>({id:n.id,createdAt:new Date(n.created_at),updatedAt:new Date(n.updated_at),createdBy:n.created_by,updatedBy:n.updated_by,name:n.name,description:n.description,instructions:n.instructions,sampleQuestions:n.sample_questions??[],modelId:n.model_id,avatar:n.avatar,owner:{id:n.owner.id,name:n.owner.name,email:n.owner.email},currentUserInfo:n.current_user_info?{id:n.current_user_info.id,permission:n.current_user_info.permission}:null,status:n.status,allowDownload:n.allow_download,verified:n.verified,showInstructions:n.show_instructions,category:n.category?{id:n.category.id,displayName:n.category.display_name,description:n.category.description}:null}),mp=n=>({id:n.id,createdAt:new Date(n.created_at),updatedAt:new Date(n.updated_at),createdBy:n.created_by,updatedBy:n.updated_by,name:n.name,description:n.description,sampleQuestions:n.sampleQuestions,avatar:n.avatar,owner:{id:n.owner.id,name:n.owner.name,email:n.owner.email},acl:n.acl,status:n.status,verified:n.verified,category:n.category}),gp=n=>n.rs.map(l=>({id:l.id,displayName:l.display_name,description:l.description})),Un=n=>new Promise(l=>setTimeout(l,n)),Gl=n=>n.map(l=>({fileId:l.file_id,content:l.content,mappingId:l.mapping_id,page:l.page,source:l.source})),fp=n=>n.rs.map(l=>({id:l.id,createdAt:new Date(l.created_at),updatedAt:new Date(l.updated_at),createdBy:l.created_by,updatedBy:l.updated_by,name:l.name})),vp=n=>({id:n.id,createdAt:new Date(n.created_at),updatedAt:new Date(n.updated_at),createdBy:n.created_by,updatedBy:n.updated_by,name:n.name,settings:{allowDownload:n.settings.allow_download},memberNum:n.member_num,currentUserInfo:n.current_user_info}),hp=n=>({id:n.id,createdAt:new Date(n.created_at),updatedAt:new Date(n.updated_at),createdBy:n.created_by,updatedBy:n.updated_by,conversationName:n.conversation_name,conversationDescription:n.conversation_description,agentId:n.agent_id,messagesList:n.messages_list.map(l=>_p(l)),conversationMetadata:{agentId:n.conversation_metadata.agent_id,attachments:n.conversation_metadata.attachments.map(l=>({fileId:l.file_id,fileName:l.file_name}))},readOnly:n.read_only}),_p=n=>{var l;return{id:n.id,createdAt:new Date(n.created_at),updatedAt:new Date(n.updated_at),createdBy:n.created_by,updatedBy:n.updated_by,role:n.role,content:{text:n.content.text,references:Array.isArray(n.content.references)?n.content.references.map(a=>({fileId:a.file_id,fileName:a.file_name})):null,citations:n.content.citations?Gl(n.content.citations):null},conversationId:n.conversation_id,parentId:n.parent_id??null,children:Array.isArray(n.children)?n.children:[],messageMetadata:(l=n.message_metadata)!=null&&l.attachments?{attachments:n.message_metadata.attachments.map(a=>({fileId:a.file_id,fileName:a.file_name}))}:null,modelId:n.model_id,feedback:n.feedback??null,isCompleted:!0,error:n.error??!1}},Wl=n=>n.map(l=>({fileId:l.file_id,fileName:l.file_name})),bp=["data","mes_info","conv","ref","hint","citation","DONE","followup_questions","unknown"],kp=n=>bp.includes(n),Hl=n=>n.map(l=>({fileId:l.file_id,content:l.content,mappingId:l.mapping_id,page:l.page})),yp=n=>({id:n.id,createdAt:new Date(n.created_at),updatedAt:new Date(n.updated_at),createdBy:n.created_by,updatedBy:n.updated_by,conversationName:n.conversation_name,conversationDescription:n.conversation_description,agentId:n.agent_id,messagesList:n.messages_list.map(l=>xp(l)),conversationMetadata:{agentId:n.conversation_metadata.agent_id,attachments:n.conversation_metadata.attachments.map(l=>({fileId:l.file_id,fileName:l.file_name}))},readOnly:n.read_only}),qa=n=>({items:n.items.map(l=>({id:l.id,createdAt:new Date(l.created_at),updatedAt:new Date(l.updated_at),createdBy:l.created_by,updatedBy:l.updated_by,conversationName:l.conversation_name,conversationDescription:l.conversation_description,agentId:l.agent_id}))}),xp=n=>{var l;return{id:n.id,createdAt:new Date(n.created_at),updatedAt:new Date(n.updated_at),createdBy:n.created_by,updatedBy:n.updated_by,role:n.role,content:{text:n.content.text,references:Array.isArray(n.content.references)?n.content.references.map(a=>({fileId:a.file_id,fileName:a.file_name})):null,citations:n.content.citations?Hl(n.content.citations):null},conversationId:n.conversation_id,parentId:n.parent_id??null,children:Array.isArray(n.children)?n.children:[],messageMetadata:(l=n.message_metadata)!=null&&l.attachments?{attachments:n.message_metadata.attachments.map(a=>({fileId:a.file_id,fileName:a.file_name}))}:null,modelId:n.model_id,feedback:n.feedback??null,isCompleted:!0,error:n.error??!1}},Xo=n=>({modelId:n.model_id,displayName:n.display_name,description:n.description}),Gt=Ft("agentStore",()=>{const n=v(),l=v(),a=v(),c=v([]),r=v([]),p=v([]),m=v([]),g=v([]),h=v(!1),_=v([]),x=v(""),b=v("notUpdated"),S=v("notUpdated"),D=v(!1),y=v([]),I=v(""),C=v(!0),U=te=>{C.value=te},E=v({}),N=v({}),$=v({}),R=v({}),B=v(!1),j=v({}),ee=async()=>{B.value=!0;try{const{data:te}=await it.get("/agents/discovery");c.value=pp(te).rs,E.value={},N.value={},j.value={},c.value.forEach(Z=>{const re=Z.info.id;j.value[re]=!1,E.value[re]=0,N.value[re]=!0,Z.list.offset===-1&&Z.list.limit===-1?$.value[re]=!0:$.value[re]=!1,R.value[re]=Z.list.items.length}),c.value.length>0&&(I.value=c.value[0].info.displayGroup.en_US)}catch(te){console.error("Error fetching agents data: ",te)}finally{B.value=!1}},se=v([]),G=async(te,Z)=>{const{data:re}=await it.get(`/agents/discovery/category/${te}`,{params:Z}),ue=c.value.find(he=>he.info.id===te);ue==null||ue.list.items.push(...re.items),se.value=re.items},J=v(0),H=async te=>{const{data:Z}=await it.get("/agents/discovery/created_by",{params:te});te.offset===0?p.value=[...Z.items]:p.value.push(...Z.items),J.value=Z.total},M=v([]),W=async te=>{const{data:Z}=await it.get("/agents/discovery/shared",{params:te});te.offset===0?m.value=[...Z.items]:m.value.push(...Z.items),M.value=Z.items},X=async te=>{const{data:Z}=await it.get(`/agents/${te}`);return l.value=Na(Z),n.value=Z.id,Na(Z)},O=async(te,Z,re,ue,he,$e,Se,be)=>{const Ge=await it.post("/agents",{name:te,description:Z,instructions:re,model_id:ue,allow_download:he,sample_questions:Se,show_instructions:$e,category:be}),fe=Na(Ge.data);l.value=fe,n.value=fe.id,await Un(1e3)},K=async te=>{await it.put(`agents/${te}/publish`)},V=async(te,Z,re,ue,he,$e,Se,be,Ge)=>{try{h.value=!1;const fe=await it.put(`/agents/${te}`,{name:Z,description:re,instructions:ue,model_id:he,allow_download:$e,show_instructions:Se,sample_questions:be,category:Ge}),Y=Na(fe.data);await Un(1e3),l.value=Y}catch(fe){h.value=!0,console.error("Error edit agent: ",fe)}},F=async()=>{const te=await it.get("/agents/pins",{params:{offset:0,limit:Ol}});r.value=te.data.items},P=async te=>{await it.post(`/agents/${te}/pin`)},q=async te=>{await it.delete(`/agents/${te}/unpin`)},A=v(!1);return{supportModelsForAgent:g,agents:c,pinAgents:r,createdAgents:p,sharedAgents:m,currentAgentId:n,currentAgent:l,currentAgentAcl:a,createAgent:O,publishAgent:K,editAgent:V,searchAgent:async te=>(await it.get("/agents/search",{params:{agent_name:te}})).data.items.map(mp),getPinAgents:F,pinAgent:P,unpinAgent:q,deleteAgent:async te=>{A.value=!0;try{(await it.delete(`/agents/${te}`)).status==200&&r.value.some(re=>re.id===te)&&(r.value=r.value.filter(re=>re.id!==te),F())}finally{A.value=!1}},deleteAgentById:async te=>{(await it.delete(`/agents/${te}`)).status==200&&r.value.some(re=>re.id===te)&&(r.value=r.value.filter(re=>re.id!==te),F())},getAllAgents:ee,getCreatedAgents:H,getSharedAgents:W,getAgentById:X,getAcl:async te=>{try{const Z=await it.get(`/agents/${te}/acl`);a.value=Z.data}catch(Z){console.error("Error get acl: ",Z)}},updateAcl:async(te,Z,re,ue)=>{try{await it.put(`/agents/${te}/acl`,{users:Z,groups:re,tenant:ue})}catch{console.error(`Error update acl agent ${te}`)}},getLLMForAgentList:async()=>{const te=await it.get("/agents/support-models");g.value=te.data.map(Xo)},getUserCategories:async()=>{const te=await it.get("/agents/user_categories");y.value=gp(te.data)},loading:A,countAgentShared:M,isUpdatedAgentFail:h,sampleQuestions:_,sampleQuestion:x,agentUpdateStatus:b,agentInfoChanged:D,agentUpdateBeforePublishStatus:S,userCategoryList:y,activeTab:I,observerEnabled:C,setObserverEnabled:U,getAgentsByCategoryId:G,agentsInCategory:se,offsetByCategory:E,shouldDisplaySeeMore:N,isSystemCategory:$,countAgentsInCurrentCategory:R,loadingForAgentsCategory:B,loadingForFetchMoreAgentsInCategory:j,totalCreatedAgents:J}});function Me(...n){return ac(Zr(n))}function We(n){const l=(c,r)=>r?n(c,r):n(c);return{t:l,tFallback:(c,r,p)=>c in nc?l(c,p):r}}const wp=oe({__name:"Toast",props:{class:{},variant:{},onOpenChange:{type:Function},defaultOpen:{type:Boolean},forceMount:{type:Boolean},type:{},open:{type:Boolean},duration:{},asChild:{type:Boolean},as:{}},emits:["escapeKeyDown","pause","resume","swipeStart","swipeMove","swipeCancel","swipeEnd","update:open"],setup(n,{emit:l}){const a=n,c=l,r=ne(()=>{const{class:m,...g}=a;return g}),p=$t(r,c);return(m,g)=>(s(),T(e(lc),He(e(p),{class:e(Me)(e(Mp)({variant:m.variant}),a.class),"onUpdate:open":m.onOpenChange}),{default:i(()=>[we(m.$slots,"default")]),_:3},16,["class","onUpdate:open"]))}}),$p=oe({__name:"ToastClose",props:{asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:c,...r}=l;return r});return(c,r)=>(s(),T(e(ic),He(a.value,{class:e(Me)("absolute right-2 top-1 rounded-md p-1 text-white opacity-0 transition-opacity hover:text-white focus:opacity-100 focus:outline-hidden focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 hover:group-[.destructive]:text-red-50 focus:group-[.destructive]:ring-red-400 focus:group-[.destructive]:ring-offset-red-600",l.class)}),{default:i(()=>r[0]||(r[0]=[t("i",{class:"bi bi-x"},null,-1)])),_:1,__:[0]},16,["class"]))}}),On=oe({__name:"ToastDescription",props:{asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:c,...r}=l;return r});return(c,r)=>(s(),T(e(rc),He({class:e(Me)("text-sm opacity-90 text-white",l.class)},a.value),{default:i(()=>[we(c.$slots,"default")]),_:3},16,["class"]))}}),Sp=1,Tp=3e3,Us={ADD_TOAST:"ADD_TOAST",UPDATE_TOAST:"UPDATE_TOAST",DISMISS_TOAST:"DISMISS_TOAST",REMOVE_TOAST:"REMOVE_TOAST"};let $o=0;function Ap(){return $o=($o+1)%Number.MAX_VALUE,$o.toString()}const So=new Map;function jn(n){if(So.has(n))return;const l=setTimeout(()=>{So.delete(n),$a({type:Us.REMOVE_TOAST,toastId:n})},Tp);So.set(n,l)}const _s=v({toasts:[]});function $a(n){switch(n.type){case Us.ADD_TOAST:_s.value.toasts=[n.toast,..._s.value.toasts].slice(0,Sp);break;case Us.UPDATE_TOAST:_s.value.toasts=_s.value.toasts.map(l=>l.id===n.toast.id?{...l,...n.toast}:l);break;case Us.DISMISS_TOAST:{const{toastId:l}=n;l?jn(l):_s.value.toasts.forEach(a=>{jn(a.id)}),_s.value.toasts=_s.value.toasts.map(a=>a.id===l||l===void 0?{...a,open:!1}:a);break}case Us.REMOVE_TOAST:n.toastId===void 0?_s.value.toasts=[]:_s.value.toasts=_s.value.toasts.filter(l=>l.id!==n.toastId);break}}function gt(){return{toasts:ne(()=>_s.value.toasts),toast:Ue,dismiss:n=>$a({type:Us.DISMISS_TOAST,toastId:n})}}function Ue(n){const l=Ap(),a=r=>$a({type:Us.UPDATE_TOAST,toast:{...r,id:l}}),c=()=>$a({type:Us.DISMISS_TOAST,toastId:l});return $a({type:Us.ADD_TOAST,toast:{...n,id:l,open:!0,onOpenChange:r=>{r||c()}}}),{id:l,dismiss:c,update:a}}const Cp={class:"grid gap-1"},Dp=oe({__name:"Toaster",setup(n){const{toasts:l}=gt();return(a,c)=>(s(),T(e(Lp),null,{default:i(()=>[(s(!0),u(ve,null,Le(e(l),r=>(s(),T(e(wp),He({key:r.id,ref_for:!0},r),{default:i(()=>[t("div",Cp,[r.title?(s(),T(e(Ip),{key:0},{default:i(()=>[me(d(r.title),1)]),_:2},1024)):w("",!0),r.description?(s(),u(ve,{key:1},[xr(r.description)?(s(),T(e(On),{key:0},{default:i(()=>[(s(),T(pa(r.description)))]),_:2},1024)):(s(),T(e(On),{key:1},{default:i(()=>[me(d(r.description),1)]),_:2},1024))],64)):w("",!0),o(e($p))]),(s(),T(pa(r.action)))]),_:2},1040))),128)),o(e(Bp))]),_:1}))}}),Lp=oe({__name:"ToastProvider",props:{label:{},duration:{},swipeDirection:{},swipeThreshold:{}},setup(n){const l=n;return(a,c)=>(s(),T(e(cc),At(Ct(l)),{default:i(()=>[we(a.$slots,"default")]),_:3},16))}}),Ip=oe({__name:"ToastTitle",props:{asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:c,...r}=l;return r});return(c,r)=>(s(),T(e(dc),He(a.value,{class:e(Me)("text-sm font-semibold text-white",l.class)}),{default:i(()=>[we(c.$slots,"default")]),_:3},16,["class"]))}}),Bp=oe({__name:"ToastViewport",props:{hotkey:{},label:{type:[String,Function]},asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:c,...r}=l;return r});return(c,r)=>(s(),T(e(uc),He(a.value,{class:e(Me)("fixed top-0 inset-x-0 mx-auto z-100 flex max-h-screen w-full max-w-[420px] flex-col-reverse p-4 sm:flex-col",l.class)}),null,16,["class"]))}}),Mp=oo("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-y-0 data-[swipe=end]:translate-y-(--radix-toast-swipe-end-y) data-[swipe=move]:translate-y-(--radix-toast-swipe-move-y) data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-top-full data-[state=open]:slide-in-from-top-full sm:data-[state=open]:slide-in-from-bottom-full",{variants:{variant:{default:"border-none bg-green-500 text-white",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),ps=Ft("meStore",()=>{const n=v(),l=v(!1),a=v("light");Te(()=>a.value,g=>{g==="light"?(localStorage.setItem("theme","light"),document.documentElement.className=g):(localStorage.setItem("theme","dark"),document.documentElement.className=g)});const c=async()=>{try{const{data:g}=await it.get("/me/locale");return g&&Ht.global.availableLocales.includes(g.locale)?(Ht.global.locale=g.locale,n.value=g.locale):(r("en_US"),console.warn(`Locale ${g} is not available.`),Ht.global.locale=Ht.global.fallbackLocale),g}catch(g){console.error("Failed to fetch language:",g)}},r=async g=>{try{const{data:h}=await it.put("/me/locale",{locale:g});return Ht.global.availableLocales.includes(g)&&(Ht.global.locale=g,n.value=g),h}catch(h){console.error("Failed to update language:",h)}};return{getMyCurrentLanguage:c,updateCurrentLanguage:r,currentLanguage:n,mode:a,sendRating:async g=>{await ma.post("/rating",g)},getRating:async()=>{const{data:g}=await ma.get("/rating/has-rated");l.value=g},isRatingSent:l}}),Qe=js.create({baseURL:"https://privategpt.fptconsulting.co.jp/api/kaigi/v1",headers:{"Content-Type":"application/json"}});Qe.interceptors.request.use(async n=>{const l=Ot();await l.initializeClient();const a=await l.getUserAccessToken();return a&&(n.headers.Authorization=`Bearer ${a}`),n},n=>Promise.reject(n));const Ep=n=>({id:n.id,name:n.name,createdBy:n.created_by,updatedBy:n.updated_by,createdAt:new Date(n.created_at),updatedAt:new Date(n.updated_at)}),Rp=n=>({id:n.id,transcription:n.transcription,translation:n.translation,timestamp:String(Math.floor(Math.ceil(n.timestamp)/60)).padStart(2,"0")+":"+String(Math.floor(Math.ceil(n.timestamp)%60)).padStart(2,"0"),timestampNumb:Math.ceil(n.timestamp),speakerId:n.speaker_id,note:n.note}),To=n=>n?{summary:n.summary.map(l=>({topic:l.topic,content:l.content})),summaryLang:n.summary_lang}:null,Fp=n=>({id:n.id,title:n.title,content:n.content}),Pp=n=>n.map(Fp),Vn=n=>({id:n.id,name:n.name,sourceLang:n.source_lang,translateLang:n.translate_lang,enableTranslation:n.enable_translation,createdBy:n.created_by,updatedBy:n.updated_by,createdAt:new Date(n.created_at),updatedAt:new Date(n.updated_at),status:n.status,file:{id:n.file.id,name:n.file.name},messageList:(n.message_list??[]).map(Rp)}),Np=n=>({items:n.items.map(Ep),total:n.total,offset:n.offset,limit:n.limit}),Kl=n=>n.map(l=>({speakerId:l.speaker_id,displayName:l.display_name})),Qa=n=>({id:n.id,createdAt:new Date(n.created_at),updatedAt:new Date(n.updated_at),createdBy:n.created_by,updatedBy:n.updated_by,transcription:n.transcription,translation:n.translation,timestamp:String(Math.floor(n.timestamp/60)).padStart(2,"0")+":"+String(n.timestamp%60).padStart(2,"0"),timestampNumb:Math.ceil(n.timestamp),speakerId:n.speaker_id,note:n.note}),ql=n=>({speakerId:n.speaker_id,displayName:n.display_name}),zp=n=>({id:n.id,name:n.name,createdBy:n.created_by,updatedBy:n.updated_by,createdAt:new Date(n.created_at),updatedAt:new Date(n.updated_at)}),Ql=n=>({id:n.id,transcription:n.transcription,translation:n.translation,timestamp:String(Math.floor(Math.ceil(n.timestamp)/60)).padStart(2,"0")+":"+String(Math.floor(Math.ceil(n.timestamp)%60)).padStart(2,"0"),speakerId:n.speaker_id,timestampNumb:Math.ceil(n.timestamp),note:n.note}),Gn=n=>({id:n.id,name:n.name,multiSpeakers:n.multi_speakers,sourceLang:n.source_lang,translateLang:n.translate_lang,enableTranslation:n.enable_translation,createdBy:n.created_by,updatedBy:n.updated_by,createdAt:new Date(n.created_at),updatedAt:new Date(n.updated_at),status:n.status,isShareScreen:n.is_share_screen,messageList:(n.message_list??[]).map(Ql)}),Up=n=>({items:n.items.map(zp),total:n.total,offset:n.offset,limit:n.limit}),Op=n=>n.map(l=>({speakerId:l.speaker_id,displayName:l.display_name})),Wn=n=>({id:n.id,createdAt:new Date(n.created_at),updatedAt:new Date(n.updated_at),createdBy:n.created_by,updatedBy:n.updated_by,transcription:n.transcription,translation:n.translation,timestamp:String(Math.floor(n.timestamp/60)).padStart(2,"0")+":"+String(n.timestamp%60).padStart(2,"0"),speakerId:n.speaker_id,note:n.note}),jp=n=>({speakerId:n.speaker_id,displayName:n.display_name}),Ja=n=>({id:n.id,createdAt:new Date(n.created_at),updatedAt:new Date(n.updated_at),createdBy:n.created_by,updatedBy:n.updated_by,content:n.content,recordingId:n.recording_id,recordingMessageId:n.recording_message_id,timestamp:String(Math.floor(Math.ceil(n.timestamp)/60)).padStart(2,"0")+":"+String(Math.floor(Math.ceil(n.timestamp)%60)).padStart(2,"0"),timestampNumb:Math.ceil(n.timestamp)}),Vp=n=>({id:n.id,title:n.title,content:n.content}),Jl=n=>n.map(Vp),ua=n=>n?{summary:n.summary.map(l=>({topic:l.topic,content:l.content})),summaryLang:n.summary_lang}:null,Yo=n=>({locale:n.locale,isAvailable:n.is_available}),Gp=n=>({id:n.id,createdAt:new Date(n.created_at),updatedAt:new Date(n.updated_at),createdBy:n.created_by,updatedBy:n.updated_by,name:n.name,status:n.status,extension:n.extension}),Hn=n=>({id:n.id,createdAt:new Date(n.created_at),updatedAt:new Date(n.updated_at),createdBy:n.created_by,updatedBy:n.updated_by,name:n.name,multiSpeakers:n.multi_speakers,sourceLang:n.source_lang,translateLang:n.translate_lang,enableTranslation:n.enable_translation,status:n.status,messageList:(n.message_list??[]).map(Ql),file:n.file}),Wp=n=>({id:n.id,createdAt:new Date(n.created_at),updatedAt:new Date(n.updated_at),createdBy:n.created_by,updatedBy:n.updated_by,name:n.name}),Hp=n=>({items:n.items.map(Wp),total:n.total,offset:n.offset,limit:n.limit}),Ks=Ft("uploadAndTranscribeStore",()=>{const n=v(!1),l=v(!1),a=v(!1),c=v(!1),r=v(!1),p=v(!0),m=v(),g=v(),h=v([]),_=v([]),x=v(""),b=v(),S=v(),D=v([]),y=v(),I=v(!1),C=v(!0),U=wr({}),E=v(""),N=v(!1),$=v(),R=v(),B=v([]),j=v(),ee=v([]),se=ne(()=>{var fe;return((fe=j.value)==null?void 0:fe.summary.map(Y=>Y.topic))??[]}),G=ne(()=>{var fe;return(fe=j.value)==null?void 0:fe.summary.map(Y=>`${Y.topic}
${Y.content}`).join(`

`)}),J=(fe,Y)=>{U[fe]=Y},H=fe=>{delete U[fe]},M=async()=>{const fe=new FormData;if(S.value){fe.append("file",S.value);const{data:Y}=await Qe.post("/upload-transcribe/upload",fe,{headers:{"Content-Type":"multipart/form-data"}});g.value=Gp(Y)}},W=async fe=>{const Y=await Qe.post("/upload-transcribe",fe),ce=Hn(Y.data);return D.value.unshift(ce),ce},X=async fe=>{const Y=await Qe.get(`/upload-transcribe/${fe}`);m.value=Hn(Y.data),p.value=m.value.enableTranslation,m.value.status==="PROCESSING"&&J(m.value.id,m.value.status)},O=async()=>{const fe=Object.keys(U);if(!fe.length)return;const ce=(await Promise.allSettled(fe.map(ge=>Qe.get(`/upload-transcribe/${ge}`).then(ye=>({id:ge,status:ye.data.status}))))).map((ge,ye)=>ge.status==="fulfilled"?ge.value:{id:fe[ye],status:"FAILED"});for(const{id:ge,status:ye}of ce)J(ge,ye)},{pause:K,resume:V}=Go(O,6e4,{immediate:!0});return Te(()=>Object.keys(U).length,fe=>{fe>0?V():K()},{immediate:!0}),{isFetchingFile:l,isFetchingSpeaker:a,isFetchingBookmark:c,isFetchingSummary:r,fileRecordingList:D,isUploadAndTranscribeDialogOpen:n,showTranslation:p,currentFileRecording:m,recordingFile:S,currentUploadedRecordingFileInfo:g,currentFileRecordingSpeakers:h,timeStampNumber:y,uploadRecordingFile:M,createNewFileRecording:W,fetchFileRecordingById:X,fetchFileRecordingList:async(fe,Y)=>{const ce=await Qe.get("/upload-transcribe",{params:{offset:fe,limit:Y}}),ge=Hp(ce.data);return fe===0?D.value=[...ge.items]:D.value.push(...ge.items),ge.total},deleteFileRecording:async fe=>{const Y=D.value.findIndex(ce=>ce.id===fe);await Qe.delete(`/upload-transcribe/${fe}`),D.value.splice(Y,1)},renameFileRecording:async(fe,Y)=>{var ge;const ce=D.value.find(ye=>ye.id===fe);ce&&(await Qe.put(`/upload-transcribe/${fe}`,{new_name:Y}),ce.name=Y,((ge=m.value)==null?void 0:ge.id)===fe&&(m.value.name=Y))},updateMessageSpeaker:async(fe,Y,ce)=>{var _e;await Qe.put(`/upload-transcribe/${fe}/messages/${Y}/speaker`,ce);const ge=(_e=m.value)==null?void 0:_e.messageList.find(Re=>Re.id===Y),ye=h.value.find(Re=>Re.speakerId===ce.new_speaker);ge&&ye&&(ge.speakerId=ce.new_speaker)},renameSpeaker:async(fe,Y,ce)=>{const ge=await Qe.put(`/upload-transcribe/${fe}/speakers/${Y}`,{new_name:ce}),ye=h.value.findIndex(_e=>_e.speakerId===Y);return ye!==-1&&(h.value[ye]=ql(ge.data)),ge},fetchFileRecordingSpeakerList:async fe=>{const Y=await Qe.get(`/upload-transcribe/${fe}/speakers`);h.value=Kl(Y.data)},updateMessage:async(fe,Y,ce)=>{if(!m.value)return;const ge=await Qe.put(`upload-transcribe/${m.value.id}/messages/${fe.id}/edit`,{new_transcription:Y,new_translation:ce}),ye=Qa(ge.data),_e=m.value.messageList.find(Re=>Re.id===fe.id);return _e&&(_e.transcription=ye.transcription,_e.translation=ye.translation),ye},translateMessage:async fe=>{if(!m.value)return;const Y=await Qe.put(`upload-transcribe/${m.value.id}/messages/${fe.id}/translate`),ce=Qa(Y.data),ge=m.value.messageList.find(ye=>ye.id===fe.id);return ge&&(ge.translation=ce.translation),ce},getFileRecordingAudio:async fe=>{const Y=await Qe.get(`/upload-transcribe/${fe}/download`,{responseType:"blob"});if(Y.status!==200)throw new Error(`Failed to fetch the file: ${Y.statusText}`);E.value=URL.createObjectURL(Y.data)},isLoadingFileRecording:I,hasMoreFileRecording:C,currentFileRecordingBookmarks:_,fetchBookmarksList:async fe=>{const Y=await Qe.get(`/upload-transcribe/${fe}/bookmarks`);_.value=Y.data.map(Ja)},newBookmarkId:x,bookmark:async(fe,Y,ce)=>{const ge=await Qe.post(`/upload-transcribe/${fe}/messages/${Y}/bookmarks`,ce),ye=Ja(ge.data);if(x.value=ye.id,_.value.length===0)_.value.push(ye);else{const _e=_.value.findIndex(Re=>Re.timestamp>ye.timestamp);_e===-1?_.value.push(ye):_.value.splice(_e,0,ye)}},editBookmark:async(fe,Y,ce,ge)=>{const ye=await Qe.put(`/upload-transcribe/${fe}/messages/${Y}/bookmarks/${ce}`,ge),_e=_.value.find(Re=>Re.id===ce);_e&&(_e.content=ye.data.content)},editingBookmarkId:b,deleteBookmark:async(fe,Y,ce)=>{const ge=_.value.findIndex(ye=>ye.id===ce);await Qe.delete(`/upload-transcribe/${fe}/messages/${Y}/bookmarks/${ce}`),_.value.splice(ge,1)},useFilesPolling:O,processingStatuses:U,setStatus:J,removeFile:H,recordUrl:E,isGeneratingSummary:N,selectedTemplate:$,topics:se,summaryContent:G,currentRecordingContent:R,currentRecordingLocaleList:B,currentRecordingSummary:j,generateSummary:async(fe,Y)=>{try{N.value=!0;const ce=await Qe.post(`/upload-transcribe/${fe}/summary`,Y);j.value=ua(ce.data)}finally{N.value=!1}},fetchLocale:async fe=>{const{data:Y}=await Qe.get(`/upload-transcribe/${fe}/available-locale`);B.value=Y.map(Yo)},fetchSummary:async(fe,Y="en_US")=>{const ce=await Qe.get(`upload-transcribe/${fe}/summary`,{params:{locale:Y}});j.value=ua(ce.data)},regenerateSummary:async(fe,Y)=>{N.value=!0;const ce=await Qe.put(`/upload-transcribe/${fe}/summary/regenerate`,Y),ge=ua(ce.data);return N.value=!1,ge},deleteSummary:async(fe,Y)=>{await Qe.delete(`/upload-transcribe/${fe}/summary`,{params:{locale:Y}})},fetchUploadTranscribeTemplates:async()=>{const fe=await Qe.get("/upload-transcribe/summary-templates");ee.value=Jl(fe.data)},uploadAndTranscribeTemplateList:ee,clearState:()=>{m.value=void 0,E.value=void 0,h.value=[],R.value=void 0,_.value=[]}}}),qs=Ft("agentFileStore",()=>{const n=Gt(),l=v(!1),{currentAgentId:a}=ie(n),c=v([]),r=v([]),p=v([]),m=v(0),g=$=>m.value+$+r.value.length>ja,h=$=>{const R=ip($.name),B=$.size<La*1024*1024;if(R&&B){const j={file:$,fileId:"",isUploaded:!1,isProcessing:!1,isQueueing:!0};c.value.push(j)}return{isValidExtension:R,isValidSize:B,file:$}},_=$=>{const R=p.value.indexOf($);R<0||p.value.splice(R,1)},x=async($,R=!0)=>{const j=(await it.get(`/agents/${$}/files`)).data.map(ee=>Ta(ee));if(r.value=j.filter(ee=>ee.status!=="FAILED"),R)for(const ee of j)!p.value.includes(ee.id)&&ee.status!=="READY"&&ee.status!=="FAILED"?p.value.push(ee.id):(ee.status==="READY"||ee.status==="FAILED")&&_(ee.id);return j},b=$=>{$<0||(c.value.splice($,1),m.value--)},S=$=>{r.value.splice($,1)},D=async($,R)=>{const B=r.value.findIndex(j=>R===j.id);await it.delete(`/agents/${$}/files/${R}`,{headers:{"Content-Type":"application/json"}}),S(B)},y=async $=>{for(const[R,B]of c.value.entries())try{if(p.value.length>=Ul)return;if(B.isUploaded)continue;B.isQueueing=!1,B.isProcessing=!0;const j=new FormData;j.append("file",B.file,B.file.name);const{data:ee}=await it.post(`/agents/${$}/files/upload`,j,{headers:{"Content-Type":"multipart/form-data"}});B.isUploaded=!0,p.value.push(ee.id)}catch(j){throw console.error(j),b(R),new Error}},{start:I,stop:C}=sa(async()=>{try{const $=await x(a.value);for(const R of $){const B=c.value.findIndex(j=>j.file.name===R.fileName);b(B),(R.status==="FAILED"||R.status==="READY")&&_(R.id)}}catch($){console.error($),C()}finally{p.value.length>0&&I()}},3e4,{immediate:!1}),U=()=>{p.value.length<=0||I()},E=()=>{C()};return{agentFiles:r,isDroppingFileToAgent:l,selectedFiles:c,uploadingFileCount:m,wouldExceedUploadAgentFileLimit:g,handleSingleFileUpload:h,retrieveAllAgentFiles:x,uploadSelectedFiles:y,removeSelectedFile:b,removeAgentFile:S,deleteAgentFile:D,startPolling:U,stopPolling:E,clearState:()=>{r.value=[],p.value=[],c.value=[],m.value=0,E()},isPolling:p}}),io=n=>{const l=n.trim().split(`
`);let a="",c="";for(const p of l)p.startsWith("event")?a=p.slice(7):p.startsWith("data")?c=p.slice(6):(console.warn("Unknown line event: ",p),a="unknown");return{event:kp(a)?a:"unknown",data:c}},ro=async()=>{const n=Ot(),{initializeClient:l,checkAuthorization:a,getUserAccessToken:c}=n,r=ot();try{return n.isAuthenticated||await l(),n.isAuthorized||await a(),await c()}catch{r.replace("/access-denied")}},ms=Ft("conversationStore",()=>{const n=Is(),l=v(0),a=v(0),c=v([]),r=v(!1),p=v(!1),m=v(null),g=v(),h=v({items:[],total:0,currentOffset:0,loading:!1}),_=v(!0),x=v([]),b=v(),S=v(!1),D=v(!1),y=v({canvasOpen:!1,canvasStates:[],quoted:""}),I=v([]),C="https://privategpt.fptconsulting.co.jp/api/chat/v1",U=v(null),E=v(!1),N=v(!1),$=async(P,q,A=ap)=>{try{h.value.loading=!0;const k=await it.get("/conversations",{params:{agent_id:P,offset:q,limit:A}}),L=qa(k.data);if(h.value.currentOffset=k.data.offset+L.items.length,h.value.total=k.data.total,q){h.value.items.push(...L.items);return}h.value.items=[...L.items]}finally{h.value.loading=!1}},R=async(P,q)=>{const A=await it.get("/conversations",{params:{offset:P,limit:q}}),k=qa(A.data);return c.value.push(...k.items),l.value=A.data.offset,a.value=A.data.total,r.value=!0,k.items},B=async P=>{n.readyFiles=[];const q=await it.get(`/conversations/${P}`);g.value=yp(q.data),m.value=g.value.messagesList[g.value.messagesList.length-1].id;const A=g.value.messagesList,k=A[A.length-1],L=x.value.find(z=>z.modelId===k.modelId);L?b.value=L:b.value=x.value[0]},j=P=>{P||(P="New Conversation");const q={id:void 0,createdAt:new Date,updatedAt:new Date,conversationName:P,messagesList:[],conversationMetadata:{attachments:[],agentId:null},readOnly:!1};c.value.unshift(q),a.value++,g.value=q},ee=(P,q,A,k,L)=>{g.value&&g.value.messagesList?g.value.messagesList.push({id:A,createdAt:new Date,updatedAt:new Date,role:q,content:{text:P,references:L,citations:null},messageMetadata:{attachments:k},isCompleted:!0,feedback:null}):console.error("Current conversation not existed")},se=async(P,q)=>{const A=c.value.find(k=>k.id===q);A!=null&&A.id&&(await it.put(`/conversations/${q}`,{new_name:P}),A.conversationName=P)},G=async P=>{await it.delete(`/conversations/${P}`),c.value=c.value.filter(q=>q.id!==P)},J=async()=>{if(g.value){g.value.updatedAt=new Date;const P=c.value.findIndex(A=>{var k;return A.id===((k=g.value)==null?void 0:k.id)});if(P<=0)return;const q=c.value.splice(P,1)[0];q.updatedAt=new Date,c.value.unshift(q)}},H=async()=>{if(!x.value.length){const P=await it.get("/conversations/support-models");x.value=P.data.map(Xo),b.value=x.value[0]}},M=async()=>{U.value&&U.value.abort(),E.value=!1,N.value=!1},W=(P,q,A,k)=>{switch(P){case"hint":I.value=JSON.parse(q);break;case"data":{const L=JSON.parse(q);k+=L.v,g.value.messagesList[A-1].content.text=k;break}case"mes_info":{const L=JSON.parse(q);g.value.messagesList[A-1].id=L.id,g.value.messagesList[A-1].modelId=L.model_id,m.value=L.id;break}case"conv":{const L=JSON.parse(q);g.value.id=L.conversation_id,g.value.conversationName=L.generated_name;break}case"citation":{const L=JSON.parse(q);g.value.messagesList[A-1].content.citations=Hl(L.citations);break}case"ref":{const L=JSON.parse(q);g.value.messagesList[A-1].content.references=Wl(L.references);break}case"DONE":break;default:console.warn("[Unhandled event]",JSON.stringify(P),JSON.stringify(q));break}return k};return{hasMore:_,loadingAnimation:E,generatingResponse:N,conversations:c,currentOffset:l,totalConversations:a,conversationsFetched:r,currentConversation:g,recentConversationsWithAgent:h,messageEditorState:y,unshiftConversation:j,addMessage:ee,messagesRetrieved:p,currentParentMessageId:m,editConversationTitle:se,deleteConversation:G,generateAIResponse:async(P,q,A,k,L,z)=>{var ae,de;await M(),N.value=!0,E.value=!0;const Q=(ae=g.value)!=null&&ae.messagesList?g.value.messagesList.length+1:1;try{(de=g.value)==null||de.messagesList.push({id:"",content:{text:"",references:[],citations:null},role:"AI",feedback:null,createdAt:new Date,updatedAt:new Date,error:!1,isCompleted:!1}),D.value=!0;const le={parent_message_id:k,conversation_id:L,question:P,metadata:z,model_id:A,tools:Array.from(q.values())};y.value.quoted="",await J();const te=await ro();U.value=new AbortController;const Z=await fetch(`${C}/conversations`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"text/event-stream",Authorization:`Bearer ${te}`},body:JSON.stringify(le),signal:U.value.signal});if(!Z.ok||!Z.body)throw new Error(`HTTP error: ${Z.status}`);D.value=!1;const re=Z.body.getReader(),ue=new TextDecoder("utf-8");let he="",$e="",Se=!1;for(;!Se;){const{done:be,value:Ge}=await re.read();if(Se=be,E.value=!1,be)break;const fe=ue.decode(Ge,{stream:!0});he+=fe;const Y=he.split(`

`);he=Y.pop();for(const ce of Y){if(!ce.trim())continue;const{event:ge,data:ye}=io(ce);$e=W(ge,ye,Q,$e)}}}catch(le){if(le instanceof Error&&le.name==="AbortError")return;g.value.messagesList[Q-1].content.text=`${le}`,g.value.messagesList[Q-1].error=!0}finally{E.value=!1,N.value=!1,g.value.messagesList[Q-1].isCompleted=!0}},stopAIResponse:M,fetchRecentConversationsWithAgent:$,fetchConversations:R,fetchConversationById:B,supportModels:x,fetchSupportModels:H,currentModel:b,shouldLeaveWhiteSpace:S,newMessageAdded:D,sendMessageFeedback:async(P,q)=>{var k;await it.post(`/conversations/${P.conversation_id}/messages/${P.message_id}/feedback`,q);const A=(k=g.value)==null?void 0:k.messagesList.find(L=>L.id===P.message_id);A.feedback=q.feedback},deleteMessageFeedback:async P=>{var A;await it.delete(`/conversations/${P.conversation_id}/messages/${P.message_id}/feedback`);const q=(A=g.value)==null?void 0:A.messagesList.find(k=>k.id===P.message_id);q.feedback=null},openCanvas:P=>{y.value.canvasStates=[P],y.value.canvasOpen=!0},closeCanvas:()=>{y.value.canvasStates=[],y.value.canvasOpen=!1},hints:I}}),Kp={class:"flex justify-between gap-2"},fa=oe({__name:"EzDialog",props:{title:{},description:{},footer:{type:Boolean,default:!0},contentClass:{},shouldDisableConfirmButton:{type:Boolean}},emits:["cancel","confirm"],setup(n,{emit:l}){const a=Ce(),{t:c}=We(a.t),r=n,p=v(!1),m=()=>{p.value=!1,g("cancel")},g=l;return(h,_)=>{const x=f("DialogTrigger"),b=f("DialogTitle"),S=f("DialogHeader"),D=f("DialogDescription"),y=f("Button"),I=f("DialogFooter"),C=f("DialogContent"),U=f("Dialog");return s(),T(U,{open:p.value,"onUpdate:open":[_[1]||(_[1]=E=>p.value=E),_[2]||(_[2]=E=>g("cancel"))]},{default:i(()=>[o(x,{"as-child":""},{default:i(()=>[we(h.$slots,"trigger")]),_:3}),o(C,{class:pe(r.contentClass)},{default:i(()=>[o(S,null,{default:i(()=>[o(b,null,{default:i(()=>[we(h.$slots,"title",{},()=>[me(d(r.title),1)])]),_:3})]),_:3}),o(D,null,{default:i(()=>[we(h.$slots,"description",{},()=>[me(d(r.description),1)])]),_:3}),r.footer?(s(),T(I,{key:0},{default:i(()=>[t("div",Kp,[o(y,{onClick:m,variant:"outline",size:"full"},{default:i(()=>[we(h.$slots,"cancel",{},()=>[me(d(e(c)("ezDialog.footer.button.cancel")),1)])]),_:3}),o(y,{onClick:_[0]||(_[0]=E=>g("confirm")),disabled:r.shouldDisableConfirmButton,size:"full"},{default:i(()=>[we(h.$slots,"confirm",{},()=>[me(d(e(c)("ezDialog.footer.button.confirm")),1)])]),_:3},8,["disabled"])])]),_:3})):w("",!0)]),_:3},8,["class"])]),_:3},8,["open"])}}}),qp=n=>{let l=0;for(let a=0;a<n.length;a++)l=n.charCodeAt(a)+((l<<5)-l);return Math.abs(l)%16},Qp=n=>`bg-linear-60 from-hue-from to-hue hue-${qp(n)}`,Xl=oe({__name:"Avatar",props:{class:{}},setup(n){const l=n;return(a,c)=>(s(),T(e(pc),{"data-slot":"avatar",class:pe(e(Me)("relative flex size-8 shrink-0 overflow-hidden rounded-full",l.class))},{default:i(()=>[we(a.$slots,"default")]),_:3},8,["class"]))}}),Yl=oe({__name:"AvatarFallback",props:{delayMs:{},asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=la(l,"class");return(c,r)=>(s(),T(e(mc),He({"data-slot":"avatar-fallback"},e(a),{class:e(Me)("bg-muted flex size-full items-center justify-center rounded-full",l.class)}),{default:i(()=>[we(c.$slots,"default")]),_:3},16,["class"]))}}),Zl=oe({__name:"AvatarImage",props:{src:{},referrerPolicy:{},crossOrigin:{},asChild:{type:Boolean},as:{}},setup(n){const l=n;return(a,c)=>(s(),T(e(gc),He({"data-slot":"avatar-image"},l,{class:"aspect-square size-full"}),{default:i(()=>[we(a.$slots,"default")]),_:3},16))}}),wt=oe({__name:"EzAvatar",props:{size:{default:"xs"},src:{default:"fallbackSrc"},alt:{},fallbackText:{},avatarClass:{},fallbackClass:{}},setup(n){const l=n,a=ne(()=>l.fallbackText&&l.fallbackText!=="Untitled"?l.fallbackText.charAt(0).toUpperCase():"#"),c=ne(()=>{switch(l.size){case"xxs":return"h-6 w-6 text-xs text-white";case"xs":return"h-7 w-7 text-xs text-white";case"sm":return"h-9 w-9 text-sm text-white";case"lg":return"h-16 w-16 text-xl text-white";case"base":default:return"h-12 w-12 text-lg text-white"}});return(r,p)=>(s(),T(e(Xl),{class:pe(e(Me)(l.avatarClass,c.value))},{default:i(()=>[o(e(Zl),{src:l.src??"",alt:l.alt},null,8,["src","alt"]),o(e(Yl),{class:pe(e(Me)(r.fallbackClass,c.value,e(Qp)(a.value)))},{default:i(()=>[me(d(a.value),1)]),_:1},8,["class"])]),_:1},8,["class"]))}}),mt=js.create({baseURL:"https://privategpt.fptconsulting.co.jp/api/workspace/v1",headers:{"Content-Type":"application/json"}});mt.interceptors.request.use(async n=>{const l=Ot();await l.initializeClient();const a=await l.getUserAccessToken();return a&&(n.headers.Authorization=`Bearer ${a}`),n},n=>Promise.reject(n));const ei=js.create({...mt.defaults,baseURL:"https://privategpt.fptconsulting.co.jp/api"});ei.interceptors.request.use(async n=>{const l=Ot();await l.initializeClient();const a=await l.getUserAccessToken();return a&&(n.headers.Authorization=`Bearer ${a}`),n},n=>Promise.reject(n));const as=Ft("workspaceStore",()=>{const n=v([]),l=v(),a=v(!1),c="https://privategpt.fptconsulting.co.jp/api",r=v([]),p=v(),m=v(0),g=v({}),h=v(""),_=v(""),x=v(""),b=v(!1),S=async()=>{if(n.value.length>0)return;const R=await mt.get("/workspaces");n.value=fp(R.data)},D=async R=>{b.value=!0;try{const B=await mt.get(`/workspaces/${R}`);l.value=vp(B.data),h.value=l.value.currentUserInfo.id,g.value[l.value.id]=l.value.currentUserInfo.workspace_role}finally{b.value=!1}},y=v([]),I=async R=>{const{data:B}=await ei.get(`${c}/users`,{params:R});y.value=B},C=async(R,B)=>{const j=B.map(ee=>({email:ee.email}));await mt.post(`workspaces/${R}/members`,j),await U(R,{offset:m.value,limit:20})},U=async(R,B)=>{const{data:j}=await mt.get(`/workspaces/${R}/members`,{params:B});r.value=j.items,p.value=j.total,m.value=j.offset};return{isSelectWorkspaceDialogOpen:a,workspaceList:n,currentWorkspace:l,getAllWorkspaces:S,getCurrentWorkspace:D,users:y,getUsers:I,addMemberToWorkspace:C,membersInCurrentWorkspace:r,totalMember:p,currentDataTableOffset:m,getMembersInWorkspace:U,currentUserRoleInWorkspace:g,currentUserIdInWorkspace:h,changeMemberRoleWorkspace:async(R,B,j)=>{await mt.put(`/workspaces/${R}/members/${B}`,{role:j})},removeMemberFromWorkspace:async(R,B)=>{await mt.delete(`/workspaces/${R}/members/${B}`),await U(R,{offset:m.value,limit:20})},userSearchMemberInput:_,updateWorkspaceSettings:async(R,B)=>{if(await mt.put(`/workspaces/${R}`,B),B.name){const j=n.value.find(ee=>R===ee.id);if(!j)return;j.name=B.name}},newWorkspaceName:x,loadingGetCurrentWorkspace:b}}),Jp={class:"grid grid-cols-2 gap-4 mt-2"},Xp={class:"font-semibold line-clamp-2 flex-1"},Yp=oe({__name:"SelectWorkspaceDialog",setup(n){const l=Ce(),{t:a}=We(l.t),c=ot(),r=as(),{workspaceList:p,isSelectWorkspaceDialogOpen:m,currentWorkspace:g}=ie(r),h=()=>{c.push("/")};return(_,x)=>{const b=f("RouterLink");return s(),T(fa,{open:e(m),"onUpdate:open":x[0]||(x[0]=S=>kt(m)?m.value=S:null),footer:!1,onCancel:h},{title:i(()=>[me(d(e(a)("workspace.selectWorkspaceDialog.title")),1)]),description:i(()=>[t("div",Jp,[(s(!0),u(ve,null,Le(e(p),S=>{var D;return s(),T(b,{key:S.id,to:`/workspace/${S.id}`,class:pe([{"bg-stone-200 dark:bg-white dark:text-black cursor-not-allowed":S.id===((D=e(g))==null?void 0:D.id)},"border rounded-lg p-4 flex items-center gap-2 justify-center transition-colors hover:bg-stone-200 dark:hover:bg-white dark:hover:text-black dark:bg-stone-500"])},{default:i(()=>[o(wt,{fallbackText:S.name,size:"xs"},null,8,["fallbackText"]),t("span",Xp,d(S.name),1)]),_:2},1032,["to","class"])}),128))])]),_:1},8,["open"])}}}),Zp=oe({__name:"App",setup(n){const l=Ce(),{t:a}=We(l.t),c=tt(),{toast:r}=gt(),p=ps(),{getMyCurrentLanguage:m}=p,{mode:g}=ie(p),h=Is(),{selectedFiles:_,embedFailedFiles:x,uploadingFileCount:b}=ie(h),S=Gt(),{currentAgent:D,currentAgentId:y}=ie(S),I=qs(),{isDroppingFileToAgent:C}=ie(I),U=Ks(),{processingStatuses:E,fileRecordingList:N,currentFileRecording:$}=ie(U),{removeFile:R,fetchFileRecordingById:B}=U,j=ms(),{currentConversation:ee}=ie(j),se=v(!1),G=ne(()=>c.meta.allowDragAndDrop),J=()=>C.value||!G.value,H=(V,F)=>{if(V.length===0)return;const P=V.map(A=>A.name).join(", "),q=V.length===1?a("home.toast.fail.uploadFileFailSingle",{fileName:P}):a("home.toast.fail.uploadFileFailPlural",{fileName:P});r({title:a(F),description:q,variant:"destructive"})},M=async V=>{var q;if(V.preventDefault(),J()||!((q=V.dataTransfer)!=null&&q.files))return;const F=Array.from(V.dataTransfer.files);if(h.wouldExceedUploadFileLimit(F.length)){r({title:a("home.toast.fail.generalErrorTitle"),description:a("home.toast.fail.exceedLimitNumberOfFile",{maxFilesPerMessage:Ga,maxFilesPerConversation:Wa}),variant:"destructive"});return}const P=F.map(W);b.value+=P.filter(A=>A.isValidExtension&&A.isValidSize).length,H(P.flatMap(A=>A.isValidExtension?[]:[A.file]),"home.toast.fail.fileExtensionInvalid"),H(P.flatMap(A=>A.isValidSize?[]:[A.file]),"home.toast.fail.fileSizeInvalid");try{await h.uploadSelectedFiles()}catch(A){r({title:a("home.toast.fail.generalErrorTitle"),description:a("home.toast.fail.generalError"),variant:"destructive"}),console.error(A)}},W=V=>{const F=lo(V.name),P=V.size<La*1024*1024;if(F&&P){const q={file:V,fileUrl:["png","jpg","jpeg"].includes(Rt(V.name))?URL.createObjectURL(V):"",fileId:"",isProcessing:null};_.value.push(q)}return{isValidExtension:F,isValidSize:P,file:V}};Te(x.value,()=>{if(x.value.length>0){const V=x.value.map(P=>P.file.name).join(", "),F=x.value.length===1?a("home.toast.fail.uploadFileFailSingle",{fileName:V}):a("home.toast.fail.uploadFileFailPlural",{fileName:V});r({title:a("home.toast.fail.generalErrorTitle"),description:F,variant:"destructive"})}x.value.splice(0,x.value.length)});const X=ne(()=>c.name==="chat"||c.name==="home"),O=ne(()=>c.name==="agent-chat"||c.name==="chat"||c.name==="agent-chat-home");Te(O,()=>{O.value||(D.value=void 0,y.value=void 0,ee.value=void 0)}),Te(X,()=>{X.value||(ee.value=void 0)}),Dt(async()=>{const V=localStorage.getItem("theme");V&&(g.value=V,document.documentElement.className=V),await m()});const K=async V=>{var F;if(R(V),c.params.id===V&&((F=$.value)==null?void 0:F.status)!=="COMPLETED")try{await B(V)}catch(P){console.error(P),r({title:a("kaigikun.toast.fail.fetchRecording.title"),description:a("kaigikun.toast.fail.fetchRecording.description"),variant:"destructive"})}};return Te(E,async V=>{for(const[F,P]of Object.entries(V)){const q=N.value.find(A=>A.id===F);P==="COMPLETED"&&(r({title:a("kaigikun.toast.success.transcribeNewAudioRecording.title",{fileName:q==null?void 0:q.name}),description:a("kaigikun.toast.success.transcribeNewAudioRecording.description",{fileName:q==null?void 0:q.name}),variant:"default"}),K(F)),P==="FAILED"&&(r({title:a("kaigikun.toast.fail.transcribeNewAudioRecording.title",{fileName:q==null?void 0:q.name}),description:a("kaigikun.toast.fail.transcribeNewAudioRecording.description",{fileName:q==null?void 0:q.name}),variant:"destructive"}),K(F))}},{deep:!0}),(V,F)=>{const P=f("Toaster");return s(),u("div",{class:"font-app-font bg-white dark:bg-stone-900 transition-background duration-300",onDragover:F[0]||(F[0]=Ye(q=>se.value=!0,["prevent"])),onDragleave:F[1]||(F[1]=q=>se.value=!1),onDrop:F[2]||(F[2]=q=>{se.value=!1,M(q)})},[o(P,{duration:1600,class:"pointer-events-auto"}),o(Yp),o(e($r))],32)}}}),em={class:"container relative flex h-dvh flex-col items-center justify-center md:grid lg:max-w-none lg:grid-cols-2 lg:px-0 py-0"},tm={class:"lg:p-8"},sm={class:"mx-auto flex w-full flex-col justify-center space-y-6 sm:w-[350px]"},am={class:"flex flex-col space-y-2 text-center"},om={class:"text-2xl font-semibold tracking-tight mb-2"},nm={class:"ml-2"},lm=oe({__name:"LoginView",setup(n){const{t:l}=Ce(),a=v(!1),c=Ot(),{toast:r}=gt(),p=async()=>{await c.login(),c.isSecured?a.value=!0:a.value=!1};return Te(a,()=>{console.log("watch isLoggedIn"),a.value||r({title:l("login.toast.fail.authentication"),description:l("login.toast.fail.authenticationDescription"),variant:"destructive"})}),(m,g)=>{const h=f("Button");return s(),u("div",em,[g[1]||(g[1]=t("div",{class:"relative h-full flex-col bg-muted p-10 text-white dark:border-r lg:flex hidden"},[t("div",{class:"absolute inset-0 bg-zinc-900"})],-1)),t("div",tm,[t("div",sm,[t("div",am,[t("h1",om,d(e(l)("login.label.signIn")),1),o(h,{onClick:p},{default:i(()=>[g[0]||(g[0]=t("i",{class:"bi bi-microsoft"},null,-1)),t("span",nm,d(e(l)("login.button.signIn")),1)]),_:1,__:[0]})])])])])}}}),im={class:"flex flex-col items-center justify-center h-screen bg-stone-100"},rm={class:"bg-red-100 border text-red-700 px-4 py-3 rounded relative w-4/5 md:w-1/3 text-center",role:"alert"},cm={class:"font-bold"},dm={class:"block sm:inline"},ti=oe({__name:"AccessDeniedView",setup(n){const{t:l}=Ce(),a=tt(),c=Ot(),r=async()=>{a.path==="/access-denied"?(console.log("ACCESS DENIED"),await c.logout()):window.history.back()};return(p,m)=>{const g=f("Button");return s(),u("div",im,[t("div",rm,[t("strong",cm,d(e(l)("login.label.title")),1),t("span",dm,d(e(l)("login.label.descriptionDenied")),1)]),o(g,{onClick:r,class:"mt-4 px-6 py-2 rounded-lg focus:outline-hidden focus:ring-2 focus:ring-blue-400 focus:ring-offset-2"},{default:i(()=>[me(d(e(a).path==="/access-denied"?e(l)("login.label.logOut"):e(l)("login.label.goBack")),1)]),_:1})])}}}),um=oe({__name:"AuthorizeView",setup(n){const l=Ot();return Vt(async()=>{await l.checkAuthorization()}),(a,c)=>(s(),u("h1",null,"Redirecting"))}}),si="/assets/FPT_logo-1mCU2RH5.svg",xt=Ft("sidebarStateStore",()=>{const n=v(!0),l=v(!1),a=v(!1),c=v(!1),r=v(!1),p=x=>{x.value=!x.value},m=(x,b)=>{x.value=b},g=v(!1);return{mobileSidebarState:l,privateGPTSidebarState:n,renameSpeakerSidebarState:a,bookmarkSidebarState:c,summarySidebarState:r,ignoreNextSidebarClose:g,toggleVisibleState:p,setVisibleState:m,setIgnore:()=>{g.value=!0},clearIgnore:()=>{g.value=!1}}}),ai="/assets/Samurai-CiH1mYFU.png",oi="/assets/Smart_Bidder_logo_dark-6XcJxeLt.png",ni="/assets/Smart_Bidder_logo-36G2Cout.png";var ns=(n=>(n.PRIVATE_GPT="PrivateGPT",n.KAIGIKUN="Kaigikun",n.QMS="QMS",n.WIKIFJP="WikiFJP",n.WORKSPACE="Samurai",n.SMARTBIDDER="SmartBidder",n))(ns||{});const ea=[{name:"PrivateGPT",icon:"bi bi-chat-left-dots",route:"/",isShow:!0},{name:"Kaigikun",icon:"bi bi-mic",route:"/kaigikun/record",isShow:!0},{name:"QMS",icon:"bi bi-file-earmark-ruled",route:"/qms",isShow:!0},{name:"WikiFJP",icon:"bi bi-file-earmark-ruled",route:"/wiki-fjp",isShow:!1},{name:"Samurai",icon:"",route:"/workspace",isShow:!0},{name:"SmartBidder",icon:"",route:"https://smartbidder.stu-platform.live/#/",isShow:!0}],at=Ft("screenStore",()=>{const n=xt(),{privateGPTSidebarState:l}=ie(n),a=Fn("(max-width: 768px)"),c=Fn("(max-width: 1279px");return Te(a,r=>{if(r){l.value=!1;return}l.value=!0}),Vt(()=>{a.value&&(l.value=!1)}),{isMobileSize:a,isLargeScreenSize:c}}),pm=n=>({app_name:n.appName,view_name:n.viewName,destination:n.destination,details:n.details}),li=js.create({baseURL:"https://privategpt.fptconsulting.co.jp/api/"+lp,headers:{"Content-Type":"application/json"}});li.interceptors.request.use(async n=>{const l=Ot();await l.initializeClient();const a=await l.getUserAccessToken();return a&&(n.headers.Authorization=`Bearer ${a}`),n},n=>Promise.reject(n));const mm=Ft("outboundStore",()=>({registerOutboundClick:async l=>{try{await li.post("/outbound",pm(l))}catch(a){console.error(a)}}})),gm=["title"],fm={class:"text-center"},vm={class:"pb-4 text-center"},hm={class:"mx-auto p-2 rounded-lg border wrap-anywhere"},_m={class:"text-stone-500"},bm={class:"font-bold text-stone-950 dark:text-stone-100"},km={class:"text-stone-500"},ym=["title","href"],xm=["href","title"],Hs=oe({__name:"TrackedHyperlink",props:{href:{},title:{},className:{},tracking:{}},setup(n){const l=Ce(),{t:a}=We(l.t),c=n,{registerOutboundClick:r}=mm(),p=ne(()=>!c.href.startsWith(window.location.origin)),m=v(!1),g=ne(()=>{if(!c.href)return{protocol:"",domain:"",rest:""};try{const _=new URL(c.href),x=_.protocol?_.protocol+(_.protocol.endsWith(":")?"":":")+(_.host?"//":""):"",b=_.host||"";let S="";return _.host?S=_.href.replace(x+b,""):S=_.href.replace(x,""),{protocol:x,domain:b,rest:S}}catch{return{protocol:"",domain:"",rest:c.href}}}),h=()=>{m.value=!1,r({appName:c.tracking.appName,destination:g.value.domain??c.href,viewName:c.tracking.viewName,details:{url:c.href,...c.tracking.additionalInfo}})};return(_,x)=>p.value?(s(),T(fa,{key:0,open:m.value,"onUpdate:open":x[0]||(x[0]=b=>m.value=b),onCancel:x[1]||(x[1]=b=>m.value=!1),onConfirm:h},{trigger:i(()=>[t("a",{href:"#",title:c.title??"",class:pe(_.className)},[we(_.$slots,"default")],10,gm)]),title:i(()=>[t("div",fm,d(e(a)("home.dialog.hyperlink.externalTitle")),1)]),description:i(()=>[t("div",vm,d(e(a)("home.dialog.hyperlink.externalLink")),1),t("div",hm,[t("span",_m,d(g.value.protocol),1),t("span",bm,d(g.value.domain),1),t("span",km,d(g.value.rest),1)])]),cancel:i(()=>[me(d(e(a)("home.dialog.hyperlink.goBack")),1)]),confirm:i(()=>[t("a",{title:c.title??"",href:c.href,target:"_blank",rel:"noopener noreferrer",class:"-mx-2 py-2 px-4 block rounded-full"},d(e(a)("home.dialog.hyperlink.openLink")),9,ym)]),_:3},8,["open"])):(s(),u("a",{key:1,href:c.href,title:c.title??"",class:pe(_.className)},[we(_.$slots,"default")],10,xm))}}),wm={key:0,class:"grid grid-rows-2 gap-2"},$m={key:1,src:ai,alt:"Samurai",height:"24",class:"h-8 -my-1 -ml-1"},Sm={class:"text-[0.5rem] text-center"},Tm={key:2,class:"absolute -top-2 -right-1 bg-stone-600 text-white text-[0.5rem] font-bold px-2 py-0.5 rounded-full shadow pointer-events-none select-none"},Am={class:"mt-2 relative flex rounded-xl w-13 h-13 hover:bg-stone-200 dark:hover:bg-stone-800 justify-center flex-col gap-1 items-center hover:cursor-pointer"},Cm={key:0,src:oi,width:"25",height:"24",class:"h-6",alt:"SmartBidder Logo"},Dm={key:1,src:ni,width:"25",height:"24",class:"h-6",alt:"SmartBidder Logo"},Lm={class:"text-[0.5rem] text-center"},Im={key:1,class:"flex flex-col gap-1 p-3"},Bm={class:"flex gap-3 items-center"},Mm={key:1,src:ai,alt:"Samurai",height:"24",class:"h-6"},Em={class:"text-xs text-center"},Rm={key:2,class:"bg-stone-600 text-white text-[0.45rem] font-bold px-2 py-0.5 rounded-full shadow pointer-events-none select-none"},Fm={class:"flex items-center p-1.5 rounded-md w-full cursor-pointer hover:bg-stone-200 dark:hover:bg-stone-800 justify-between"},Pm={class:"flex gap-3 items-center"},Nm={key:0,src:oi,width:"24",class:"w-4",alt:"SmartBidder Logo"},zm={key:1,src:ni,width:"24",class:"w-4",alt:"SmartBidder Logo"},Um={class:"text-xs text-center"},ii=oe({__name:"AppList",setup(n){const l=ps(),{mode:a}=ie(l),c=at(),{isMobileSize:r}=ie(c),p=tt(),m=ne(()=>ea.filter(h=>h.isShow)),g=ne(()=>p.path.startsWith("/kaigikun")?ea.find(h=>h.name===ns.KAIGIKUN):p.path.startsWith("/qms")?ea.find(h=>h.name===ns.QMS):p.path.startsWith("/wiki-fjp")?ea.find(h=>h.name===ns.WIKIFJP):p.path.startsWith("/workspace")?ea.find(h=>h.name===ns.WORKSPACE):ea.find(h=>h.name===ns.PRIVATE_GPT));return(h,_)=>{const x=f("RouterLink");return e(r)?(s(),u("div",Im,[(s(!0),u(ve,null,Le(m.value,(b,S)=>(s(),u("div",{class:"flex",key:S},[b.name!==e(ns).SMARTBIDDER?(s(),T(x,{key:0,to:b.route,class:pe(["flex items-center p-1.5 rounded-md w-full cursor-pointer hover:bg-stone-200 dark:hover:bg-stone-800 justify-between",{"border bg-background dark:bg-stone-700 px-2":g.value&&g.value.name===b.name}])},{default:i(()=>[t("div",Bm,[b.route!=="/workspace"?(s(),u("i",{key:0,class:pe(b.icon)},null,2)):w("",!0),b.route==="/workspace"?(s(),u("img",Mm)):w("",!0),t("span",Em,d(b.name),1),b.name===e(ns).WIKIFJP||b.name===e(ns).WORKSPACE?(s(),u("span",Rm,"BETA ")):w("",!0)])]),_:2},1032,["to","class"])):(s(),T(Hs,{key:1,href:b.route,tracking:{appName:"SMARTBIDDER",viewName:"HOME",additionalInfo:{}}},{default:i(()=>[t("div",Fm,[t("div",Pm,[e(a)==="light"?(s(),u("img",Nm)):(s(),u("img",zm)),t("span",Um,d(b.name),1),_[1]||(_[1]=t("span",{class:"bg-stone-600 text-white text-[0.45rem] font-bold px-2 py-0.5 rounded-full shadow pointer-events-none select-none"},"LINK ",-1))])])]),_:2},1032,["href"]))]))),128))])):(s(),u("div",wm,[(s(!0),u(ve,null,Le(m.value,(b,S)=>(s(),u(ve,{key:S},[b.name!==e(ns).SMARTBIDDER?(s(),T(x,{key:0,to:b.route,class:pe(["relative flex rounded-xl w-13 h-13 hover:bg-stone-200 dark:hover:bg-stone-800 justify-center flex-col gap-1 items-center hover:cursor-pointer border",{"bg-background dark:bg-stone-800 shadow-xs":g.value&&g.value.name===b.name,"border-transparent":!g.value||g.value.name!==b.name,"sm:mt-2":b.name===e(ns).WIKIFJP||b.name===e(ns).WORKSPACE}])},{default:i(()=>[b.route!=="/workspace"?(s(),u("i",{key:0,class:pe(b.icon)},null,2)):w("",!0),b.route==="/workspace"?(s(),u("img",$m)):w("",!0),t("span",Sm,d(b.name),1),b.name===e(ns).WIKIFJP||b.name===e(ns).WORKSPACE?(s(),u("span",Tm,"BETA ")):w("",!0)]),_:2},1032,["to","class"])):(s(),T(Hs,{key:1,href:b.route,tracking:{appName:"SMARTBIDDER",viewName:"HOME",additionalInfo:{}}},{default:i(()=>[t("div",Am,[e(a)==="light"?(s(),u("img",Cm)):(s(),u("img",Dm)),t("span",Lm,d(b.name),1),_[0]||(_[0]=t("span",{class:"absolute -top-2 -right-1 bg-stone-600 text-white text-[0.5rem] font-bold px-2 py-0.5 rounded-full shadow pointer-events-none select-none"},"LINK ",-1))])]),_:2},1032,["href"]))],64))),128))]))}}}),ri=oe({__name:"DialogFooter",props:{class:{}},setup(n){const l=n;return(a,c)=>(s(),u("div",{class:pe(e(Me)("flex flex-col-reverse sm:flex-row sm:justify-end sm:gap-x-2",l.class))},[we(a.$slots,"default")],2))}}),Om=Ft("supportStore",()=>{const n="https://privategpt.fptconsulting.co.jp/api",l=v([]),a=v(""),c=v("");return{issues:l,getIssueList:async()=>{try{if(l.value.length>0)return;const{data:m}=await ma.get(`${n}/support/report/category`);l.value=m}catch(m){console.error("Failed to fetch issue list: ",m)}},postSelectedIssue:async()=>{await ma.post(`${n}/support/report`,{feedback_category:a.value,message:c.value})},messageIssue:c,selectedIssueId:a}}),jm={class:"text-xs"},Vm={class:"my-5"},Gm={class:"text-xs my-1 ml-1"},ci=oe({__name:"UserSupportSetting",props:{isButtonDisplay:{type:Boolean,default:!1}},setup(n){const l=n,a=Om(),{issues:c,messageIssue:r,selectedIssueId:p}=ie(a),{getIssueList:m,postSelectedIssue:g}=a,{t:h}=Ce(),_=v(!1),x=()=>{b.value=!1,_.value=!0,p.value="",r.value=""},b=v(!1),S=async()=>{b.value=!0;try{await g(),_.value=!1,Ue({title:h("home.toast.success.issueReport.header"),description:h("home.toast.success.issueReport.description")})}catch(D){console.log("Report issue error: ",D),Ue({title:h("home.toast.fail.generalErrorTitle"),description:h("home.toast.fail.generalError"),variant:"destructive"})}};return Vt(async()=>{await m()}),(D,y)=>{const I=f("Button"),C=f("DialogTrigger"),U=f("TooltipTrigger"),E=f("TooltipContent"),N=f("Tooltip"),$=f("TooltipProvider"),R=f("DialogTitle"),B=f("DialogHeader"),j=f("SelectValue"),ee=f("SelectTrigger"),se=f("SelectItemText"),G=f("SelectItem"),J=f("SelectGroup"),H=f("SelectContent"),M=f("Select"),W=f("Textarea"),X=f("Loader"),O=f("DialogContent"),K=f("Dialog");return s(),T(K,{open:_.value,"onUpdate:open":y[2]||(y[2]=V=>_.value=V)},{default:i(()=>[l.isButtonDisplay?(s(),T(C,{key:0,"as-child":"",onClick:x},{default:i(()=>[o(I,{variant:"ghost",size:"full"},{default:i(()=>[y[3]||(y[3]=t("i",{class:"bi bi-question-circle"},null,-1)),t("span",jm,d(e(h)("home.userSettings.customerSupport.title")),1)]),_:1,__:[3]})]),_:1})):w("",!0),o($,null,{default:i(()=>[o(N,null,{default:i(()=>[o(U,{"as-child":""},{default:i(()=>[l.isButtonDisplay?w("",!0):(s(),T(C,{key:0,"as-child":"",onClick:x},{default:i(()=>[o(I,{variant:"ghost",size:"icon"},{default:i(()=>y[4]||(y[4]=[t("i",{class:"bi bi-question-circle"},null,-1)])),_:1,__:[4]})]),_:1}))]),_:1}),o(E,{side:"right"},{default:i(()=>[me(d(e(h)("home.userSettings.customerSupport.title")),1)]),_:1})]),_:1})]),_:1}),o(O,{class:"max-w-sm rounded-md sm:rounded-lg sm:max-w-lg"},{default:i(()=>[o(B,null,{default:i(()=>[o(R,null,{default:i(()=>[me(d(e(h)("home.userSettings.customerSupport.dialog.header")),1)]),_:1})]),_:1}),t("div",null,[o(M,{modelValue:e(p),"onUpdate:modelValue":y[0]||(y[0]=V=>kt(p)?p.value=V:null),id:"issue-select"},{default:i(()=>[o(ee,{class:"w-full flex justify-between items-center"},{default:i(()=>[o(j,{placeholder:e(h)("home.userSettings.customerSupport.dialog.select.placeholder")},null,8,["placeholder"]),y[5]||(y[5]=t("i",{class:"bi bi-chevron-down opacity-60"},null,-1))]),_:1,__:[5]}),o(H,null,{default:i(()=>[(s(!0),u(ve,null,Le(e(c),V=>(s(),T(J,{key:V.id},{default:i(()=>[o(G,{value:V.id},{default:i(()=>[o(se,null,{default:i(()=>[me(d(V.title),1)]),_:2},1024)]),_:2},1032,["value"])]),_:2},1024))),128))]),_:1})]),_:1},8,["modelValue"])]),t("div",null,[t("div",Vm,[t("p",Gm,d(e(h)("home.userSettings.customerSupport.dialog.textAreaTitle")),1),o(W,{id:"customer-issue-report-textarea",modelValue:e(r),"onUpdate:modelValue":y[1]||(y[1]=V=>kt(r)?r.value=V:null),class:"text-xs min-h-20",placeholder:e(h)("home.userSettings.customerSupport.dialog.placeHolder")},null,8,["modelValue","placeholder"])])]),o(ri,null,{default:i(()=>[o(I,{disabled:!e(r)||!e(p)||b.value,class:"px-5",onClick:S},{default:i(()=>[b.value?(s(),T(X,{key:0,class:"w-4 h-4 animate-spin mr-2"})):w("",!0),me(" "+d(e(h)("home.userSettings.customerSupport.dialog.button.send")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])}}}),ts=oe({__name:"Button",props:{variant:{},size:{},class:{},asChild:{type:Boolean},as:{default:"button"}},setup(n){const l=n;return(a,c)=>(s(),T(e(fc),{as:a.as,"as-child":a.asChild,class:pe(e(Me)(e(Zo)({variant:a.variant,size:a.size}),l.class))},{default:i(()=>[we(a.$slots,"default")]),_:3},8,["as","as-child","class"]))}}),Zo=oo("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{variants:{variant:{default:"rounded-3xl bg-primary text-primary-foreground hover:bg-primary/90",destructive:"text-red-500 hover:bg-accent/90",outline:"border rounded-3xl border-input bg-background hover:bg-accent dark:outline hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",dull:"text-primary"},size:{default:"h-10 px-3 py-2",xs:"h-7 rounded px-2",sm:"h-9 rounded-2xl px-3",lg:"h-11 rounded-md px-7 py-7",full:"h-10 w-full px-2 [&>span]:grow font-normal text-left space-x-2 [&>i]:text-lg",bigicon:"h-10 h-10 text-3xl",icon:"h-10 w-10 text-xl",smicon:"h-5 w-5 text-xs",mdicon:"h-7 w-7 text-md"}},defaultVariants:{variant:"default",size:"default"}}),di=oe({__name:"Tooltip",props:{defaultOpen:{type:Boolean},open:{type:Boolean},delayDuration:{},disableHoverableContent:{type:Boolean},disableClosingTrigger:{type:Boolean},disabled:{type:Boolean},ignoreNonKeyboardFocus:{type:Boolean}},emits:["update:open"],setup(n,{emit:l}){const r=$t(n,l);return(p,m)=>(s(),T(e(vc),At(Ct(e(r))),{default:i(()=>[we(p.$slots,"default")]),_:3},16))}}),ui=oe({inheritAttrs:!1,__name:"TooltipContent",props:{forceMount:{type:Boolean},ariaLabel:{},asChild:{type:Boolean},as:{},side:{},sideOffset:{default:4},align:{},alignOffset:{},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},class:{}},emits:["escapeKeyDown","pointerDownOutside"],setup(n,{emit:l}){const a=n,c=l,r=ne(()=>{const{class:m,...g}=a;return g}),p=$t(r,c);return(m,g)=>(s(),T(e(_c),null,{default:i(()=>[o(e(hc),He({...e(p),...m.$attrs},{class:e(Me)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a.class)}),{default:i(()=>[we(m.$slots,"default")]),_:3},16,["class"])]),_:3}))}}),en=oe({__name:"TooltipProvider",props:{delayDuration:{default:100},skipDelayDuration:{default:100},disableHoverableContent:{type:Boolean},disableClosingTrigger:{type:Boolean,default:!0},disabled:{type:Boolean},ignoreNonKeyboardFocus:{type:Boolean,default:!0}},setup(n){const l=n;return(a,c)=>(s(),T(e(bc),At(Ct(l)),{default:i(()=>[we(a.$slots,"default")]),_:3},16))}}),tn=oe({__name:"TooltipTrigger",props:{asChild:{type:Boolean},as:{}},setup(n){const l=n;return(a,c)=>(s(),T(e(kc),At(Ct(l)),{default:i(()=>[we(a.$slots,"default")]),_:3},16))}}),Wm={class:"wrap-anywhere line-clamp-2 max-w-xl"},Pe=oe({__name:"EzButton",props:{active:{type:Boolean},activeClass:{default:"bg-stone-200 dark:bg-stone-600"},icon:{},disabled:{type:Boolean},size:{default:"smicon"},variant:{default:"ghost"},className:{},tooltip:{},tooltipSide:{default:"top"}},emits:["click"],setup(n,{emit:l}){const a=n,c=l;return(r,p)=>(s(),T(e(en),null,{default:i(()=>[o(e(di),null,{default:i(()=>[o(e(tn),{"as-child":""},{default:i(()=>[o(e(ts),{variant:a.variant,class:pe({[a.activeClass]:a.active,[a.className??""]:!0}),size:a.size,disabled:a.disabled,onClick:p[0]||(p[0]=m=>c("click",m))},{default:i(()=>[a.icon?(s(),u("i",{key:0,class:pe(a.icon)},null,2)):w("",!0),we(r.$slots,"default")]),_:3},8,["variant","class","size","disabled"])]),_:3}),a.tooltip?(s(),T(e(ui),{key:0,side:a.tooltipSide},{default:i(()=>[t("p",Wm,d(a.tooltip),1)]),_:1},8,["side"])):w("",!0)]),_:3})]),_:3}))}}),Hm={class:"hidden sm:flex w-fit p-2 bg-stone-100 dark:bg-stone-950 h-dvh flex-col items-center gap-1 py-1 transition-all duration-300"},Km=["src"],qm={class:"flex-1 flex flex-col overflow-x-hidden items-center overflow-y-auto -mx-2 px-2"},Qm=oe({__name:"AppMainSidebar",setup(n){const l=ps(),{mode:a}=ie(l),c=tt(),r=ot(),p=Ot(),m=xt(),{privateGPTSidebarState:g}=ie(m),h=Ce(),{t:_}=We(h.t),x=ne(()=>c.path.match(/kaigikun/i)),b=ne(()=>c.path.match(/qms/i)),S=()=>{x.value?r.push("/kaigikun/record"):b.value?r.push("/qms"):r.push("/")},D=()=>{m.toggleVisibleState(g)},y=()=>{switch(a.value){case"light":a.value="dark",localStorage.setItem("theme","dark");break;case"dark":a.value="light",localStorage.setItem("theme","light");break;default:a.value="light",localStorage.setItem("theme","light")}document.documentElement.className=a.value};return(I,C)=>{const U=f("Button"),E=f("AlertDialogTrigger"),N=f("TooltipTrigger"),$=f("TooltipContent"),R=f("Tooltip"),B=f("TooltipProvider"),j=f("AlertDialogTitle"),ee=f("AlertDialogDescription"),se=f("AlertDialogHeader"),G=f("AlertDialogCancel"),J=f("AlertDialogAction"),H=f("AlertDialogFooter"),M=f("AlertDialogContent"),W=f("AlertDialog");return s(),u("div",Hm,[t("img",{src:e(si),alt:"FPT Logo",class:"hover:cursor-pointer py-1 xl:py-4",onClick:S},null,8,Km),t("div",qm,[o(ii)]),o(Pe,{size:"icon",onClick:y,icon:{bi:!0,"bi-sun":e(a)==="dark","bi-moon":e(a)==="light"},tooltip:e(a)==="light"?e(_)("home.mainSidebar.tooltip.darkMode"):e(_)("home.mainSidebar.tooltip.lightMode"),"tooltip-side":"right"},null,8,["icon","tooltip"]),o(ci,{"is-button-display":!1}),o(W,null,{default:i(()=>[o(B,null,{default:i(()=>[o(R,null,{default:i(()=>[o(N,{"as-child":""},{default:i(()=>[o(E,{"as-child":""},{default:i(()=>[o(U,{size:"icon",variant:"ghost"},{default:i(()=>C[0]||(C[0]=[t("i",{class:"bi bi-box-arrow-right"},null,-1)])),_:1,__:[0]})]),_:1})]),_:1}),o($,{side:"right"},{default:i(()=>[t("p",null,d(e(_)("home.mainSidebar.tooltip.logOut")),1)]),_:1})]),_:1})]),_:1}),o(M,null,{default:i(()=>[o(se,null,{default:i(()=>[o(j,null,{default:i(()=>[me(d(e(_)("home.mainSidebar.dialog.logOut.title")),1)]),_:1}),o(ee,null,{default:i(()=>[me(d(e(_)("home.mainSidebar.dialog.logOut.description")),1)]),_:1})]),_:1}),o(H,null,{default:i(()=>[o(G,null,{default:i(()=>[me(d(e(_)("home.mainSidebar.button.cancel")),1)]),_:1}),o(J,{class:"bg-red-500 hover:bg-red-600",onClick:e(p).logout},{default:i(()=>[me(d(e(_)("home.mainSidebar.button.logOut")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1}),o(B,null,{default:i(()=>[o(R,null,{default:i(()=>[o(N,{"as-child":""},{default:i(()=>[o(U,{variant:"ghost",size:"icon",onClick:D},{default:i(()=>C[1]||(C[1]=[t("i",{class:"bi bi-three-dots-vertical"},null,-1)])),_:1,__:[1]})]),_:1}),o($,{side:"right"},{default:i(()=>[t("p",null,d(e(_)("home.mainSidebar.tooltip.closeSidebar")),1)]),_:1})]),_:1})]),_:1})])}}}),Jm={class:"w-full h-dvh flex"},Xm={key:1,class:"flex flex-0"},Ym={class:"relative"},Zm={class:"flex-1 flex"},eg=oe({__name:"MainLayout",setup(n){const l=at(),{isMobileSize:a}=ie(l),c=xt(),{clearIgnore:r}=c,{privateGPTSidebarState:p,mobileSidebarState:m,ignoreNextSidebarClose:g}=ie(c),h=()=>{c.setVisibleState(m,!1),c.setVisibleState(p,!1)},_=Bt("clickOutsideTargetRef");return aa(_,()=>{if(g.value){r();return}h()}),(x,b)=>{const S=f("RouterView");return s(),u("div",Jm,[e(a)?(s(),u("div",{key:0,class:"absolute top-0 left-0 z-50",ref_key:"clickOutsideTargetRef",ref:_},b[0]||(b[0]=[t("div",{id:"mobile-sub-sidebar"},null,-1)]),512)):(s(),u("div",Xm,[t("div",Ym,[b[1]||(b[1]=t("div",{class:"absolute inset-0 pointer-events-none z-30 before:content-[''] before:absolute before:inset-0 before:inset-shadow-right dark:before:inset-shadow-stone-100/7.5 before:inset-shadow-stone-950/7.5"},null,-1)),o(Qm)]),b[2]||(b[2]=t("div",{class:"relative"},[t("div",{class:"absolute inset-0 pointer-events-none z-30 before:content-[''] before:absolute before:inset-0 before:inset-shadow-right dark:before:inset-shadow-stone-100/7.5 before:inset-shadow-stone-950/7.5"}),t("div",{id:"sub-sidebar"})],-1))])),o(fl,{name:"fade"},{default:i(()=>[e(a)?(s(),u("div",{key:0,class:pe(["fixed backdrop-blur-2xs inset-0 bg-black/80 dark:bg-stone-950/80 z-45",e(m)?"":"hidden pointer-events-none"])},null,2)):w("",!0)]),_:1}),t("div",Zm,[o(S)])])}}}),tg={class:"relative h-0"},sg={class:"flex flex-1 overflow-hidden"},ag={class:"relative h-0"},og={key:0,class:"relative h-0"},sn=oe({__name:"ScrollableContainer",props:{disableShadowTop:{type:Boolean},disableShadowBottom:{type:Boolean},disableScrollToBottom:{type:Boolean},shadowStyleTop:{},shadowStyleBottom:{}},emits:["arrivedBottom","leaveBottom","arrivedTop","leaveTop"],setup(n,{expose:l,emit:a}){const{t:c}=We(Ce().t),r=n,p=a,m=Bt("container"),{measure:g,arrivedState:h}=Wo(m,{throttle:200,offset:{top:20,bottom:20}}),_=new MutationObserver(ec(async()=>{g()},500,{leading:!1,trailing:!0})),x=new ResizeObserver(()=>{m.value&&m.value.style.setProperty("--scrollable-container-height",m.value.clientHeight+"px")}),b=D=>{var y,I;(I=m.value)==null||I.scrollTo({top:(y=m.value)==null?void 0:y.scrollHeight,behavior:D?"instant":"smooth"})};return l({scrollToBottom:b,scrollToTop:D=>{var y;(y=m.value)==null||y.scrollTo({top:0,behavior:D?"instant":"smooth"})}}),Te(()=>h.top,D=>{m.value&&(D&&m.value.scrollHeight>m.value.clientHeight&&p("arrivedTop"),D||p("leaveTop"))}),Te(()=>h.bottom,D=>{m.value&&(D&&m.value.scrollHeight>m.value.clientHeight&&p("arrivedBottom"),D||p("leaveBottom"))}),Vt(async()=>{await Et(),m.value&&(_.observe(m.value,{childList:!0,subtree:!0}),x.observe(m.value,{box:"content-box"}))}),ls(()=>{_.disconnect(),x.disconnect()}),(D,y)=>(s(),u(ve,null,[t("div",tg,[r.disableShadowTop?w("",!0):(s(),u("div",{key:0,class:pe([e(Me)("absolute h-5 left-0 right-0 top-0 z-10 border-t border-stone-200/50 dark:border-stone-700/80 transition-opacity duration-500 inset-shadow-top pointer-events-none",r.shadowStyleTop??""),e(h).top?"opacity-0":"opacity-100"])},null,2))]),t("div",sg,[t("div",He({ref_key:"container",ref:m,class:"overflow-y-scroll scroll-smooth"},D.$attrs),[we(D.$slots,"default")],16)]),t("div",ag,[o(fl,{name:"fade-up"},{default:i(()=>[!e(h).bottom&&!r.disableScrollToBottom?(s(),u("div",og,[o(Pe,{icon:"bi bi-arrow-down text-sm",size:"icon",variant:"default","class-name":"absolute h-9 w-9 border border-stone-800 -mt-18 rounded-full z-20 mx-auto shadow-md shadow-stone-900/50 left-1/2",tooltip:e(c)("kaigiInstantRecord.button.scrollToBottom"),onClick:y[0]||(y[0]=I=>b())},null,8,["tooltip"])])):w("",!0)]),_:1}),r.disableShadowBottom?w("",!0):(s(),u("div",{key:0,class:pe([e(Me)("absolute h-5 left-0 right-0 bottom-0 z-10 border-b transition-opacity duration-500 inset-shadow-bottom pointer-events-none",r.shadowStyleBottom??""),e(h).bottom?"opacity-0":"opacity-100"])},null,2))])],64))}}),Jt={mounted:async(n,l)=>{l.value&&(await Ca(200),n instanceof HTMLElement?n.focus():n[0]instanceof HTMLElement?n[0].focus():console.warn("vAutofocus: Cannot focus element, invalid target:",n))}},ng={class:"flex flex-col"},lg={key:0,class:"relative flex border border-input bg-white dark:bg-stone-700 p-3 items-center justify-between rounded-lg mt-3"},ig={class:"flex flex-row items-center gap-2 pr-2"},rg={class:"whitespace-nowrap overflow-hidden text-ellipsis max-w-[150px]"},cg={key:1,class:"bi bi-check text-green-500 opacity-100"},dg={key:2},ug=["src"],pg=["onKeydown"],mg=["src"],gg={key:2},Xa=oe({__name:"ContextFileItem",props:{file:{},fileUrl:{},fileId:{},fileName:{},readyIcon:{type:Boolean,default:!1},isProcessing:{type:[Boolean,null],default:null},deleteButton:{type:Boolean,default:!1}},setup(n){const l=Is(),a=ms(),{currentConversation:c}=ie(a),r=n,p=v(),m=Rt(r.fileName),g=v(1);setTimeout(()=>{g.value=0},1500);const h=v(!1),_=async()=>{h.value=!h.value};Vt(async()=>{r.fileName&&r.fileId&&["png","jpg","jpeg"].includes(Rt(r.fileName))&&(p.value=await l.getImageUrl(r.fileId),c===void 0&&(p.value=void 0))});const x=tt();return Te(()=>x.params.id,async()=>{if(p.value)p.value=void 0,r.fileName&&r.fileId&&["png","jpg","jpeg"].includes(Rt(r.fileName))&&(p.value=await l.getImageUrl(r.fileId));else return}),(b,S)=>{const D=f("Loader"),y=f("Button");return s(),u("div",ng,[r.fileName!==void 0&&!["png","jpg","jpeg"].includes(e(Rt)(r.fileName))?(s(),u("div",lg,[t("div",ig,[t("i",{class:pe(["bi",`bi-filetype-${e(m)}`,"text-3xl"])},null,2),t("p",rg,d(r.fileName),1)]),r.isProcessing?(s(),T(D,{key:0,class:"w-4 h-4 animate-spin"})):w("",!0),!r.isProcessing&&r.readyIcon?(s(),u("i",cg)):w("",!0),r.deleteButton&&r.isProcessing===!1?(s(),u("div",dg,[o(y,{variant:"default",size:"smicon",class:"absolute top-[-6px] right-[-6px] rounded-full w-4 h-4",onClick:S[0]||(S[0]=I=>e(l).deleteReadyFile(r.fileId))},{default:i(()=>S[2]||(S[2]=[t("i",{class:"bi bi-x"},null,-1)])),_:1,__:[2]})])):w("",!0)])):w("",!0),r.fileName!==void 0&&["png","jpg","jpeg"].includes(e(Rt)(r.fileName))?(s(),u("div",{key:1,class:pe(["relative flex shrink-0 w-16 rounded-2xl",r.isProcessing?"bg-stone-400 opacity-70":""])},[t("img",{src:p.value??r.fileUrl,class:pe(["w-16 h-16 object-cover cursor-pointer border border-gray-300 dark:border-stone-800 rounded-2xl",r.isProcessing?"bg-stone-400 opacity-70":""]),onClick:_},null,10,ug),r.isProcessing?(s(),T(e(zs),{key:0,class:"w-8 h-8 absolute top-1/4 left-1/4 animate-spin"})):w("",!0),h.value?Ke((s(),u("div",{key:1,tabindex:"0",class:"backdrop-filter-xs fixed top-0 left-0 w-full h-full py-4 bg-black/80 dark:bg-stone-950/80 flex items-center justify-center z-50",onKeydown:yt(Ye(_,["exact","prevent"]),["esc"]),onClick:_},[S[3]||(S[3]=t("button",{class:"absolute top-4 right-4 text-white bg-stone-800 hover:bg-stone-600 rounded-full w-8 h-8 flex items-center justify-center z-50"},[t("i",{class:"bi bi-x text-xl"})],-1)),t("img",{src:p.value?p.value:r.fileUrl,class:"max-w-full max-h-full rounded-lg"},null,8,mg)],40,pg)),[[e(Jt),!0]]):w("",!0),r.deleteButton&&!r.isProcessing?(s(),u("div",gg,[o(y,{variant:"default",size:"smicon",class:"absolute top-[-6px] right-[-6px] rounded-full w-4 h-4",onClick:S[1]||(S[1]=I=>e(l).deleteReadyFile(r.fileId))},{default:i(()=>S[4]||(S[4]=[t("i",{class:"bi bi-x"},null,-1)])),_:1,__:[4]})])):w("",!0)],2)):w("",!0)])}}}),fg={class:"flex cursor-text flex-col sm:rounded-3xl rounded-t-3xl px-2.5 pb-2 contain-inline-size bg-white dark:bg-stone-800 border shadow-xs focus-within:shadow-md sm:mb-5 transition-shadow duration-200 dark:outline mt-1"},vg={class:"flex flex-col min-h-20 sm:min-h-12 items-center"},hg={class:"flex w-full overflow-x-auto gap-2 items-center pt-2"},_g={key:0,class:"w-full flex gap-4 items-center bg-stone-100 dark:bg-stone-900 rounded-t-2xl rounded-b-lg p-4"},bg={class:"flex-1 overflow-hidden text-nowrap line-clamp-3 whitespace-pre-line text-xs italic text-stone-600 dark:text-stone-300"},kg={key:0,class:"flex gap-2 items-end"},yg={class:"text-xs"},xg={class:"text-xs"},wg={class:"flex items-end"},Ya=oe({__name:"MessageInput",props:{initialText:{},isUsingPreviewAgent:{type:Boolean}},emits:["handle-message"],setup(n,{expose:l,emit:a}){const c=ne(()=>As-O.value.length<=2),r=v(!1),p=Ce(),{t:m}=We(p.t),{toast:g}=gt(),h=a,_=n,x=at(),{isMobileSize:b}=ie(x),S=v(null),D=Z=>{S.value&&(O.value=Z,S.value.setValue(Z))};l({setValue:D}),Te(()=>_.initialText,Z=>{Z!==void 0&&(O.value=Z)});const y=()=>{r.value=!1},I=Gt(),{currentAgent:C}=ie(I),U=Is(),{selectedFiles:E,readyFiles:N,attachments:$,embedFailedFiles:R,contextFiles:B,uploadingFileCount:j}=ie(U),ee=ms(),{currentConversation:se,generatingResponse:G,currentParentMessageId:J,currentModel:H,shouldLeaveWhiteSpace:M,messageEditorState:W,hints:X}=ie(ee),O=v(""),K=ne(()=>{const Z=new Set;return W.value.canvasOpen&&Z.add("CANVAS"),Z}),V=tt(),F=ne(()=>V.name==="agent-chat-home"||V.name==="agent-chat"||V.name==="create-agent"),P=ne(()=>{var Z;return{attachments:$.value.map(re=>({file_id:re.fileId})),agent_id:(Z=C.value)==null?void 0:Z.id}}),q=ne(()=>E.value.length>0||B.value.length===0&&O.value.trim()===""?!1:!G.value),A=async()=>{var Z,re,ue;M.value=!0,X.value=[];try{if(q.value&&!r.value){h("handle-message",O.value),se.value.agentId=P.value.agent_id;const he=W.value.quoted?`<quoted>${W.value.quoted}</quoted>

${O.value.trim()}`:O.value.trim();O.value="",j.value=0,E.value=[],B.value=[],U.changeToMetaData(),ee.addMessage(he,"USER","user_temp",N.value),N.value=[],await ee.generateAIResponse(he,K.value,(Z=C.value)!=null&&Z.modelId||(re=H.value)==null?void 0:re.modelId,J.value||null,(ue=se.value)==null?void 0:ue.id,P.value)}}catch(he){console.error(he),g({title:m("home.toast.fail.generalErrorTitle"),description:m("home.toast.fail.generalError"),variant:"destructive"})}},k=Z=>{b.value||(Z.preventDefault(),A())};Te(()=>O.value,Z=>{D(Z)}),Te(()=>W.value.quoted,()=>{var Z;return(Z=S.value)==null?void 0:Z.focus()});const L=(Z,re)=>{if(Z.length===0)return;const ue=Z.map($e=>$e.name).join(", "),he=Z.length===1?m("home.toast.fail.uploadFileFailSingle",{fileName:ue}):m("home.toast.fail.uploadFileFailPlural",{fileName:ue});g({title:m(re),description:he,variant:"destructive"})},z=v(null),Q=()=>{z.value&&z.value.click()},ae=v(null),de=()=>{ae.value&&ae.value.click()},le=async Z=>{if(_.isUsingPreviewAgent)return;const re=Z.clipboardData;if(!re||re.types.includes("text/plain"))return;const he=re.items;if(U.wouldExceedUploadFileLimit(he.length)){g({title:m("home.toast.fail.generalErrorTitle"),description:m("home.toast.fail.exceedLimitNumberOfFile",{maxFilesPerMessage:Ga,maxFilesPerConversation:Wa}),variant:"destructive"}),ae.value.value="";return}const $e=Array.from(he).flatMap(Se=>{const be=Se.getAsFile();return be?[U.handleSingleFileUpload(be)]:[]});j.value+=$e.filter(Se=>Se.isValidExtension&&Se.isValidSize).length,L($e.flatMap(Se=>Se.isValidExtension?[]:[Se.file]),"home.toast.fail.fileExtensionInvalid"),L($e.flatMap(Se=>Se.isValidSize?[]:[Se.file]),"home.toast.fail.fileSizeInvalid"),ae.value.value="";try{await U.uploadSelectedFiles()}catch(Se){console.error(Se),g({title:m("home.toast.fail.generalErrorTitle"),description:m("home.toast.fail.generalError"),variant:"destructive"})}},te=async Z=>{const re=Z.target;if(Et(()=>{D(O.value)}),!re.files)return;const ue=Array.from(re.files);if(U.wouldExceedUploadFileLimit(ue.length)){g({title:m("home.toast.fail.generalErrorTitle"),description:m("home.toast.fail.exceedLimitNumberOfFile",{maxFilesPerMessage:Ga,maxFilesPerConversation:Wa}),variant:"destructive"}),z.value.value="",ae.value.value="";return}const he=ue.map(U.handleSingleFileUpload);j.value+=he.filter($e=>$e.isValidExtension&&$e.isValidSize).length,L(he.flatMap($e=>$e.isValidExtension?[]:[$e.file]),"home.toast.fail.fileExtensionInvalid"),L(he.flatMap($e=>$e.isValidSize?[]:[$e.file]),"home.toast.fail.fileSizeInvalid"),z.value.value="",ae.value.value="";try{await U.uploadSelectedFiles()}catch($e){console.error($e),g({title:m("home.toast.fail.generalErrorTitle"),description:m("home.toast.fail.generalError"),variant:"destructive"})}};return Te(()=>R.value.length,Z=>{if(Z>0){const re=R.value.map(he=>he.file.name).join(", "),ue=R.value.length===1?m("home.toast.fail.uploadFileFailSingle",{fileName:re}):m("home.toast.fail.uploadFileFailPlural",{fileName:re});g({title:m("home.toast.fail.generalErrorTitle"),description:ue,variant:"destructive"})}R.value.splice(0,Z)}),Te(()=>V.path,()=>{U.clearState(),W.value.quoted="",O.value=""},{immediate:!0}),(Z,re)=>{const ue=f("Button"),he=f("Textarea");return f("Toggle"),s(),u("div",fg,[t("div",vg,[t("div",hg,[(s(!0),u(ve,null,Le(e(E),($e,Se)=>(s(),u("div",{key:Se,class:"p-2 shrink-0"},[(s(),T(Xa,{file:$e.file,fileUrl:$e.fileUrl,fileName:$e.file.name,deleteButton:!0,isProcessing:$e.isProcessing,key:Se},null,8,["file","fileUrl","fileName","isProcessing"]))]))),128)),(s(!0),u(ve,null,Le(e(B),($e,Se)=>(s(),u("div",{key:Se},[(s(),T(Xa,{fileName:$e.fileName,fileId:$e.id,deleteButton:!0,readyIcon:!0,isProcessing:!1,key:Se},null,8,["fileName","fileId"]))]))),128)),re[6]||(re[6]=t("div",null,null,-1))]),e(W).quoted.trim()?(s(),u("div",_g,[re[8]||(re[8]=t("div",{class:"flex-0"},[t("i",{class:"bi bi-arrow-return-right text-xl"})],-1)),t("div",bg,d(e(W).quoted.trim()),1),o(ue,{size:"mdicon",class:"rounded-full",variant:"ghost",onClick:re[0]||(re[0]=$e=>e(W).quoted="")},{default:i(()=>re[7]||(re[7]=[t("i",{class:"bi bi-x text-sm"},null,-1)])),_:1,__:[7]})])):w("",!0),F.value?Ke((s(),T(he,{key:1,ref_key:"textareaRef",ref:S,rows:"1",maxLength:e(As),modelValue:O.value,"onUpdate:modelValue":re[1]||(re[1]=$e=>O.value=$e),onKeydown:yt(Ye(k,["exact"]),["enter"]),onCompositionstart:re[2]||(re[2]=$e=>r.value=!0),onCompositionend:y,onPaste:le,id:"message",placeholder:e(C)?e(C).name+" "+e(m)("home.chat.label.agentChatPlaceholder"):e(m)("home.chat.label.chatPlaceholder"),class:"flex flex-col items-center h-full w-full grow rounded-md border-input bg-transparent p-2 mx-3 mb-3 mt-1 ring-offset-background placeholder:text-muted-foreground focus-visible:outline-hidden focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 border-0 resize-none max-h-52 text-sm"},null,8,["maxLength","modelValue","onKeydown","placeholder"])),[[e(Jt),!_.isUsingPreviewAgent]]):Ke((s(),T(he,{key:2,ref_key:"textareaRef",ref:S,rows:"1",maxLength:e(As),modelValue:O.value,"onUpdate:modelValue":re[3]||(re[3]=$e=>O.value=$e),onKeydown:yt(Ye(k,["exact"]),["enter"]),onCompositionstart:re[4]||(re[4]=$e=>r.value=!0),onCompositionend:y,onPaste:le,id:"message",placeholder:e(m)("home.chat.label.chatPlaceholder"),class:"flex flex-col items-center h-full w-full grow rounded-md border-input bg-transparent p-2 mx-3 mb-3 mt-1 ring-offset-background placeholder:text-muted-foreground focus-visible:outline-hidden focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 border-0 resize-none max-h-52 text-sm"},null,8,["maxLength","modelValue","onKeydown","placeholder"])),[[e(Jt),!0]])]),t("div",{class:pe([_.isUsingPreviewAgent?"justify-end":"justify-between","flex items-center"])},[_.isUsingPreviewAgent?w("",!0):(s(),u("div",kg,[o(Pe,{icon:"bi bi-paperclip text-xl text-stone-600 dark:text-white dark:hover:text-stone-200",className:"outline rounded-full flex gap-0.5",size:"default",onClick:Q},{default:i(()=>[t("span",yg,d(e(m)("home.chat.tooltip.uploadFile")),1)]),_:1}),t("input",{id:"chat-file-input",type:"file",class:"hidden",ref_key:"fileInput",ref:z,onChange:te,accept:".pdf,.txt,.md,.pptx,.xlsx,.csv,.docx",multiple:""},null,544),o(Pe,{icon:"bi bi-images text-xl text-stone-600 dark:text-white dark:hover:text-stone-200",className:"outline rounded-full flex gap-2",size:"default",onClick:de},{default:i(()=>[t("span",xg,d(e(m)("home.chat.tooltip.uploadImage")),1)]),_:1}),w("",!0),t("input",{id:"chat-image-input",type:"file",class:"hidden",ref_key:"imageInput",ref:ae,onChange:te,accept:".png, .jpg, .jpeg",multiple:""},null,544)])),t("div",wg,[t("span",{class:pe(["text-xs mb-2 self-end px-3 max-sm:hidden",[c.value?"text-red-400 font-semibold":"text-stone-400"]])},d(e(m)("home.chat.message.maxLengthCharacters",{inputLength:O.value.length,maxLength:e(As)})),3),o(ue,{size:"icon",onClick:A,disabled:!q.value},{default:i(()=>[t("i",{class:pe([e(G)?"bi text-2xl bi-arrow-repeat animate-spin":"bi text-2xl bi-arrow-up-short",q.value?"opacity-100":"opacity-50"])},null,2)]),_:1},8,["disabled"])])],2)])}}}),$g={class:"text-xs sm:text-sm"},oa=oe({__name:"CopyContentButton",props:{copyIcon:{default:"bi bi-copy"},copyDoneIcon:{default:"bi bi-check"},content:{},copyDoneTooltip:{},copyTooltip:{},disabled:{type:Boolean},showButtonLabel:{type:Boolean},variant:{default:"ghost"},className:{},size:{default:"smicon"},copyLabel:{},copyDoneLabel:{}},setup(n){const l=n,a=ne(()=>l.content.replace(/<citation[\s\S]*?<\/citation>/g,"")),{copy:c,copied:r,isSupported:p}=ga({source:a});return(m,g)=>{const h=f("Button");return s(),u(ve,null,[e(p)&&!m.showButtonLabel?(s(),T(Pe,{key:0,className:l.className,onClick:g[0]||(g[0]=_=>e(c)()),variant:l.variant,size:l.size,icon:e(r)?l.copyDoneIcon:l.copyIcon,tooltip:e(r)?l.copyDoneTooltip:l.copyTooltip,disabled:l.disabled},null,8,["className","variant","size","icon","tooltip","disabled"])):w("",!0),m.showButtonLabel?(s(),T(h,{key:1,class:pe(e(Me)("text-sm flex justify-start w-full",l.className)),onClick:g[1]||(g[1]=_=>e(c)()),disabled:l.disabled,variant:l.variant,size:l.size},{default:i(()=>[t("i",{class:pe([e(r)?"bi bi-check":"bi bi-markdown","mr-2"])},null,2),t("span",$g,d(e(r)?l.copyDoneLabel:l.copyLabel),1)]),_:1},8,["class","disabled","variant","size"])):w("",!0)],64)}}}),Sg={class:"mx-auto text-sm flex px-3 w-full flex-col gap-1 empty:hidden items-end"},Tg={key:0,class:"flex flex-row pb-3 justify-end w-full"},Ag={class:"grid grid-cols-3 gap-2 auto-rows-auto items-center",dir:"rtl"},Cg={key:1,class:"xl:max-w-xl md:max-w-sm gap-2 rounded-3xl rounded-tr-xs pl-5 pr-3 py-3 bg-stone-100 dark:bg-stone-800 flex"},Dg={class:"flex-1 relative"},Lg={key:0,class:"border-double border-l border-stone-300 w-full flex gap-4 items-center bg-stone-100 dark:bg-stone-900 px-4 py-2 mt-2"},Ig={class:"flex-1 overflow-hidden text-nowrap line-clamp-3 whitespace-pre-line text-xs italic text-stone-600 dark:text-stone-300"},Bg={class:"whitespace-pre-wrap break-words"},Mg={key:0,class:"absolute bottom-0 left-0 right-0 h-6 w-full bg-linear-to-b from-transparent via-stone-100/80 dark:via-stone-800/80 to-stone-100 dark:to-stone-800"},Eg={class:"flex-0"},Rg={class:"flex items-center gap-1 mr-3"},pi=oe({__name:"UserMessageItem",props:{message:{}},setup(n){const l=n,a=Ce(),{t:c}=We(a.t),r=ne(()=>{if(!l.message)return{};const S=/^<quoted>([\s\S]*?)<\/quoted>(\s)*/,D=l.message.content.text.match(S);return D&&D[1]?{quoted:D[1],message:l.message.content.text.slice(D[0].length)}:{message:l.message.content.text}}),p=ne(()=>{var S,D,y;return(y=(D=(S=l.message)==null?void 0:S.messageMetadata)==null?void 0:D.attachments)==null?void 0:y.filter(I=>/\.(jpg|jpeg|png|gif|bmp|webp)$/i.test(I.fileName))}),m=ne(()=>{var S,D,y;return(y=(D=(S=l.message)==null?void 0:S.messageMetadata)==null?void 0:D.attachments)==null?void 0:y.filter(I=>!/\.(jpg|jpeg|png|gif|bmp|webp)$/i.test(I.fileName))}),g=v(!1),h=v(!1),_=Bt("contentContainer"),x=()=>{_.value&&(h.value?_.value.classList.add("line-clamp-3"):_.value.classList.remove("line-clamp-3"),h.value=!h.value)},b=async()=>{await Et(),g.value=!!_.value&&_.value.scrollHeight>_.value.clientHeight};return Vt(()=>b()),vl(()=>b()),(S,D)=>{var y,I,C,U,E,N;return s(),u("div",Sg,[(C=(I=(y=l.message)==null?void 0:y.messageMetadata)==null?void 0:I.attachments)!=null&&C.length?(s(),u("div",Tg,[t("div",Ag,[(s(!0),u(ve,null,Le(p.value,($,R)=>(s(),u("div",{key:R,class:pe(["flex justify-center items-center",["png","jpg","jpeg"].includes(e(Rt)($.fileName))?"":"col-span-3"]),dir:"ltr"},[o(Xa,{fileId:$.fileId,fileName:$.fileName,deleteButton:!1},null,8,["fileId","fileName"])],2))),128)),(s(!0),u(ve,null,Le(m.value,($,R)=>(s(),u("div",{key:R,class:pe(["flex justify-center items-center",["png","jpg","jpeg"].includes(e(Rt)($.fileName))?"":"col-span-3"]),dir:"ltr"},[o(Xa,{fileId:$.fileId,fileName:$.fileName,deleteButton:!1},null,8,["fileId","fileName"])],2))),128))])])):w("",!0),((U=l.message)==null?void 0:U.content.text.trim())!==""?(s(),u("div",Cg,[t("div",Dg,[t("div",{class:"flex-1 line-clamp-3 overflow-hidden",ref_key:"contentContainer",ref:_},[(E=r.value.quoted)!=null&&E.trim()?(s(),u("div",Lg,[t("div",Ig,d((N=r.value.quoted)==null?void 0:N.trim()),1)])):w("",!0),t("div",Bg,d(r.value.message),1)],512),g.value?(s(),u("div",Mg)):w("",!0)]),t("div",Eg,[g.value||h.value?(s(),T(Pe,{key:0,size:"mdicon",variant:"secondary",icon:"bi bi-chevron-up",onClick:x,"class-name":["transition-all",h.value?"rotate-0":"rotate-180"].join(" ")},null,8,["class-name"])):w("",!0)])])):w("",!0),t("div",Rg,[o(oa,{className:"p-4 text-sm",content:l.message.content.text,"copy-done-tooltip":e(c)("home.chat.label.copyCodeDone"),"copy-tooltip":e(c)("home.chat.button.copyMessage.tooltip")},null,8,["content","copy-done-tooltip","copy-tooltip"])])])}}}),an=Ft("cspStore",()=>{var l;return{nonce:v((l=document.getElementById("app"))==null?void 0:l.nonce)}}),Fg=n=>n.rs.map(l=>({id:l.id,createdAt:new Date(l.created_at),updatedAt:new Date(l.updated_at),createdBy:l.created_by,updatedBy:l.updated_by,name:l.name,size:l.size,contentType:l.content_type,vectorIndexStatus:l.vector_index_status,isDownloading:!1})),Kn=n=>({id:n.id,createdAt:new Date(n.created_at),updatedAt:new Date(n.updated_at),createdBy:n.created_by,updatedBy:n.updated_by,name:n.name,size:n.size,contentType:n.content_type,vectorIndexStatus:n.vector_index_status,isDownloading:!1}),qn=n=>{const l=new Set;return n.forEach(a=>{const c=a.name.split("/").filter(Boolean);for(let r=1;r<c.length;r+=1){const p=c.slice(0,r).join("/");l.add(p)}}),Array.from(l.values()).map(a=>({id:a+"/",name:a+"/",contentType:"directory"}))},Pg={"text/plain":{extension:"TXT",icon:"bi bi-filetype-txt text-xl"},"text/markdown":{extension:"MD",icon:"bi bi-filetype-md text-xl"},"application/pdf":{extension:"PDF",icon:"bi bi-filetype-pdf text-xl"},"application/vnd.openxmlformats-officedocument.presentationml.presentation":{extension:"PPTX",icon:"bi bi-filetype-pptx text-xl"},"application/json":{extension:"JSON",icon:"bi bi-filetype-json text-xl"},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":{extension:"XLSX",icon:"bi bi-filetype-xlsx text-xl"},"text/csv":{extension:"CSV",icon:"bi bi-filetype-csv text-xl"},"application/vnd.openxmlformats-officedocument.wordprocessingml.document":{extension:"DOCX",icon:"bi bi-filetype-docx text-xl"}},Qn=n=>Pg[n]||{extension:"file",icon:"bi bi-file-earmark text-xl"},Ng=n=>n.files.map(l=>({id:l.id,name:l.name,vectorIndexStatus:l.vector_index_status})),co=Ft("knowledgeBaseStore",()=>{const n=as(),{currentWorkspace:l,currentUserIdInWorkspace:a}=ie(n),c=v([]),r=v([]),p=v(!1),m=v(!1),g=v(!1),h=v(!1),_=v(!1),x=v(!1),b=v([]),S=v([]),D=v(""),y=v([]),I=(P,q="file")=>{const A=P.split("/");return q==="directory"?A[A.length-2]:A[A.length-1]},C=(P,q)=>!!(!P||q||a.value===P),U=ne(()=>c.value.filter(P=>y.value.find(A=>A.id===P))),E=P=>{b.value.splice(P,1)},N=P=>{const q=S.value.findIndex(A=>A.id===P);q<0||S.value.splice(q,1)},$=async(P,q)=>{var L;const A=new FormData;A.append("file",P.file),D.value&&A.append("path",q);const{data:k}=await mt.post(`/workspaces/${(L=l.value)==null?void 0:L.id}/knowledge-base/files/upload`,A,{headers:{"Content-Type":"multipart/form-data"}});return k},R=async()=>{if(!(b.value.length===0||!l.value)){m.value=!0;for(const[P,q]of b.value.entries())if(!(q.status==="UPLOADED"||q.status==="FAILED"))try{b.value[P].status="STARTED";const A=await $(q,q.path);A&&(b.value[P].status=A==null?void 0:A.status)}catch(A){console.error(A),b.value[P].status="FAILED"}await B(l.value.id),m.value=!1,p.value=!0}},B=async P=>{try{g.value=!0;const{data:q}=await mt.get(`/workspaces/${P}/knowledge-base/files`);y.value=Fg(q),r.value=qn(y.value)}finally{g.value=!1}},j=async P=>{var k;const q=y.value.find(L=>L.id===P);if(!q)return;const{data:A}=await mt.get(`/workspaces/${(k=l.value)==null?void 0:k.id}/knowledge-base/files/${P}`);q.vectorIndexStatus=Kn(A).vectorIndexStatus,(q.vectorIndexStatus==="DONE"||q.vectorIndexStatus==="FAILED")&&N(q.id)},ee=async()=>{S.value.length<=0||(await Promise.allSettled(S.value.flatMap(P=>P.vectorIndexStatus==="INDEXING"?[j(P.id)]:[])),S.value.length===0&&se())},{pause:se,resume:G,isActive:J}=Go(ee,np,{immediate:!0}),H=()=>{J.value||G()},M=()=>{se()};return Te(()=>S.value.length,P=>{P>0?H():M()},{immediate:!0}),{currentPath:D,selectedBlobs:c,selectedFileIds:U,selectedFiles:b,indexingFiles:S,files:y,directories:r,uploadingFiles:m,disableUploadButton:p,disableDownloadButton:x,loadingBlobs:g,deletingBlobs:h,copyingBlobs:_,convertFromPathToName:I,canSelect:C,removeSelectedFile:E,uploadSingleFile:$,uploadAllFiles:R,loadWorkspaceBlobs:B,clearWorkspaceBlobs:()=>{y.value=[],r.value=[],S.value=[],M()},deleteWorkspaceBlobs:async P=>{var q;try{h.value=!0;for(const A of P)await mt.delete(`/workspaces/${(q=l.value)==null?void 0:q.id}/knowledge-base/files/${A}`),y.value=y.value.filter(k=>k.id!==A),N(A);r.value=qn(y.value)}finally{h.value=!1}},copyWorkspaceBlobs:async(P,q)=>{try{g.value=!0,await Ca(2e3);const A=y.value.filter(k=>P.includes(k.id)).map(k=>({...k,path:q}));y.value.push(...A)}finally{g.value=!1}},startVectorIndexFile:async(P,q)=>{const A=y.value.find(L=>L.id===q);if(!A)return;A.vectorIndexStatus="INDEXING";const{data:k}=await mt.post(`/workspaces/${P}/knowledge-base/files/${q}/vector-index`);if(Kn(k).vectorIndexStatus==="FAILED")throw new Error;S.value.push(A)},deleteVectorIndexFile:async(P,q)=>{const A=y.value.find(k=>k.id===q);A&&(await mt.delete(`/workspaces/${P}/knowledge-base/files/${q}/vector-index`),A.vectorIndexStatus="NONE")},downloadFile:async P=>{var A;if(!P)return;const q=y.value.find(k=>k.id===P);if(!(!q||q.isDownloading))try{q.isDownloading=!0,c.value=c.value.filter(ae=>ae!==P);const k=await mt.get(`/workspaces/${(A=l.value)==null?void 0:A.id}/knowledge-base/files/${P}/download`,{responseType:"blob"}),L=I(q.name),z=window.URL.createObjectURL(k.data),Q=document.createElement("a");Q.href=z,Q.download=L,document.body.appendChild(Q),Q.click(),Q.remove(),window.URL.revokeObjectURL(z)}catch(k){throw console.error(k),k}finally{q.isDownloading=!1}}}}),zg={class:"text-sm mb-4"},Ug=oe({__name:"AddDirectory",props:{modelValue:{},modelModifiers:{},open:{type:Boolean},openModifiers:{}},emits:bs(["cancel","confirm"],["update:modelValue","update:open"]),setup(n,{emit:l}){const a=Os(n,"modelValue"),c=Os(n,"open"),r=Ce(),{t:p}=We(r.t),m=l;return(g,h)=>{const _=f("Label"),x=f("Input");return s(),T(fa,{open:c.value,"onUpdate:open":h[2]||(h[2]=b=>c.value=b),onCancel:h[3]||(h[3]=b=>m("cancel")),onConfirm:h[4]||(h[4]=b=>m("confirm"))},{title:i(()=>[me(d(e(p)("workspace.addDirectory.title")),1)]),description:i(()=>[t("div",zg,d(e(p)("workspace.addDirectory.description")),1),o(_,{for:"addDirectoryName",class:"mb-2 block"},{default:i(()=>[me(d(e(p)("workspace.addDirectory.name-label")),1)]),_:1}),o(x,{id:"addDirectoryName",modelValue:a.value,"onUpdate:modelValue":h[0]||(h[0]=b=>a.value=b),onKeydown:h[1]||(h[1]=yt(Ye(b=>m("confirm"),["exact"]),["enter"]))},null,8,["modelValue"])]),_:1},8,["open"])}}}),Og=oe({__name:"Sheet",props:{open:{type:Boolean},defaultOpen:{type:Boolean},modal:{type:Boolean}},emits:["update:open"],setup(n,{emit:l}){const r=Da(n,l);return(p,m)=>(s(),T(e(yc),He({"data-slot":"sheet"},e(r)),{default:i(()=>[we(p.$slots,"default")]),_:3},16))}}),jg=oe({__name:"SheetOverlay",props:{forceMount:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=la(l,"class");return(c,r)=>(s(),T(e(xc),He({"data-slot":"sheet-overlay",class:e(Me)("backdrop-blur-2xs data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/80",l.class)},e(a)),{default:i(()=>[we(c.$slots,"default")]),_:3},16,["class"]))}}),Vg=oe({inheritAttrs:!1,__name:"SheetContent",props:{class:{},side:{default:"right"},forceMount:{type:Boolean},disableOutsidePointerEvents:{type:Boolean},asChild:{type:Boolean},as:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(n,{emit:l}){const a=n,c=l,r=la(a,"class","side"),p=Da(r,c);return(m,g)=>(s(),T(e(Sc),null,{default:i(()=>[o(jg),o(e($c),He({"data-slot":"sheet-content",class:e(Me)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500",m.side==="right"&&"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm",m.side==="left"&&"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm",m.side==="top"&&"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b",m.side==="bottom"&&"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",a.class)},{...e(p),...m.$attrs}),{default:i(()=>[we(m.$slots,"default"),o(e(wc),{class:"ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none"},{default:i(()=>[o(e(kl),{class:"size-4"}),g[0]||(g[0]=t("span",{class:"sr-only"},"Close",-1))]),_:1,__:[0]})]),_:3},16,["class"])]),_:3}))}}),Gg=oe({__name:"SheetDescription",props:{asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=la(l,"class");return(c,r)=>(s(),T(e(Tc),He({"data-slot":"sheet-description",class:e(Me)("text-muted-foreground text-sm",l.class)},e(a)),{default:i(()=>[we(c.$slots,"default")]),_:3},16,["class"]))}}),Wg=oe({__name:"SheetFooter",props:{class:{}},setup(n){const l=n;return(a,c)=>(s(),u("div",{"data-slot":"sheet-footer",class:pe(e(Me)("mt-auto flex flex-col gap-2 p-4",l.class))},[we(a.$slots,"default")],2))}}),Hg=oe({__name:"SheetHeader",props:{class:{}},setup(n){const l=n;return(a,c)=>(s(),u("div",{"data-slot":"sheet-header",class:pe(e(Me)("flex flex-col gap-1.5 p-4",l.class))},[we(a.$slots,"default")],2))}}),Kg=oe({__name:"SheetTitle",props:{asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=la(l,"class");return(c,r)=>(s(),T(e(Ac),He({"data-slot":"sheet-title",class:e(Me)("text-foreground font-semibold",l.class)},e(a)),{default:i(()=>[we(c.$slots,"default")]),_:3},16,["class"]))}}),qg=oe({__name:"SheetTrigger",props:{asChild:{type:Boolean},as:{}},setup(n){const l=n;return(a,c)=>(s(),T(e(Cc),He({"data-slot":"sheet-trigger"},l),{default:i(()=>[we(a.$slots,"default")]),_:3},16))}}),Qg=oe({__name:"EzSheet",props:bs({useHeader:{type:Boolean,default:!0},useFooter:{type:Boolean,default:!0},contentClass:{}},{open:{type:Boolean},openModifiers:{}}),emits:["update:open"],setup(n){const l=Os(n,"open");return(a,c)=>(s(),T(e(Og),{open:l.value,"onUpdate:open":c[0]||(c[0]=r=>l.value=r),defaultOpen:!1},{default:i(()=>[o(e(qg),{"as-child":""},{default:i(()=>[we(a.$slots,"trigger")]),_:3}),o(e(Vg),{class:pe(a.contentClass)},{default:i(()=>[a.useHeader?(s(),T(e(Hg),{key:0},{default:i(()=>[o(e(Kg),null,{default:i(()=>[we(a.$slots,"title")]),_:3}),o(e(Gg),null,{default:i(()=>[we(a.$slots,"description")]),_:3})]),_:3})):w("",!0),we(a.$slots,"content"),a.useFooter?(s(),T(e(Wg),{key:1},{default:i(()=>[we(a.$slots,"footerClose")]),_:3})):w("",!0)]),_:3},8,["class"])]),_:3},8,["open"]))}}),Jg={class:"flex flex-col items-center"},Xg={class:"text-gray-700 dark:text-gray-500"},Yg={class:"flex items-center gap-2"},Zg={class:"text-gray-500 text-sm"},ef={class:"text-xs text-center"},tf={key:0,class:"text-xs"},sf={key:0,class:"px-6 mb-3"},af={class:"max-w-86 line-clamp-1 wrap-anywhere"},of={key:0,class:"bi bi-arrow-repeat animate-spin"},nf={key:1,class:"bi bi-x-circle-fill text-red-500"},lf={key:2,class:"bi bi-check-circle-fill text-green-500"},rf={key:3,class:"flex items-center gap-2"},cf={class:"opacity-60 text-sm truncate"},df=oe({__name:"UploadRightPanel",props:bs({visibleFiles:{}},{open:{type:Boolean},openModifiers:{}}),emits:["update:open"],setup(n){const l=n,a=co(),{selectedFiles:c,currentPath:r,uploadingFiles:p,disableUploadButton:m}=ie(a),{uploadAllFiles:g,removeSelectedFile:h}=a,_=Ce(),{t:x}=We(_.t),{toast:b}=gt(),S=Os(n,"open"),D=Bt("hiddenUpload"),y=()=>{D.value&&D.value.click()},I=ne(()=>{var G;return((G=l.visibleFiles)==null?void 0:G.map(J=>J.name))??[]}),C=ne(()=>c.value.map(G=>G.name)??[]),U=G=>I.value.includes((r.value===""?"/":r.value)+G),E=(G,J)=>{if(G.length===0)return;const H=G.map(W=>W.name).join(", "),M=G.length===1?x("home.toast.fail.uploadFileFailSingle",{fileName:H}):x("home.toast.fail.uploadFileFailPlural",{fileName:H});b({title:x(J),description:M,variant:"destructive"})},N=G=>{const J=rp(G.name),H=G.size<La*1024*1024,M=U(G.name);if(M&&b({title:x("workspace.toast.fail.title.knowledgeBaseTab.uploadFile.duplicate"),description:x("workspace.toast.fail.description.knowledgeBaseTab.uploadFile.duplicate"),variant:"destructive"}),J&&H&&!M){const W={file:G,name:G.name,path:r.value};c.value.push(W)}return{isValidExtension:J,isValidSize:H,file:G}},$=G=>{var X;if(G.preventDefault(),!((X=G.dataTransfer)!=null&&X.files))return;const J=Array.from(G.dataTransfer.files),H=new Set(C.value),W=J.filter(O=>!H.has(O.name)).map(N);E(W.flatMap(O=>O.isValidExtension?[]:[O.file]),"home.toast.fail.fileExtensionInvalid"),E(W.flatMap(O=>O.isValidSize?[]:[O.file]),"home.toast.fail.fileSizeInvalid")},R=G=>{var O;const J=G.target;if(!((O=J.files)!=null&&O.length))return;const H=Array.from(J.files),M=new Set(C.value),X=H.filter(K=>!M.has(K.name)).map(N);E(X.flatMap(K=>K.isValidExtension?[]:[K.file]),"home.toast.fail.fileExtensionInvalid"),E(X.flatMap(K=>K.isValidSize?[]:[K.file]),"home.toast.fail.fileSizeInvalid"),D.value&&(D.value.value="")},B=G=>{G||(c.value=[],p.value=!1,D.value&&(D.value.value=""))},j=async()=>{await g();const G=c.value.length,J=c.value.filter(M=>M.status==="FAILED").length,H=G-J;H>0&&J>0&&b({title:x("workspace.uploadRightPanel.toast.success.someFiles",{file_num:H,all_file_num:G})}),H===0&&J>0&&b({title:x("workspace.uploadRightPanel.toast.failed.allFiles"),variant:"destructive"}),J<=0&&b({title:x("workspace.uploadRightPanel.toast.success.allFiles")}),D.value&&(D.value.value="")};Te(()=>c.value.length,async(G,J)=>{m.value=!1,G>J&&(await Et(),se())});const ee=Bt("filesContainer"),se=()=>{ee.value&&ee.value.scrollTo({top:ee.value.scrollHeight,behavior:"smooth"})};return(G,J)=>{const H=f("Button"),M=f("Loader");return s(),T(Qg,{useHeader:!0,useFooter:!0,open:S.value,"onUpdate:open":[J[1]||(J[1]=W=>S.value=W),B],contentClass:"w-full sm:max-w-xl"},{title:i(()=>[me(d(e(x)("workspace.uploadRightPanel.header")),1)]),content:i(()=>[t("div",{class:"mx-6 py-4 border-2 border-dashed border-gray-300 rounded-lg flex flex-col items-center justify-center transition hover:border-blue-400",onDragover:J[0]||(J[0]=Ye(()=>{},["prevent"])),onDrop:$},[t("div",Jg,[J[2]||(J[2]=t("i",{class:"bi bi-cloud-arrow-up text-4xl"},null,-1)),t("span",Xg,d(e(x)("workspace.uploadRightPanel.label.dragAndDrop")),1),t("div",Yg,[t("span",Zg,d(e(x)("workspace.uploadRightPanel.label.or")),1),o(H,{class:"p-0 text-blue-500",variant:"link",onClick:y},{default:i(()=>[me(d(e(x)("workspace.uploadRightPanel.button.browse")),1)]),_:1}),t("input",{ref:"hiddenUpload",type:"file",multiple:"",accept:".pdf,.txt,.md,.pptx,.xlsx,.csv,.docx,.json",class:"hidden",onChange:R},null,544)]),t("span",ef,d(e(x)("workspace.uploadRightPanel.label.supportedExtensions")),1),e(c).length?(s(),u("div",tf,[t("span",null,d(e(x)("workspace.uploadRightPanel.label.filesSelected",{files_num:e(c).length})),1)])):w("",!0)])],32),t("div",{class:"flex flex-col overflow-y-auto",ref_key:"filesContainer",ref:ee},[e(c).length?(s(),u("span",sf,d(e(x)("workspace.uploadRightPanel.label.currentUploads")),1)):w("",!0),(s(!0),u(ve,null,Le(e(c),(W,X)=>(s(),u("div",{key:W.name,class:"flex items-center justify-between border-b mx-3 px-6 py-3 hover:bg-stone-100 dark:hover:bg-stone-800 opacity-80"},[t("span",af,d(W.name),1),W.status==="STARTED"?(s(),u("i",of)):W.status==="FAILED"?(s(),u("i",nf)):W.status==="UPLOADED"?(s(),u("i",lf)):(s(),u("span",rf,[t("span",cf,d(e(x)("workspace.uploadRightPanel.label.waitingToUpload")),1),o(Pe,{onClick:O=>e(h)(X),icon:"bi bi-trash3 text-red-500 text-lg",tooltip:e(x)("workspace.uploadRightPanel.button.tooltip")},null,8,["onClick","tooltip"])]))]))),128))],512)]),footerClose:i(()=>[t("div",null,[o(H,{onClick:j,class:"px-4 py-2 rounded-full gap-2",disabled:!e(c).length||e(p)||e(m)},{default:i(()=>[t("span",null,d(e(x)("workspace.uploadRightPanel.button.upload")),1),e(p)?(s(),T(M,{key:0,class:"w-4 h-4 animate-spin"})):w("",!0)]),_:1},8,["disabled"])])]),_:1},8,["open"])}}}),uf={class:"text-xs text-zinc-500 m-1"},na=oe({__name:"EzDropdownMenu",props:{tooltip:{},buttonVariant:{},buttonClass:{},buttonLabel:{},disabled:{type:Boolean},icon:{default:"bi bi-chevron-down text-xs"},size:{},title:{},items:{},itemKey:{}},emits:["onTrigger","onSelect"],setup(n,{emit:l}){const a=n,c=l;return(r,p)=>{const m=f("DropdownMenuTrigger"),g=f("DropdownMenuItem"),h=f("DropdownMenuContent"),_=f("DropdownMenu");return s(),T(_,null,{default:i(()=>[o(m,null,{default:i(()=>[o(Pe,{variant:a.buttonVariant,"class-name":a.buttonClass,icon:a.icon,size:a.size,tooltip:a.tooltip,disabled:a.disabled,onClick:p[0]||(p[0]=x=>c("onTrigger"))},{default:i(()=>[we(r.$slots,"trigger")]),_:3},8,["variant","class-name","icon","size","tooltip","disabled"])]),_:3}),o(h,null,{default:i(()=>[t("div",uf,d(a.title),1),(s(!0),u(ve,null,Le(a.items,x=>(s(),u("div",{key:x[a.itemKey]},[o(g,{disabled:x.disabled,class:"cursor-pointer",onClick:b=>c("onSelect",x)},{default:i(()=>[we(r.$slots,"item",{item:x})]),_:2},1032,["disabled","onClick"])]))),128))]),_:3})]),_:3})}}}),pf=n=>n.rs.map(l=>({modelId:l.model_id,displayName:l.display_name,description:l.description})),mf=n=>n.rs.map(l=>({code:l.code,description:l.description,displayName:l.display_name})),Ao=n=>({id:n.id,createdAt:new Date(n.created_at),updatedAt:new Date(n.updated_at),createdBy:n.created_by,updatedBy:n.updated_by,name:n.name,description:n.description,owner:{id:n.owner.id,name:n.owner.name,email:n.owner.email},status:n.status,instructions:n.instructions,modelId:n.model_id,tools:n.tools.map(l=>({code:l.code,description:l.description,displayName:l.display_name})),currentUserInfo:n.current_user_info?{id:n.current_user_info.id,workspaceRole:n.current_user_info.workspace_role}:null,sampleQuestions:n.sample_questions}),gf=n=>({id:n.id,createdAt:new Date(n.created_at),updatedAt:new Date(n.update_at),createdBy:n.created_by,updatedBy:n.updated_by,name:n.name,description:n.description,owner:{id:n.owner.id,name:n.owner.name,email:n.owner.email},status:n.status}),ka=n=>({items:n.items.map(gf),total:n.total,offset:n.offset,limit:n.limit}),is=Ft("workspaceAgentStore",()=>{const n=v([]),l=v([]),a=v([]),c=v(""),r=v(),p=v(""),m=v(!1),g=v(!1),h=v("notUpdated"),_=v("notUpdated"),x=v([]),b=v([]),S=v(!1),D=v(!1),y=v(0),I=v(0),C=v([]),U=v(),E=async K=>{const{data:V}=await mt.get(`/workspaces/${K}/agents/support-models`);n.value=pf(V)},N=async K=>{const{data:V}=await mt.get(`/workspaces/${K}/agents/available-tools`);l.value=mf(V)},$=async(K,V)=>{const{data:F}=await mt.post(`/workspaces/${K}/agents`,V);r.value=Ao(F),p.value=r.value.id},R=async(K,V,F)=>{const{data:P}=await mt.put(`/workspaces/${K}/agents/${V}`,F);r.value=Ao(P)},B=async(K,V)=>{await mt.delete(`/workspaces/${K}/agents/${V}`),await W(K)},j=async(K,V)=>{const{data:F}=await mt.get(`/workspaces/${K}/agents/${V}`);r.value=Ao(F)},ee=async(K,V)=>{const{data:F}=await mt.get(`workspaces/${K}/agents/discovery`,{params:V});V.offset===0?x.value=[...ka(F).items]:x.value.push(...ka(F).items),I.value=F.total},se=async(K,V)=>{const{data:F}=await mt.get(`workspaces/${K}/agents/discovery`,{params:V});return ka(F).items},G=async(K,V)=>{const{data:F}=await mt.get(`workspaces/${K}/agents/discovery/created_by`,{params:V});V.offset===0?b.value=[...ka(F).items]:b.value.push(...ka(F).items),y.value=F.total},J=async(K,V)=>{await mt.put(`workspaces/${K}/agents/${V}/publish`)},H=async(K,V,F)=>{await mt.post(`/workspaces/${K}/agents/${V}/knowledge-base`,{files:F}),await M(K,V)},M=async(K,V)=>{const{data:F}=await mt.get(`/workspaces/${K}/agents/${V}/knowledge-base`);C.value=Ng(F)},W=async K=>{const V=await mt.get(`/workspaces/${K}/agents/pins`,{params:{offset:0,limit:Ol}});U.value=V.data.items};return{getWorkspaceAgentSupportModels:E,workspaceAgentSupportModels:n,sampleQuestion:c,agentAvailableTools:l,getAgentAvailableTools:N,createWorkspaceAgent:$,currentAgent:r,currentAgentKnowledgeFiles:C,sampleQuestions:a,currentAgentId:p,getWorkspaceAgentById:j,editWorkspaceAgent:R,loadingCreateEditAgent:m,agentUpdateStatus:h,agentUpdateBeforePublishStatus:_,getAllAgentsWorkspace:ee,allAgents:x,getCreatedAgents:G,createdAgents:b,deleteWorkspaceAgent:B,loadingAgentInfo:g,publishAgent:J,agentInfoChanged:S,isUpdatedAgentFail:D,createdAgentsAmount:y,allAgentsAmount:I,searchAgentsWorkspace:se,addFileToKnowledge:H,getAgentKnowledgeFiles:M,pinnedAgents:U,getPinnedAgents:W,pinAgent:async(K,V)=>{await mt.post(`/workspaces/${K}/agents/${V}/pin`),await W(K)},unpinAgent:async(K,V)=>{await mt.delete(`/workspaces/${K}/agents/${V}/unpin`),await W(K)}}}),Za=oe({__name:"EzAlertDialog",props:{title:{},description:{}},emits:["cancel","confirm"],setup(n,{emit:l}){const a=Ce(),{t:c}=We(a.t),r=n,p=l;return(m,g)=>{const h=f("AlertDialogTrigger"),_=f("AlertDialogTitle"),x=f("AlertDialogDescription"),b=f("AlertDialogHeader"),S=f("AlertDialogCancel"),D=f("AlertDialogAction"),y=f("AlertDialogFooter"),I=f("AlertDialogContent"),C=f("AlertDialog");return s(),T(C,null,{default:i(()=>[o(h,{"as-child":""},{default:i(()=>[we(m.$slots,"trigger")]),_:3}),o(I,null,{default:i(()=>[o(b,null,{default:i(()=>[o(_,null,{default:i(()=>[me(d(r.title),1)]),_:1}),o(x,null,{default:i(()=>[me(d(r.description),1)]),_:1})]),_:1}),o(y,null,{default:i(()=>[o(S,{onClick:g[0]||(g[0]=U=>p("cancel"))},{default:i(()=>[we(m.$slots,"cancel",{},()=>[me(d(e(c)("ezAlertDialog.footer.button.cancel")),1)])]),_:3}),o(D,{onClick:g[1]||(g[1]=U=>p("confirm")),class:"bg-red-600 hover:bg-red-500"},{default:i(()=>[we(m.$slots,"confirm",{},()=>[me(d(e(c)("ezAlertDialog.footer.button.confirm")),1)])]),_:3})]),_:3})]),_:3})]),_:3})}}}),on=(n,l=2)=>{if(n===0)return"0 Bytes";const a=1024,c=l<0?0:l,r=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],p=Math.floor(Math.log(n)/Math.log(a));return`${parseFloat((n/Math.pow(a,p)).toFixed(c))} ${r[p]}`},ff={class:"flex flex-col w-full"},vf={class:"flex flex-col max-h-dvh pb-24"},hf={class:"flex flex-wrap items-center gap-2 border-y px-3"},_f={class:"max-w-96 truncate"},bf={class:"flex flex-wrap items-center px-3 py-2 border-b bg-white dark:bg-stone-900 space-x-2"},kf={class:"text-gray-600 dark:text-gray-200 text-xs my-3 mx-4"},yf={key:1,class:"flex gap-1"},xf={key:0},wf={key:1,class:"flex gap-1 items-center"},$f={key:0,class:"flex items-center justify-center w-8 h-8"},Sf={class:"flex items-center justify-start h-8 px-2"},Tf={class:"whitespace-normal text-left line-clamp-2"},Af={key:0,class:"ml-1 bi bi-arrow-down-up opacity-30"},Cf={key:1,class:"ml-1 bi bi-arrow-up text-blue-500 dark:text-sky-500"},Df={key:2,class:"ml-1 bi bi-arrow-down text-blue-500 dark:text-sky-500"},Lf={class:"flex items-center h-8 px-2"},If={class:"whitespace-normal text-left line-clamp-2"},Bf={key:0,class:"ml-1 bi bi-arrow-down-up opacity-30"},Mf={key:1,class:"ml-1 bi bi-arrow-up text-blue-500 dark:text-sky-500"},Ef={key:2,class:"ml-1 bi bi-arrow-down text-blue-500 dark:text-sky-500"},Rf={class:"flex items-center h-8 px-2"},Ff={class:"whitespace-normal text-left line-clamp-2"},Pf={key:0,class:"ml-1 bi bi-arrow-down-up opacity-30"},Nf={key:1,class:"ml-1 bi bi-arrow-up text-blue-500 dark:text-sky-500"},zf={key:2,class:"ml-1 bi bi-arrow-down text-blue-500 dark:text-sky-500"},Uf={class:"flex items-center h-8 px-2"},Of={class:"whitespace-normal text-left line-clamp-2"},jf={key:0,class:"ml-1 bi bi-arrow-down-up opacity-30"},Vf={key:1,class:"ml-1 bi bi-arrow-up text-blue-500 dark:text-sky-500"},Gf={key:2,class:"ml-1 bi bi-arrow-down text-blue-500 dark:text-sky-500"},Wf={class:"flex items-center h-8 px-2"},Hf={class:"whitespace-normal text-left line-clamp-2"},Kf={key:0,class:"ml-1 bi bi-arrow-down-up opacity-30"},qf={key:1,class:"ml-1 bi bi-arrow-up text-blue-500 dark:text-sky-500"},Qf={key:2,class:"ml-1 bi bi-arrow-down text-blue-500 dark:text-sky-500"},Jf={class:"flex items-center h-8 px-2"},Xf={class:"whitespace-normal text-left line-clamp-2"},Yf={key:0,class:"ml-1 bi bi-arrow-down-up opacity-30"},Zf={key:1,class:"ml-1 bi bi-arrow-up text-blue-500 dark:text-sky-500"},ev={key:2,class:"ml-1 bi bi-arrow-down text-blue-500 dark:text-sky-500"},tv={class:"flex-1 max-sm:min-w-5xl"},sv={key:0,class:"flex items-center justify-center w-8 h-8"},av={class:"px-2 w-full truncate"},ov={key:0,class:"flex items-center justify-center w-8 h-8"},nv={class:"px-2 py-2 flex truncate"},lv={class:"px-2 py-2 flex"},iv={class:"px-2 py-2 flex"},rv={class:"px-2 py-2 flex"},cv={class:"px-2 py-2 flex"},dv={class:"flex py-2 items-center px-2 justify-end"},uv={key:0,class:"flex justify-center mt-5 opacity-50"},pv={key:0,class:"flex items-center justify-center w-8 h-8"},mv={class:"px-2 w-full truncate"},gv={class:"truncate"},fv={key:0,class:"flex items-center gap-1 opacity-70"},vv={key:0,class:"flex items-center justify-center w-8 h-8"},hv={class:"px-2 w-full truncate"},_v={class:"truncate"},bv={key:0,class:"flex items-center gap-1 opacity-70"},kv={class:"px-2 whitespace-nowrap"},yv={class:"text-white"},xv={class:"text-red-500"},wv={key:2,class:"flex items-center gap-1"},$v={key:3,class:"flex items-center"},Sv={key:4,class:"flex items-center gap-1 opacity-70"},Tv={class:"px-2 whitespace-nowrap"},Av={class:"px-2 whitespace-nowrap"},Cv={class:"px-2 whitespace-nowrap"},Dv={class:"px-2 whitespace-nowrap"},Lv={class:"flex items-center px-2 justify-end"},nn=oe({__name:"WorkspaceKnowledgeBase",props:{forAgent:{type:Boolean},forChat:{type:Boolean},tableHeight:{}},setup(n){const l=Ce(),{t:a}=We(l.t),c=tt(),r=at(),{isLargeScreenSize:p}=ie(r),m=as(),{membersInCurrentWorkspace:g,currentWorkspace:h}=ie(m),{getMembersInWorkspace:_}=m,x=co(),{files:b,directories:S,currentPath:D,loadingBlobs:y,deletingBlobs:I,selectedBlobs:C,selectedFileIds:U,indexingFiles:E,disableDownloadButton:N}=ie(x),{loadWorkspaceBlobs:$,clearWorkspaceBlobs:R,deleteWorkspaceBlobs:B,startVectorIndexFile:j,deleteVectorIndexFile:ee,canSelect:se,convertFromPathToName:G,downloadFile:J}=x,H=Fe=>{const xe=g.value.find(rt=>rt.id===Fe);return(xe==null?void 0:xe.email)??a("workspace.knowledgeBase.table.unknownEmail")},M=is(),{currentAgentKnowledgeFiles:W}=ie(M),X=n,O=(Fe,xe)=>xe.filter(rt=>{if(Fe===""){const je=(rt.name.startsWith("/")?rt.name.slice(1):rt.name).split("/");return je.length===1||je.length===2&&je[1]===""&&!je[0].includes("/")}if(!rt.name.startsWith(Fe))return!1;const nt=rt.name.slice(Fe.length);if(nt==="")return!1;const Je=nt.split("/");return Je.length===1||Je.length===2&&Je[1]===""}),K=ne(()=>O(D.value,S.value)),V=ne(()=>O(D.value,b.value)),F=v("name"),[P,q]=Sr(!0),A=Fe=>{F.value===Fe?q():(F.value=Fe,P.value||q())},k=ne(()=>K.value.slice().sort((Fe,xe)=>{const rt=F.value;if(!rt)return 0;const nt=Fe[rt],Je=xe[rt];let Ee=0;return typeof nt=="string"&&typeof Je=="string"?Ee=nt.localeCompare(Je):Ee=0,P.value?Ee:-Ee})),L=ne(()=>V.value.slice().sort((Fe,xe)=>{const rt=F.value;if(!rt)return 0;const nt=Fe[rt],Je=xe[rt];let Ee=0;return typeof nt=="string"&&typeof Je=="string"?Ee=nt.localeCompare(Je):typeof nt=="number"&&typeof Je=="number"?Ee=nt-Je:nt instanceof Date&&Je instanceof Date?Ee=nt.getTime()-Je.getTime():Ee=0,P.value?Ee:-Ee})),z=v(""),Q=ne(()=>z.value?k.value.filter(Fe=>Fe.name.toLowerCase().includes(z.value.toLowerCase())):k.value),ae=ne(()=>z.value?L.value.filter(Fe=>Fe.name.toLowerCase().includes(z.value.toLowerCase())):L.value),de=ne(()=>[...V.value,...K.value].filter(xe=>C.value.includes(xe.id)).length),le=(Fe,xe,rt)=>[...xe,...rt].filter(Je=>Je.name!==Fe&&Je.name.startsWith(Fe.endsWith("/")?Fe:Fe+"/")).map(Je=>Je.id),te=(Fe,xe,rt)=>[...xe,...rt].filter(Je=>Je.name!==Fe&&Je.name.startsWith(Fe.endsWith("/")?Fe:Fe+"/")).some(Je=>Je.isDownloading),Z=Fe=>{const xe=b.value.find(nt=>nt.id===Fe)||S.value.find(nt=>nt.id===Fe);if(!xe)return;if(xe.name.endsWith("/")){const nt=[xe.id,...le(xe.name,b.value,S.value)],Je=nt.every(Ee=>C.value.includes(Ee));C.value=Je?C.value.filter(Ee=>!nt.includes(Ee)):[...C.value,...nt]}else C.value=C.value.includes(Fe)?C.value.filter(nt=>nt!==Fe):[...C.value,Fe]},re=ne(()=>[...ae.value,...Q.value]),ue=()=>{const Fe=re.value.flatMap(xe=>xe.name.endsWith("/")?[xe.id,...le(xe.name,b.value,S.value)]:[xe.id]);C.value=C.value.length===Fe.length?[]:Fe},he=Fe=>{z.value=Fe},$e=ne(()=>{if(!D.value)return[];const Fe=D.value.split("/").filter(Boolean),xe=[];let rt="";for(const nt of Fe)rt+=nt+"/",xe.push({label:nt,path:rt});return xe}),Se=Fe=>{D.value=Fe,z.value=""},be=()=>{if(!D.value)return"";const Fe=D.value.replace(/\/$/,"").split("/");Fe.pop(),D.value=Fe.length?Fe.join("/")+"/":""},Ge=Fe=>{D.value=Fe,C.value=[],z.value=""},fe=v(""),Y=/(\/\.\.\/|\/\.\.|\/\.\/|\/\/|\\0|[:*?"<>|])/,ce=Fe=>Y.test(Fe),ge=()=>{const Fe=fe.value.trim();if(!Fe)return;if(ce(Fe)){Ue({title:a("workspace.toast.fail.generalErrorTitle"),description:a("workspace.toast.fail.knowledgeBaseTab.addDirectoryDialog.hasSpecialChar.description",{specialChar:"'/../', '//', '\\0', '/./', '\\:*?'"}),variant:"destructive"});return}const xe=D.value+Fe+"/";Se(xe),Ge(xe),fe.value="",ye.value=!1},ye=v(!1),_e=v(!1),Re=v(!1),ke=v(!1);Te(()=>c.params.id,()=>{R(),C.value=[],D.value="",$(c.params.id),X.forAgent&&(C.value=W.value.map(Fe=>Fe.id))},{immediate:!0}),ls(()=>{R()});const qe=Fe=>new Date(Fe).toLocaleString("en-US",{weekday:"short",year:"numeric",month:"short",day:"2-digit"}).replace(",",""),lt=Fe=>{var xe;return(xe=h.value)!=null&&xe.settings.allowDownload?[{icon:"bi bi-download",name:a("workspace.knowledgeBase.button.download"),action:"download",disabled:Fe.isDownloading},{icon:"bi bi-trash text-red-500",name:a("workspace.knowledgeBase.button.delete"),action:"delete",disabled:!se(Fe.createdBy??"")}]:[{icon:"bi bi-trash text-red-500",name:a("workspace.knowledgeBase.button.delete"),action:"delete",disabled:!se(Fe.createdBy??"")}]},St=async Fe=>{var xe;try{await J(Fe)}catch{const nt=(xe=b.value.find(Je=>Je.id===Fe))==null?void 0:xe.name;Ue({title:a("workspace.toast.fail.generalErrorTitle"),description:a("workspace.toast.fail.title.knowledgeBaseTab.download",{fileName:nt??""}),variant:"destructive"})}},Nt=(Fe,xe)=>{switch(Fe.action){case"delete":Ze(xe);break;case"download":St(xe);break}},Mt=Fe=>[{icon:"bi bi-trash text-red-500",name:a("workspace.knowledgeBase.button.deleteIndex"),action:"delete index",disabled:Fe.vectorIndexStatus!=="DONE"}],vt=v([]),zt=v(""),bt=v(0),Ve=()=>{vt.value=[...U.value],bt.value=vt.value.length,_e.value=!0},Ze=Fe=>{vt.value=[Fe],bt.value=vt.value.length,_e.value=!0},ze=Fe=>{zt.value=Fe,Re.value=!0},Be=async()=>{try{await B(vt.value),C.value=[],vt.value=[],bt.value=0}catch(Fe){console.error(Fe),Ue({title:a("workspace.knowledgeBase.toast.failed.deleteFile"),variant:"destructive"})}};Dt(async()=>{const Fe={email:""};await _(c.params.id,Fe)});const et=async Fe=>{try{await j(c.params.id,Fe)}catch(xe){console.error(xe),Ue({title:a("workspace.knowledgeBase.toast.failed.indexFile"),variant:"destructive"})}},ft=async Fe=>{try{await ee(c.params.id,Fe)}catch(xe){console.error(xe),Ue({title:a("workspace.knowledgeBase.toast.failed.unindexFile"),variant:"destructive"})}};Te(V,()=>{E.value=V.value.filter(Fe=>Fe.vectorIndexStatus==="INDEXING")},{immediate:!0});const ht=ne(()=>X.forChat?"flex items-center justify-between":X.forAgent?"grid grid-cols-[2rem_1fr_8rem]":"grid grid-cols-[2rem_1fr_10rem_10rem_10rem_8rem_5rem_3rem]"),pt=ne(()=>!X.forAgent&&!X.forChat),jt=ne(()=>X.forAgent||X.forChat),st=async()=>{var Fe;if(U.value.length!==0){N.value=!0;for(const xe of U.value)try{await J(xe)}catch{const nt=(Fe=b.value.find(Je=>Je.id===xe))==null?void 0:Fe.name;Ue({title:a("workspace.toast.fail.generalErrorTitle"),description:a("workspace.toast.fail.title.knowledgeBaseTab.download",{fileName:nt??""}),variant:"destructive"})}N.value=!1}};return(Fe,xe)=>{var je;const rt=f("Button"),nt=f("Input"),Je=f("Skeleton"),Ee=f("Checkbox");return s(),u("div",ff,[t("div",vf,[t("div",hf,[X.forAgent?w("",!0):(s(),T(rt,{key:0,variant:"ghost",class:"flex items-center px-2 py-1 text-sm rounded-none hover:bg-stone-100 dark:hover:bg-stone-700 gap-2","aria-label":e(a)("workspace.knowledgeBase.button.addDirectory"),disabled:e(y),onClick:xe[0]||(xe[0]=Ie=>ye.value=!0)},{default:i(()=>[xe[24]||(xe[24]=t("i",{class:"bi bi-plus-lg"},null,-1)),t("span",null,d(e(a)("workspace.knowledgeBase.button.addDirectory")),1)]),_:1,__:[24]},8,["aria-label","disabled"])),X.forAgent?w("",!0):(s(),T(Ug,{key:1,open:ye.value,"onUpdate:open":xe[1]||(xe[1]=Ie=>ye.value=Ie),onCancel:xe[2]||(xe[2]=Ie=>ye.value=!1),modelValue:fe.value,"onUpdate:modelValue":xe[3]||(xe[3]=Ie=>fe.value=Ie),onConfirm:ge},null,8,["open","modelValue"])),pt.value?(s(),u(ve,{key:2},[o(rt,{variant:"ghost",class:"flex items-center px-2 py-1 text-sm rounded-none hover:bg-stone-100 dark:hover:bg-stone-700 gap-2","aria-label":e(a)("workspace.knowledgeBase.button.upload"),disabled:e(y),onClick:xe[4]||(xe[4]=Ie=>ke.value=!0)},{default:i(()=>[xe[25]||(xe[25]=t("i",{class:"bi bi-upload"},null,-1)),t("span",null,d(e(a)("workspace.knowledgeBase.button.upload")),1)]),_:1,__:[25]},8,["aria-label","disabled"]),o(df,{visibleFiles:V.value,open:ke.value,"onUpdate:open":xe[5]||(xe[5]=Ie=>ke.value=Ie)},null,8,["visibleFiles","open"]),(je=e(h))!=null&&je.settings.allowDownload?(s(),T(rt,{key:0,variant:"ghost",class:"flex items-center px-2 py-1 text-sm rounded-none hover:bg-stone-100 dark:hover:bg-stone-700 gap-2","aria-label":e(a)("workspace.knowledgeBase.button.download"),disabled:e(y)||!e(C).length||e(N),onClick:st},{default:i(()=>[xe[26]||(xe[26]=t("i",{class:"bi bi-download"},null,-1)),t("span",null,d(e(a)("workspace.knowledgeBase.button.download")),1)]),_:1,__:[26]},8,["aria-label","disabled"])):w("",!0),o(rt,{variant:"ghost",class:"flex items-center px-2 py-1 text-sm rounded-none hover:bg-stone-100 dark:hover:bg-stone-700 gap-2","aria-label":e(a)("workspace.knowledgeBase.button.refresh"),disabled:e(y),onClick:xe[6]||(xe[6]=Ie=>{e(R)(),C.value=[],e($)(e(c).params.id)})},{default:i(()=>[xe[27]||(xe[27]=t("i",{class:"bi bi-arrow-clockwise"},null,-1)),t("span",null,d(e(a)("workspace.knowledgeBase.button.refresh")),1)]),_:1,__:[27]},8,["aria-label","disabled"]),o(rt,{variant:"ghost",class:"flex items-center px-2 py-1 text-sm rounded-none hover:bg-stone-100 dark:hover:bg-stone-700 gap-2","aria-label":e(a)("workspace.knowledgeBase.button.delete"),disabled:e(y)||!e(C).length,onClick:Ve},{default:i(()=>[xe[28]||(xe[28]=t("i",{class:"bi bi-trash3"},null,-1)),t("span",null,d(e(a)("workspace.knowledgeBase.button.delete")),1)]),_:1,__:[28]},8,["aria-label","disabled"]),o(Za,{open:_e.value,"onUpdate:open":xe[7]||(xe[7]=Ie=>_e.value=Ie),title:e(a)("workspace.deleteFiles.title"),description:e(a)("workspace.deleteFiles.description",{files_num:bt.value}),onCancel:xe[8]||(xe[8]=Ie=>_e.value=!1),onConfirm:xe[9]||(xe[9]=Ie=>Be())},null,8,["open","title","description"])],64)):w("",!0)]),t("div",{class:pe([jt.value?"overflow-x-auto":"flex-wrap","flex items-center text-sm px-2 bg-white dark:bg-stone-900 border-b"])},[o(rt,{variant:"ghost",class:"text-gray-700 dark:text-white hover:underline hover:bg-transparent",onClick:xe[10]||(xe[10]=Ie=>Ge(""))},{default:i(()=>[me(d(e(a)("workspace.subSidebar.tabs.knowledgeBase")),1)]),_:1}),xe[30]||(xe[30]=t("i",{class:"bi bi-chevron-right"},null,-1)),(s(!0),u(ve,null,Le($e.value,Ie=>(s(),u(ve,{key:Ie.path},[o(rt,{variant:"ghost",class:"hover:bg-transparent hover:underline",onClick:ct=>Ge(Ie.path)},{default:i(()=>[t("span",_f,d(Ie.label),1)]),_:2},1032,["onClick"]),xe[29]||(xe[29]=t("i",{class:"bi bi-chevron-right"},null,-1))],64))),128))],2),t("div",bf,[o(nt,{class:"border rounded px-2 py-1 text-sm w-full",placeholder:e(a)("workspace.knowledgeBase.seachBox.placeholder"),"aria-label":e(a)("workspace.knowledgeBase.seachBox.placeholder"),modelValue:z.value,"onUpdate:modelValue":xe[11]||(xe[11]=Ie=>z.value=Ie),onInput:xe[12]||(xe[12]=Ie=>he(Ie.target.value))},null,8,["placeholder","aria-label","modelValue"])]),t("div",kf,[e(y)?(s(),T(Je,{key:0,class:"w-24 h-4"})):(s(),u("div",yf,[t("span",null,d(e(a)("workspace.knowledgeBase.label.item-count-all",{count:ae.value.length+Q.value.length})),1),de.value>1?(s(),u("span",xf,d(e(a)("workspace.knowledgeBase.label.item-selected",{count:de.value})),1)):w("",!0),e(I)?(s(),u("span",wf,[t("p",null,d(e(a)("workspace.knowledgeBase.label.deletingFiles")),1),o(e(zs),{class:"size-4 animate-spin"})])):w("",!0)]))]),t("div",{class:pe(["flex flex-col overflow-auto max-w-screen",X.tableHeight])},[t("div",{class:pe(["max-sm:min-w-5xl sticky top-0 z-10 bg-white dark:bg-stone-900 px-3 py-2 border-b text-sm font-semibold",ht.value])},[X.forChat?w("",!0):(s(),u("div",$f,[o(Ee,{checked:re.value.every(Ie=>e(C).includes(Ie.id))&&re.value.length>0,disabled:e(y)||[...K.value,...V.value].length<=0,"onUpdate:checked":ue,"aria-label":"Select all"},null,8,["checked","disabled"])])),t("div",Sf,[o(Pe,{variant:"ghost",size:"default",className:"gap-2 hover:bg-transparent justify-start px-0 w-full",onClick:xe[13]||(xe[13]=Ie=>A("name"))},{default:i(()=>[t("span",Tf,[me(d(e(a)("workspace.knowledgeBase.table.header.name"))+" ",1),F.value!=="name"?(s(),u("i",Af)):F.value==="name"&&e(P)?(s(),u("i",Cf)):F.value==="name"&&!e(P)?(s(),u("i",Df)):w("",!0)])]),_:1})]),t("div",Lf,[o(Pe,{variant:"ghost",size:"default",className:"gap-2 hover:bg-transparent justify-start px-0 w-full",onClick:xe[14]||(xe[14]=Ie=>A("vectorIndexStatus"))},{default:i(()=>[t("span",If,[me(d(e(a)("workspace.knowledgeBase.table.header.status"))+" ",1),F.value!=="vectorIndexStatus"?(s(),u("i",Bf)):F.value==="vectorIndexStatus"&&e(P)?(s(),u("i",Mf)):F.value==="vectorIndexStatus"&&!e(P)?(s(),u("i",Ef)):w("",!0)])]),_:1})]),pt.value?(s(),u(ve,{key:1},[t("div",Rf,[o(Pe,{variant:"ghost",size:"default",className:"gap-2 hover:bg-transparent justify-start px-0 w-full",onClick:xe[15]||(xe[15]=Ie=>A("createdBy"))},{default:i(()=>[t("span",Ff,[me(d(e(a)("workspace.knowledgeBase.table.header.uploadedBy"))+" ",1),F.value!=="createdBy"?(s(),u("i",Pf)):F.value==="createdBy"&&e(P)?(s(),u("i",Nf)):F.value==="createdBy"&&!e(P)?(s(),u("i",zf)):w("",!0)])]),_:1})]),t("div",Uf,[o(Pe,{variant:"ghost",size:"default",className:"gap-2 hover:bg-transparent justify-start px-0 w-full",onClick:xe[16]||(xe[16]=Ie=>A("updatedAt"))},{default:i(()=>[t("span",Of,[me(d(e(a)("workspace.knowledgeBase.table.header.last-modified"))+" ",1),F.value!=="updatedAt"?(s(),u("i",jf)):F.value==="updatedAt"&&e(P)?(s(),u("i",Vf)):F.value==="updatedAt"&&!e(P)?(s(),u("i",Gf)):w("",!0)])]),_:1})]),t("div",Wf,[o(Pe,{variant:"ghost",size:"default",className:"gap-2 hover:bg-transparent justify-start px-0 w-full",onClick:xe[17]||(xe[17]=Ie=>A("contentType"))},{default:i(()=>[t("span",Hf,[me(d(e(a)("workspace.knowledgeBase.table.header.type"))+" ",1),F.value!=="contentType"?(s(),u("i",Kf)):F.value==="contentType"&&e(P)?(s(),u("i",qf)):F.value==="contentType"&&!e(P)?(s(),u("i",Qf)):w("",!0)])]),_:1})]),t("div",Jf,[o(Pe,{variant:"ghost",size:"default",className:"gap-2 hover:bg-transparent justify-start px-0 w-full",onClick:xe[18]||(xe[18]=Ie=>A("size"))},{default:i(()=>[t("span",Xf,[me(d(e(a)("workspace.knowledgeBase.table.header.size"))+" ",1),F.value!=="size"?(s(),u("i",Yf)):F.value==="size"&&e(P)?(s(),u("i",Zf)):F.value==="size"&&!e(P)?(s(),u("i",ev)):w("",!0)])]),_:1})]),xe[31]||(xe[31]=t("div",{class:"flex items-center h-8 px-2 justify-end"},null,-1))],64)):w("",!0)],2),t("div",tv,[e(D)?(s(),u("div",{key:0,class:pe(["px-3 items-center border-b hover:bg-stone-50 dark:hover:bg-stone-700 text-xs cursor-pointer",ht.value]),onClick:xe[20]||(xe[20]=Ie=>be())},[X.forChat?w("",!0):(s(),u("div",sv)),t("div",av,[o(rt,{variant:"ghost",class:"gap-2 hover:underline hover:bg-transparent w-full justify-start px-0",onClick:xe[19]||(xe[19]=Ie=>Se(e(D)))},{default:i(()=>xe[32]||(xe[32]=[t("i",{class:"bi bi-folder-fill text-lg text-transparent bg-clip-text bg-linear-to-br from-yellow-300 to-yellow-500"},null,-1),t("i",{class:"bi bi-arrow-90deg-up"},null,-1)])),_:1,__:[32]})])],2)):w("",!0),e(y)?(s(),u(ve,{key:1},Le(8,Ie=>t("div",{key:Ie,class:pe(["px-3 items-center border-b hover:bg-stone-100 dark:hover:bg-stone-700 text-xs",ht.value])},[X.forChat?w("",!0):(s(),u("div",ov,[o(Je,{class:"w-4 h-4"})])),t("div",nv,[o(Je,{class:"w-xs sm:w-sm xl:w-lg h-4"})]),t("div",lv,[o(Je,{class:"w-24 h-4"})]),pt.value?(s(),u(ve,{key:1},[t("div",iv,[o(Je,{class:"w-16 h-4"})]),t("div",rv,[o(Je,{class:"w-16 h-4"})]),t("div",cv,[o(Je,{class:"w-16 h-4"})]),t("div",dv,[o(Je,{class:"w-6 h-6"})])],64)):w("",!0)],2)),64)):(s(),u(ve,{key:2},[!ae.value.length&&!Q.value.length?(s(),u("div",uv,d(e(a)("workspace.knowledgeBase.table.noBlob")),1)):w("",!0),(s(!0),u(ve,null,Le(Q.value,Ie=>(s(),u("div",{key:Ie.id,class:pe(["px-3 items-center border-b hover:bg-stone-100 dark:hover:bg-stone-700 text-xs",ht.value])},[X.forChat?w("",!0):(s(),u("div",pv,[o(Ee,{checked:e(C).includes(Ie.id),"onUpdate:checked":ct=>Z(Ie.id),"aria-label":"Select "+Ie.name},null,8,["checked","onUpdate:checked","aria-label"])])),t("div",mv,[o(Pe,{variant:"ghost",size:"default",className:"gap-2 hover:underline hover:bg-transparent justify-start px-0 w-full",icon:"bi bi-folder-fill text-lg text-transparent bg-clip-text bg-gradient-to-br from-yellow-300 to-yellow-500",tooltip:e(p)&&pt.value?e(G)(Ie.name,"directory"):"",onClick:ct=>Se(Ie.id)},{default:i(()=>[t("span",gv,d(e(G)(Ie.name,"directory")),1),te(Ie.name,e(b),e(S))?(s(),u("div",fv,[o(e(zs),{class:"size-4 animate-spin"}),t("span",null,d(e(a)("workspace.knowledgeBase.label.downloading")),1)])):w("",!0)]),_:2},1032,["tooltip","onClick"])])],2))),128)),(s(!0),u(ve,null,Le(ae.value,Ie=>(s(),u("div",{key:Ie.id,class:pe(["px-3 items-center border-b text-xs transition-colors duration-150",ht.value,{"bg-orange-200 dark:bg-orange-400 hover:bg-orange-200 dark:text-gray-800":X.forAgent&&(Ie.vectorIndexStatus==="FAILED"||Ie.vectorIndexStatus==="NONE"),"hover:bg-stone-100 dark:hover:bg-stone-700":Ie.vectorIndexStatus!=="FAILED"&&Ie.vectorIndexStatus!=="NONE"}])},[X.forChat?w("",!0):(s(),u("div",vv,[o(Ee,{checked:e(C).includes(Ie.id),"onUpdate:checked":ct=>Z(Ie.id),"aria-label":"Select "+Ie.name},null,8,["checked","onUpdate:checked","aria-label"])])),t("div",hv,[o(Pe,{variant:"ghost",size:"default",className:"gap-2 hover:underline hover:bg-transparent w-full justify-start px-0 cursor-default",icon:e(Qn)(Ie.contentType).icon,tooltip:e(p)&&pt.value?e(G)(Ie.name):""},{default:i(()=>[t("span",_v,d(e(G)(Ie.name)),1),Ie.isDownloading?(s(),u("div",bv,[o(e(zs),{class:"size-4 animate-spin"}),t("span",null,d(e(a)("workspace.knowledgeBase.label.downloading")),1)])):w("",!0)]),_:2},1032,["icon","tooltip"])]),t("div",kv,[pt.value&&(Ie.vectorIndexStatus==="NONE"||Ie.vectorIndexStatus==="FAILED")?(s(),T(Pe,{key:0,variant:"ghost",className:"rounded-full bg-blue-500 border shadow-sm shadow-blue-500/50 dark:shadow-stone-600/50 hover:bg-blue-600 text-xs dark:bg-stone-600 dark:hover:bg-stone-500 gap-1",icon:"bi bi-plus text-white",size:"xs",onClick:ct=>et(Ie.id)},{default:i(()=>[t("span",yv,d(e(a)("workspace.knowledgeBase.button.index")),1)]),_:2},1032,["onClick"])):pt.value&&Ie.vectorIndexStatus==="DONE"?(s(),T(na,{key:1,items:Mt(Ie),"item-key":"index",icon:"",size:"xs","button-variant":"secondary","button-label":e(a)("workspace.knowledgeBase.label.indexed"),"button-class":"w-full rounded-full text-xs gap-1 border-gray-300 shadow-sm",onOnSelect:ct=>ze(Ie.id)},{trigger:i(()=>[xe[33]||(xe[33]=t("i",{class:"bi bi-check text-green-500 text-xs"},null,-1)),t("span",null,d(e(a)("workspace.knowledgeBase.label.indexed")),1),xe[34]||(xe[34]=t("i",{class:"bi bi-chevron-down"},null,-1))]),item:i(({item:ct})=>[t("i",{class:pe(ct.icon)},null,2),t("span",xv,d(ct.name),1)]),_:2},1032,["items","button-label","onOnSelect"])):jt.value&&(Ie.vectorIndexStatus==="NONE"||Ie.vectorIndexStatus==="FAILED")?(s(),u("span",wv,[xe[35]||(xe[35]=t("i",{class:"bi bi-exclamation-triangle text-xs text-orange-500 dark:text-red-600"},null,-1)),t("span",null,d(e(a)("workspace.knowledgeBase.label.notIndexed")),1)])):jt.value&&Ie.vectorIndexStatus==="DONE"?(s(),u("span",$v,[xe[36]||(xe[36]=t("i",{class:"bi bi-circle-fill text-[0.5rem] text-green-400 mr-2 ml-0.5"},null,-1)),t("span",null,d(e(a)("workspace.knowledgeBase.label.indexed")),1)])):Ie.vectorIndexStatus==="INDEXING"?(s(),u("span",Sv,[o(e(zs),{class:"size-4 animate-spin"}),t("span",null,d(e(a)("workspace.knowledgeBase.label.indexing")),1)])):w("",!0)]),pt.value?(s(),u(ve,{key:1},[t("div",Tv,d(H(Ie.createdBy??"")),1),t("div",Av,d(qe(Ie.updatedAt??new Date)),1),t("div",Cv,d(e(Qn)(Ie.contentType).extension),1),t("div",Dv,d(Ie.size?e(on)(Ie.size):""),1),t("div",Lv,[o(na,{items:lt(Ie),"item-key":"index",icon:"bi bi-three-dots text-xs",size:"icon","button-variant":"ghost",onOnTrigger:ct=>C.value=e(C).includes(Ie.id)?e(C):[Ie.id],onOnSelect:ct=>Nt(ct,Ie.id)},{item:i(({item:ct})=>[t("i",{class:pe(ct.icon)},null,2),t("span",{class:pe(ct.action==="delete"?"text-red-500":"")},d(ct.name),3)]),_:2},1032,["items","onOnTrigger","onOnSelect"])])],64)):w("",!0)],2))),128)),o(Za,{open:Re.value,"onUpdate:open":xe[21]||(xe[21]=Ie=>Re.value=Ie),title:e(a)("workspace.deleteFiles.title"),description:e(a)("workspace.deleteIndex.description"),onCancel:xe[22]||(xe[22]=Ie=>Re.value=!1),onConfirm:xe[23]||(xe[23]=Ie=>ft(zt.value))},null,8,["open","title","description"])],64))])],2)])])}}}),mi=oe({__name:"Select",props:{open:{type:Boolean},defaultOpen:{type:Boolean},defaultValue:{},modelValue:{},dir:{},name:{},autocomplete:{},disabled:{type:Boolean},required:{type:Boolean}},emits:["update:modelValue","update:open"],setup(n,{emit:l}){const r=$t(n,l);return(p,m)=>(s(),T(e(Dc),At(Ct(e(r))),{default:i(()=>[we(p.$slots,"default")]),_:3},16))}}),gi=oe({inheritAttrs:!1,__name:"SelectContent",props:{forceMount:{type:Boolean},position:{default:"popper"},bodyLock:{type:Boolean},side:{},sideOffset:{},align:{},alignOffset:{},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},updatePositionStrategy:{},prioritizePosition:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["closeAutoFocus","escapeKeyDown","pointerDownOutside"],setup(n,{emit:l}){const a=n,c=l,r=ne(()=>{const{class:m,...g}=a;return g}),p=$t(r,c);return(m,g)=>(s(),T(e(Bc),null,{default:i(()=>[o(e(Ic),He({...e(p),...m.$attrs},{class:e(Me)("relative z-50 max-h-96 min-w-32 overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",m.position==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a.class)}),{default:i(()=>[o(e(Rv)),o(e(Lc),{class:pe(e(Me)("p-1",m.position==="popper"&&"h-(--radix-select-trigger-height) w-full min-w-(--radix-select-trigger-width)"))},{default:i(()=>[we(m.$slots,"default")]),_:3},8,["class"]),o(e(Ev))]),_:3},16,["class"])]),_:3}))}}),fi=oe({__name:"SelectGroup",props:{asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:c,...r}=l;return r});return(c,r)=>(s(),T(e(Mc),He({class:e(Me)("p-1 w-full",l.class)},a.value),{default:i(()=>[we(c.$slots,"default")]),_:3},16,["class"]))}}),Iv={class:"absolute right-4 flex h-3 w-3 items-center justify-center"},vi=oe({__name:"SelectItem",props:{value:{},disabled:{type:Boolean},textValue:{},asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:r,...p}=l;return p}),c=Pt(a);return(r,p)=>(s(),T(e(Rc),He(e(c),{class:e(Me)("relative flex w-full cursor-pointer select-none items-center rounded-sm py-1.5 px-4 mr-8 text-sm outline-hidden hover:bg-accent focus:text-accent-foreground data-disabled:pointer-events-none data-disabled:opacity-50",l.class)}),{default:i(()=>[t("span",Iv,[o(e(Ec),null,{default:i(()=>p[0]||(p[0]=[t("i",{class:"bi bi-check text-xl"},null,-1)])),_:1,__:[0]})]),we(r.$slots,"default")]),_:3},16,["class"]))}}),Bv=oe({__name:"SelectItemText",props:{asChild:{type:Boolean},as:{}},setup(n){const l=n;return(a,c)=>(s(),T(e(yl),At(Ct(l)),{default:i(()=>[we(a.$slots,"default")]),_:3},16))}}),Mv=oe({__name:"SelectLabel",props:{for:{},asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n;return(a,c)=>(s(),T(e(Fc),{class:pe(e(Me)("py-1.5 pl-8 pr-2 text-sm font-semibold",l.class))},{default:i(()=>[we(a.$slots,"default")]),_:3},8,["class"]))}}),Ev=oe({__name:"SelectScrollDownButton",props:{asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:r,...p}=l;return p}),c=Pt(a);return(r,p)=>(s(),T(e(Pc),He(e(c),{class:e(Me)("flex cursor-default items-center justify-center py-1",l.class)}),{default:i(()=>[we(r.$slots,"default",{},()=>[o(e(xl),{class:"h-4 w-4"})])]),_:3},16,["class"]))}}),Rv=oe({__name:"SelectScrollUpButton",props:{asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:r,...p}=l;return p}),c=Pt(a);return(r,p)=>(s(),T(e(zc),He(e(c),{class:e(Me)("flex cursor-default items-center justify-center py-1",l.class)}),{default:i(()=>[we(r.$slots,"default",{},()=>[o(e(Nc),{class:"h-4 w-4"})])]),_:3},16,["class"]))}}),hi=oe({__name:"SelectTrigger",props:{disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:r,...p}=l;return p}),c=Pt(a);return(r,p)=>(s(),T(e(Uc),He(e(c),{class:e(Me)("flex h-10 w-full items-center justify-center rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-placeholder:text-muted-foreground focus:outline-hidden focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:truncate text-start",l.class)}),{default:i(()=>[we(r.$slots,"default")]),_:3},16,["class"]))}}),_i=oe({__name:"SelectValue",props:{placeholder:{},asChild:{type:Boolean},as:{}},setup(n){const l=n;return(a,c)=>(s(),T(e(Oc),At(Ct(l)),{default:i(()=>[we(a.$slots,"default")]),_:3},16))}}),Fv={class:"text-xs text-zinc-500 m-1"},Ds=oe({__name:"EzSelect",props:{id:{default:"ez-select"},placeholder:{},defaultValue:{},icon:{default:"bi bi-chevron-expand text-xs"},disabled:{type:Boolean},title:{},items:{},itemKey:{},itemText:{},itemIcon:{},itemIconDisplay:{}},setup(n){const l=n;return(a,c)=>(s(),T(e(mi),{defaultValue:l.defaultValue,id:l.id},{default:i(()=>[o(e(hi),{disabled:l.disabled,class:"flex flex-row justify-between"},{default:i(()=>[o(e(_i),{placeholder:l.placeholder},null,8,["placeholder"]),t("i",{class:pe(l.icon)},null,2)]),_:1},8,["disabled"]),o(e(gi),null,{default:i(()=>[t("div",Fv,d(l.title),1),(s(!0),u(ve,null,Le(l.items,r=>(s(),T(e(fi),{key:r[l.itemKey]},{default:i(()=>[o(e(vi),{value:r[l.itemKey]},{default:i(()=>[o(e(Bv),null,{default:i(()=>[me(d(r[l.itemText]),1)]),_:2},1024),l.itemIcon&&l.itemIconDisplay?(s(),u("i",{key:0,class:pe([r[l.itemIconDisplay]?l.itemIcon:""])},null,2)):w("",!0)]),_:2},1032,["value"])]),_:2},1024))),128))]),_:1})]),_:1},8,["defaultValue","id"]))}}),Pv={key:0},Nv={key:1},zv={class:"h-full max-h-dvh sm:max-lg:h-[20rem] lg:max-2xl:h-[25rem] 2xl:h-[45rem] sm:max-w-2xl mx-auto"},Uv={class:"flex flex-col pt-10 gap-4 w-full"},Ov={class:"flex flex-col gap-2"},jv={key:0,class:"text-red-500 dark:text-red-600"},Vv={key:1,class:"text-red-500 dark:text-red-600"},Gv={class:"flex flex-col gap-2"},Wv={class:"text-gray-500 dark:text-gray-400 text-xs"},Hv={class:"font-semibold text-black dark:text-white"},Kv={key:0,class:"text-center -mx-2 py-2 px-4 block rounded-full"},qv={key:1,class:"text-center -mx-2 py-2 px-4 block rounded-full"},Qv={key:0,class:"text-center -mx-2 py-2 px-4 block rounded-full"},Jv={key:1,class:"text-center -mx-2 py-2 px-4 block rounded-full"},Xv=oe({__name:"KnowledgeUploadDestination",props:bs({fileContent:{}},{open:{type:Boolean},openModifiers:{}}),emits:["update:open"],setup(n){const l=Ce(),{t:a}=We(l.t),{toast:c}=gt(),r=co(),{currentPath:p}=ie(r),{uploadSingleFile:m}=r,g=v(1),h=Os(n,"open"),_=v(!1),x=n,b=[{value:".json",type:"application/json"},{value:".md",type:"text/markdown"},{value:".txt",type:"text/plain"}],S=v("result"),D=v(".json"),y=()=>{var ee;let j=(ee=b.find(se=>se.value===D.value))==null?void 0:ee.type;return j||(j="application/json"),new File([x.fileContent],E.value,{type:j})},I=async()=>{var j;try{_.value=!0;const ee={file:y(),name:E.value,path:p.value};await m(ee,ee.path),c({title:a("workspace.toast.knowledgeUploadDestination.uploadToKnowledge")})}catch(ee){console.error(ee),((j=ee.response)==null?void 0:j.status)===400?c({title:a("workspace.toast.fail.title.knowledgeBaseTab.uploadFile.duplicate"),description:a("workspace.toast.fail.description.knowledgeBaseTab.uploadFile.duplicate"),variant:"destructive"}):c({title:a("workspace.toast.fail.knowledgeBase.upload"),variant:"destructive"})}finally{_.value=!1,h.value=!1}},C=async()=>{g.value===1?g.value=2:(await I(),B())},U=()=>{B(),g.value===1?h.value=!1:g.value=1},E=ne(()=>S.value+D.value),N=ne(()=>"/"+p.value),$=[/\/\.\.\//,/\/\.\//,/\/\//,/\0/,/[\\:*?"<>|]/],R=ne(()=>!$.some(j=>j.test(S.value))),B=()=>{S.value="result",p.value=""};return(j,ee)=>{const se=f("Label"),G=f("Input"),J=f("Loader2");return s(),T(fa,{open:h.value,"onUpdate:open":ee[2]||(ee[2]=H=>h.value=H),contentClass:"max-w-3xl",shouldDisableConfirmButton:g.value===2&&(!R.value||!S.value)||_.value,onCancel:U,onConfirm:C},{title:i(()=>[g.value===1?(s(),u("span",Pv,d(e(a)("workspace.knowledgeUploadDestination.dialog.selectLocation.title")),1)):(s(),u("span",Nv,d(e(a)("workspace.knowledgeUploadDestination.dialog.inputFileName.title")),1))]),description:i(()=>[t("div",zv,[Ke(o(nn,{forChat:!0,"table-height":"max-sm:max-w-sm max-h-[20rem] sm:max-lg:max-h-[12rem] lg:max-2xl:max-h-[14rem] 2xl:max-h-[34rem]"},null,512),[[es,g.value===1]]),Ke(t("div",Uv,[t("div",Ov,[o(se,{for:"fileNameInput"},{default:i(()=>[me(d(e(a)("workspace.knowledgeUploadDestination.dialog.label.inputFileName")),1)]),_:1}),o(G,{maxlength:"100",id:"fileNameInput",modelValue:S.value,"onUpdate:modelValue":ee[0]||(ee[0]=H=>S.value=H),placeholder:e(a)("workspace.knowledgeUploadDestination.dialog.label.inputFileName"),autocomplete:"off",autofocus:""},null,8,["modelValue","placeholder"]),S.value.length?w("",!0):(s(),u("span",jv,d(e(a)("workspace.knowledgeUploadDestination.dialog.label.warning.emptyFileName")),1)),R.value?w("",!0):(s(),u("span",Vv,d(e(a)("workspace.knowledgeUploadDestination.dialog.label.warning.invalidFileName")),1))]),t("div",Gv,[o(se,{for:"fileExtensionInput"},{default:i(()=>[me(d(e(a)("workspace.knowledgeUploadDestination.dialog.label.selectFileExtension")),1)]),_:1}),o(Ds,{modelValue:D.value,"onUpdate:modelValue":ee[1]||(ee[1]=H=>D.value=H),items:b,itemKey:"value",itemText:"value"},null,8,["modelValue"])]),t("div",Wv,[t("span",null,d(e(a)("workspace.knowledgeUploadDestination.dialog.label.uploadedLocation")),1),t("span",Hv,d(N.value+E.value),1)])],512),[[es,g.value===2]])])]),confirm:i(()=>[g.value===1?(s(),u("span",Kv,d(e(a)("workspace.chat.dialog.uploadToKnowledge.nextStep")),1)):g.value===2?(s(),u("span",qv,d(e(a)("ezDialog.footer.button.confirm")),1)):w("",!0),_.value?(s(),T(J,{key:2,class:"animate-spin"})):w("",!0)]),cancel:i(()=>[g.value===1?(s(),u("span",Qv,d(e(a)("ezDialog.footer.button.cancel")),1)):w("",!0),g.value===2?(s(),u("span",Jv,d(e(a)("workspace.chat.dialog.uploadToKnowledge.previousStep")),1)):w("",!0)]),_:1},8,["open","shouldDisableConfirmButton"])}}}),Yv={class:"flex flex-col p-1 bg-stone-100 dark:bg-stone-950 border rounded-md border-solid"},Zv={class:"sticky top-0 pb-20 pointer-events-none"},eh={class:"bg-stone-100 rounded-t-md dark:bg-stone-950 flex items-center justify-between px-4 -m-1 py-2 text-xs border-b"},th={class:"text-xs font-semibold opacity-50"},sh={class:"pointer-events-auto"},ah={key:0,class:"bi bi-copy"},oh={key:1,class:"bi bi-check-lg"},nh={key:2},lh={key:3},ih={class:"flex h-fit -mt-20"},rh={class:"not-prose px-1 py-0 m-0 overflow-x-auto"},ch=["innerHTML"],dh=oe({__name:"CodeComponent",props:{code:{},lang:{},isCompleted:{type:Boolean},forWorkspace:{type:Boolean}},setup(n){const{t:l}=Ce(),a=n,c={javascript:"js",typescript:"ts",python:"py",json:"json",html:"html",css:"css",scss:"scss",vue:"vue",markdown:"md",shell:"sh",bash:"sh",go:"go",java:"java",c:"c",cpp:"cpp",plaintext:"txt",xml:"xml",yaml:"yaml",php:"php",ruby:"rb",rust:"rs",swift:"swift",kotlin:"kt",dart:"dart",sql:"sql",powershell:"ps1",typescriptreact:"tsx",javascriptreact:"jsx",perl:"pl",makefile:"mk",dockerfile:"dockerfile",ini:"ini",objectivec:"m",objectivecpp:"mm",clojure:"clj",elixir:"ex",erlang:"erl",fsharp:"fs",lisp:"lisp",scala:"scala",coffee:"coffee",gradle:"gradle",groovy:"groovy",latex:"tex",r:"r",matlab:"m",nim:"nim",ocaml:"ml",pascal:"pas",protobuf:"proto",reasonml:"re",sas:"sas",scheme:"scm",smalltalk:"st",toml:"toml",vbnet:"vb",visualbasic:"vb",wasm:"wasm"},r=ne(()=>{const D=Nn.getLanguage(a.lang)?a.lang:"plaintext";return ya.sanitize(Nn.highlight(a.code,{language:D}).value)}),p=ne(()=>a.code),{copy:m,copied:g,isSupported:h}=ga({source:p}),_=ne(()=>c[a.lang.toLowerCase()]||"txt"),x=v(!1),b=Bt("downloadRef"),S=()=>{const D=new Blob([a.code],{type:"text/plain"}),y=URL.createObjectURL(D),I=`result.${_.value}`;b.value&&(b.value.href=y,b.value.download=I,b.value.click(),URL.revokeObjectURL(y))};return(D,y)=>{const I=f("Button");return s(),u("div",Yv,[t("div",Zv,[t("div",eh,[t("span",th,d(D.lang),1),t("div",sh,[e(h)?(s(),T(I,{key:0,variant:"ghost",class:"text-xs gap-1 hover:bg-stone-200 dark:hover:bg-stone-800",onClick:y[0]||(y[0]=C=>e(m)())},{default:i(()=>[e(g)?(s(),u("i",oh)):(s(),u("i",ah)),e(g)?(s(),u("span",lh,d(e(l)("home.chat.label.copyCodeDone")),1)):(s(),u("span",nh,d(e(l)("home.chat.label.copyCode")),1))]),_:1})):w("",!0),a.forWorkspace?(s(),T(I,{key:1,disabled:!a.isCompleted,variant:"ghost",class:"text-xs gap-1 hover:bg-stone-200 dark:hover:bg-stone-800",onClick:S},{default:i(()=>[y[3]||(y[3]=t("i",{class:"bi bi-download"},null,-1)),t("span",null,d(e(l)("workspace.chat.button.downloadCode",{ext:_.value})),1)]),_:1,__:[3]},8,["disabled"])):w("",!0),a.forWorkspace?(s(),T(I,{key:2,disabled:!a.isCompleted,variant:"ghost",class:"text-xs gap-1 hover:bg-stone-200 dark:hover:bg-stone-800",onClick:y[1]||(y[1]=C=>x.value=!0)},{default:i(()=>[y[4]||(y[4]=t("i",{class:"bi bi-upload"},null,-1)),t("span",null,d(e(l)("workspace.chat.button.uploadToKnowledge",{ext:_.value})),1)]),_:1,__:[4]},8,["disabled"])):w("",!0),a.forWorkspace?(s(),T(Xv,{key:3,open:x.value,"onUpdate:open":y[2]||(y[2]=C=>x.value=C),fileContent:p.value},null,8,["open","fileContent"])):w("",!0),t("a",{ref_key:"downloadRef",ref:b,class:"hidden"},null,512)])])]),t("div",ih,[t("pre",rh,[t("code",{class:"hljs p-0 language-{{lang}}",innerHTML:r.value},null,8,ch)])])])}}}),uh={class:"text-xs sm:text-sm"},ss=oe({__name:"CopyRichTextButton",props:{size:{default:"smicon"},variant:{default:"ghost"},content:{},copyDoneTooltip:{},copyTooltip:{},copyFailedTooltip:{},disabled:{type:Boolean},showButtonLabel:{type:Boolean},copyLabel:{},copyDoneLabel:{},copyFailedLabel:{},className:{}},setup(n){const l=new bu,{toast:a}=gt(),c=Ce(),{t:r}=We(c.t),p=v(!1),m=v(!1),g=n,h=ne(()=>m.value?g.copyFailedTooltip:p.value?g.copyDoneTooltip:g.copyTooltip),_=ne(()=>m.value?g.copyFailedLabel:p.value?g.copyDoneLabel:g.copyLabel);l.use({extensions:[{name:"canvas-mode",level:"block",start(b){return b.indexOf("<canvas-mode>")},tokenizer(b){const S="<canvas-mode>",D="</canvas-mode>",y=b.indexOf(S);if(y!=0)return;let I=b.slice(y);const C=I.indexOf(D);C>=0&&(I=I.slice(0,C+D.length));const U=I.match(/<title>\s*([^<]*)/i),E=U?U[1].trim():I;return{type:"canvas-mode",raw:I,titleContent:E}},renderer(b){return b.titleContent}},{name:"citation",level:"block",start(b){return b.indexOf("<citation>")},tokenizer(b){const S="<citation>",D="</citation>",y=b.indexOf(S);if(y!=0)return;let I=b.slice(y);const C=I.indexOf(D);return C>=0&&(I=I.slice(0,C+D.length)),{type:"citation",raw:I}},renderer(){return""}}]});const x=async b=>{try{const S=await l.parse(b),D=document.createElement("div");D.innerHTML=S;const I=`
          <style>
            table, th, td {
              border: 1px solid #333;
              border-collapse: collapse;
              text-align: left;
            }
          </style>
        `+S,C=D.textContent||D.innerText||"",U=new Blob([C],{type:"text/plain"}),E=new Blob([I],{type:"text/html"}),N=new ClipboardItem({"text/html":E,"text/plain":U});await navigator.clipboard.write([N]),p.value=!0;const{start:$}=sa(()=>p.value=!1,1500);$()}catch{m.value=!0;const{start:D}=sa(()=>m.value=!1,1500);a({title:r("copyRichTextButton.toast.copyFailed"),variant:"destructive"}),D()}};return(b,S)=>{const D=f("Button");return s(),u(ve,null,[b.showButtonLabel?w("",!0):(s(),T(Pe,{key:0,className:g.className,onClick:S[0]||(S[0]=y=>x(g.content)),variant:g.variant,size:g.size,icon:{"bi bi-x":m.value,"bi bi-check":p.value,"bi bi-copy":!p.value},tooltip:h.value,disabled:g.disabled},null,8,["className","variant","size","icon","tooltip","disabled"])),b.showButtonLabel?(s(),T(D,{key:1,class:pe(e(Me)(g.className,"text-sm flex justify-start w-full")),onClick:S[1]||(S[1]=y=>x(g.content)),disabled:g.disabled,variant:g.variant,size:g.size},{default:i(()=>[t("i",{class:pe({"bi bi-copy mr-2":!p.value&&!m.value,"bi bi-check mr-2":p.value,"bi bi-x mr-2":m.value})},null,2),t("span",uh,d(_.value),1)]),_:1},8,["class","disabled","variant","size"])):w("",!0)],64)}}}),ph={key:0,class:"flex gap-2 items-center"},mh={key:0,class:"bi-arrow-clockwise text-lg m-1 animate-spin"},gh={key:1,class:"bi bi-file-earmark-text text-lg m-1"},fh={key:2,class:"bi bi-code-square text-lg m-1"},vh={class:"pl-2 font-bold overflow-hidden text-nowrap line-clamp-2 whitespace-pre-line"},hh=oe({__name:"CanvasModeOpen",props:{code:{},done:{type:Boolean}},setup(n){const l=ms(),{messageEditorState:a}=ie(l),c=Ce(),{t:r}=We(c.t),p=n,m=xt(),{privateGPTSidebarState:g}=ie(m),h=()=>{l.openCanvas(_.value),g.value=!1},_=ne(()=>b(p.code));hl(_,S=>{a.value.canvasStates=[S]},{immediate:!0,debounce:500,maxWait:500});const x=ne(()=>_.value.lang==="markdown");function b(S){const D={},y=/<language>\s*([^<]*)/i,I=S.match(y);I&&I[1]&&(D.lang=I[1].trim());const C=/<title>\s*([^<]*)/i,U=S.match(C);U&&U[1]&&(D.title=U[1].trim());const E=/<data>\s*<!\[CDATA\[([\s\S]*)/i,N=S.match(E);if(N&&typeof N[1]=="string"){const $=N[1],R=$.indexOf("]]>");R!==-1?D.code=$.substring(0,R).trim():D.code=$.trim()}return D}return(S,D)=>{var C,U,E;const y=f("Button"),I=Kt("auto-animate");return Ke((s(),u("div",{class:pe({"flex gap-2 items-center justify-between transition-all duration-200":!0,"bg-white dark:bg-stone-700 cursor-pointer shadow-md":!!((C=_.value)!=null&&C.title),"max-w-md   border p-4 rounded-3xl":!!((U=_.value)!=null&&U.title)}),onClick:h},[(E=_.value)!=null&&E.title?(s(),u("div",ph,[S.done?x.value?(s(),u("i",gh)):(s(),u("i",fh)):(s(),u("i",mh)),t("div",vh,d(_.value.title),1)])):w("",!0),o(y,{onClick:h,class:"px-4"},{default:i(()=>[me(d(e(r)("home.chat.canvasMode.open")),1)]),_:1})],2)),[[I]])}}}),Aa=oe({__name:"EzTooltip",props:{side:{default:"top"},align:{default:"start"},sideOffset:{},tooltipContent:{},tooltipContentClass:{}},setup(n){const l=n;return(a,c)=>{const r=f("TooltipTrigger"),p=f("TooltipContent"),m=f("Tooltip"),g=f("TooltipProvider");return s(),T(g,null,{default:i(()=>[o(m,null,{default:i(()=>[o(r,{"as-child":""},{default:i(()=>[we(a.$slots,"trigger")]),_:3}),o(p,{side:l.side,align:l.align,sideOffset:l.sideOffset,class:pe(l.tooltipContentClass)},{default:i(()=>[we(a.$slots,"content",{},()=>[me(d(l.tooltipContent),1)])]),_:3},8,["side","align","sideOffset","class"])]),_:3})]),_:3})}}}),_h={class:"inline-flex min-w-6 mx-0.5 justify-center items-center rounded-md dark:bg-stone-700 dark:text-stone-400 bg-blue-100 text-blue-800 font-semibold text-sm font-mono tabular-nums cursor-pointer"},bh={key:1,class:"bi bi-link-45deg"},kh={class:"flex flex-col max-w-96"},yh={class:"flex items-center gap-2"},xh={class:"font-bold line-clamp-1"},wh={class:"line-clamp-4 text-sm mt-2"},$h={class:"flex self-end gap-1 mt-4 items-center"},Sh={class:"opacity-50 text-xs"},Th={class:"rounded-full text-xs font-semibold"},Jn=oe({__name:"GeneralCitation",props:{index:{},title:{},content:{},page:{},isNumberCitation:{type:Boolean}},setup(n){const l=n,a=Ce(),{t:c}=We(a.t);return(r,p)=>l.content?(s(),T(Aa,{key:0,align:"start",tooltipContentClass:"border-l-4 border-l-blue-500 dark:border-l-stone-500 px-5 py-2 dark:bg-stone-800"},{trigger:i(()=>[t("span",_h,[l.isNumberCitation?(s(),u(ve,{key:0},[me(d(l.index),1)],64)):(s(),u("i",bh))])]),content:i(()=>[t("div",kh,[t("div",yh,[p[0]||(p[0]=t("i",{class:"bi bi-book text-lg"},null,-1)),t("div",xh,d(l.title),1)]),t("div",wh,d(l.content),1),t("div",$h,[p[1]||(p[1]=t("i",{class:"bi bi-file-earmark-text text-md opacity-50"},null,-1)),t("span",Sh,d(e(c)("qms.searchChat.citation.page")),1),t("span",Th,d(l.page),1)])])]),_:1})):w("",!0)}}),Ah={class:"prose prose-sm max-w-none dark:prose-invert"},va=oe({__name:"StreamingMarkdownRenderer",props:{streamingMarkdown:{},isCompleted:{type:Boolean},markedOptions:{},katexOptions:{},enableCanvas:{type:Boolean},citations:{},isNumberCitation:{type:Boolean},forWorkspace:{type:Boolean},tracking:{}},setup(n){const{t:l}=Ce(),a=n,{nonce:c}=ie(an()),r=ne(()=>a.streamingMarkdown.replace(new RegExp("(?<![\\\\$])\\$(\\d[\\d,]*(\\.\\d+)?)\\b","g"),"\\$$$1").replace(/\\\[(.+?)\\]/gs,(A,k)=>`$$${k.trim()}$$`).replace(/\\\((.+?)\\\)/g,(A,k)=>`$${k.trim()}$`)),p={throwOnError:!1,output:"html",nonStandard:!0,...a.katexOptions||{}};ba.use(ku({...p}),{extensions:[{name:"canvas-mode",level:"block",start(A){return A.indexOf("<canvas-mode>")},tokenizer(A){const k="<canvas-mode>",L="</canvas-mode>",z=A.indexOf(k);if(z!==0)return;let Q=A.slice(z);const ae=Q.indexOf(L);return ae>=0&&(Q=Q.slice(0,ae+L.length)),{type:"canvas-mode",raw:Q,done:ae>=0}}},{name:"citation",level:"inline",start(A){return A.indexOf("<citation>")},tokenizer(A){const k=/^<citation>(.*?)<\/citation>/.exec(A);if(k)return{type:"citation",raw:k[0],text:k[1]}}}]}),ba.use({gfm:!0,pedantic:!1,breaks:!1,...a.markedOptions||{}});const m=Tr([]),g=v(""),h=(A,k,L)=>`${L}::${A}:${k}`,_=(A,k,L,z,Q)=>`${A}-unit-${k}-${L}-${z}-${Q}`,x=(A,k,L)=>`${A}-unit-${k}-${L}`,b=A=>{const k=[];return A.isStrong&&k.push("font-bold"),A.isEm&&k.push("italic"),A.isDel&&k.push("line-through"),k.join(" ")||""},S=(A,k)=>{var Q;const L=Number(A.text.trim()),z=(Q=a.citations)==null?void 0:Q.find(ae=>ae.id===L);z&&(z.link?k.push(Oe(Hs,{tracking:a.tracking,href:z.link},[Oe(Jn,{index:z.citationNumber??0,title:z.title,content:z.content,page:z.page,isNumberCitation:a.isNumberCitation})])):k.push(Oe(Jn,{title:z.title,content:z.content,page:z.page,isNumberCitation:a.isNumberCitation})))},D=(A,k,L)=>{const z=A;if(z.tokens&&z.tokens.length>0){k.push(...N(z.tokens,L.currentTokenBaseKey,L.renderingStable,L.activeStyles));return}const Q=z.raw??"";if(L.renderingStable){k.push(Oe("span",{key:L.currentTokenBaseKey,class:L.classes},Q));return}Q.split(/(\s+)/).filter(de=>de.length>0).forEach((de,le)=>{const Z={key:_(L.baseKey,A.type,L.tokenIdx,"segment",le),class:L.classes};k.push(Oe("span",Z,de))})},y=(A,k,L)=>{const z=A,Q=z.text??z.raw,ae={key:L.currentTokenBaseKey,class:L.classes};k.push(Oe("span",ae,Q))},I=(A,k,L)=>{const z=A;z.block&&!L.renderingStable?(z.text||"").split(/(\s+)/).filter(ae=>ae.length>0).forEach((ae,de)=>{k.push(Oe("span",{key:_(L.baseKey,A.type,L.tokenIdx,"segment",de),innerText:ae}))}):k.push(Oe("span",{key:L.currentTokenBaseKey,innerText:z.text}))},C=(A,k,L)=>{const z=A,Q=N(z.tokens,`${L.currentTokenBaseKey}-content`,L.renderingStable,L.activeStyles);!Q.length||!z.href||k.push(Oe(Hs,{key:x(L.baseKey,"link",L.tokenIdx),href:z.href,title:z.title||void 0,tracking:a.tracking},()=>Q))},U=(A,k,L)=>{const z=A;try{const Q=Fa.renderToString(z.text,{...p,displayMode:z.displayMode}).replace(/<(.*?) style=/g,(ae,de)=>`<${de} nonce='${c.value}' style=`);k.push(Oe("span",{key:x(L.baseKey,"inlineKatex",L.tokenIdx),innerHTML:ya.sanitize(Q)}))}catch(Q){const ae=p.throwOnError===!1?`[KaTeX Error: ${z.text}]`:"[KaTeX Error]";k.push(Oe("span",{key:x(L.baseKey,"katex-error",L.tokenIdx),class:"text-red-500",title:Q.message},ae))}},E=(A,k,L)=>{const z=A;try{const Q=Fa.renderToString(z.text,{...p,displayMode:!0});k.push(Oe("div",{key:x(L.baseKey,"blockKatex-in-inline",L.tokenIdx),class:"katex-block-in-inline",innerHTML:ya.sanitize(Q)}))}catch(Q){const ae=p.throwOnError===!1?`[KaTeX Error: ${z.text}]`:"[KaTeX Error]";k.push(Oe("div",{key:x(L.baseKey,"katex-error-block",L.tokenIdx),class:"text-red-500 p-1 my-1",title:Q.message},ae))}},N=(A,k,L,z={})=>{if(!A)return[];const Q=[];return A.forEach((ae,de)=>{const le=`${k}-${ae.type}-${de}`,Z={classes:b(z),activeStyles:z,currentTokenBaseKey:le,baseKey:k,tokenIdx:de,renderingStable:L};switch(ae.type){case"citation":S(ae,Q);break;case"text":D(ae,Q,Z);break;case"escape":y(ae,Q,Z);break;case"html":I(ae,Q,Z);break;case"link":C(ae,Q,Z);break;case"inlineKatex":U(ae,Q,Z);break;case"blockKatex":E(ae,Q,Z);break;case"strong":Q.push(...N(ae.tokens,le,L,{...z,isStrong:!0}));break;case"em":Q.push(...N(ae.tokens,le,L,{...z,isEm:!0}));break;case"del":Q.push(...N(ae.tokens,le,L,{...z,isDel:!0}));break;case"codespan":Q.push(Oe("code",{key:x(k,"codespan",de),class:"font-mono text-sm bg-stone-200 dark:bg-stone-700 py-0.5 px-1 rounded",innerText:ae.text}));break;case"image":Q.push(Oe("img",{key:x(k,"image",de),src:ae.href,alt:ae.text,title:ae.title||void 0,class:"inline-block"}));break;case"br":Q.push(Oe("br",{key:le}));break;case"space":break;default:Q.push(Oe("span",{key:x(k,"unknown",de)},ae.raw));break}}),Q},$=(A,k,L,z)=>{if(!A)return[];const Q=[];let ae=[];const de=()=>{if(!ae.length)return;const le=[...ae];z?Q.push(...le):Q.push(Oe(Ps,{name:"word-fade",tag:"span",appear:!0},()=>le)),ae=[]};return A.forEach((le,te)=>{const Z=`${k}-${L?"loose":"tight"}-${le.type}-${te}`,re=["list","code","blockquote","hr","table","blockKatex"].includes(le.type)||le.type==="html"&&le.block;if(!L&&!re){ae.push(...N([le],Z,z,{}));return}de(),Q.push(...H(Object.assign([le],{links:{}}),Z,z))}),L||de(),Q},R=(A,k,L)=>{const z=A,Q=N(z.tokens,`${L.blockKey}-content`,L.renderingStable,{}),ae=A.type==="heading"?`h${z.depth}`:"p";if(L.renderingStable){k.push(Oe(ae,{key:L.blockKey},Q));return}k.push(Oe(ae,{key:L.blockKey},[Oe(Ps,{name:"word-fade",tag:"span",appear:!0},()=>Q)]))},B=(A,k,L)=>{const Q=N([A],`${L.blockKey}-content`,L.renderingStable,{});if(Q.some(ae=>{var de,le,te;return((de=ae.children)==null?void 0:de.trim())!==""||((te=(le=ae.props)==null?void 0:le.innerHTML)==null?void 0:te.trim())!==""})){if(L.renderingStable){k.push(Oe("p",{key:L.blockKey},Q));return}k.push(Oe("p",{key:L.blockKey},[Oe(Ps,{name:"word-fade",tag:"span",appear:!0},()=>Q)]))}},j=(A,k,L)=>{const z=A;k.push(Oe(z.ordered?"ol":"ul",{key:L.blockKey,start:z.start||void 0},z.items.map((Q,ae)=>{const de=h("list_item",ae,L.blockKey),le=$(Q.tokens,`${de}-content`,Q.loose,L.renderingStable),te=Q.task?Oe("input",{type:"checkbox",checked:Q.checked,disabled:!0,class:"mr-2 align-middle -mt-1",key:`${de}-checkbox`}):null;return Oe("li",{key:de,class:Q.task?"flex items-baseline":""},te?[te,...le]:le)})))},ee=(A,k,L)=>{const z=A;if(z.block){k.push(Oe("div",{key:`${L.blockKey}-htmlcontent`,class:"raw-html-block",innerText:z.text}));return}const Q=N([z],`${L.blockKey}-inlinehtml`,L.renderingStable,{});if(Q.some(ae=>{var de,le,te;return((de=ae.children)==null?void 0:de.trim())!==""||((te=(le=ae.props)==null?void 0:le.innerHTML)==null?void 0:te.trim())!==""})){if(L.renderingStable){k.push(Oe("p",{key:L.blockKey},Q));return}k.push(Oe("p",{key:L.blockKey},[Oe(Ps,{name:"word-fade",tag:"span",appear:!0},()=>Q)]))}},se=(A,k,L)=>{const z=A,Q=(Z,re,ue)=>Z.map((he,$e)=>{const Se=Object.assign([...he.tokens],{links:{}}),be=N(Se,`${h(re,$e,ue)}-content`,L.renderingStable,{}),Ge=h(re,$e,ue);return L.renderingStable?Oe(re,{key:Ge},be):Oe(re,{key:Ge},[Oe(Ps,{name:"word-fade",tag:"span",appear:!0},()=>be)])}),ae=Q(z.header,"th",`${L.blockKey}-head-row0`),de=Oe("th",{key:`${L.blockKey}-head-row0-copy`,class:"px-0"},[Oe("div",{class:"flex items-center gap-1"},[Oe(ss,{content:z.raw,copyIcon:"bi bi-copy",copyFailedTooltip:l("copyRichTextButton.tooltip.copyFailed"),copyDoneTooltip:l("home.chat.label.copyCodeDone"),copyTooltip:l("home.chat.button.copyTable.tooltip")}),Oe(oa,{content:z.raw,copyIcon:"bi bi-markdown",copyDoneTooltip:l("home.chat.label.copyCodeDone"),copyTooltip:l("copyMarkdownButton.tooltip.copy")})])]);ae.push(de);const le=Oe("thead",{key:`${L.blockKey}-head`},[Oe("tr",{key:`${L.blockKey}-head-row0`},ae)]),te=Oe("tbody",{key:`${L.blockKey}-body`},z.rows.map((Z,re)=>Oe("tr",{key:`${L.blockKey}-body-row${re}`},Q(Z,"td",`${L.blockKey}-body-row${re}`))));k.push(Oe("table",{key:L.blockKey},[le,te]))},G=(A,k,L)=>{const z=A;try{const Q=Fa.renderToString(z.text,{...p,displayMode:!0});k.push(Oe("div",{key:`${L.blockKey}-blockKatex`,innerHTML:ya.sanitize(Q)}))}catch(Q){const ae=p.throwOnError===!1?`[KaTeX Error: ${z.text}]`:"[KaTeX Error (Block)]";k.push(Oe("div",{key:`${L.blockKey}-katexblock-error`,class:"text-red-500 p-1 my-1",title:Q.message},ae))}},J=(A,k,L)=>{const z=A;let Q;try{const ae=Fa.renderToString(z.text,{...p,displayMode:!1});Q=Oe("span",{innerHTML:ya.sanitize(ae)})}catch(ae){const de=p.throwOnError===!1?`[KaTeX Error: ${z.text}]`:"[KaTeX Error]";Q=Oe("span",{class:"text-red-500",title:ae.message},de)}if(L.renderingStable){k.push(Oe("p",{key:L.blockKey},[Q]));return}k.push(Oe("p",{key:L.blockKey},[Oe(Ps,{name:"word-fade",tag:"span",appear:!0},()=>[Q])]))},H=(A,k,L)=>{if(!A)return[];const z=[];return A.forEach((Q,ae)=>{const de=h(Q.type,ae,k),le={blockKey:de,renderingStable:L};switch(Q.type){case"canvas-mode":a.enableCanvas?z.push(Oe(hh,{code:Q.raw,done:Q.done})):z.push(Oe("code",{},Q.text));break;case"paragraph":case"heading":R(Q,z,le);break;case"text":B(Q,z,le);break;case"space":break;case"code":{const te=Q,{text:Z,lang:re=""}=te;z.push(Oe(dh,{code:Z,lang:re,isCompleted:a.isCompleted,forWorkspace:a.forWorkspace}));break}case"blockquote":z.push(Oe("blockquote",{key:de},H(Object.assign(Q.tokens,{links:A.links||{}}),`${de}-content`,L)));break;case"list":{j(Q,z,le);break}case"hr":z.push(Oe("hr",{key:`${de}-hrcontent`}));break;case"html":{ee(Q,z,le);break}case"table":se(Q,z,le);break;case"blockKatex":G(Q,z,le);break;case"inlineKatex":{J(Q,z,le);break}default:z.push(Oe("div",{key:de,style:"color: red;"},`[Unhandled token: ${Q.type}] ${Q.raw}`));break}}),z},M=(A,k)=>A.trim()&&k.length===0&&A!==`
`,W=(A,k)=>k.length===0&&(A.trim()!==""||A.endsWith(`

`)),X=ne(()=>{const A=g.value;if(!A.trim()&&!A.endsWith(`
`))return null;try{const k=ba.lexer(A);if(M(A,k))return null;const L=H(k,"unstable-content",!1);return W(A,L)?null:L.length>0?Oe(ve,{key:"unstable-fragment-wrapper"},L):null}catch(k){const L=Oe("div",{key:"unstable-error-display",style:"color: red; border: 1px dashed red; padding: 0.5em; margin: 0.5em 0;"},`Error rendering unstable part: ${k instanceof Error?k.message:String(k)}`);return Oe(ve,{key:"unstable-error-fragment"},[L])}}),O=(A,k)=>{if(!A||!(k&&A.startsWith(k)))m.value=[],g.value=A??"";else{const L=A.substring((k==null?void 0:k.length)??0);g.value+=L}},K=(A,k,L)=>{let z=A;return!L&&A.endsWith(`
`)&&k.endsWith(" ")&&!k.endsWith(`
 `)&&(z=A.slice(0,-1)+" "),z},V=()=>{const A=ba.lexer(r.value),k=H(A,`stable-final-${m.value.length}`,!0);k.length>0&&(m.value=[...k]),g.value=""},F=(A,k,L)=>{const z=L.slice(0,L.length-1);if(z.length>0){const de=H(Object.assign([...z],{links:{}}),`stable-inc-${m.value.length}`,!0);de.length>0&&m.value.push(...de)}let ae=L[L.length-1].raw||"";ae=K(ae,A??"",!!k),g.value=ae,k&&(g.value+=k.raw||"")},P=A=>A.length>0&&A[A.length-1].type==="space",q=(A,k)=>{const L=Array.from(A);let z=null;if(P(L)&&(z=L.pop()??null),L.length>1)F(k,z,L);else if(L.length===1){let ae=L[0].raw||"";ae=K(ae,k??"",!!z),g.value=ae,z&&(g.value+=z.raw||"")}else z&&(g.value=z.raw||"")};return Te(()=>[r.value,a.isCompleted],([A,k],L)=>{const[z]=L??[];if(k){V();return}A!==z&&O(A,z);let Q=Object.assign([],{links:{}});if(g.value.trim()||g.value.endsWith(`
`))try{Q=ba.lexer(g.value)}catch{g.value="";return}q(Q,A)},{immediate:!0}),(A,k)=>(s(),u("div",Ah,[(s(!0),u(ve,null,Le(m.value,L=>(s(),T(pa(L),{key:L.key}))),128)),(s(),T(pa(X.value)))]))}}),Ch=oe({__name:"Collapsible",props:{defaultOpen:{type:Boolean},open:{type:Boolean},disabled:{type:Boolean},asChild:{type:Boolean},as:{}},emits:["update:open"],setup(n,{emit:l}){const r=$t(n,l);return(p,m)=>(s(),T(e(jc),At(Ct(e(r))),{default:i(({open:g})=>[we(p.$slots,"default",{open:g})]),_:3},16))}}),Dh=oe({__name:"CollapsibleContent",props:{forceMount:{type:Boolean},asChild:{type:Boolean},as:{}},setup(n){const l=n;return(a,c)=>(s(),T(e(Vc),He(l,{class:"overflow-hidden transition-all data-[state=closed]:animate-collapsible-up data-[state=open]:animate-collapsible-down"}),{default:i(()=>[we(a.$slots,"default")]),_:3},16))}}),Vo=oe({__name:"CollapsibleTrigger",props:{asChild:{type:Boolean},as:{}},setup(n){const l=n;return(a,c)=>(s(),T(e(Gc),At(Ct(l)),{default:i(()=>[we(a.$slots,"default")]),_:3},16))}}),Lh={class:"transition-all w-full flex flex-col gap-2 rounded-lg p-0 text-sm prose prose-xl lg:max-w-[660px] prose-a:text-blue-600"},Ih={class:"w-full text-left"},Bh={key:0},Mh={class:"w-full text-left"},Eh={key:0},bi=oe({__name:"ReasoningContent",props:{content:{},isThinking:{type:Boolean},tracking:{}},setup(n){const l=Ce(),{t:a}=We(l.t),c=n,r=v(!0);return(p,m)=>{const g=f("Button"),h=f("CollapsibleContent"),_=f("Collapsible");return s(),u("div",Lh,[o(_,{open:r.value,"onUpdate:open":m[0]||(m[0]=x=>r.value=x)},{default:i(()=>[o(e(Vo),{"as-child":""},{default:i(()=>[o(g,{variant:"ghost",size:"lg",class:"px-5 py-3 flex font-bold rounded-full dark:text-stone-300 hover:dark:text-stone-100"},{default:i(()=>[t("div",Ih,[c.isThinking?(s(),u("span",Bh,d(e(a)("home.chat.label.thinking")),1)):w("",!0),r.value?(s(),u(ve,{key:1},[me(d(e(a)("home.chat.label.thoughtCollapse")),1)],64)):(s(),u(ve,{key:2},[me(d(e(a)("home.chat.label.thoughtExpand")),1)],64)),t("i",{class:pe({"ml-2 bi bi-chevron-down inline-block transition-all":!0,"rotate-180":r.value})},null,2)])]),_:1})]),_:1}),o(h,null,{default:i(()=>[o(va,{"streaming-markdown":c.content||"","is-completed":!c.isThinking,class:"ml-5 italic py-1 pl-8 border-l border-gray-200",tracking:c.tracking},null,8,["streaming-markdown","is-completed","tracking"])]),_:1}),r.value?(s(),T(e(Vo),{key:0,"as-child":""},{default:i(()=>[o(g,{variant:"ghost",size:"lg",class:"px-5 py-3 flex font-bold rounded-full dark:text-stone-300 hover:dark:text-stone-100"},{default:i(()=>[t("div",Mh,[c.isThinking?(s(),u("span",Eh,d(e(a)("home.chat.label.thinking")),1)):w("",!0),me(" "+d(e(a)("home.chat.label.thoughtCollapse"))+" ",1),m[1]||(m[1]=t("i",{class:"ml-2 bi bi-chevron-up"},null,-1))])]),_:1})]),_:1})):w("",!0)]),_:1},8,["open"])])}}}),Co=n=>n.split("/").pop()||"",Rh={class:"flex px-3 w-full h-full gap-4 empty:hidden items-start rtl:items-start"},Fh={key:0,class:"flex flex-col w-full gap-1"},Ph={key:1,class:"lds-ellipsis pb-4"},Nh={key:2,class:"px-5 flex flex-col gap-2"},zh={key:0,class:"flex items-center border rounded-lg px-2 py-1 gap-2"},Uh={class:"flex items-center gap-3 justify-between"},Oh={class:"text-xs whitespace-nowrap"},jh={class:"flex items-center gap-1 ml-2"},Vh={key:0,class:"bi bi-stars text-sm text-blue-500 animate-pulse dark:text-sky-500"},Gh={class:"text-sm text-blue-500 dark:text-sky-500 select-none"},Wh={class:"flex justify-between"},Hh={class:"text-xl"},Kh={class:"text-sm my-4"},qh=["onClick"],Qh={class:"flex items-center justify-between"},Jh={key:0,class:"bi bi-check text-md"},Xh={key:1,class:"bg-red-100 text-red-500 text-sm p-4 w-full rounded-lg"},Yh=oe({__name:"AIMessageItem",props:{message:{},index:{},forWorkspace:{type:Boolean}},setup(n){const l=ms(),{sendMessageFeedback:a,deleteMessageFeedback:c}=l,{currentConversation:r,supportModels:p}=ie(l),m=Is(),g=Gt(),{currentAgentId:h,currentAgent:_,supportModelsForAgent:x}=ie(g),b=qs(),{agentFiles:S}=ie(b),{t:D}=Ce(),{toast:y}=gt(),I=tt(),C=n,U=L=>{var ae;const z=(ae=C.message.content)==null?void 0:ae.references;if(!z||!z[L])return!1;const Q=z[L].fileId;return S.value.some(de=>de.id===Q)},E=ne(()=>I.name==="chat"||I.name==="home"),N=ne(()=>{let L=[];E.value?L=p.value:L=x.value;const z=L.find(Q=>Q.modelId===C.message.modelId);return(z==null?void 0:z.displayName)??D("home.chat.label.unknownModel")}),$=v(""),R=v(""),B=ne(()=>{var L;return{conversation_id:(L=r.value)==null?void 0:L.id,message_id:C.message.id}}),j=async()=>{await c(B.value)},ee=async()=>{if(C.message.feedback==="LIKE"){j();return}const L={feedback:"LIKE",reason:""};H.value=!1,await a(B.value,L)},se=async()=>{if(W.value=!1,R.value="",C.message.feedback==="DISLIKE"){M(),j();return}H.value=!0;const L={feedback:"DISLIKE",reason:""};await a(B.value,L),Et(()=>{var z;(z=J.value)==null||z.scrollIntoView({behavior:"smooth",block:"center"})})},G=async L=>{$.value=L;const z={feedback:"DISLIKE",reason:L};await a(B.value,z),H.value=!1,y({title:D("home.toast.success.messageFeedback.header"),description:D("home.toast.success.messageFeedback.description")})},J=v(null),H=v(!1),M=()=>{H.value=!1,W.value=!1},W=v(!1),X=()=>{W.value=!W.value},O=[{id:1,choice:"home.chat.message.userBadResponse.factual",textRaw:"Not factually correct"},{id:2,choice:"home.chat.message.userBadResponse.offensive",textRaw:"Offensive/Unsafe"},{id:3,choice:"home.chat.message.userBadResponse.language",textRaw:"Wrong language"},{id:4,choice:"home.chat.message.userBadResponse.format",textRaw:"Poorly formatted"},{id:5,choice:"home.chat.message.userBadResponse.generic",textRaw:"Generic/Bland"}],K=async L=>{var z,Q,ae;if((z=C.message.content.references)!=null&&z[L].fileName&&h.value){const de=(Q=C.message.content)==null?void 0:Q.references[L].fileId,le=Co((ae=C.message.content)==null?void 0:ae.references[L].fileName);try{await m.downloadFile(h.value,de,le)}catch(te){console.log("Failed to download: ",te),y({title:D("home.toast.fail.generalErrorTitle"),description:D("home.toast.fail.generalError"),variant:"destructive"})}}else y({title:D("home.toast.fail.generalErrorTitle"),description:D("home.toast.fail.generalError"),variant:"destructive"})},V=ne(()=>{const L=C.message.content??"";return L.text.startsWith("<think>")&&L.text.indexOf(`</think>
`)<0}),F=ne(()=>{const L=C.message.content??"";if(!L.text.startsWith("<think>"))return[null,L.text];const z=L.text.indexOf(`</think>
`);return z<0?[L.text.substring(7),""]:[L.text.substring(7,z),L.text.substring(z+8)]}),P=v(""),{isSupported:q}=ga({source:P}),A=ne(()=>({appName:"PRIVATEGPT",viewName:"CHAT",additionalInfo:{messageId:C.message.id,conversationId:C.message.conversationId}})),k=ne(()=>{const L=C.message.content.citations??[],z=C.message.content.references??[];return L.map(Q=>{const ae=z.find(de=>de.fileId===Q.fileId);return{title:ae?ae.fileName:"",citationNumber:Q.mappingId,content:Q.content,page:Q.page}})});return(L,z)=>{var ue,he,$e,Se,be,Ge;const Q=f("Button"),ae=f("DropdownMenuTrigger"),de=f("DropdownMenuItem"),le=f("DropdownMenuContent"),te=f("DropdownMenu"),Z=f("Textarea"),re=Kt("auto-animate");return s(),u("div",Rh,[L.message.error?(s(),u("div",Xh,d(F.value[1]),1)):Ke((s(),u("div",Fh,[F.value[0]?(s(),T(bi,{key:0,content:F.value[0]??"","is-thinking":V.value,class:"-ml-5",tracking:A.value},null,8,["content","is-thinking","tracking"])):w("",!0),o(va,{"for-workspace":C.forWorkspace,"streaming-markdown":F.value[1],"is-completed":L.message.isCompleted,"enable-canvas":!0,citations:k.value,tracking:A.value,isNumberCitation:!1},null,8,["for-workspace","streaming-markdown","is-completed","citations","tracking"]),!L.message.isCompleted&&((ue=e(r))!=null&&ue.messagesList)&&C.index===((he=e(r))==null?void 0:he.messagesList.length)-1?(s(),u("div",Ph,z[5]||(z[5]=[t("div",null,null,-1),t("div",null,null,-1),t("div",null,null,-1),t("div",null,null,-1)]))):w("",!0),($e=C.message.content)!=null&&$e.references?(s(),u("div",Nh,[(s(!0),u(ve,null,Le((Se=C.message.content)==null?void 0:Se.references,(fe,Y)=>{var ce,ge,ye;return s(),u("div",{class:"flex items-center justify-between w-fit",key:Y},[z[8]||(z[8]=t("div",{class:"opacity-50"},"",-1)),(ce=C.message.content)!=null&&ce.references[Y].fileName?(s(),u("div",zh,[t("div",Uh,[t("i",{class:pe(`bi bi-filetype-${e(Rt)(e(Co)(fe.fileName))}`)},null,2),t("p",Oh,d(e(Co)(fe.fileName)),1)]),!((ge=C.message.content)!=null&&ge.references[Y].fileName.match("/user"))&&((ye=e(_))!=null&&ye.allowDownload)&&U(Y)?(s(),T(te,{key:0},{default:i(()=>[o(ae,{"as-child":""},{default:i(()=>[o(Q,{variant:"ghost",size:"smicon",onClick:z[0]||(z[0]=Ye(()=>{},["stop"]))},{default:i(()=>z[6]||(z[6]=[t("i",{class:"bi bi-three-dots"},null,-1)])),_:1,__:[6]})]),_:1}),o(le,null,{default:i(()=>[o(de,{onClick:_e=>K(Y)},{default:i(()=>[z[7]||(z[7]=t("i",{class:"bi bi-cloud-arrow-down"},null,-1)),t("span",null,d(e(D)("home.chat.button.downloadFile")),1)]),_:2,__:[7]},1032,["onClick"])]),_:2},1024)]),_:2},1024)):w("",!0)])):w("",!0)])}),128))])):w("",!0),t("div",{class:pe(["flex items-center gap-1",[e(q)&&L.message.isCompleted||e(q)&&L.message.isCompleted&&((be=e(r))!=null&&be.messagesList)&&C.index===((Ge=e(r))==null?void 0:Ge.messagesList.length)-1?"visible animate-fade animate-once animate-duration-500 animate-delay-100":"invisible"]])},[o(ss,{className:"p-4 text-sm",content:F.value[1],copyFailedTooltip:e(D)("copyRichTextButton.tooltip.copyFailed"),copyDoneTooltip:e(D)("copyRichTextButton.tooltip.copyDone"),copyTooltip:e(D)("copyRichTextButton.tooltip.copy")},null,8,["content","copyFailedTooltip","copyDoneTooltip","copyTooltip"]),o(oa,{copyIcon:"bi bi-markdown",className:"p-4 text-sm",content:F.value[1],"copy-done-tooltip":e(D)("copyMarkdownButton.tooltip.copyDone"),"copy-tooltip":e(D)("copyMarkdownButton.tooltip.copy")},null,8,["content","copy-done-tooltip","copy-tooltip"]),o(Pe,{className:"p-4",onClick:ee,size:"mdicon",icon:C.message.feedback==="LIKE"?"bi bi-hand-thumbs-up-fill animate-jump animate-once animate-duration-500 animate-delay-100 animate-ease-in-out text-blue-500 dark:text-sky-500":"bi bi-hand-thumbs-up",tooltip:C.message.feedback==="LIKE"?e(D)("home.chat.label.likeDone.tooltip"):e(D)("home.chat.button.like.tooltip")},null,8,["icon","tooltip"]),o(Pe,{className:"p-4",onClick:z[1]||(z[1]=fe=>se()),size:"mdicon",icon:C.message.feedback==="DISLIKE"?"bi bi-hand-thumbs-down-fill animate-bounce animate-twice animate-duration-600 animate-delay-100 animate-ease-in-out text-blue-500 dark:text-sky-500":"bi bi-hand-thumbs-down",tooltip:C.message.feedback==="DISLIKE"?e(D)("home.chat.label.unlikeDone.tooltip"):e(D)("home.chat.button.unlike.tooltip")},null,8,["icon","tooltip"]),t("div",jh,[N.value?(s(),u("i",Vh)):w("",!0),t("p",Gh,d(N.value),1)])],2),H.value?(s(),u("div",{key:3,class:"my-2",ref_key:"feedbackRef",ref:J},[t("div",Wh,[t("p",Hh,d(e(D)("home.chat.message.userBadResponse.title.question")),1),o(Q,{variant:"ghost",class:"p-4",size:"mdicon",onClick:M},{default:i(()=>z[9]||(z[9]=[t("i",{class:"bi bi-x-lg"},null,-1)])),_:1,__:[9]})]),t("p",Kh,d(e(D)("home.chat.message.userBadResponse.userHelp")),1),(s(),u(ve,null,Le(O,fe=>t("div",{key:fe.id},[t("div",{onClick:Y=>G(fe.textRaw),class:"p-3 w-full bg-stone-100 hover:bg-stone-200 dark:bg-stone-800 dark:hover:bg-stone-700 rounded-md cursor-pointer mb-1"},d(e(D)(fe.choice)),9,qh)])),64)),t("div",{onClick:X,class:"p-3 w-full bg-stone-100 hover:bg-stone-200 dark:bg-stone-800 dark:hover:bg-stone-700 rounded-md cursor-pointer mb-1"},[t("div",Qh,[t("span",null,d(e(D)("home.chat.message.userBadResponse.other")),1),W.value?(s(),u("i",Jh)):w("",!0)]),W.value?(s(),T(Z,{key:0,id:"dislike-reason-textarea",modelValue:R.value,"onUpdate:modelValue":z[2]||(z[2]=fe=>R.value=fe),onClick:z[3]||(z[3]=Ye(()=>{},["stop"])),class:"mt-3 border-black dark:border-stone-500 text-sm min-h-14"},null,8,["modelValue"])):w("",!0),W.value?(s(),T(Q,{key:1,onClick:z[4]||(z[4]=Ye(fe=>G(R.value),["stop"])),variant:"default",class:"mt-3 px-6"},{default:i(()=>[me(d(e(D)("home.chat.message.userBadResponse.button.label.submit")),1)]),_:1})):w("",!0)])],512)):w("",!0)])),[[re]])])}}}),Vs=(n,l)=>{const a=n.__vccOpts||n;for(const[c,r]of l)a[c]=r;return a},ki=Vs(Yh,[["__scopeId","data-v-bd7af3a4"]]),Zh={class:"text-xs opacity-80"},uo=oe({__name:"HomeSettingLanguageOptions",setup(n){const l=ps(),{updateCurrentLanguage:a}=l,{currentLanguage:c}=ie(l);Te(()=>c.value,p=>{p&&a(p)});const r=v([{locale:"ar_EG",langLabel:""},{locale:"az_AZ",langLabel:"Azrbaycan"},{locale:"bn_BD",langLabel:""},{locale:"cs_CZ",langLabel:"etina"},{locale:"de_CH",langLabel:"Deutsch (Schweiz)"},{locale:"en_US",langLabel:"English (US)"},{locale:"es_CL",langLabel:"Espaol (Chile)"},{locale:"es_ES",langLabel:"Espaol (Espaa)"},{locale:"fil_PH",langLabel:"Filipino"},{locale:"fr_FR",langLabel:"Franaise"},{locale:"hi_IN",langLabel:""},{locale:"id_ID",langLabel:"Bahasa Indonesia"},{locale:"ja_JP",langLabel:""},{locale:"ko_KR",langLabel:""},{locale:"lo_LA",langLabel:""},{locale:"mg_MG",langLabel:"Malagasy"},{locale:"ms_MY",langLabel:"Bahasa Melayu"},{locale:"my_MM",langLabel:""},{locale:"nds_DE",langLabel:"Deutsch"},{locale:"ne_NP",langLabel:""},{locale:"ru_RU",langLabel:""},{locale:"si_LK",langLabel:""},{locale:"sk_SK",langLabel:"Slovenina"},{locale:"th_TH",langLabel:""},{locale:"vi_VN",langLabel:"Ting Vit"},{locale:"zh_CN",langLabel:""},{locale:"zh_TW",langLabel:" ()"}]);return(p,m)=>{const g=f("SelectValue"),h=f("SelectTrigger"),_=f("SelectItemText"),x=f("SelectItem"),b=f("SelectGroup"),S=f("SelectContent"),D=f("Select");return s(),u("div",null,[o(D,{modelValue:e(c),"onUpdate:modelValue":m[0]||(m[0]=y=>kt(c)?c.value=y:null),class:"w-full"},{default:i(()=>[o(h,{class:"w-fit focus:ring-0 focus:ring-offset-0 border-none bg-white dark:bg-stone-900 hover:bg-stone-50 dark:hover:bg-stone-800 space-x-1 ml-auto"},{default:i(()=>[o(g),m[1]||(m[1]=t("i",{class:"bi bi-chevron-down text-xs"},null,-1))]),_:1,__:[1]}),o(S,{class:"max-h-72"},{default:i(()=>[(s(!0),u(ve,null,Le(r.value,y=>(s(),T(b,{key:y,class:"p-0"},{default:i(()=>[o(x,{value:y.locale},{default:i(()=>[o(_,null,{default:i(()=>[t("span",Zh,d(y.langLabel),1)]),_:2},1024)]),_:2},1032,["value"])]),_:2},1024))),128))]),_:1})]),_:1},8,["modelValue"])])}}}),e_={class:"flex items-center justify-between"},t_={class:"text-xs"},s_=oe({__name:"HomeSettingLanguage",setup(n){const l=ps(),{updateCurrentLanguage:a}=l,{currentLanguage:c}=ie(l),{t:r}=Ce();return Te(()=>c.value,p=>{p&&a(p)}),(p,m)=>{const g=f("Separator");return s(),u(ve,null,[t("div",e_,[t("div",t_,d(e(r)("home.userSettings.settings.language")),1),o(uo)]),o(g)],64)}}}),a_={class:"flex items-center justify-between"},o_={class:"text-xs"},n_={class:"text-xs opacity-80"},l_={class:"text-xs opacity-80"},i_=oe({__name:"ThemeSetting",setup(n){const l=ps(),{mode:a}=ie(l),c=Ce(),{t:r}=We(c.t);return(p,m)=>{const g=f("SelectValue"),h=f("SelectTrigger"),_=f("SelectItemText"),x=f("SelectItem"),b=f("SelectGroup"),S=f("SelectContent"),D=f("Select"),y=f("Separator");return s(),u(ve,null,[t("div",a_,[t("div",o_,d(e(r)("home.userSettings.settings.theme")),1),o(D,{id:"theme-setting-select",modelValue:e(a),"onUpdate:modelValue":m[0]||(m[0]=I=>kt(a)?a.value=I:null),class:"w-full"},{default:i(()=>[o(h,{class:"w-fit focus:ring-0 focus:ring-offset-0 border-none bg-white dark:bg-stone-900 hover:bg-stone-50 dark:hover:bg-stone-800 space-x-1 ml-auto"},{default:i(()=>[o(g),m[1]||(m[1]=t("i",{class:"bi bi-chevron-down text-xs"},null,-1))]),_:1,__:[1]}),o(S,{class:"max-h-72"},{default:i(()=>[o(b,{class:"p-0"},{default:i(()=>[o(x,{value:"light"},{default:i(()=>[o(_,null,{default:i(()=>[t("span",n_,d(e(r)("home.userSettings.settings.theme.option.light")),1)]),_:1})]),_:1}),o(x,{value:"dark"},{default:i(()=>[o(_,null,{default:i(()=>[t("span",l_,d(e(r)("home.userSettings.settings.theme.option.dark")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),o(y)],64)}}}),r_={class:"text-xs"},c_={class:"px-5 py-1 font-semibold text-md"},d_={class:"text-xs"},u_=oe({__name:"HomeSetting",setup(n){const{t:l}=Ce();return v(""),(a,c)=>{const r=f("Button"),p=f("DialogTrigger"),m=f("Separator"),g=f("DialogHeader"),h=f("TabsTrigger"),_=f("TabsList"),x=f("TabsContent"),b=f("Tabs"),S=f("DialogContent"),D=f("Dialog");return s(),T(D,null,{default:i(()=>[o(p,{class:"w-full"},{default:i(()=>[o(r,{variant:"ghost",size:"full"},{default:i(()=>[c[0]||(c[0]=t("i",{class:"bi bi-gear"},null,-1)),t("span",r_,d(e(l)("home.userSettings.settings.title")),1)]),_:1,__:[0]})]),_:1}),o(S,{class:"max-w-sm rounded-md sm:rounded-lg sm:max-w-lg px-0"},{default:i(()=>[o(g,null,{default:i(()=>[t("span",c_,d(e(l)("home.userSettings.settings.title")),1),o(m,{class:"w-full"})]),_:1}),o(b,{"default-value":"general",class:"flex px-3 gap-3"},{default:i(()=>[o(_,{class:"flex flex-col justify-start gap-1 bg-transparent pr-5"},{default:i(()=>[o(h,{value:"general",class:"p-2 rounded-md dark:data-[state=active]:bg-stone-800 data-[state=active]:bg-stone-100 data-[state=active]:shadow-none w-40 flex items-center"},{default:i(()=>[c[1]||(c[1]=t("i",{class:"bi bi-gear mr-2"},null,-1)),t("span",d_,d(e(l)("home.userSettings.settings.general")),1)]),_:1,__:[1]})]),_:1}),o(x,{value:"general",class:"w-full flex flex-col gap-2"},{default:i(()=>[o(s_),o(i_)]),_:1})]),_:1})]),_:1})]),_:1})}}}),p_={key:0},m_={key:0,class:"flex"},g_={class:"text-xs font-medium truncate"},f_={class:"text-xs"},v_={class:"text-xs"},h_={class:"text-xs"},__={class:"text-xs"},ln=oe({__name:"UserAvatarMenu",props:{isShowAccountNameBtn:{type:Boolean,default:!1},isPrivateGptRoute:{type:Boolean,default:!0}},setup(n){var N;const l=Is(),a=Ot(),{authenticationResult:c}=ie(a),r=v((N=c.value)==null?void 0:N.account.username),p=at(),m=xt(),{isMobileSize:g}=ie(p),{privateGPTSidebarState:h}=ie(m),{t:_}=Ce();Te(c,()=>{var $;c&&!r.value&&(r.value=($=c.value)==null?void 0:$.account.username)});const x=tt(),b=ot(),S=ne(()=>x.path.match(/kaigikun/i)),D=ne(()=>x.path.match(/qms/i)),y=ne(()=>x.path.match(/workspace/i)),I=()=>{l.clearState(),b.push("/agents/mine"),E()},C=()=>{l.clearState(),b.push("/groups"),E()},U=n,E=()=>{g.value&&m.privateGPTSidebarState&&m.toggleVisibleState(h)};return($,R)=>{const B=f("Button"),j=f("PopoverTrigger"),ee=f("Separator"),se=f("AlertDialogTrigger"),G=f("AlertDialogTitle"),J=f("AlertDialogDescription"),H=f("AlertDialogHeader"),M=f("AlertDialogCancel"),W=f("AlertDialogAction"),X=f("AlertDialogFooter"),O=f("AlertDialogContent"),K=f("AlertDialog"),V=f("PopoverContent"),F=f("Popover");return r.value?(s(),u("div",p_,[o(F,null,{default:i(()=>[o(j,{class:"flex items-center space-x-2"},{default:i(()=>[o(B,{variant:"ghost",size:"icon"},{default:i(()=>R[0]||(R[0]=[t("i",{class:"bi bi-person-circle text-3xl"},null,-1)])),_:1,__:[0]}),U.isShowAccountNameBtn?(s(),u("div",m_,[t("span",g_,d(r.value),1)])):w("",!0)]),_:1}),o(V,{class:"mr-3 p-1 w-48"},{default:i(()=>[o(B,{variant:"ghost",size:"full",disabled:""},{default:i(()=>[t("span",f_,d(r.value),1)]),_:1}),o(ee,{class:"my-1"}),U.isPrivateGptRoute&&!S.value&&!D.value&&!y.value?(s(),T(B,{key:0,class:"w-full",variant:"ghost",size:"full",onClick:C},{default:i(()=>[R[1]||(R[1]=t("i",{class:"bi bi-suitcase-lg"},null,-1)),t("span",v_,d(e(_)("home.userSettings.groupManage")),1)]),_:1,__:[1]})):w("",!0),U.isPrivateGptRoute&&!S.value&&!D.value&&!y.value?(s(),T(B,{key:1,variant:"ghost",size:"full",onClick:I},{default:i(()=>[R[2]||(R[2]=t("i",{class:"bi bi-person-gear"},null,-1)),t("span",h_,d(e(_)("home.userSettings.agentManage")),1)]),_:1,__:[2]})):w("",!0),o(u_),o(ee,{class:"my-1"}),o(ci,{"is-button-display":!0}),o(ee,{class:"my-1"}),o(K,null,{default:i(()=>[o(se,{"as-child":""},{default:i(()=>[o(B,{variant:"ghost",size:"full"},{default:i(()=>[R[3]||(R[3]=t("i",{class:"bi bi-box-arrow-right"},null,-1)),t("span",__,d(e(_)("home.userSettings.logOut")),1)]),_:1,__:[3]})]),_:1}),o(O,{class:"max-w-sm sm:max-w-lg rounded-md sm:rounded-lg"},{default:i(()=>[o(H,null,{default:i(()=>[o(G,null,{default:i(()=>[me(d(e(_)("home.mainSidebar.dialog.logOut.title")),1)]),_:1}),o(J,null,{default:i(()=>[me(d(e(_)("home.mainSidebar.dialog.logOut.description")),1)]),_:1})]),_:1}),o(X,null,{default:i(()=>[o(M,null,{default:i(()=>[me(d(e(_)("home.mainSidebar.button.cancel")),1)]),_:1}),o(W,{class:"bg-red-500 hover:bg-red-600",onClick:e(a).logout},{default:i(()=>[me(d(e(_)("home.mainSidebar.button.logOut")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])):w("",!0)}}}),b_={class:"sm:hidden flex items-center"},k_={key:0,class:"flex items-center gap-4 overflow-hidden justify-center w-full md:justify-start"},y_={class:"text-lg font-bold pr-1 truncate max-w-36 sm:max-w-lg"},x_={class:"flex w-64 items-center justify-between cursor-pointer"},w_={class:"flex flex-col"},$_={class:"text-xs opacity-80"},S_={class:"flex"},T_={class:"bi bi-check2"},A_={key:1,class:"flex items-center gap-4 overflow-hidden overflow-x-auto"},C_={class:"text-lg font-bold pr-1 truncate max-w-36 sm:max-w-64"},D_={key:0,class:"text-md text-stone-400"},L_={key:1,class:"bi bi-chevron-down pt-1"},I_={key:1,class:"bi bi-pin-angle"},B_={key:1,class:"bi bi-eye-slash"},M_={key:2,class:"flex items-center gap-3"},E_={key:3,class:"flex items-center gap-3"},R_={key:1,class:"bi bi-pin-angle mr-2"},F_={key:1,class:"bi bi-eye-slash mr-2"},P_={key:3,class:"sm:hidden"},ks=oe({__name:"AppTopbar",props:{justifyContent:{type:String,default:"justify-between"},showShareChatButton:{type:Boolean,default:!1},chooseModelDropdown:{type:Boolean,default:!0},showCreateAgentButton:{type:Boolean,default:!1},showMyAgentButton:{type:Boolean,default:!1},showLanguageOption:{type:Boolean,default:!0},isShowCreateNewChat:{type:Boolean,default:!0},isGroupView:{type:Boolean,default:!1},isKaigiView:{type:Boolean,default:!1},isQMSView:{type:Boolean,default:!1},isWikiFJPView:{type:Boolean,default:!1},shouldDisplayAppTopbar:{type:Boolean,default:!0}},setup(n){const l=Gt(),a=at(),{currentAgent:c,currentAgentId:r,pinAgents:p,supportModelsForAgent:m}=ie(l),{pinAgent:g,unpinAgent:h,getPinAgents:_,getLLMForAgentList:x}=l,b=qs(),{selectedFiles:S}=ie(b),D=Is(),{attachments:y}=ie(D),{isMobileSize:I}=ie(a),C=xt(),{privateGPTSidebarState:U,mobileSidebarState:E}=ie(C),N=ms(),{currentModel:$,supportModels:R,currentConversation:B,generatingResponse:j,loadingAnimation:ee}=ie(N),{fetchSupportModels:se}=N,G=tt(),J=ot(),H=ne(()=>G.name==="chat"||G.name==="home"),M=ne(()=>G.name==="agent-chat-home"||G.name==="agent-chat"),W=ne(()=>{const de=m.value.find(le=>{var te;return le.modelId===((te=c.value)==null?void 0:te.modelId)});return de?de.displayName:P("home.chat.label.unknownModel")}),X=v(!1),O=ne(()=>Array.isArray(p.value)&&p.value.some(de=>{var le;return de.id===((le=c.value)==null?void 0:le.id)})),K=async()=>{try{X.value=!0,r.value&&(await g(r.value),await _(),Ue({title:P("home.toast.success.pinAgent")}))}catch(de){console.error(de),Ue({title:P("home.toast.fail.generalErrorTitle"),description:P("home.toast.fail.generalError"),variant:"destructive"})}finally{X.value=!1}},V=async()=>{try{X.value=!0,r.value&&(await h(r.value),await _(),Ue({title:P("home.toast.success.unpinAgent")}))}catch(de){console.log(de),Ue({title:P("home.toast.fail.generalErrorTitle"),description:P("home.toast.fail.generalError"),variant:"destructive"})}finally{X.value=!1}},F=n,{t:P}=Ce(),q=de=>{J.push(`/agent/${de}`)},A=de=>{S.value=[],r.value=de,J.push(`/agents/editor/${de}`)},k=async()=>{try{const{origin:de}=window.location,te=`/agent/${String(G.params.agentId)}`;await navigator.clipboard.writeText(`${de}${te}`),Ue({title:P("home.toast.success.linkCopy")})}catch(de){console.error(de),Ue({title:P("home.toast.fail.generalErrorTitle"),description:P("home.toast.fail.generalError"),variant:"destructive"})}},L=()=>{y.value=[];const de=G.name,te=G.path.split("/");if(de==="agent-chat-home"||de==="agent-chat"){const Z=`/${te[1]}/${te[2]}/`;J.push(Z)}else J.push("/")},z=()=>{if(I.value){C.toggleVisibleState(E);return}C.toggleVisibleState(U)},Q=de=>{$.value=de},ae=ne(()=>{var de;return(de=B.value)==null?void 0:de.messagesList.map(le=>`${le.role}: ${le.content.text}`).join(`\r
\r
`)});return Dt(async()=>{H.value?await se():M.value&&await x()}),(de,le)=>{var fe,Y,ce,ge,ye;const te=f("Button"),Z=f("TooltipTrigger"),re=f("TooltipContent"),ue=f("Tooltip"),he=f("TooltipProvider"),$e=f("DropdownMenuTrigger"),Se=f("DropdownMenuItem"),be=f("DropdownMenuContent"),Ge=f("DropdownMenu");return F.shouldDisplayAppTopbar?(s(),u("div",{key:0,class:pe(["sticky top-0 flex flex-row items-center p-3 dark:bg-stone-900 z-40",[F.justifyContent]])},[t("div",b_,[o(he,null,{default:i(()=>[o(ue,null,{default:i(()=>[o(Z,{"as-child":""},{default:i(()=>[o(te,{variant:"ghost",size:"icon",onClick:z},{default:i(()=>le[5]||(le[5]=[t("i",{class:"bi bi-list"},null,-1)])),_:1,__:[5]})]),_:1}),o(re,{side:"right"},{default:i(()=>[t("p",null,d(e(P)("home.mainSidebar.tooltip.openSidebar")),1)]),_:1})]),_:1})]),_:1}),(H.value||M.value)&&((fe=ae.value)!=null&&fe.length)?(s(),T(Ge,{key:0},{default:i(()=>[o($e,null,{default:i(()=>[o(te,{variant:"ghost",size:"full"},{default:i(()=>le[6]||(le[6]=[t("i",{class:"bi bi-three-dots"},null,-1)])),_:1,__:[6]})]),_:1}),o(be,{class:"ml-2",align:e(I)?"center":"start"},{default:i(()=>[o(Se,{class:"px-2 py-0"},{default:i(()=>{var _e;return[(_e=ae.value)!=null&&_e.length?(s(),T(ss,{key:0,content:ae.value??"",showTooltip:!1,disabled:e(j),showButtonLabel:!0,variant:"ghost",copyLabel:e(P)("copyRichTextButton.copyAllContentWithTranslation.label"),size:"default"},null,8,["content","disabled","copyLabel"])):w("",!0)]}),_:1}),o(Se,{class:"px-2 py-0"},{default:i(()=>{var _e;return[(_e=ae.value)!=null&&_e.length?(s(),T(oa,{key:0,content:ae.value??"",showTooltip:!1,disabled:e(j),showButtonLabel:!0,variant:"ghost",size:"default",copyLabel:e(P)("copyMarkdownButton.tooltip.copyAllContentMarkdown"),copyDoneLabel:e(P)("copyMarkdownButton.tooltip.copyAllDone")},null,8,["content","disabled","copyLabel","copyDoneLabel"])):w("",!0)]}),_:1})]),_:1},8,["align"])]),_:1})):w("",!0)]),F.chooseModelDropdown&&H.value?(s(),u("div",k_,[o(Ge,null,{default:i(()=>[o($e,null,{default:i(()=>[o(te,{variant:"ghost",size:"full"},{default:i(()=>{var _e;return[t("div",y_,d((_e=e($))==null?void 0:_e.displayName),1),le[7]||(le[7]=t("i",{class:"bi bi-chevron-down pt-1"},null,-1))]}),_:1,__:[7]})]),_:1}),o(be,{align:e(I)?"center":"start"},{default:i(()=>[(s(!0),u(ve,null,Le(e(R),_e=>(s(),u("div",{key:_e.modelId},[o(Se,{onClick:Re=>Q(_e)},{default:i(()=>{var Re;return[t("div",x_,[t("div",w_,[t("p",null,d(_e.displayName),1),t("p",$_,d(_e.description),1)]),t("div",S_,[Ke(t("i",T_,null,512),[[es,((Re=e($))==null?void 0:Re.modelId)===_e.modelId]])])])]}),_:2},1032,["onClick"])]))),128))]),_:1},8,["align"])]),_:1})])):w("",!0),F.chooseModelDropdown&&M.value?(s(),u("div",A_,[o(Ge,null,{default:i(()=>[o($e,null,{default:i(()=>[o(te,{variant:"ghost",size:"full",class:pe({"cursor-default":!e(c)})},{default:i(()=>{var _e;return[t("div",C_,d(e(c)?(_e=e(c))==null?void 0:_e.name:e(P)("home.chat.label.unknownAgent")),1),W.value!==e(P)("home.chat.label.unknownModel")?(s(),u("div",D_,d(W.value),1)):w("",!0),e(c)?(s(),u("i",L_)):w("",!0)]}),_:1},8,["class"])]),_:1}),e(c)?(s(),T(be,{key:0},{default:i(()=>{var _e,Re;return[o(Se,{class:"cursor-pointer",onClick:le[0]||(le[0]=ke=>{var qe;return q((qe=e(c))==null?void 0:qe.id)})},{default:i(()=>[le[8]||(le[8]=t("i",{class:"bi bi-pencil-square"},null,-1)),t("span",null,d(e(P)("home.chat.agentDropdown.newChat")),1)]),_:1,__:[8]}),o(Se,{class:"cursor-pointer",onClick:le[1]||(le[1]=ke=>A(e(r)))},{default:i(()=>{var ke,qe,lt,St;return[((qe=(ke=e(c))==null?void 0:ke.currentUserInfo)==null?void 0:qe.permission)==="OWNER"||((St=(lt=e(c))==null?void 0:lt.currentUserInfo)==null?void 0:St.permission)==="EDIT"?(s(),u(ve,{key:0},[le[9]||(le[9]=t("i",{class:"bi bi-gear"},null,-1)),t("span",null,d(e(P)("home.chat.agentDropdown.editAgent")),1)],64)):(s(),u(ve,{key:1},[le[10]||(le[10]=t("i",{class:"bi bi-eye"},null,-1)),t("span",null,d(e(P)("home.chat.agentDropdown.viewAgent")),1)],64))]}),_:1}),!O.value&&((_e=e(c))==null?void 0:_e.status)==="PUBLISH"?(s(),T(Se,{key:0,class:"cursor-pointer",onClick:K},{default:i(()=>[X.value?(s(),T(e(xa),{key:0,class:"w-4 h-4 animate-spin"})):(s(),u("i",I_)),t("span",null,d(e(P)("home.chat.agentDropdown.pinAgent")),1)]),_:1})):O.value&&((Re=e(c))==null?void 0:Re.status)==="PUBLISH"?(s(),T(Se,{key:1,class:"cursor-pointer",onClick:V},{default:i(()=>[X.value?(s(),T(e(xa),{key:0,class:"w-4 h-4 animate-spin"})):(s(),u("i",B_)),t("span",null,d(e(P)("home.chat.agentDropdown.unpinAgent")),1)]),_:1})):w("",!0),o(Se,{class:"cursor-pointer",onClick:k},{default:i(()=>[le[11]||(le[11]=t("i",{class:"bi bi-link"},null,-1)),t("span",null,d(e(P)("home.chat.agentDropdown.copyLink")),1)]),_:1,__:[11]})]}),_:1})):w("",!0)]),_:1})])):w("",!0),!e(I)||F.showMyAgentButton||F.showCreateAgentButton?(s(),u("div",M_,[F.showMyAgentButton?(s(),T(te,{key:0,class:"px-3",variant:"outline",size:"full",onClick:le[2]||(le[2]=_e=>e(J).push("/agents/mine"))},{default:i(()=>[t("span",null,d(e(P)("home.searchAgent.button.myAgent")),1)]),_:1})):w("",!0),F.showCreateAgentButton?(s(),T(te,{key:1,class:"pl-3 pr-4 space-x-1",variant:"default",size:"full",onClick:le[3]||(le[3]=_e=>e(J).push("/agents/editor/"))},{default:i(()=>[le[12]||(le[12]=t("i",{class:"bi bi-plus"},null,-1)),t("span",null,d(e(P)("home.searchAgent.button.createAgent")),1)]),_:1,__:[12]})):w("",!0),F.showShareChatButton?(s(),T(te,{key:2,variant:"outline",size:"full",class:"px-3.5 font-medium"},{default:i(()=>[le[13]||(le[13]=t("i",{class:"bi bi-upload"},null,-1)),t("span",null,d(e(P)("chat.share")),1)]),_:1,__:[13]})):w("",!0),H.value||M.value?(s(),u("div",E_,[(Y=ae.value)!=null&&Y.length&&!e(I)?(s(),T(ss,{key:0,content:ae.value??"",disabled:e(j),copyFailedTooltip:e(P)("copyRichTextButton.tooltip.copyAllContentFailed"),copyDoneTooltip:e(P)("copyRichTextButton.tooltip.copyAllDone"),copyTooltip:e(P)("copyRichTextButton.tooltip.copyAllContent"),variant:"outline",className:"p-4 text-sm"},null,8,["content","disabled","copyFailedTooltip","copyDoneTooltip","copyTooltip"])):w("",!0),(ce=ae.value)!=null&&ce.length&&!e(I)?(s(),T(oa,{key:1,copyIcon:"bi bi-markdown",content:ae.value??"",disabled:e(j),copyDoneTooltip:e(P)("copyMarkdownButton.tooltip.copyAllDone"),copyTooltip:e(P)("copyMarkdownButton.tooltip.copyAllContentMarkdown"),variant:"outline",className:"p-4 text-sm"},null,8,["content","disabled","copyDoneTooltip","copyTooltip"])):w("",!0)])):w("",!0),F.showLanguageOption?(s(),T(uo,{key:4,class:"hidden sm:block"})):w("",!0),!O.value&&((ge=e(c))==null?void 0:ge.status)==="PUBLISH"?(s(),T(te,{key:5,variant:"outline",onClick:K},{default:i(()=>[X.value?(s(),T(e(xa),{key:0,class:"w-4 h-4 animate-spin mr-2"})):(s(),u("i",R_)),t("span",null,d(e(P)("home.chat.agentDropdown.pinAgent")),1)]),_:1})):O.value&&((ye=e(c))==null?void 0:ye.status)==="PUBLISH"?(s(),T(te,{key:6,variant:"outline",onClick:V},{default:i(()=>[X.value?(s(),T(e(xa),{key:0,class:"w-4 h-4 animate-spin mr-2"})):(s(),u("i",F_)),t("span",null,d(e(P)("home.chat.agentDropdown.unpinAgent")),1)]),_:1})):w("",!0),M.value&&e(c)?(s(),T(te,{key:7,variant:"outline",onClick:le[4]||(le[4]=_e=>A(e(r)))},{default:i(()=>{var _e,Re,ke,qe;return[((Re=(_e=e(c))==null?void 0:_e.currentUserInfo)==null?void 0:Re.permission)==="OWNER"||((qe=(ke=e(c))==null?void 0:ke.currentUserInfo)==null?void 0:qe.permission)==="EDIT"?(s(),u(ve,{key:0},[le[14]||(le[14]=t("i",{class:"bi bi-gear mr-2"},null,-1)),t("span",null,d(e(P)("home.chat.agentDropdown.editAgent")),1)],64)):(s(),u(ve,{key:1},[le[15]||(le[15]=t("i",{class:"bi bi-eye mr-2"},null,-1)),t("span",null,d(e(P)("home.chat.agentDropdown.viewAgent")),1)],64))]}),_:1})):w("",!0),o(ln,{class:"hidden sm:block"})])):w("",!0),n.isShowCreateNewChat?(s(),u("div",P_,[e(U)?w("",!0):(s(),T(he,{key:0},{default:i(()=>[o(ue,null,{default:i(()=>[o(Z,{"as-child":""},{default:i(()=>[o(te,{variant:"ghost",size:"icon",onClick:L},{default:i(()=>le[16]||(le[16]=[t("i",{class:"bi bi-pencil-square"},null,-1)])),_:1,__:[16]})]),_:1}),o(re,{side:"right"},{default:i(()=>[t("p",null,d(e(P)("home.mainSidebar.tooltip.newChat")),1)]),_:1})]),_:1})]),_:1}))])):w("",!0)],2)):w("",!0)}}}),N_=Ft("versionStore",()=>{const n="https://privategpt.fptconsulting.co.jp/api",l=v();return{BEVersion:l,getBEVersion:async()=>{try{const{data:c}=await js.get(`${n}/actuator/version`);l.value=c.version}catch(c){console.log(c)}}}}),z_={class:"hidden sm:flex absolute bottom-0 right-0 sm:bottom-1 sm:right-3 justify-end m-0 p-0"},U_={class:"opacity-80"},O_={class:"opacity-80"},Ls=oe({__name:"AppFooter",setup(n){const l="fcj.2025.12.3.20251215.4",a=N_(),{BEVersion:c}=ie(a),{getBEVersion:r}=a;return Dt(async()=>{c.value||await r()}),(p,m)=>{const g=f("Button"),h=f("DropdownMenuTrigger"),_=f("DropdownMenuItem"),x=f("DropdownMenuContent"),b=f("DropdownMenu");return s(),u("div",z_,[o(b,null,{default:i(()=>[o(h,null,{default:i(()=>[o(g,{variant:"ghost",class:"hover:bg-transparent"},{default:i(()=>m[0]||(m[0]=[t("i",{class:"bi bi-info-circle text-sm sm:text-xl opacity-40"},null,-1)])),_:1,__:[0]})]),_:1}),o(x,{class:"mx-3"},{default:i(()=>[o(_,{class:"cursor-pointer",disabled:""},{default:i(()=>[t("span",U_,"PrivateGPT version - "+d(e(l)),1)]),_:1}),o(_,{class:"cursor-pointer",disabled:""},{default:i(()=>[t("span",O_,"BE version - "+d(e(c)),1)]),_:1})]),_:1})]),_:1})])}}}),j_=oe({__name:"CanvasModeCodeEditor",props:bs({lang:{},darkMode:{type:Boolean}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const l=Ce(),{t:a}=We(l.t),c=ms(),{messageEditorState:r}=ie(c),p=an(),m=jr({settings:{background:"var(--color-stone-950)",gutterBackground:"var(--color-stone-900)",selection:"color-mix(in srgb, var(--color-stone-400) 20%, transparent)",selectionMatch:"color-mix(in srgb, var(--color-stone-400) 30%, transparent)"}}),g=Vr({settings:{selection:"color-mix(in srgb, var(--color-stone-200) 60%, transparent)",lineHighlight:"color-mix(in srgb, var(--color-stone-200) 70%, transparent)",selectionMatch:"color-mix(in srgb, var(--color-stone-300) 50%, transparent)"}}),h=n,_=Os(n,"modelValue"),x=ne(()=>{switch(h.lang.toLowerCase()){case"html":return Jr();case"javascript":return Qr({jsx:!0,typescript:!0});case"java":return qr();case"c#":return Kr();case"python":return Hr();case"go":case"golang":return Wr();case"markdown":case"md":default:return Gr()}}),b=v(!1),S=v({}),D=v(null),y=v(null),I=v(null),C=B=>{if(!D.value)return;const{state:j}=D.value,ee=j.selection.main,se=j.sliceDoc(ee.from,ee.to);switch(B){case"ask":r.value.quoted=se;break}b.value=!1},U=B=>{if(b.value&&y.value&&I.value){const j=B.target;!y.value.contains(j)&&!I.value.contains(j)&&(b.value=!1)}};aa(I,U),aa(y,U);const E=()=>{var B,j;if(document.activeElement&&((B=y.value)!=null&&B.contains(document.activeElement)))b.value=!1;else if(!document.activeElement||!((j=I.value)!=null&&j.contains(document.activeElement)))b.value=!1;else return},N=(B,j,ee)=>{if(!I.value){S.value={top:`${j}px`,left:`${B}`},b.value=!0;return}const se=I.value.offsetWidth;if(B+se>ee.width)B=ee.width-se-5;else if(B<0)B=5;else return;S.value={top:`${j}px`,left:`${B}px`},b.value=!0},$=ko.updateListener.of(B=>{if(!D.value||!y.value)return;const{state:j,view:ee}=B;if(!B.selectionSet&&!B.docChanged)return;const se=j.selection.main;if(se.empty)E();else{const G=ee.coordsAtPos(se.head);if(G){const J=y.value.getBoundingClientRect();let H=G.top-J.top-30;const M=G.left-J.left;G.top-30<J.top&&(H=G.bottom-J.top+5),Et(()=>{N(M,H,J)})}else b.value=!1}}),R=B=>{D.value=B.view};return(B,j)=>{const ee=Kt("auto-animate");return Ke((s(),u("div",{ref_key:"editorContainerRef",ref:y,class:"relative"},[o(e(Ar),{modelValue:_.value,"onUpdate:modelValue":j[0]||(j[0]=se=>_.value=se),extensions:[e(Xr),e($),x.value,e(ko).lineWrapping,e(ko).cspNonce.of(e(p).nonce||""),h.darkMode?e(m):e(g)],"indent-with-tab":!0,"auto-focus":!0,onReady:R,class:"h-full"},null,8,["modelValue","extensions"]),b.value?(s(),u("div",{key:0,ref_key:"floatingMenuRef",ref:I,class:"absolute z-10 bg-white dark:bg-stone-500 shadow-2lg/50 rounded-md border border-stone-200 dark:border-stone-700 flex gap-1",style:_l(S.value)},[o(Pe,{onClick:j[1]||(j[1]=se=>C("ask")),variant:"ghost",size:"icon",icon:"bi-chat",tooltip:e(a)("home.chat.canvasMode.toolbar.ask",{ai:"PrivateGPT"}),class:"bg-white dark:bg-stone-500"},null,8,["tooltip"])],4)):w("",!0)])),[[ee]])}}}),V_=oe({__name:"CanvasModeMarkdownToolbar",setup(n){const l=Ce(),{t:a}=We(l.t),c=ms(),{view:r,prevState:p}=yu(),[m,g]=xu(),h=v();let _;Vt(()=>{_=new wu({content:h.value}),_.update(r.value,p.value)}),Te([r,p],()=>{_==null||_.update(r.value,p.value)}),ls(()=>{_.destroy()});const x=D=>{if(m.value)return;D.preventDefault();const y=g();y.action(I=>{const{doc:C,selection:U}=I.get($u),E=I.get(Su);U.from===U.to||!y.action(Ml()).slice(U.from,U.to).trim()||(c.messageEditorState.quoted=E(C.cut(U.from,U.to)))})},b=D=>{m.value||(D.preventDefault(),g().action(zn(Tu.key)))},S=D=>{m.value||(D.preventDefault(),g().action(zn(Au.key)))};return(D,y)=>(s(),u("div",{class:"absolute z-51 data-[show=false]:hidden flex border rounded-md bg-white dark:bg-stone-500 shadow-lg shadow-stone-500/50",ref_key:"divRef",ref:h},[o(Pe,{onClick:x,variant:"ghost",size:"icon",icon:"bi-chat",tooltip:e(a)("home.chat.canvasMode.toolbar.ask",{ai:"PrivateGPT"}),class:"bg-stone-100 dark:bg-stone-500 rounded-r-none"},null,8,["tooltip"]),o(Pe,{onClick:b,variant:"ghost",size:"icon",icon:"bi-type-bold",tooltip:e(a)("home.chat.canvasMode.toolbar.bold"),class:"bg-stone-100 dark:bg-stone-500 rounded-l-none"},null,8,["tooltip"]),o(Pe,{onClick:S,variant:"ghost",size:"icon",icon:"bi-type-italic",tooltip:e(a)("home.chat.canvasMode.toolbar.italic"),class:"bg-stone-100 dark:bg-stone-500 rounded-l-none"},null,8,["tooltip"])],512))}}),G_=oe({__name:"MarkdownEditorInner",props:{content:{},disabled:{type:Boolean},tooltipComponent:{}},setup(n){const l=Gu("Text"),a=Cu(),c=n,r=Du(p=>Bu.make().config(m=>{m.set(Mu,p),m.set(Eu,c.content),m.set(Ru,{editable:()=>!c.disabled}),m.set(l.key,{view:a({component:c.tooltipComponent})}),m.get(Fu).selectionUpdated((g,h,_)=>{!_||h.eq(_)||r.get().action(Ml())})}).config(Pu).use(Nu).use(zu).use(Uu).use(Ou).use(l).use(ju).use(Vu));return Te(()=>c.content,p=>{var m;(m=r.get())==null||m.action(Lu(p||""))}),(p,m)=>(s(),T(e(Iu),{class:"w-full h-full"}))}}),W_=oe({__name:"MarkdownEditor",props:{content:{},disabled:{type:Boolean},tooltipComponent:{}},setup(n){const l=n;return(a,c)=>(s(),T(e(Hu),null,{default:i(()=>[o(e(Wu),null,{default:i(()=>[o(G_,{content:l.content,disabled:l.disabled,tooltipComponent:l.tooltipComponent},null,8,["content","disabled","tooltipComponent"])]),_:1})]),_:1}))}}),H_=Vs(W_,[["__scopeId","data-v-d1c3e8e5"]]),K_={class:"py-2 px-4 w-full flex justify-between items-center border-b dark:border-b-stone-700"},q_={class:"flex items-center"},Q_={key:0,class:"bi bi-file-earmark-text text-lg m-2"},J_={key:1,class:"bi bi-code-square text-lg m-2"},X_={class:"m-2 text-md font-bold line-clamp-1 whitespace-wrap overflow-hidden"},Y_={class:"flex gap-4 items-center"},Z_={key:0,class:"flex gap-2"},eb={class:"text-sm"},tb={key:0,class:"flex-1 overflow-hidden"},sb={class:"overflow-y-auto h-full w-full relative"},ab={key:0,class:"pl-16 pr-4 py-4 canvas-text"},ob=["srcdoc"],nb={key:1,class:"border-t dark:border-blue-900 text-xs"},lb={class:"flex justify-between px-2 items-center"},ib={class:"font-semibold"},rb={class:"flex items-center gap-3"},cb={class:"flex gap-1"},db={key:0,class:"flex items-center gap-1"},ub={key:1,class:"flex items-center gap-1"},pb={key:2,class:"flex items-center gap-1"},mb={key:3,class:"flex items-center gap-1"},gb={class:"flex gap-1"},fb={class:"border-t dark:border-blue-900 h-40 overflow-y-auto"},vb={key:0,class:"p-2"},hb={key:1,class:"flex flex-col"},_b={class:"grid grid-cols-15 gap-3 items-center"},bb={class:"col-span-2 flex justify-end"},kb={class:"wrap-anywhere col-span-13"},yb={class:"flex items-center flex-none px-4 py-2 border-t dark:border-t-stone-700"},xb={class:"text-xs text-blue-500 dark:text-sky-500 mr-2"},wb={key:0,class:"bi bi-copy mr-1"},$b={key:1,class:"bi bi-check-lg mr-1"},Sb={key:2},Tb={key:3},Ab=`
window.onerror = (message, source, lineno, colno, error) => {
    window.parent.postMessage({ type: 'iframe-error', message, source, lineno, colno }, '*');
};

const interceptConsole = (type) => {
    const orig = console[type];
    console[type] = function (...args) {
        window.parent.postMessage({
            type: 'iframe-console',
            consoleType: type,
            message: args.join(' '),
        }, '*');
        orig.apply(console, args);
    }
}
['log', 'error', 'debug', 'warn', 'assert'].forEach(interceptConsole);
`,Cb=oe({__name:"CanvasModeContainer",setup(n){const l=ps(),{mode:a}=ie(l),c=Ce(),{t:r}=We(c.t),p=ms(),{messageEditorState:m}=ie(p),g=an(),h=ne(()=>m.value.canvasOpen),_=ne(()=>{var O;return(O=m.value.canvasStates)==null?void 0:O[0]}),x=ne(()=>_.value.lang==="markdown"),b=ne(()=>_.value.lang==="html"),S=v(!0),D=v(!1),y=ne(()=>{var O;return(O=_.value)!=null&&O.code?_.value.code.replace("<script>",`<script nonce="${g.nonce}">`).replace("<style>",`<style nonce="${g.nonce}">`).replace('<script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"',`<script src="${oc}"`).replace(/<body([^>]*)>/i,`<body$1>
<script nonce="${g.nonce}">${Ab}<\/script>
<div class="hidden ${N.value}" id="nonce" nonce="${g.nonce}"></div>`).replace('href="#"',"").replace("href='#'",""):""}),{copy:I,copied:C,isSupported:U}=ga({source:()=>_.value.code??""}),E=Bt("canvasRef"),N=v(0),$=()=>{N.value++},{isFullscreen:R,toggle:B}=Cr(E),j=v([]),ee=ne(()=>j.value.filter(O=>O.type==="ERROR")),se=ne(()=>j.value.filter(O=>["DEBUG","ASSERT"].includes(O.type))),G=ne(()=>j.value.filter(O=>O.type==="LOG")),J=ne(()=>j.value.filter(O=>O.type==="WARN")),H=O=>{const K=window.location.origin;O.origin!==K&&O.origin!=="null"||j.value.push({type:O.data.consoleType.toUpperCase()??"ERROR",message:O.data.message})},M=()=>{D.value=!D.value},W=()=>{D.value=!1},X=()=>{j.value=[]};return Vt(()=>{window.addEventListener("message",H)}),ia(()=>{window.removeEventListener("message",H)}),(O,K)=>{var A,k;const V=f("Switch"),F=f("Button"),P=f("Badge"),q=Kt("auto-animate");return _.value?Ke((s(),u("div",{key:0,class:pe(["bg-white dark:bg-stone-800 border shadow-xl rounded-tl-3xl flex flex-col items-stretch transition-all duration-300",h.value?"opacity-100":"opacity-0 overflow-hidden"]),ref_key:"canvasRef",ref:E},[t("div",K_,[t("div",q_,[x.value?(s(),u("i",Q_)):(s(),u("i",J_)),t("div",X_,d((A=_.value)==null?void 0:A.title),1)]),t("div",Y_,[b.value?(s(),u("div",Z_,[t("p",eb,d(e(r)("home.chat.canvasMode.preview")),1),o(V,{size:"base",checked:S.value,"onUpdate:checked":K[0]||(K[0]=L=>S.value=L)},null,8,["checked"])])):w("",!0),x.value?w("",!0):(s(),T(Pe,{key:1,icon:e(R)?"bi bi-fullscreen-exit":"bi bi-fullscreen",size:"mdicon",className:"rounded-full",variant:"ghost",tooltip:e(R)?e(r)("home.chat.canvasMode.button.exitFullScreen"):e(r)("home.chat.canvasMode.button.fullScreen"),onClick:e(B)},null,8,["icon","tooltip","onClick"])),x.value?w("",!0):(s(),T(Pe,{key:2,icon:"bi bi-arrow-clockwise",size:"mdicon",className:"rounded-full",variant:"ghost",tooltip:e(r)("home.chat.canvasMode.button.reload"),onClick:$},null,8,["tooltip"])),o(Pe,{icon:"bi-x",size:"mdicon",className:"rounded-full",variant:"ghost",onClick:e(p).closeCanvas,tooltip:e(r)("home.chat.canvasMode.close")},null,8,["onClick","tooltip"])])]),_.value?(s(),u("div",tb,[Ke((s(),u("div",sb,[x.value?(s(),u("div",ab,[o(H_,{content:_.value.code??"",disabled:!1,tooltipComponent:V_},null,8,["content","tooltipComponent"])])):b.value&&S.value?(s(),u("iframe",{key:1,title:"Canvas",srcdoc:y.value,class:"w-full h-full",sandbox:"allow-scripts"},null,8,ob)):(s(),T(j_,{key:2,modelValue:_.value.code,"onUpdate:modelValue":K[1]||(K[1]=L=>_.value.code=L),lang:e(m).canvasStates[0].lang||"text",darkMode:e(a)==="dark"},null,8,["modelValue","lang","darkMode"]))])),[[q]])])):w("",!0),D.value?(s(),u("div",nb,[t("div",lb,[t("div",ib,d(e(r)("home.chat.canvasMode.button.console.label")),1),t("div",rb,[t("div",cb,[ee.value.length?(s(),u("div",db,[K[3]||(K[3]=t("i",{class:"bi bi-x-circle text-red-400"},null,-1)),t("span",null,d(ee.value.length),1)])):w("",!0),J.value.length?(s(),u("div",ub,[K[4]||(K[4]=t("i",{class:"bi bi-exclamation-circle text-orange-400"},null,-1)),t("span",null,d(J.value.length),1)])):w("",!0),se.value.length?(s(),u("div",pb,[K[5]||(K[5]=t("i",{class:"bi bi-bug text-yellow-400"},null,-1)),t("span",null,d(se.value.length),1)])):w("",!0),G.value.length?(s(),u("div",mb,[K[6]||(K[6]=t("i",{class:"bi bi-info-circle text-blue-400"},null,-1)),t("span",null,d(G.value.length),1)])):w("",!0)]),t("div",gb,[o(F,{variant:"dull",size:"mdicon",onClick:X},{default:i(()=>K[7]||(K[7]=[t("i",{class:"bi bi-slash-circle"},null,-1)])),_:1,__:[7]}),o(F,{variant:"dull",size:"mdicon",onClick:W},{default:i(()=>K[8]||(K[8]=[t("i",{class:"bi bi-x"},null,-1)])),_:1,__:[8]})])])]),Ke((s(),u("div",fb,[j.value.length?(s(),u("div",hb,[(s(!0),u(ve,null,Le(j.value,(L,z)=>(s(),u("div",{key:z,class:"border-b p-2 dark:border-blue-900"},[t("div",_b,[t("div",bb,[t("div",{class:pe({"border rounded-full px-2 py-1 text-xs text-center w-fit":!0,"border-red-400 bg-red-50 text-red-400 dark:bg-red-900/50":L.type==="ERROR","border-yellow-400 bg-yellow-50 text-yellow-400 dark:bg-yellow-900/50":["ASSERT","DEBUG"].includes(L.type),"border-orange-400 bg-orange-50 text-orange-400 dark:bg-orange-900/50":L.type==="WARN","border-blue-400 bg-blue-50 text-blue-400 dark:bg-blue-900/50":L.type==="LOG"})},d(L.type),3)]),t("p",kb,d(L.message),1)])]))),128))])):(s(),u("div",vb,d(e(r)("home.chat.canvasMode.label.console.noProblemsDetected")),1))])),[[q]])])):w("",!0),t("div",yb,[t("span",xb,d((k=e(m).canvasStates)==null?void 0:k[0].lang),1),e(U)?Ke((s(),T(F,{key:0,variant:"dull",size:"sm",class:"text-xs",onClick:K[2]||(K[2]=L=>e(I)())},{default:i(()=>[e(C)?(s(),u("i",$b)):(s(),u("i",wb)),e(C)?(s(),u("span",Tb,d(e(r)("home.chat.label.copyCodeDone")),1)):(s(),u("span",Sb,d(e(r)("home.chat.label.copyCode")),1))]),_:1})),[[q]]):w("",!0),o(F,{variant:"dull",class:pe(["text-xs rounded-none border-b-2 border-transparent mb-[-2px]",{"border-blue-300 bg-gray-50 dark:bg-gray-50/6":D.value}]),onClick:M},{default:i(()=>[me(d(e(r)("home.chat.canvasMode.button.console.label"))+" ",1),ee.value.length?(s(),T(P,{key:0,variant:"destructive",class:"text-white ml-1"},{default:i(()=>[me(d(ee.value.length),1)]),_:1})):w("",!0)]),_:1},8,["class"])])],2)),[[q]]):w("",!0)}}}),Db={class:"flex flex-col h-dvh w-full"},Lb={class:"flex flex-1 overflow-hidden"},Ib={key:1,class:"flex-1 w-11/12 sm:w-3/4 max-w-sm sm:max-w-200 sm:min-w-lg mx-auto h-full pt-5"},Bb=["id"],Mb={class:"w-full sm:w-3/4 sm:max-w-200 sm:min-w-lg sm:mx-auto"},Eb={key:0,class:"relative w-full"},Rb={key:0,class:"overflow-x-auto w-full flex items-center gap-2 px-8 pt-1.5 py-1"},Fb={key:2,class:"my-8 p-4 rounded-2xl bg-red-300 flex text-center gap-4"},Pb={class:"text-xl font-semibold text-rose-900"},Nb={key:3,class:"max-sm:hidden text-xs text-center opacity-50 -mt-4 mb-1"},Xn=oe({__name:"ChatView",setup(n){const l=ot(),a=ms(),{generatingResponse:c,currentConversation:r,shouldLeaveWhiteSpace:p,newMessageAdded:m,messageEditorState:g,hints:h}=ie(a),_=Gt(),{getAgentById:x}=_,{currentAgent:b}=ie(_),S=qs(),{retrieveAllAgentFiles:D}=S,y=tt(),I=Is(),{toast:C}=gt(),{attachments:U}=ie(I),E=at(),{isMobileSize:N}=ie(E),$=Ce(),{t:R}=We($.t),B=v(!1),j=v(null),ee=O=>{j.value&&j.value.setValue(O)},se=async O=>{try{await a.fetchConversationById(O)}catch(K){console.error(K),C({title:R("home.toast.fail.generalErrorTitle"),description:R("home.toast.fail.generalError"),variant:"destructive"}),B.value=!1,l.push("/");return}},G=async O=>{var K,V;try{await x(O)}catch(F){B.value=!1,await Et(),(K=H.value)==null||K.scrollToBottom(),r.value.readOnly=!0,((V=F.response)==null?void 0:V.status)!==404&&C({title:R("home.toast.fail.generalErrorTitle"),description:R("home.toast.fail.generalError"),variant:"destructive"})}await D(O,!1).catch(()=>{})},J=ne(()=>{var O;return(O=r.value)!=null&&O.messagesList?r.value.messagesList.flatMap((K,V,F)=>V%2?[[F[V-1],K]]:[]):[]});Te(()=>y.params.id,async(O,K)=>{var V,F,P,q;if(K&&a.closeCanvas(),O&&!c.value){b.value=void 0,h.value=[],U.value=[],p.value=!1,B.value=!0,await se(O),r.value&&r.value.conversationMetadata&&(U.value=r.value.conversationMetadata.attachments);const A=(F=(V=r.value)==null?void 0:V.conversationMetadata)==null?void 0:F.agentId;!((P=r.value)!=null&&P.readOnly)&&A&&A!=="None"&&await G(A),B.value=!1,await Et(),(q=H.value)==null||q.scrollToBottom(!0)}},{immediate:!0});const H=Bt("contentContainer"),M=v([]),W=(O,K)=>{O instanceof HTMLElement&&(M.value[K]=O)},X=ne(()=>g.value.canvasOpen);return Te(m,async O=>{if(!O)return;await Ca(100),await Et();const K=M.value[M.value.length-1];K&&K.scrollIntoView({behavior:"smooth",block:"start"})}),ls(()=>{a.stopAIResponse(),a.closeCanvas()}),Dt(()=>{!y.params.id&&!c.value&&l.push("/")}),(O,K)=>{var P,q;const V=f("Button"),F=Kt("auto-animate");return s(),u(ve,null,[t("div",Db,[o(ks,{"show-share-chat-button":!1}),Ke((s(),u("div",Lb,[t("div",{class:pe({"flex flex-col transition-all duration-300":!0,"w-0 md:w-1/2 xl:w-1/3":X.value,"w-full":!X.value})},[o(sn,{ref_key:"contentContainer",ref:H,class:"flex flex-col flex-1 justify-center gap-6","disable-shadow-bottom":!0},{default:i(()=>[B.value?(s(),T(e(zs),{key:0,class:"w-8 h-8 animate-spin mx-auto"})):(s(),u("div",Ib,[(s(!0),u(ve,null,Le(J.value,(A,k)=>(s(),u("div",{key:k,class:pe([e(p)&&J.value.length>1?"last:min-h-[var(--scrollable-container-height)]":"","last:pb-10"]),ref_for:!0,ref:L=>W(L,k),id:`msg-${A[1].id}`},[o(pi,{message:A[0],class:"py-4"},null,8,["message"]),o(ki,{message:A[1],index:k*2+1},null,8,["message","index"])],10,Bb))),128))]))]),_:1},512),t("div",null,[K[2]||(K[2]=t("div",{class:"relative h-0"},[t("div",{class:"absolute h-8 left-0 right-4 bottom-0 z-10 bg-linear-to-b from-transparent via-white/80 dark:via-stone-900/80 to-white dark:to-stone-900"})],-1)),t("div",Mb,[e(h).length?(s(),u("div",Eb,[K[0]||(K[0]=t("div",{class:"pointer-events-none absolute top-0 left-0 h-full w-10 -ml-1 bg-gradient-to-r from-white from-30% to-transparent to-90% dark:from-stone-900 transition-opacity duration-300 z-2"},null,-1)),e(N)?w("",!0):Ke((s(),u("div",Rb,[(s(!0),u(ve,null,Le(e(h),A=>(s(),T(V,{key:A,onClick:k=>ee(A),variant:"ghost",class:"border border-blue-200 text-blue-400 dark:border-blue-200 dark:text-blue-300 hover:bg-blue-100/40 hover:text-blue-400 dark:hover:bg-blue-100/20 dark:hover:text-blue-300"},{default:i(()=>[me(d(A),1)]),_:2},1032,["onClick"]))),128))])),[[F]]),K[1]||(K[1]=t("div",{class:"pointer-events-none absolute top-0 right-0 h-full w-10 bg-gradient-to-l from-white from-30% to-transparent to-80% dark:from-stone-900 transition-opacity duration-300"},null,-1))])):w("",!0),(P=e(r))!=null&&P.readOnly?(s(),u("div",Fb,[t("div",Pb,d(e(R)("home.chat.message.readonly")),1)])):(s(),T(Ya,{key:1,ref_key:"messageInputRef",ref:j},null,512)),(q=e(r))!=null&&q.readOnly?w("",!0):(s(),u("p",Nb,d(e(R)("home.chat.label.description",{ai:"PrivateGPT"})),1))])])],2),X.value?(s(),T(Cb,{key:0,class:"w-full md:w-1/2 xl:w-2/3"})):w("",!0)])),[[F]])]),o(Ls)],64)}}}),Tt=oe({__name:"Skeleton",props:{class:{}},setup(n){const l=n;return(a,c)=>(s(),u("div",{class:pe(e(Me)("relative w-full overflow-hidden rounded-lg bg-stone-100 dark:bg-stone-800",l.class))},c[0]||(c[0]=[t("div",{class:"absolute inset-0 h-[200%] w-[200%] top-50% -bg-linear-60 from-transparent from-30% via-50% to-70% via-white/80 dark:via-stone-700/80 to-transparent animate-wave1 rounded-lg"},null,-1)]),2))}}),zb={class:"w-full"},Ub={class:"flex flex-col justify-between items-center h-full overflow-y-auto w-full"},Ob={key:0,class:"my-4 text-xl font-semibold text-center select-none"},jb={class:"sm:hidden flex justify-center items-center gap-2 opacity-50 my-4"},Vb={class:"text-xs text-center"},Gb={key:1,class:"agent-info flex flex-col items-center grow justify-center gap-3 w-full py-5"},Wb={key:2,class:"flex items-center gap-3"},Hb={class:"text-2xl font-bold text-center truncate max-w-[250px] sm:max-w-[800px]"},Kb={key:0,class:"bi bi-patch-check-fill text-xl text-blue-500 dark:text-blue-400"},qb={key:4,class:"text-base text-stone-400"},Qb={key:6,class:"max-w-sm sm:max-w-3xl break-words text-base text-center"},Jb={class:"w-full p-2 sm:w-3/5 max-w-[800px]"},Xb=["onClick"],Yb={class:"text-sm select-none"},Zb={class:"inline-block"},e1={key:0,class:"pt-2 flex flex-col max-w-sm sm:max-w-xl"},t1={class:"flex-1"},s1={class:"px-3 pt-4 pb-2 text-xs text-stone-400"},a1={class:"w-full gap-3 flex items-baseline contents-start overflow-hidden"},o1={class:"flex-1 text-sm text-left line-clamp-1 text-ellipsis"},n1=["href"],l1={class:"flex-1"},i1={key:3},r1={class:"w-11/12 sm:w-3/4 max-w-sm sm:max-w-200 sm:min-w-lg mx-auto h-full pt-5"},c1={class:"relative h-0"},d1={class:"relative w-full"},u1={key:0,class:"overflow-x-auto w-full flex items-center gap-2 px-8 pt-1.5 py-1"},p1={class:"max-sm:hidden text-xs text-center opacity-50 mb-2"},yi=oe({__name:"AgentChatHomeView",props:{isUsingPreviewAgent:{type:Boolean},isAllowedToPreviewChat:{type:Boolean}},setup(n){const l=Ce(),{t:a}=We(l.t),c=ot(),r=tt(),{toast:p}=gt(),m=Gt(),{currentAgent:g}=ie(m),{getAgentById:h}=m,_=qs(),{retrieveAllAgentFiles:x}=_,b=ms(),{currentConversation:S,currentParentMessageId:D,newMessageAdded:y,hints:I,recentConversationsWithAgent:C}=ie(b),{fetchSupportModels:U,fetchRecentConversationsWithAgent:E}=b,N=at(),{isMobileSize:$}=ie(N),R=Is(),{clearState:B}=R,j=v(!1),ee=ne(()=>r.params.agentId),se=n,G=Bt("chatContainer"),J=v([]),H=(A,k)=>{A instanceof HTMLElement&&(J.value[k]=A)},M=v(null),W=A=>{M.value&&M.value.setValue(A)},X=A=>{G.value&&(G.value.scrollTo({top:G.value.scrollHeight,behavior:A}),O.value=!0)},O=v(!0),K=()=>{if(!G.value)return;const A=G.value.scrollTop,k=G.value.clientHeight,L=G.value.scrollHeight;O.value=A+k>=L-10};Te(()=>{var A;return(A=S.value)==null?void 0:A.messagesList},K,{deep:!0}),Te(y,async A=>{if(!A)return;await Et();const k=J.value[J.value.length-2];k&&k.scrollIntoView({behavior:"smooth",block:"start"})});const V=async()=>{var A;if(!se.isUsingPreviewAgent){b.unshiftConversation(""),c.push({path:`/agent/${(A=g.value)==null?void 0:A.id}/chat/`});const k=Te(()=>{var L;return(L=S.value)==null?void 0:L.id},L=>{var z;L&&L!==""&&(c.replace({path:`/agent/${(z=g.value)==null?void 0:z.id}/chat/${L}`}),k())})}S.value||b.unshiftConversation("")},F=()=>{E(ee.value,C.value.currentOffset)},P=(A,k)=>{const L=[...A];for(let z=L.length-1;z>0;z--){const Q=Math.floor(Math.random()*(z+1));[L[z],L[Q]]=[L[Q],L[z]]}return L.slice(0,k)},q=v(null);return Te(()=>{var A;return(A=g.value)==null?void 0:A.sampleQuestions},A=>{Array.isArray(A)&&A.length>4?q.value=P(A,4):q.value=A??[]}),Te(()=>r.params.agentId,async()=>{var A,k;if(S.value=void 0,I.value=[],!se.isUsingPreviewAgent)try{if(j.value=!0,B(),D.value=null,await h(ee.value),!g.value||(A=g.value)!=null&&A.currentUserInfo&&((k=g.value)==null?void 0:k.currentUserInfo.permission)==="NONE"){c.replace("/agent/access-denied");return}await Promise.all([E(ee.value,0),x(ee.value,!1)])}catch{c.replace("/agent/access-denied"),p({title:a("home.toast.fail.generalErrorTitle"),description:a("home.toast.fail.generalError"),variant:"destructive"})}finally{j.value=!1}await U()},{immediate:!0}),(A,k)=>{var ae,de,le,te,Z,re,ue,he,$e;const L=f("RouterLink"),z=f("Button"),Q=Kt("auto-animate");return s(),u("div",{class:pe([se.isUsingPreviewAgent?"h-[calc(100dvh-3.5rem)]":"h-dvh","flex flex-col items-center justify-center w-full"])},[t("div",zb,[se.isUsingPreviewAgent?w("",!0):(s(),T(ks,{key:0,"show-language-option":!0}))]),t("div",Ub,[se.isUsingPreviewAgent&&!e(S)?(s(),u("p",Ob,d(e(a)("editAgent.preview.label")),1)):w("",!0),t("div",jb,[k[1]||(k[1]=t("i",{class:"bi bi-exclamation-circle text-xs"},null,-1)),t("p",Vb,d(e(a)("home.chat.label.description",{ai:"PrivateGPT"})),1)]),e(S)?w("",!0):Ke((s(),u("div",Gb,[j.value?(s(),T(Tt,{key:1,class:"h-16 w-16 rounded-full"})):(s(),T(wt,{key:0,fallbackText:(ae=e(g))==null?void 0:ae.name,size:"lg"},null,8,["fallbackText"])),j.value?(s(),T(Tt,{key:3,class:"w-32 h-7"})):(s(),u("div",Wb,[t("span",Hb,d((de=e(g))==null?void 0:de.name),1),(le=e(g))!=null&&le.name&&e(g).verified?(s(),u("i",Kb)):w("",!0)])),j.value?(s(),T(Tt,{key:5,class:"w-60 h-7"})):(s(),u("div",qb,[t("span",null,[k[2]||(k[2]=t("i",{class:"bi bi-person"},null,-1)),me(" "+d(e(a)("home.chat.label.hasCreated",{person:(te=e(g))==null?void 0:te.owner.name})),1)])])),j.value?(s(),T(Tt,{key:7,class:"w-80 h-7"})):(s(),u("div",Qb,d((Z=e(g))==null?void 0:Z.description),1)),t("div",Jb,[Ke((s(),u("div",{class:pe([((ue=(re=e(g))==null?void 0:re.sampleQuestions)==null?void 0:ue.length)!==1?"grid grid-cols-2 gap-3":"grid grid-cols-1"])},[j.value?(s(),u(ve,{key:1},Le(4,Se=>o(Tt,{key:Se,class:"col-span-1 h-16 p-3 bg-stone-100 dark:bg-stone-800 hover:bg-stone-200 dark:hover:bg-stone-700 rounded-xl rounded-tr-xs w-full cursor-pointer wrap-anywhere"})),64)):(s(!0),u(ve,{key:0},Le(q.value,(Se,be)=>{var Ge,fe,Y,ce;return s(),u("div",{key:be,class:pe([be===((fe=(Ge=e(g))==null?void 0:Ge.sampleQuestions)==null?void 0:fe.length)-1&&((ce=(Y=e(g))==null?void 0:Y.sampleQuestions)==null?void 0:ce.length)%2!==0?"col-span-2":"col-span-1","p-3 bg-stone-100 dark:bg-stone-800 hover:bg-stone-200 dark:hover:bg-stone-700 rounded-xl rounded-tr-xs w-full cursor-pointer wrap-anywhere"]),onClick:ge=>W(Se)},[t("span",Yb,d(Se),1)],10,Xb)}),128))],2)),[[Q]]),t("div",Zb,[A.isUsingPreviewAgent?w("",!0):Ke((s(),u("div",e1,[j.value?(s(),u(ve,{key:0},[o(Tt,{class:"mx-3 mb-2 mt-4 w-12 h-5"}),(s(),u(ve,null,Le(4,Se=>t("div",{key:Se,class:"flex gap-3 items-center pl-3 py-2"},[t("div",null,[o(Tt,{class:"w-6 h-6 flex-0 rounded-full p-0"})]),t("div",t1,[o(Tt,{class:pe(["w-full h-4",{"w-64":Se%2,"w-80":!(Se%2)}])},null,8,["class"])]),t("div",null,[o(Tt,{class:"w-6 h-6 flex-0 rounded-full p-0"})])])),64)),o(Tt,{class:"mx-3 mb-2 mt-4 w-18 h-5"})],64)):w("",!0),!j.value&&((he=e(C).items)!=null&&he.length)?(s(),u(ve,{key:1},[t("div",s1,d(e(a)("home.chat.label.recentConversations")),1),(s(!0),u(ve,null,Le(e(C).items,Se=>(s(),u("div",{key:Se.id,class:"flex items-center"},[o(L,{to:`/agent/${Se.agentId}/chat/${Se.id}`,class:"flex-1 overflow-hidden"},{default:i(()=>[o(Pe,{size:"default",variant:"ghost",className:"rounded-full w-full"},{default:i(()=>{var be;return[t("div",a1,[o(wt,{fallbackText:(be=e(g))==null?void 0:be.name,size:"xxs",className:"flex-0"},null,8,["fallbackText"]),t("div",o1,d(Se.conversationName),1)])]}),_:2},1024)]),_:2},1032,["to"]),t("a",{href:`/agent/${Se.agentId}/chat/${Se.id}`,target:"_blank",class:"flex-0"},[o(Pe,{size:"mdicon",variant:"ghost",className:"rounded-full p-3.5 w-10 h-10"},{default:i(()=>[o(e(wl))]),_:1})],8,n1)]))),128))],64)):w("",!0),!j.value&&e(C).loading?(s(),u(ve,{key:2},Le(2,Se=>t("div",{key:Se,class:"flex gap-3 items-center pl-3 pr-2 py-3"},[t("div",null,[o(Tt,{class:"w-6 h-6 flex-0 rounded-full p-0"})]),t("div",l1,[o(Tt,{class:"w-full h-4"})]),t("div",null,[o(Tt,{class:"w-6 h-6 flex-0 rounded-full p-0"})])])),64)):w("",!0),!j.value&&e(C).currentOffset<e(C).total?(s(),u("div",i1,[o(Pe,{variant:"link",size:"sm",className:"mt-2 text-xs",onClick:F,disabled:e(C).loading},{default:i(()=>[me(d(e(a)("home.chat.button.seeMoreRecentConversation")),1)]),_:1},8,["disabled"])])):w("",!0)])),[[Q]])])])])),[[Q]]),e(S)?(s(),u("div",{key:2,class:"flex flex-col w-full justify-center overflow-y-auto gap-6 scroll-smooth",ref_key:"chatContainer",ref:G,onScroll:K},[t("div",r1,[(s(!0),u(ve,null,Le(($e=e(S))==null?void 0:$e.messagesList,(Se,be)=>(s(),u("div",{key:be,ref_for:!0,ref:Ge=>H(Ge,be),class:"last:pb-5"},[Se.role==="USER"?(s(),T(pi,{key:0,message:Se,class:"py-4"},null,8,["message"])):w("",!0),Se.role==="AI"?(s(),T(ki,{key:1,message:Se,index:be},null,8,["message","index"])):w("",!0)]))),128))])],544)):w("",!0)]),t("div",{class:pe([se.isUsingPreviewAgent?"w-11/12":"w-full sm:w-3/4 sm:max-w-200 sm:min-w-lg sm:mx-auto"])},[t("div",c1,[O.value?w("",!0):(s(),T(Pe,{key:0,icon:"bi bi-arrow-down text-sm",size:"icon","class-name":"absolute h-8 w-8 rounded-full bg-white dark:bg-stone-700 border z-20 bottom-2 mx-auto shadow-md left-1/2",tooltip:e(a)("kaigiInstantRecord.button.scrollToBottom"),onClick:k[0]||(k[0]=Se=>X("smooth"))},null,8,["tooltip"]))]),t("div",d1,[k[3]||(k[3]=t("div",{class:"pointer-events-none absolute top-0 left-0 h-full w-10 -ml-1 bg-gradient-to-r from-white from-30% to-transparent to-90% dark:from-stone-900 transition-opacity duration-300 z-2"},null,-1)),e($)?w("",!0):Ke((s(),u("div",u1,[(s(!0),u(ve,null,Le(e(I),Se=>(s(),T(z,{key:Se,onClick:be=>W(Se),variant:"ghost",class:"border border-blue-200 text-blue-400 dark:border-blue-200 dark:text-blue-300 hover:bg-blue-100/40 hover:text-blue-400 dark:hover:bg-blue-100/20 dark:hover:text-blue-300"},{default:i(()=>[me(d(Se),1)]),_:2},1032,["onClick"]))),128))])),[[Q]]),k[4]||(k[4]=t("div",{class:"pointer-events-none absolute top-0 right-0 h-full w-10 bg-gradient-to-l from-white from-30% to-transparent to-80% dark:from-stone-900 transition-opacity duration-300"},null,-1))]),!j.value&&A.isAllowedToPreviewChat||!se.isUsingPreviewAgent?(s(),T(Ya,{key:0,ref_key:"messageInputRef",ref:M,onHandleMessage:V,isUsingPreviewAgent:se.isUsingPreviewAgent},null,8,["isUsingPreviewAgent"])):w("",!0),t("p",p1,d(e(a)("home.chat.label.description",{ai:"PrivateGPT"})),1)],2),se.isUsingPreviewAgent?w("",!0):(s(),T(Ls,{key:0}))],2)}}}),m1={key:0,class:"absolute flex items-center justify-center bg-white dark:bg-stone-800 mt-1 shadow-lg h-16 rounded-lg w-full z-50"},g1={class:"font-semibold xl:text-md sm:text-sm whitespace-nowrap overflow-hidden text-ellipsis sm:max-w-[35rem] max-w-[15rem]"},f1={key:0,class:"bi bi-patch-check-fill text-md text-blue-500 dark:text-blue-400 ml-1"},v1={class:"font-extralight dark:text-white text-sm text-left text-stone-600 whitespace-nowrap overflow-hidden text-ellipsis sm:max-w-[35rem] max-w-[15rem]"},h1={class:"sm:text-sm text-xs line-clamp-1 opacity-40 whitespace-wrap overflow-hidden w-full"},_1={key:0,class:"backdrop-blur-2xs fixed inset-0 bg-black/80 dark:bg-stone-950/80 flex items-center justify-center z-50"},b1={class:"top-dialog-buttons flex items-center justify-end gap-3"},k1={key:0,class:"bi bi-pin mr-2"},y1={key:0,class:"bi bi-eye-slash mr-2"},x1={class:"text-sm"},w1={class:"flex flex-col items-center justify-center pb-5"},$1={class:"font-semibold text-md text-center my-5"},S1={key:0,class:"bi bi-patch-check-fill text-md text-blue-500 dark:text-blue-400 ml-1"},T1={class:"text-sm opacity-40"},A1={class:"text-sm text-center opacity-40"},C1=oe({__name:"SearchAgentAll",setup(n){const l=ot(),{t:a}=Ce(),c=Gt(),{pinAgent:r,unpinAgent:p,getPinAgents:m,searchAgent:g}=c,{pinAgents:h}=ie(c),_=v([]),x=v(""),b=v(!1),S=v(!1),D=us(async X=>{try{S.value=!0,_.value=await g(X)}catch{Ue({title:a("home.toast.fail.generalErrorTitle"),description:a("home.toast.fail.generalError"),variant:"destructive"})}finally{S.value=!1}},300);Te(x,X=>{if(!X){_.value=[];return}D(X)});const y=v(!1),I=v(!1),C=v(),U=Bt("searchBoxRef"),E=Bt("dialogContentRef"),N=v(!1);aa(U,()=>{N.value||(y.value=!1)}),aa(E,()=>{N.value||(I.value=!1),N.value=!1});const $=X=>{C.value=X,I.value=!0},R=()=>{y.value=!0},B=async X=>{try{b.value=!0,await r(X),await m(),Ue({title:a("home.toast.success.pinAgent")})}catch{Ue({title:a("home.toast.fail.generalErrorTitle"),description:a("home.toast.fail.generalError"),variant:"destructive"})}finally{b.value=!1}},j=X=>Array.isArray(h.value)&&h.value.some(O=>O.id===X),ee=async X=>{try{b.value=!0,await p(X),await m(),Ue({title:a("home.toast.success.unpinAgent")})}catch{Ue({title:a("home.toast.fail.generalErrorTitle"),description:a("home.toast.fail.generalError"),variant:"destructive"})}finally{b.value=!1}},se=async X=>{l.push(`/agent/${X}`)},G=v(!1),{protocol:J,host:H}=window.location,M=v(`${J}//${H}`),W=async X=>{try{await navigator.clipboard.writeText(`${M.value}/agent/${X}`),Ue({title:a("home.toast.success.linkCopy")}),G.value=!0,setTimeout(()=>G.value=!1,2e3)}catch{Ue({title:a("home.toast.fail.generalErrorTitle"),description:a("home.toast.fail.generalError"),variant:"destructive"})}};return(X,O)=>{var de,le,te,Z,re;const K=f("CommandInput"),V=f("Loader"),F=f("CommandItem"),P=f("CommandGroup"),q=f("CommandList"),A=f("Command"),k=f("DropdownMenuTrigger"),L=f("DropdownMenuItem"),z=f("DropdownMenuContent"),Q=f("DropdownMenu"),ae=f("Button");return s(),u("div",{class:"my-4",ref_key:"searchBoxRef",ref:U},[o(A,{class:"overflow-visible relative h-10"},{default:i(()=>[o(K,{class:"h-9 z-10 w-full",placeholder:e(a)("home.searchAgent.label.searchAgent"),modelValue:x.value,"onUpdate:modelValue":O[0]||(O[0]=ue=>x.value=ue),modelModifiers:{lazy:!0},onFocus:R},null,8,["placeholder","modelValue"]),y.value&&x.value?(s(),T(q,{key:0},{default:i(()=>[S.value?(s(),u("div",m1,[o(V,{class:"size-4 animate-spin"})])):w("",!0),o(P,{class:"absolute bg-white dark:bg-stone-800 mt-1 shadow-lg max-h-48 overflow-y-auto rounded-lg w-full z-50"},{default:i(()=>[(s(!0),u(ve,null,Le(_.value,ue=>(s(),T(F,{key:ue.id,value:ue,class:"flex items-center gap-4 h-22 cursor-pointer dark:hover:bg-stone-700",onSelect:he=>$(ue)},{default:i(()=>[o(wt,{fallbackText:ue.name,size:"base"},null,8,["fallbackText"]),t("div",null,[t("h1",g1,[me(d(ue.name)+" ",1),ue.verified?(s(),u("i",f1)):w("",!0)]),t("h2",v1,d(ue.description),1),t("h2",h1,d(e(a)("home.searchAgent.label.hasCreated",{person:ue.owner.name})),1)])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})):w("",!0)]),_:1}),I.value?(s(),u("div",_1,[t("div",{onClick:O[7]||(O[7]=ue=>N.value=!1),ref_key:"dialogContentRef",ref:E,class:"bg-white dark:bg-stone-800 rounded-md shadow-lg p-4 w-full max-w-md"},[t("div",b1,[o(Q,{modal:!1},{default:i(()=>[o(k,{onClick:O[1]||(O[1]=Ye(ue=>N.value=!0,["stop"]))},{default:i(()=>O[8]||(O[8]=[t("div",null,[t("i",{class:"bi bi-three-dots cursor-pointer"})],-1)])),_:1,__:[8]}),o(z,null,{default:i(()=>[o(L,{class:"cursor-pointer"},{default:i(()=>{var ue;return[j((ue=C.value)==null?void 0:ue.id)?(s(),u("div",{key:1,variant:"ghost",onClick:O[3]||(O[3]=he=>{var $e;return ee(($e=C.value)==null?void 0:$e.id)}),class:"p-0 m-0 flex items-center mr-2"},[b.value?w("",!0):(s(),u("i",y1)),b.value?(s(),T(V,{key:1,class:"w-4 h-4 animate-spin"})):w("",!0),t("span",null,d(e(a)("home.searchAgent.button.unpinAgent")),1)])):(s(),u("div",{key:0,variant:"ghost",onClick:O[2]||(O[2]=he=>{var $e;return B(($e=C.value)==null?void 0:$e.id)}),class:"p-0 m-0 flex items-center mr-2"},[b.value?w("",!0):(s(),u("i",k1)),b.value?(s(),T(V,{key:1,class:"w-4 h-4 animate-spin"})):w("",!0),t("span",null,d(e(a)("home.searchAgent.button.pinAgent")),1)]))]}),_:1}),o(L,{class:"cursor-pointer",onClick:O[4]||(O[4]=ue=>{var he;return W((he=C.value)==null?void 0:he.id)})},{default:i(()=>[O[9]||(O[9]=t("i",{class:"bi bi-link"},null,-1)),t("span",x1,d(e(a)("home.searchAgent.button.copyLink")),1)]),_:1,__:[9]})]),_:1})]),_:1}),t("div",null,[t("i",{class:"bi bi-x cursor-pointer",onClick:O[5]||(O[5]=ue=>I.value=!1)})])]),t("div",w1,[o(wt,{fallbackText:(de=C.value)==null?void 0:de.name,size:"base",avatarClass:"m-auto mt-10"},null,8,["fallbackText"]),t("h1",$1,[me(d((le=C.value)==null?void 0:le.name)+" ",1),(te=C.value)!=null&&te.verified?(s(),u("i",S1)):w("",!0)]),t("h2",T1,d(e(a)("home.searchAgent.label.hasCreated",{person:(Z=C.value)==null?void 0:Z.owner.name})),1),t("h2",A1,d((re=C.value)==null?void 0:re.description),1),o(ae,{onClick:O[6]||(O[6]=ue=>{var he;return se((he=C.value)==null?void 0:he.id)}),class:"mt-5 bg-stone-100 hover:bg-stone-200 text-black"},{default:i(()=>[O[10]||(O[10]=t("i",{class:"bi bi-chat mr-2"},null,-1)),me(" "+d(e(a)("home.searchAgent.button.newChat")),1)]),_:1,__:[10]})])],512)])):w("",!0)],512)}}}),D1={key:0,class:"flex items-center gap-5 p-4 max-sm:max-w-sm whitespace-nowrap overflow-x-auto"},L1=oe({__name:"AgentCategoriesTabs",emits:["select-category"],setup(n,{emit:l}){const a=ps(),{currentLanguage:c}=ie(a),r=l,p=Gt(),{setObserverEnabled:m}=p,{activeTab:g,agents:h,loadingForAgentsCategory:_}=ie(p),x=S=>{m(!1),g.value=S,r("select-category",g.value),m(!0)},b=ne(()=>{const S=new Set,D=[];return h.value.forEach(({info:y})=>{const I=y.displayGroup[c.value??"en_US"],C=y.displayGroup.en_US;S.has(I)||(S.add(I),D.push({key:C,label:I}))}),D});return(S,D)=>{const y=f("Skeleton"),I=f("TabsTrigger"),C=f("TabsList"),U=f("Tabs");return s(),u("div",null,[e(_)?(s(),u("div",D1,[(s(),u(ve,null,Le(7,E=>t("div",{key:E},[o(y,{class:"h-8 w-[6rem]"})])),64))])):(s(),T(U,{key:1,modelValue:e(g),"onUpdate:modelValue":D[0]||(D[0]=E=>kt(g)?g.value=E:null),class:"w-full max-sm:max-w-sm mr-auto whitespace-nowrap overflow-x-auto"},{default:i(()=>[o(C,{class:"w-full sm:w-fit justify-between rounded-none border-b bg-transparent p-0"},{default:i(()=>[(s(!0),u(ve,null,Le(b.value,E=>(s(),T(I,{key:E.key,value:E.key,onMousedown:N=>x(E.key),class:"max-sm:w-full rounded-none border-b-2 border-b-transparent dark:bg-transparent px-4 pb-3 pt-2 text-muted-foreground shadow-none transition-all focus-visible:ring-0 data-[state=active]:border-b-primary data-[state=active]:text-foreground data-[state=active]:shadow-none data-[state=active]:delay-[200ms] hover:bg-stone-100 dark:hover:bg-stone-800"},{default:i(()=>[me(d(E.label),1)]),_:2},1032,["value","onMousedown"]))),128))]),_:1})]),_:1},8,["modelValue"]))])}}}),xi=oe({__name:"DialogTrigger",props:{asChild:{type:Boolean},as:{}},setup(n){const l=n;return(a,c)=>(s(),T(e(Wc),At(Ct(l)),{default:i(()=>[we(a.$slots,"default")]),_:3},16))}}),I1={key:0,class:"grid grid-cols-1 gap-x-1.5 gap-y-1 md:gap-x-2 md:gap-y-1.5 lg:grid-cols-2 lg:gap-x-3 lg:gap-y-2.5 mt-0 sm:mt-5"},B1={class:"space-y-2"},M1={key:1},E1=["data-category-code"],R1={class:"text-2xl font-bold ml-1"},F1={class:"text-md mb-6 ml-1 mt-1 text-stone-400 dark:text-stone-500"},P1={"as-child":"",class:"grid sm:grid-cols-1 lg:grid-cols-2 gap-3"},N1={class:"h-24 sm:h-28 hover:bg-stone-100 dark:hover:bg-stone-800 rounded-xl p-1 sm:p-5 cursor-pointer flex gap-3 transition duration-200 ease-in-out items-center"},z1={class:"flex items-center justify-center font-bold text-md w-8 h-8 rounded-full"},U1={class:"flex flex-col gap-1 w-full"},O1={class:"text-left font-semibold text-xs line-clamp-1 sm:line-clamp-2 wrap-anywhere whitespace-wrap overflow-hidden text-ellipsis max-w-60 sm:max-w-full"},j1={class:"text-start text-xs line-clamp-2 wrap-anywhere opacity-40 whitespace-wrap overflow-hidden text-ellipsis max-w-[90%]"},V1={class:"text-sm text-stone-600 wrap-anywhere"},G1={class:"text-xs opacity-40"},W1={key:0,class:"bi bi-patch-check-fill text-2xl text-blue-500 dark:text-blue-400 ml-3"},H1=["onClick"],K1={key:0,class:"bi bi-pin mr-2"},q1=["onClick"],Q1={key:0,class:"bi bi-eye-slash mr-2"},J1={class:"text-sm"},X1={class:"flex flex-col items-center justify-center pb-5"},Y1={class:"font-semibold text-md my-5 wrap-anywhere text-center max-w-60 sm:max-w-200 truncate"},Z1={key:0,class:"bi bi-patch-check-fill text-md text-blue-500 dark:text-blue-400 ml-2"},ek={class:"text-sm opacity-40"},tk={class:"text-sm text-center wrap-anywhere opacity-40"},sk={key:0,class:"w-full flex justify-center px-1"},ak={class:"text-xs"},Do=6,ok=oe({__name:"AgentsMain",setup(n,{expose:l}){const a=ps(),{currentLanguage:c}=ie(a),r=ot(),{t:p}=Ce(),m=Gt(),{getAllAgents:g,pinAgent:h,getPinAgents:_,unpinAgent:x,getAgentsByCategoryId:b}=m,{activeTab:S,observerEnabled:D,pinAgents:y,agents:I,agentsInCategory:C,offsetByCategory:U,shouldDisplaySeeMore:E,isSystemCategory:N,countAgentsInCurrentCategory:$,loadingForAgentsCategory:R,loadingForFetchMoreAgentsInCategory:B}=ie(m),j=v(!1),ee=v(!1),{protocol:se,host:G}=window.location,J=v(`${se}//${G}`),H=async k=>{try{await navigator.clipboard.writeText(`${J.value}/agent/${k}`),Ue({title:p("editAgent.toast.success.linkCopy")}),ee.value=!0,setTimeout(()=>ee.value=!1,2e3)}catch{Ue({title:p("editAgent.toast.fail.generalErrorTitle"),description:p("editAgent.toast.fail.generalError"),variant:"destructive"})}},M=async k=>{try{j.value=!0,await h(k),await _(),Ue({title:p("editAgent.toast.success.pinAgent")})}catch{Ue({title:p("editAgent.toast.fail.generalErrorTitle"),description:p("editAgent.toast.fail.generalError"),variant:"destructive"})}finally{j.value=!1}},W=async k=>{try{j.value=!0,await x(k),await _(),Ue({title:p("editAgent.toast.success.unpinAgent")})}catch{Ue({title:p("editAgent.toast.fail.generalErrorTitle"),description:p("editAgent.toast.fail.generalError"),variant:"destructive"})}finally{j.value=!1}},X=k=>Array.isArray(y.value)&&y.value.some(L=>L.id===k),O=v({}),K=[],V=()=>{K.forEach(k=>k()),K.length=0,Object.entries(O.value).forEach(([k,L])=>{if(!L)return;const{stop:z}=Dr(L,([Q])=>{D.value&&Q.isIntersecting&&(S.value=k)},{root:null,rootMargin:"-35% 0px -85% 0px",threshold:[0,.25,.5,.75,1]});K.push(z)})},F=async k=>{r.push(`/agent/${k}`)},P=async k=>{B.value[k]=!0,U.value[k]===void 0&&(U.value[k]=0);const L={offset:U.value[k],limit:Do};try{await b(k,L)}catch(z){return console.error(z),Ue({title:p("home.toast.fail.generalErrorTitle"),description:p("home.toast.fail.generalError"),variant:"destructive"}),[]}finally{B.value[k]=!1}},q=async k=>{U.value[k]+=Do,await P(k),C.value.length>0?E.value[k]=!0:E.value[k]=!1,$.value[k]=C.value.length};Te(()=>S.value,k=>{D.value||A(k)});const A=k=>{var z;const L=(z=O.value[k])==null?void 0:z[0];L&&L.scrollIntoView({behavior:"smooth",block:"start"})};return Te(()=>I.value,async k=>{k&&k.length>0&&(await Et(),V())},{immediate:!0}),Dt(async()=>{await g()}),ls(()=>{K.forEach(k=>k())}),l({scrollToCategory:()=>A(S.value)}),(k,L)=>{const z=f("Skeleton"),Q=f("TooltipTrigger"),ae=f("TooltipContent"),de=f("Tooltip"),le=f("TooltipProvider"),te=f("DropdownMenuTrigger"),Z=f("Loader"),re=f("DropdownMenuItem"),ue=f("DropdownMenuContent"),he=f("DropdownMenu"),$e=f("Button"),Se=f("DialogContent"),be=f("Dialog"),Ge=f("Loader2");return s(),u("div",null,[e(R)?(s(),u("div",I1,[(s(),u(ve,null,Le(6,fe=>t("div",{key:fe,class:"flex items-center gap-4 p-4"},[o(z,{class:"h-16 w-16 rounded-full"}),t("div",B1,[o(z,{class:"h-4 w-[250px]"}),o(z,{class:"h-4 w-[100px]"}),o(z,{class:"h-4 w-[200px]"})])])),64))])):(s(),u("div",M1,[(s(!0),u(ve,null,Le(e(I),fe=>(s(),u("div",{key:fe.info.id,"data-category-code":fe.info.id,ref_for:!0,ref:Y=>{const ce=fe.info.displayGroup.en_US;O.value[ce]||(O.value[ce]=[]),Y&&!O.value[ce].includes(Y)&&O.value[ce].push(Y)},class:"pt-10 scroll-mt-25 last:min-h-screen"},[t("div",null,[t("h2",R1,d(fe.info.displayName[e(c)??"en_US"]),1),t("h2",F1,d(fe.info.description[e(c)??"en_US"]),1),t("div",P1,[(s(!0),u(ve,null,Le(fe.list.items,(Y,ce)=>(s(),T(be,{key:Y.id},{default:i(()=>[o(xi,{"as-child":""},{default:i(()=>[t("div",N1,[t("div",z1,d(ce+1),1),o(wt,{fallbackText:Y.name,size:"base"},null,8,["fallbackText"]),t("div",U1,[t("h1",O1,d(Y.name),1),o(le,{"as-child":""},{default:i(()=>[o(de,null,{default:i(()=>[o(Q,null,{default:i(()=>[t("h3",j1,d(Y.description),1)]),_:2},1024),o(ae,{class:"m-auto max-w-xs p-2 bg-white text-left"},{default:i(()=>[t("h3",V1,d(Y.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),t("h2",G1,d(e(p)("home.searchAgent.label.hasCreated",{person:Y.owner.name})),1)]),Y.verified?(s(),u("i",W1)):w("",!0)])]),_:2},1024),o(Se,{class:"w-full max-w-sm sm:max-w-lg rounded-md sm:rounded-lg","no-close":!1},{"extra-button":i(()=>[o(he,null,{default:i(()=>[o(te,null,{default:i(()=>L[0]||(L[0]=[t("div",null,[t("i",{class:"bi bi-three-dots cursor-pointer"})],-1)])),_:1,__:[0]}),o(ue,null,{default:i(()=>[o(re,{class:"cursor-pointer"},{default:i(()=>[X(Y.id)?(s(),u("div",{key:1,variant:"ghost",onClick:ge=>W(Y.id),class:"p-0 m-0 flex items-center mr-2"},[t("div",null,[j.value?w("",!0):(s(),u("i",Q1)),j.value?(s(),T(Z,{key:1,class:"w-4 h-4 animate-spin"})):w("",!0)]),t("span",null,d(e(p)("home.searchAgent.button.unpinAgent")),1)],8,q1)):(s(),u("div",{key:0,variant:"ghost",onClick:ge=>M(Y.id),class:"p-0 m-0 flex items-center mr-2"},[t("div",null,[j.value?w("",!0):(s(),u("i",K1)),j.value?(s(),T(Z,{key:1,class:"w-4 h-4 animate-spin"})):w("",!0)]),t("span",null,d(e(p)("home.searchAgent.button.pinAgent")),1)],8,H1))]),_:2},1024),o(re,{class:"cursor-pointer",onClick:ge=>H(Y.id)},{default:i(()=>[L[1]||(L[1]=t("i",{class:"bi bi-link"},null,-1)),t("span",J1,d(e(p)("home.searchAgent.button.copyLink")),1)]),_:2,__:[1]},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),default:i(()=>[t("div",X1,[o(wt,{fallbackText:Y.name,size:"base","avatar-class":"m-auto mt-10"},null,8,["fallbackText"]),t("h1",Y1,[t("span",null,d(Y.name),1),Y.verified?(s(),u("i",Z1)):w("",!0)]),t("h2",ek,d(e(p)("home.searchAgent.label.hasCreated",{person:Y.owner.name})),1),t("h2",tk,d(Y.description),1),o($e,{onClick:ge=>F(Y.id),class:"mt-5 bg-stone-100 hover:bg-stone-200 text-black"},{default:i(()=>[L[2]||(L[2]=t("i",{class:"bi bi-chat mr-2"},null,-1)),me(" "+d(e(p)("home.searchAgent.button.newChat")),1)]),_:2,__:[2]},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),e(E)[fe.info.id]&&!e(N)[fe.info.id]&&e($)[fe.info.id]>=Do?(s(),u("div",sk,[o($e,{onClick:Y=>q(fe.info.id),class:"w-full sm:w-1/2 mt-10",variant:"outline"},{default:i(()=>[e(B)[fe.info.id]?(s(),T(Ge,{key:0,class:"w-5 h-5 animate-spin mr-2"})):w("",!0),t("span",ak,d(e(p)("home.searchAgent.button.seeMore")),1)]),_:2},1032,["onClick"])])):w("",!0)])],8,E1))),128))]))])}}}),nk={class:"flex flex-col h-dvh w-full bg-white dark:bg-stone-900"},lk={class:"flex-1 overflow-y-auto"},ik={class:"w-10/12 sm:w-8/12 m-auto"},rk={class:"z-5"},ck={class:"sm:text-center text-2xl sm:text-4xl font-semibold max-sm:mt-5 sm:mb-5"},dk={class:"sm:text-center text-sm/6 opacity-50 sm:w-3/4 sm:mx-auto"},uk={class:"sticky top-0 bg-white dark:bg-stone-900 py-2 z-10"},pk=oe({__name:"AllAgentsView",setup(n){const l=at(),{isMobileSize:a}=ie(l),{t:c}=Ce(),r=v(null),p=()=>{var m;(m=r.value)==null||m.scrollToCategory()};return(m,g)=>(s(),u("div",nk,[o(ks,{"show-language-option":!1,"show-create-agent-button":!0,"show-my-agent-button":!0,"is-show-create-new-chat":!1,"justify-content":e(a)?"justify-between":"justify-end"},null,8,["justify-content"]),t("div",lk,[t("div",ik,[t("div",rk,[t("h1",ck,d(e(c)("home.searchAgent.label.title")),1),t("h2",dk,d(e(c)("home.searchAgent.label.description")),1)]),t("div",uk,[o(C1),o(L1,{onSelectCategory:p})]),o(ok,{ref_key:"agentsMainRef",ref:r},null,512)])]),o(Ls,{class:"shrink-0"})]))}}),mk=oo("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-hidden focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",info:"border-transparent bg-blue-400 text-primary-foreground hover:bg-blue-400/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",warn:"border-transparent bg-yellow-400 text-primary-foreground hover:bg-yellow-400/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}}),wi=oe({__name:"Badge",props:{variant:{},class:{}},setup(n){const l=n;return(a,c)=>(s(),u("div",{class:pe(e(Me)(e(mk)({variant:a.variant}),l.class))},[we(a.$slots,"default")],2))}}),gk={class:"flex flex-col w-full h-dvh overflow-y-auto"},fk={class:"mx-auto w-10/12 sm:w-3/4 flex flex-col h-full"},vk={class:"mb-8 text-xl font-semibold md:text-2xl"},hk={class:"mb-4 flex flex-row space-x-4 max-sm:justify-between"},_k={class:"font-semibold text-sm"},bk={class:"text-xs opacity-50"},kk={key:0,class:"p-3 opacity-50 text-center text-sm"},yk={class:"pb-4"},xk=["onClick"],wk={class:"flex flex-row items-center gap-5 w-1/2 min-w-32 h-20"},$k={class:"flex gap-2 items-start w-full"},Sk={class:"text-sm font-semibold text-ellipsis overflow-hidden w-48 lg:w-[18rem] whitespace-wrap line-clamp-2"},Tk={key:1,class:"bi bi-patch-check-fill text-md text-blue-500 dark:text-blue-400 ml-1"},Ak={key:0},Ck={class:"whitespace-nowrap overflow-hidden text-ellipsis wrap-anywhere max-w-48 lg:max-w-[18rem] opacity-50 text-sm text-start truncate"},Dk={class:"whitespace-wrap wrap-anywhere max-w-[500px]"},Lk={key:0,class:"hidden min-[1200px]:flex flex-row w-32 items-center justify-start gap-2 opacity-50"},Ik={class:"text-xs"},Bk={key:1,class:"hidden min-[1200px]:flex flex-row w-32 items-center justify-start gap-2 opacity-50"},Mk={class:"text-xs"},Ek={class:"flex flex-row items-center gap-3"},Rk=["onClick"],Fk={class:"hover:bg-white dark:hover:bg-stone-900 w-6 h-6 sm:w-10 sm:h-10 rounded-lg flex items-center justify-center"},Pk={key:0,class:"w-full flex justify-center my-1"},Nk={key:0,class:"p-3 opacity-50 text-center text-sm"},zk={key:1,class:"pb-4"},Uk=["onClick"],Ok={class:"flex flex-row items-center gap-5 w-1/2 min-w-32 h-20"},jk={class:"text-sm font-semibold text-ellipsis overflow-hidden w-60 lg:w-[18rem] whitespace-wrap line-clamp-2"},Vk={key:0,class:"bi bi-patch-check-fill text-md text-blue-500 dark:text-blue-400 ml-1"},Gk={class:"whitespace-nowrap overflow-hidden wrap-anywhere text-ellipsis w-60 lg:w-[18rem] opacity-50 text-sm text-start truncate"},Wk={class:"whitespace-wrap max-w-[500px] wrap-anywhere"},Hk={class:"hidden text-xs min-[1200px]:flex w-48 items-center opacity-50 gap-1"},Kk={class:"whitespace-nowrap overflow-hidden text-ellipsis max-w-48 text-start truncate"},qk={class:"whitespace-wrap max-w-[500px]"},Qk={class:"flex flex-row items-center gap-3"},Jk=["onClick"],Xk={key:0,class:"w-full flex justify-center my-5"},ra=6,Yk=oe({__name:"MyAgentView",setup(n){const{toast:l}=gt(),{t:a}=Ce(),c=Gt(),r=qs(),p=at(),{currentAgent:m,currentAgentId:g,createdAgents:h,sharedAgents:_,loading:x,countAgentShared:b}=ie(c),{isMobileSize:S}=ie(p),{totalCreatedAgents:D}=ie(c),{getCreatedAgents:y,getSharedAgents:I,deleteAgent:C}=c,U=ot(),E=v("sharedByMeTab"),N=()=>{E.value="sharedByMeTab"},$=()=>{E.value="sharedWithMeTab"},R=v(0),B=v(0),j=async V=>{await C(V),await y({offset:0,limit:ra}),R.value=0},ee=V=>V.acl.users.length===1&&V.acl.groups===null&&V.acl.tenant===null,se=async()=>{const V={offset:R.value,limit:ra};x.value=!0;try{await y(V)}catch(F){console.error(F),l({title:a("editAgent.toast.fail.generalErrorTitle"),description:a("editAgent.toast.fail.generalError"),variant:"destructive"})}finally{x.value=!1}},G=async()=>{const V={offset:B.value,limit:ra};x.value=!0;try{await I(V)}catch(F){console.error(F),l({title:a("editAgent.toast.fail.generalErrorTitle"),description:a("editAgent.toast.fail.generalError"),variant:"destructive"})}finally{x.value=!1}},J=()=>{m.value=void 0,g.value=void 0,r.agentFiles=[],r.selectedFiles=[],U.push("/agents/editor/")},H=async V=>{r.selectedFiles=[],g.value=V,U.push(`/agents/editor/${V}`)},M=async(V,F)=>{if(g.value=V,F==="PUBLISH"){U.push(`/agent/${V}`);return}U.push(`/agents/editor/${V}`)},W=v(!1),X=async()=>{R.value+=ra,W.value=!0,await se(),W.value=!1},O=v(!1),K=async()=>{B.value+=ra,O.value=!0,await G(),O.value=!1};return Dt(async()=>{se(),G()}),(V,F)=>{const P=f("Separator"),q=f("TooltipTrigger"),A=f("TooltipContent"),k=f("Tooltip"),L=f("TooltipProvider"),z=f("Button"),Q=f("AlertDialogTrigger"),ae=f("AlertDialogTitle"),de=f("AlertDialogDescription"),le=f("AlertDialogHeader"),te=f("AlertDialogCancel"),Z=f("Loader"),re=f("AlertDialogAction"),ue=f("AlertDialogFooter"),he=f("AlertDialogContent"),$e=f("AlertDialog"),Se=f("Loader2");return s(),u("div",gk,[o(ks,{"show-language-option":!1,"choose-model-dropdown":!1,"is-show-create-new-chat":!1,"justify-content":e(S)?"justify-between":"justify-end"},null,8,["justify-content"]),t("div",fk,[t("h1",vk,d(e(a)("home.myAgent.label.title")),1),t("div",hk,[t("div",{onClick:N,class:pe(["border-b-2 pb-3 text-sm max-sm:w-full max-sm:text-center",E.value==="sharedByMeTab"?"border-b-black dark:border-b-stone-300":"cursor-pointer border-b-transparent opacity-50"])},d(e(a)("home.myAgent.label.createdByMe")),3),t("div",{onClick:$,class:pe(["border-b-2 pb-3 text-sm max-sm:w-full max-sm:text-center",E.value==="sharedWithMeTab"?"border-b-black dark:border-b-stone-300":"cursor-pointer border-b-transparent opacity-50"])},d(e(a)("home.myAgent.label.sharedWithMe")),3)]),E.value==="sharedByMeTab"?(s(),u(ve,{key:0},[t("div",{class:"h-20 flex flex-row items-center gap-5 p-3 hover:cursor-pointer hover:bg-accent hover:text-accent-foreground rounded-md",onClick:J},[F[1]||(F[1]=t("i",{class:"text-3xl bi bi-plus-circle-fill text-stone-300 dark:text-stone-500"},null,-1)),t("div",null,[t("div",_k,d(e(a)("home.myAgent.button.createAgent")),1),t("div",bk,d(e(a)("home.myAgent.label.createAgent")),1)])]),o(P),e(h).length===0?(s(),u("div",kk,d(e(a)("home.myAgent.label.noCreatedAgents")),1)):w("",!0),t("div",yk,[(s(!0),u(ve,null,Le(e(h),(be,Ge)=>(s(),u("div",{class:"group flex justify-between gap-3 px-3 hover:cursor-pointer hover:bg-accent hover:text-accent-foreground rounded-lg",onClick:fe=>M(be.id,be.status),key:Ge},[t("div",wk,[o(wt,{fallbackText:be.name,size:"sm"},null,8,["fallbackText"]),t("div",null,[t("div",$k,[t("div",Sk,[be.status==="DRAFT"?(s(),T(wi,{key:0,variant:"secondary",class:"mr-2 group-hover:border-black dark:group-hover:border-white"},{default:i(()=>[me(d(e(a)("home.myAgent.tooltip.draft")),1)]),_:1})):w("",!0),me(" "+d(be.name)+" ",1),be.verified?(s(),u("i",Tk)):w("",!0)])]),be.description?(s(),u("div",Ak,[o(L,null,{default:i(()=>[o(k,null,{default:i(()=>[o(q,null,{default:i(()=>[t("div",Ck,d(be.description),1)]),_:2},1024),o(A,null,{default:i(()=>[t("div",Dk,d(be.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)])):w("",!0)])]),ee(be)?(s(),u("div",Lk,[F[2]||(F[2]=t("i",{class:"bi bi-lock mr-3"},null,-1)),t("div",Ik,d(e(a)("home.myAgent.label.onlyMe")),1)])):(s(),u("div",Bk,[F[3]||(F[3]=t("i",{class:"bi bi-unlock mr-3"},null,-1)),t("div",Mk,d(e(a)("home.myAgent.label.shared")),1)])),t("div",Ek,[t("div",{class:"hover:bg-white dark:hover:bg-stone-900 w-6 h-6 sm:w-10 sm:h-10 rounded-lg flex items-center justify-center",onClick:Ye(fe=>H(be.id),["stop"])},[o(z,{variant:"ghost",size:"smicon",class:"hover:bg-white dark:hover:bg-stone-900"},{default:i(()=>F[4]||(F[4]=[t("i",{class:"bi bi-pencil"},null,-1)])),_:1,__:[4]})],8,Rk),t("div",{onClick:F[0]||(F[0]=Ye(()=>{},["stop"]))},[o($e,null,{default:i(()=>[o(Q,{class:"w-full"},{default:i(()=>[t("div",Fk,[o(z,{variant:"destructive",size:"smicon",class:"hover:bg-white dark:hover:bg-stone-900"},{default:i(()=>F[5]||(F[5]=[t("i",{class:"bi bi-trash"},null,-1)])),_:1,__:[5]})])]),_:1}),o(he,{class:"max-w-sm sm:max-w-lg rounded-md sm:rounded-lg"},{default:i(()=>[o(le,null,{default:i(()=>[o(ae,null,{default:i(()=>[me(d(e(a)("home.myAgent.dialog.deleteAgent.title")),1)]),_:1}),o(de,null,{default:i(()=>[me(d(e(a)("home.myAgent.dialog.deleteAgent.description")),1)]),_:1})]),_:1}),o(ue,null,{default:i(()=>[o(te,null,{default:i(()=>[me(d(e(a)("home.myAgent.button.cancel")),1)]),_:1}),o(re,{onClick:Ye(fe=>j(be.id),["stop"]),class:"bg-red-600 hover:bg-red-500"},{default:i(()=>[e(x)?(s(),T(Z,{key:0,class:"w-5 h-5 mr-3 animate-spin"})):w("",!0),me(" "+d(e(a)("home.myAgent.button.deleteAgent")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])])],8,xk))),128)),e(D)>e(h).length?(s(),u("div",Pk,[o(z,{onClick:X,class:"w-full sm:w-1/2 my-5 text-xs",variant:"outline"},{default:i(()=>[W.value?(s(),T(Se,{key:0,class:"w-4 h-4 animate-spin mr-2"})):w("",!0),t("span",null,d(e(a)("home.myAgent.button.seeMore")),1)]),_:1})])):w("",!0)])],64)):(s(),u(ve,{key:1},[e(_).length===0?(s(),u("div",Nk,d(e(a)("home.myAgent.label.noSharedAgents")),1)):(s(),u("div",zk,[(s(!0),u(ve,null,Le(e(_),(be,Ge)=>(s(),u("div",{class:"flex justify-between gap-3 py-3 px-0 sm:p-3 hover:cursor-pointer hover:bg-accent hover:text-accent-foreground rounded-lg",onClick:fe=>M(be.id,be.status),key:Ge},[t("div",Ok,[o(wt,{fallbackText:be.name,size:"sm",src:be.avatar},null,8,["fallbackText","src"]),t("div",null,[t("div",jk,[me(d(be.name)+" ",1),be.verified?(s(),u("i",Vk)):w("",!0)]),be.description?(s(),T(L,{key:0},{default:i(()=>[o(k,null,{default:i(()=>[o(q,null,{default:i(()=>[t("div",Gk,d(be.description),1)]),_:2},1024),o(A,null,{default:i(()=>[t("div",Wk,d(be.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)):w("",!0)])]),t("div",Hk,[o(L,null,{default:i(()=>[o(k,null,{default:i(()=>[o(q,null,{default:i(()=>[t("div",Kk,d(e(a)("home.myAgent.label.hasCreated",{person:be.owner.name})),1)]),_:2},1024),o(A,null,{default:i(()=>[t("div",qk,d(e(a)("home.myAgent.label.hasCreated",{person:be.owner.name})),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),F[6]||(F[6]=t("i",{class:"bi bi-person"},null,-1))]),t("div",Qk,[t("div",{class:"hover:bg-white dark:hover:bg-stone-900 w-6 h-6 sm:w-10 sm:h-10 rounded-lg flex items-center justify-center",onClick:Ye(fe=>H(be.id),["stop"])},[o(z,{variant:"ghost",size:"smicon",class:"hover:bg-white dark:hover:bg-stone-900"},{default:i(()=>F[7]||(F[7]=[t("i",{class:"bi bi-pencil"},null,-1)])),_:1,__:[7]})],8,Jk)])],8,Uk))),128)),e(b).length>=ra?(s(),u("div",Xk,[o(z,{onClick:K,class:"w-full sm:w-1/2 my-5 text-xs",variant:"outline"},{default:i(()=>[O.value?(s(),T(Se,{key:0,class:"w-4 h-4 animate-spin mr-2"})):w("",!0),t("span",null,d(e(a)("home.myAgent.button.seeMore")),1)]),_:1})])):w("",!0)]))],64))]),o(Ls)])}}}),Zk={key:0,class:"relative flex w-full h-dvh"},e0={class:"flex flex-col h-full w-full"},t0={class:"mx-auto flex flex-col h-full sm:px-6 md:px-8 lg:px-10 xl:px-12 w-full sm:max-w-md md:max-w-lg lg:max-w-xl xl:max-w-2xl"},s0={class:"flex justify-center items-center gap-2 opacity-50"},a0={class:"text-xs text-center"},o0={class:"flex flex-col flex-1 justify-center items-center w-full"},n0={class:"inline-block w-full max-w-xs sm:max-w-sm md:max-w-md lg:max-w-lg xl:max-w-xl text-wrap break-words text-center mb-8 font-bold text-2xl border-r-2 border-transparent overflow-hidden animate-typing",style:{animation:`typing 2s steps(31, end) forwards,
                                blink-caret 0.65s step-end infinite`}},l0={class:"w-full"},i0={key:1,class:"flex w-full h-full"},r0={class:"flex flex-col h-dvh w-full"},c0={class:"mx-auto flex flex-col w-full h-full justify-center gap-4 text-base md:gap-5 lg:gap-6 md:max-w-lg lg:max-w-160 xl:max-w-3xl px-5"},d0={class:"flex flex-col justify-center items-center"},u0={class:"inline-block whitespace-nowrap mb-8 font-bold text-2xl border-r-2 border-transparent overflow-hidden w-min text-center animate-typing"},p0={class:"w-full"},m0={class:"text-xs text-center opacity-50"},g0=oe({__name:"HomeView",setup(n){const l=ms(),{currentConversation:a}=ie(l),c=at(),{isMobileSize:r}=ie(c),{t:p}=Ce(),m=ot();ne(()=>[p("home.chat.button.rcm1"),p("home.chat.button.rcm2"),p("home.chat.button.rcm3")]);const g=v(null),h=()=>{l.unshiftConversation(""),m.push({path:"/chat/"});const _=Te(()=>{var x;return(x=a.value)==null?void 0:x.id},x=>{x&&x!==""&&(m.replace({path:`/chat/${x}`}),_())})};return(_,x)=>e(r)?(s(),u("div",Zk,[t("div",e0,[o(ks),t("div",t0,[t("div",s0,[x[0]||(x[0]=t("i",{class:"bi bi-exclamation-circle text-xs"},null,-1)),t("p",a0,d(e(p)("home.chat.label.description",{ai:"PrivateGPT"})),1)]),t("div",o0,[t("p",n0,d(e(p)("home.chat.label.greeting")),1),x[1]||(x[1]=t("div",{class:"flex flex-wrap justify-center gap-2 mb-4 md:mb-0 max-w-xs sm:max-w-sm md:max-w-md"},null,-1))]),t("div",l0,[o(Ya,{ref_key:"messageInputRef",ref:g,onHandleMessage:h},null,512)])])]),o(Ls)])):(s(),u("div",i0,[t("div",r0,[o(ks),t("div",c0,[t("div",d0,[t("p",u0,d(e(p)("home.chat.label.greeting")),1),t("div",p0,[o(Ya,{ref_key:"messageInputRef",ref:g,onHandleMessage:h},null,512),t("p",m0,d(e(p)("home.chat.label.description",{ai:"PrivateGPT"})),1)])])])]),o(Ls)]))}}),f0=Vs(g0,[["__scopeId","data-v-468c5d0e"]]),v0=n=>({id:n.id,createdAt:new Date(n.created_at),updatedAt:new Date(n.updated_at),createdBy:n.created_by,updatedBy:n.updated_by,name:n.name}),h0=n=>({id:n.id,createdAt:new Date(n.created_at),updatedAt:new Date(n.updated_at),createdBy:n.created_by,updatedBy:n.updated_by,name:n.name,memberNum:n.member_num,currentUserInfo:{id:n.current_user_info.id,groupRole:n.current_user_info.group_role}}),_0=n=>({id:n.id,name:n.name,email:n.email}),b0=n=>({id:n.id,createdAt:new Date(n.created_at),updatedAt:new Date(n.updated_at),createdBy:n.created_by,updatedBy:n.updated_by,name:n.name,description:n.description,avatar:n.avatar,owner:n.owner,status:n.status,verified:n.verified}),ys=Ft("groupStore",()=>{const n=v(null),l=v(""),a=v([]),c=v(""),r=v(""),p=v(0),m=28,g=v([]),h=v([]),_=v(""),x=v(""),b=v(),S=v({}),D=v(""),y=v(!1),I=v([]),C=v(""),U=v(!1),E=async F=>{try{y.value=!0;const{data:P}=await it.get("/groups",{params:F}),q=P.items.map(v0);return F.offset===0?a.value=q:a.value=[...a.value,...q],{items:q,total:q.length}}catch(P){console.error("Error fetching group data:",P)}finally{y.value=!1}},N=async F=>{const{data:P}=await it.get(`/groups/${F}`),q=h0(P);return S.value[F]=q.currentUserInfo.groupRole,D.value=q.currentUserInfo.id,C.value=q.name,q},$=F=>{a.value=[...a.value,F]},R=async()=>{const P=(await it.post("/groups",{name:c.value,description:r.value})).data;a.value.unshift(P),l.value=P.id,await E({group_name:"",offset:p.value,limit:m})},B=async F=>{try{const{data:P}=await it.get("/users",{params:F});g.value=P.map(_0)}catch(P){console.error("Error fetching user data:",P)}},j=v(""),ee=v(0),se=v(0),G=async F=>{const{data:P}=await it.get(`/groups/${F.group_id}/members`,{params:F});return h.value=P.items,se.value=P.total,ee.value=P.offset,P},J=async(F,P)=>{try{const q=P.map(A=>({email:A.email.toLowerCase(),role:"MEMBER"}));y.value=!0,await it.post(`groups/${F}/members`,q),await G({group_id:F,offset:0,limit:20})}catch(q){console.error("Error adding members:",q)}finally{y.value=!1}},H=async F=>{await it.put(`groups/${F}`,{name:_.value,description:""}),await N(F)},M=async F=>{a.value=a.value.filter(P=>P.id!==F),await it.delete(`groups/${F}`)},W=async F=>{await it.put(`groups/${F}/leave`)},X=async(F,P,q)=>{await it.put(`groups/${F}/members`,{id:P,role:q})},O=async(F,P,q)=>{await it.delete(`/groups/${F}/members`,{data:{id:P,role:q}}),await G({group_id:F,email:"",offset:ee.value,limit:10})},K=v([]);return{activeGroupId:n,newestGroupId:l,currentOffset:p,limit:m,groups:a,groupName:c,groupDescription:r,users:g,memberDataTable:h,newGroupName:_,memberId:x,role:b,getAllGroupData:E,addGroup:$,createNewGroup:R,getUserData:B,groupDataById:N,addMemberToGroupById:J,getGroupDataTableMember:G,updateGroupNameById:H,deleteGroupById:M,leaveGroupById:W,changeGroupMemberRole:X,removeMemberFromGroup:O,agentsInGroup:I,getGroupAgentById:async F=>{const{data:P}=await it.get(`/groups/${F.group_id}/agents`,{params:F}),q=P.items.map(b0);F.offset===0?I.value=[...q]:I.value.push(...q),K.value=q},currentUserGroupRoleInGroup:S,currentUserIdInGroup:D,currentGroupNameById:C,loading:y,totalMember:se,countAgent:K,currentDataTableOffset:ee,searchQuery:j,isScrolled:U}}),$i=oe({__name:"Input",props:{defaultValue:{},modelValue:{},class:{},autoSelect:{type:Boolean}},emits:["update:modelValue"],setup(n,{emit:l}){const a=n,r=Lr(a,"modelValue",l,{passive:!0,defaultValue:a.defaultValue}),p=m=>{a.autoSelect&&m.target.select()};return(m,g)=>Ke((s(),u("input",{onFocus:p,"onUpdate:modelValue":g[0]||(g[0]=h=>kt(r)?r.value=h:null),class:pe(e(Me)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-hidden focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a.class))},null,34)),[[Oo,e(r)]])}}),k0={class:"flex gap-3"},y0={class:"w-full"},x0={key:0,class:"text-red-500 mt-2 text-sm font-semibold"},w0=oe({__name:"CreateGroupDialog",setup(n){const{t:l}=Ce(),a=ys(),{createNewGroup:c}=a,{groupName:r,activeGroupId:p,newestGroupId:m}=ie(a),g=tt(),h=ot(),_=v(!1),x=v(!1),D=Ho({groupName:{required:Ko}},{groupName:r},{$scope:!1}),y=v(!1),I=()=>{y.value=!1},C=v(!1),U=async()=>{if(await D.value.$validate()&&!x.value&&!C.value){C.value=!0,x.value=!0;try{if(await c(),m.value){p.value=m.value;const $=g.name||"group-agents";h.push({name:$,params:{id:m.value}})}_.value=!1}catch($){console.error("Error creating new group:",$),Ue({title:l("group.toast.fail.createGroupFail"),description:l("group.toast.fail.somethingWentWrong"),variant:"destructive"})}finally{C.value=!1}}else y.value=!0},E=()=>{x.value=!1,I(),_.value=!0,r.value=""};return Te(r,N=>{N&&(y.value=!1)}),(N,$)=>{const R=f("TooltipContent"),B=f("Tooltip"),j=f("DialogTitle"),ee=f("DialogHeader"),se=f("DialogClose"),G=f("Loader"),J=f("DialogFooter"),H=f("DialogContent"),M=f("Dialog");return s(),T(M,{open:_.value,"onUpdate:open":$[2]||($[2]=W=>_.value=W)},{default:i(()=>[o(en,null,{default:i(()=>[o(B,null,{default:i(()=>[o(tn,null,{default:i(()=>[o(e(ts),{class:"flex w-10 h-10 bg-stone-900 text-white hover:bg-stone-800 hover:text-white dark:bg-stone-500 dark:hover:bg-stone-400 cursor-pointer rounded-full",onClick:E},{default:i(()=>$[3]||($[3]=[t("i",{class:"bi bi-plus-lg"},null,-1)])),_:1,__:[3]})]),_:1}),o(R,{class:"z-50"},{default:i(()=>[t("div",null,d(e(l)("group.tooltip.createNewGroup")),1)]),_:1})]),_:1})]),_:1}),o(H,{class:"max-w-sm rounded-md sm:rounded-lg sm:max-w-[425px]"},{default:i(()=>[t("div",k0,[o(ee,null,{default:i(()=>[o(j,null,{default:i(()=>[me(d(e(l)("group.dialog.createGroupDialogHeader")),1)]),_:1})]),_:1})]),t("div",y0,[o(e($i),{disabled:x.value||C.value,onKeyup:yt(U,["enter"]),modelValue:e(r),"onUpdate:modelValue":$[0]||($[0]=W=>kt(r)?r.value=W:null),id:"name",placeholder:e(l)("group.dialog.createGroupNamePlaceholder"),class:pe(["col-span-3 focus-visible:ring-offset-0",y.value?"focus-visible:ring-red-600":null])},null,8,["disabled","modelValue","placeholder","class"]),y.value?(s(),u("p",x0,d(e(l)("group.dialog.createGroupNameEmpty")),1)):w("",!0)]),o(J,{class:"gap-2"},{default:i(()=>[o(se,{"as-child":""},{default:i(()=>[o(e(ts),{onClick:$[1]||($[1]=W=>_.value=!1),type:"button",variant:"outline",class:"rounded-full"},{default:i(()=>[me(d(e(l)("group.button.cancel")),1)]),_:1})]),_:1}),o(e(ts),{disabled:e(D).groupName.$invalid||x.value||C.value,type:"button",class:"rounded-full",onClick:U},{default:i(()=>[x.value?(s(),T(G,{key:0,class:"w-5 h-5 mr-3 animate-spin"})):w("",!0),me(" "+d(e(l)("group.dialog.createGroupButtonLabel")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])}}}),$0=["onClick"],S0={class:"group-with-avatar flex items-center gap-4"},T0={class:"text-start text-xs line-clamp-2 wrap-anywhere whitespace-nowrap overflow-hidden text-ellipsis max-w-[190px]"},A0={class:"text-sm text-stone-600 wrap-anywhere line-clamp-3"},C0={key:0,class:"flex items-center gap-2 p-2"},D0=oe({__name:"GroupSidebarMainGroups",setup(n){const l=tt(),a=ot(),c=ys(),{limit:r,getAllGroupData:p}=c,{currentOffset:m,groups:g,activeGroupId:h,newGroupName:_,loading:x}=ie(c),b=v(!1),S=()=>b.value=!1,D=E=>{h.value=E;const N=l.name||"group-agents";a.push({name:N,params:{id:E}})},y=Bt("groupContainer"),{arrivedState:I}=Wo(y),C=v(!0),U=async()=>{if(!(x.value||!C.value))try{const E={offset:m.value,limit:r},N=await p(E);N!=null&&N.total&&N.total<m.value&&(C.value=!1),m.value+=r}catch(E){console.error("Error loading more data, ",E)}};return Te(()=>I.bottom,E=>{E&&U()}),Vt(async()=>{await p({offset:m.value,limit:r}),m.value+=r,l.params.id&&(h.value=l.params.id),g.value.length>0&&!l.params.id&&(h.value=g.value[0].id,a.push(`/groups/${h.value}/agents`))}),Te(()=>_.value,E=>{E&&S()}),ls(()=>{m.value=0}),(E,N)=>{const $=f("TooltipTrigger"),R=f("TooltipContent"),B=f("Tooltip"),j=f("TooltipProvider"),ee=f("Skeleton");return s(),u("div",{class:"group-list flex flex-col gap-1 p-2 overflow-y-auto",ref_key:"groupContainer",ref:y},[(s(!0),u(ve,null,Le(e(g),se=>(s(),u("div",{key:se.id,class:pe(["px-2.5 py-1.5 rounded-lg flex gap-4 w-full hover:bg-stone-200 dark:hover:bg-stone-700 items-center justify-between cursor-pointer",e(h)===se.id?"bg-stone-200 dark:bg-stone-700":""]),onClick:G=>D(se.id)},[t("div",S0,[o(wt,{fallbackText:se.name,size:"xs"},null,8,["fallbackText"]),o(j,null,{default:i(()=>[o(B,null,{default:i(()=>[o($,{"as-child":""},{default:i(()=>[t("span",T0,d(se.name),1)]),_:2},1024),o(R,{class:"m-auto max-w-xs p-2 bg-white text-left ml-2"},{default:i(()=>[t("span",A0,d(se.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)])],10,$0))),128)),e(x)?(s(),u("div",C0,[o(ee,{class:"h-7 w-7 rounded-full"}),o(ee,{class:"h-6 w-[180px]"})])):w("",!0)],512)}}}),L0={class:"bg-stone-50 dark:bg-stone-800 flex flex-col p-4 z-44 transition-shadow"},I0={class:"text-xs"},B0={class:"flex gap-4 w-full justify-between items-center mt-6"},M0={class:"text-xl font-bold"},Yn=oe({__name:"GroupSidebar",setup(n){const{t:l}=Ce(),a=ot(),c=xt(),{privateGPTSidebarState:r}=ie(c),p=()=>a.push("/");return(m,g)=>{const h=f("Button");return s(),u("div",{class:pe(["bg-stone-50 dark:bg-stone-800 flex-none h-lvh flex flex-col transition-all duration-300",{"w-72":e(r),"w-0":!e(r)}])},[t("div",L0,[o(h,{class:"bg-white hover:bg-stone-100 dark:bg-stone-700 dark:hover:bg-stone-600 rounded-md",variant:"outline",size:"full",onClick:p},{default:i(()=>[g[0]||(g[0]=t("i",{class:"bi bi-chevron-left"},null,-1)),t("span",I0,d(e(l)("group.button.backToChat")),1)]),_:1,__:[0]}),t("div",B0,[t("p",M0,d(e(l)("group.sidebar.groupLabel")),1),o(w0)])]),o(D0)],2)}}}),E0={class:"sticky top-0 right-0 bg-white dark:bg-stone-900 z-20 p-3 w-full flex justify-center sm:justify-end gap-10"},R0={class:"text-xs"},F0={class:"text-xs"},P0={class:"text-xs"},N0=oe({__name:"GroupTabs",setup(n){const{t:l}=Ce(),a=ot(),c=tt(),r=ne(()=>c.name||"group-agents"),p=m=>{a.push({name:m,params:{id:c.params.id}})};return(m,g)=>{const h=f("TabsTrigger"),_=f("TabsList"),x=f("Tabs");return s(),u("div",E0,[o(x,{"default-value":r.value,class:"bg-transparent"},{default:i(()=>[o(_,{class:"p-0 bg-transparent"},{default:i(()=>[o(h,{value:"group-agents",class:"p-2 py-4 w-32 sm:w-40 rounded-xl dark:data-[state=active]:bg-stone-800 data-[state=active]:bg-stone-100 data-[state=active]:shadow-none hover:text-black dark:hover:text-white",onClick:g[0]||(g[0]=b=>p("group-agents"))},{default:i(()=>[g[3]||(g[3]=t("div",null,[t("i",{class:"bi bi-box-fill text-xl"})],-1)),t("span",R0,d(e(l)("group.myAgentsTab.tabLabel")),1)]),_:1,__:[3]}),o(h,{value:"group-member",class:"p-2 py-4 w-32 sm:w-40 rounded-xl dark:data-[state=active]:bg-stone-800 data-[state=active]:bg-stone-100 data-[state=active]:shadow-none hover:text-black dark:hover:text-white",onClick:g[1]||(g[1]=b=>p("group-member"))},{default:i(()=>[g[4]||(g[4]=t("div",null,[t("i",{class:"bi bi-people-fill text-xl"})],-1)),t("span",F0,d(e(l)("group.membersTab.tabLabel")),1)]),_:1,__:[4]}),o(h,{value:"group-setting",class:"p-2 py-4 w-32 sm:w-40 rounded-xl dark:data-[state=active]:bg-stone-800 data-[state=active]:bg-stone-100 data-[state=active]:shadow-none hover:text-black dark:hover:text-white",onClick:g[2]||(g[2]=b=>p("group-setting"))},{default:i(()=>[g[5]||(g[5]=t("div",null,[t("i",{class:"bi bi-gear-fill text-xl"})],-1)),t("span",P0,d(e(l)("group.settingsTab.tabLabel")),1)]),_:1,__:[5]})]),_:1})]),_:1},8,["default-value"])])}}}),z0={class:"w-full h-full overflow-y-auto"},Zn=oe({__name:"GroupViewMain",setup(n){const l=at(),{isMobileSize:a}=ie(l);return(c,r)=>{const p=f("RouterView");return s(),u("div",z0,[e(a)?(s(),T(ks,{key:0,"is-show-create-new-chat":!1,"is-group-view":!0})):w("",!0),o(N0),o(p)])}}}),U0={key:0,class:"relative flex h-full overflow-hidden"},O0={class:"absolute top-0 left-0 flex z-50 overflow-hidden"},j0={class:"w-full h-dvh flex flex-col justify-center"},V0={key:0,class:"h-full flex flex-col"},G0={class:"flex-1 flex items-center justify-center"},W0={class:"text-3xl font-semibold opacity-20 text-center"},H0={key:1,class:"flex h-full overflow-hidden"},K0={class:"w-full h-dvh flex flex-col justify-center"},q0={key:0,class:"text-3xl font-semibold opacity-20 text-center"},Q0=oe({__name:"GroupView",setup(n){const{t:l}=Ce(),a=ys(),{groups:c}=ie(a),r=at(),p=xt(),{isMobileSize:m}=ie(r),{mobileSidebarState:g}=ie(p),h=()=>{g.value=!1};return(_,x)=>e(m)?(s(),u("div",U0,[t("div",O0,[o(Yn)]),t("div",{class:pe(["backdrop-blur-2xs fixed z-49 top-0 left-0 inset-0 bg-black/80 dark:bg-stone-950/80",e(g)?"":"hidden"]),onClick:h},null,2),t("div",j0,[e(c).length?(s(),T(Zn,{key:1})):(s(),u("div",V0,[e(m)?(s(),T(ks,{key:0,"is-show-create-new-chat":!1,"is-group-view":!0})):w("",!0),t("div",G0,[t("p",W0,d(e(l)("group.unavailableMessage.noGroupMessage")),1)])])),o(Ls)])])):(s(),u("div",H0,[o(Yn),t("div",K0,[e(c).length?(s(),T(Zn,{key:1})):(s(),u("p",q0,d(e(l)("group.unavailableMessage.noGroupMessage")),1)),o(Ls)])]))}}),J0={class:"py-5"},X0={key:0,class:"main-title"},Y0={class:"font-semibold text-md line-clamp-1"},Z0={key:0,class:"grid grid-cols-1 gap-x-1.5 gap-y-1 md:gap-x-2 md:gap-y-1.5 lg:grid-cols-2 lg:gap-x-3 lg:gap-y-2.5 mt-5"},ey={class:"h-[104px] hover:bg-stone-100 dark:hover:bg-stone-800 rounded-xl p-0 py-1 sm:p-4 cursor-pointer flex gap-4 transition duration-200 ease-in-out items-center"},ty={class:"flex items-center justify-center font-bold text-md w-8 h-8 rounded-full"},sy={class:"flex flex-col gap-1 w-full"},ay={class:"font-semibold text-sm line-clamp-1 whitespace-wrap overflow-hidden text-ellipsis max-w-full"},oy={class:"text-sm line-clamp-2 opacity-40 whitespace-wrap overflow-hidden text-ellipsis max-w-[90%]"},ny={class:"text-sm text-stone-600"},ly={class:"text-sm text-left text-stone-400"},iy={key:0,class:"bi bi-patch-check-fill text-2xl text-blue-500 dark:text-blue-400 ml-3"},ry=["onClick"],cy={key:0,class:"bi bi-pin mr-2"},dy=["onClick"],uy={key:0,class:"bi bi-eye-slash mr-2"},py={class:"text-sm"},my={class:"flex flex-col items-center justify-center pb-5"},gy={class:"font-semibold text-md my-5"},fy={key:0,class:"bi bi-patch-check-fill text-md text-blue-500 dark:text-blue-400 ml-1"},vy={class:"text-sm opacity-40"},hy={class:"text-sm text-center opacity-40"},_y={key:1,class:"grid grid-cols-1 gap-x-1.5 gap-y-1 md:gap-x-2 md:gap-y-1.5 lg:grid-cols-2 lg:gap-x-3 lg:gap-y-2.5 mt-5"},by={class:"flex flex-col gap-3"},ky={key:2,class:"flex flex-col items-center justify-center h-48 text-stone-500"},yy={class:"text-xl sm:text-2xl font-semibold opacity-50 mt-2"},xy={key:3,class:"w-full flex justify-center mt-8"},Lo=6,wy=oe({__name:"GroupGPTViewBelowContent",setup(n){const l=Gt(),{currentAgentId:a,pinAgents:c}=ie(l),{getAgentById:r,pinAgent:p,unpinAgent:m,getPinAgents:g}=l,h=ot(),{t:_}=Ce(),x=tt(),b=ys(),{getGroupAgentById:S,groupDataById:D}=b,{agentsInGroup:y,currentGroupNameById:I,groups:C,countAgent:U}=ie(b),E=v(!1),N=v(!1),$=v(0),R=v(!1),{protocol:B,host:j}=window.location,ee=v(`${B}//${j}`),se=async O=>{try{await navigator.clipboard.writeText(`${ee.value}/agent/${O}`),Ue({title:_("group.toast.success.linkCopy")}),R.value=!0,setTimeout(()=>R.value=!1,2e3)}catch(K){console.error(K),Ue({title:_("group.toast.fail.generalErrorTitle"),description:_("group.toast.fail.somethingWentWrong"),variant:"destructive"})}},G=async()=>{const O=x.params.id,K={group_id:O,offset:$.value,limit:Lo};if(O){N.value=!0;try{await S(K)}catch(V){console.error(V),Ue({title:_("group.toast.fail.generalErrorTitle"),description:_("group.toast.fail.somethingWentWrong"),variant:"destructive"})}finally{N.value=!1}}},J=async()=>{$.value+=Lo,await G()};Te(()=>x.params.id,async O=>{O&&await D(x.params.id)},{immediate:!0}),Dt(async()=>{await G()}),Te(()=>x.params.id,async O=>{$.value=0,y.value=[],!(!O||!C.value.some(K=>K.id===O))&&await G()});const H=async O=>{try{E.value=!0,await p(O),await g(),Ue({title:_("group.toast.success.pinAgent")})}catch(K){console.error(K),Ue({title:_("group.toast.fail.generalErrorTitle"),description:_("group.toast.fail.somethingWentWrong"),variant:"destructive"})}finally{E.value=!1}},M=O=>Array.isArray(c.value)&&c.value.some(K=>K.id===O),W=async O=>{try{E.value=!0,await m(O),await g(),Ue({title:_("group.toast.success.unpinAgent")})}catch(K){console.error(K),Ue({title:_("group.toast.fail.generalErrorTitle"),description:_("group.toast.fail.somethingWentWrong"),variant:"destructive"})}finally{E.value=!1}},X=async O=>{h.push(`/agent/${O}`),a.value=O,await r(O)};return(O,K)=>{const V=f("TooltipTrigger"),F=f("TooltipContent"),P=f("Tooltip"),q=f("TooltipProvider"),A=f("DialogTrigger"),k=f("DropdownMenuTrigger"),L=f("Loader"),z=f("DropdownMenuItem"),Q=f("DropdownMenuContent"),ae=f("DropdownMenu"),de=f("Button"),le=f("DialogContent"),te=f("Dialog"),Z=f("Skeleton");return s(),u("div",J0,[e(y).length>0?(s(),u("div",X0,[t("h1",Y0,d(e(_)("group.myAgentsTab.groupAgentFavoriteTitle",{groupName:e(I)})),1)])):w("",!0),t("div",null,[e(y).length>0?(s(),u("div",Z0,[(s(!0),u(ve,null,Le(e(y),(re,ue)=>(s(),T(te,{key:re.id},{default:i(()=>[o(A,{"as-child":""},{default:i(()=>[t("div",ey,[t("div",ty,d(ue+1),1),o(wt,{fallbackText:re.name,size:"base"},null,8,["fallbackText"]),t("div",sy,[t("h1",ay,d(re.name),1),o(q,null,{default:i(()=>[o(P,null,{default:i(()=>[o(V,{"as-child":""},{default:i(()=>[t("h3",oy,d(re.description),1)]),_:2},1024),o(F,{class:"m-auto max-w-xs p-2 bg-white text-left"},{default:i(()=>[t("h3",ny,d(re.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),t("h3",ly,d(re.owner.name)+" "+d(e(_)("group.myAgentsTab.searchQueryDialog.creatorLabel")),1)]),re.verified?(s(),u("i",iy)):w("",!0)])]),_:2},1024),o(le,{class:"w-full max-w-sm sm:max-w-lg rounded-md sm:rounded-lg"},{"extra-button":i(()=>[o(ae,null,{default:i(()=>[o(k,null,{default:i(()=>K[0]||(K[0]=[t("div",null,[t("i",{class:"bi bi-three-dots cursor-pointer"})],-1)])),_:1,__:[0]}),o(Q,null,{default:i(()=>[o(z,{class:"cursor-pointer"},{default:i(()=>[M(re.id)?(s(),u("div",{key:1,variant:"ghost",onClick:he=>W(re.id),class:"p-0 m-0 flex items-center mr-2"},[t("div",null,[E.value?w("",!0):(s(),u("i",uy)),E.value?(s(),T(L,{key:1,class:"w-4 h-4 animate-spin mr-2"})):w("",!0)]),t("span",null,d(e(_)("group.myAgentsTab.myAgentDialog.unpinButtonTitle")),1)],8,dy)):(s(),u("div",{key:0,variant:"ghost",onClick:he=>H(re.id),class:"p-0 m-0 flex items-center mr-2"},[t("div",null,[E.value?w("",!0):(s(),u("i",cy)),E.value?(s(),T(L,{key:1,class:"w-4 h-4 animate-spin mr-2"})):w("",!0)]),t("span",null,d(e(_)("group.myAgentsTab.myAgentDialog.pinButtonTitle")),1)],8,ry))]),_:2},1024),o(z,{class:"cursor-pointer",onClick:he=>se(re.id)},{default:i(()=>[K[1]||(K[1]=t("i",{class:"bi bi-link"},null,-1)),t("span",py,d(e(_)("group.myAgentsTab.myAgentDialog.copyButtonTitle")),1)]),_:2,__:[1]},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),default:i(()=>[t("div",my,[o(wt,{fallbackText:re.name,size:"base",avatarClass:"m-auto mt-10"},null,8,["fallbackText"]),t("h1",gy,[me(d(re.name)+" ",1),re.verified?(s(),u("i",fy)):w("",!0)]),t("h2",vy,d(e(_)("group.myAgentsTab.myAgentDialog.creatorLabel",{userName:re.owner.name})),1),t("h2",hy,d(re.description),1),o(de,{onClick:he=>X(re.id),class:"mt-5 bg-stone-100 hover:bg-stone-200 text-black px-4"},{default:i(()=>[K[2]||(K[2]=t("i",{class:"bi bi-chat mr-2"},null,-1)),me(" "+d(e(_)("group.myAgentsTab.myAgentDialog.startChattingButtonTitle")),1)]),_:2,__:[2]},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))])):w("",!0),N.value?(s(),u("div",_y,[(s(),u(ve,null,Le(6,re=>t("div",{key:re,class:"flex items-center gap-4 p-4"},[o(Z,{class:"h-16 w-16 rounded-full"}),t("div",by,[o(Z,{class:"h-4 w-[250px]"}),o(Z,{class:"h-4 w-[100px]"}),o(Z,{class:"h-4 w-[200px]"})])])),64))])):e(y).length===0?(s(),u("div",ky,[t("p",yy,d(e(_)("group.unavailableMessage.noAgentMessage")),1)])):w("",!0),e(U).length>=Lo?(s(),u("div",xy,[o(de,{onClick:J,class:"w-1/2",variant:"outline"},{default:i(()=>[me(d(e(_)("group.button.seeMore")),1)]),_:1})])):w("",!0)])])}}}),$y=oe({__name:"GroupGPTTabs",setup(n){const{t:l}=Ce();return(a,c)=>{const r=f("TabsTrigger"),p=f("TabsList"),m=f("Tabs");return s(),u("div",null,[o(m,{"default-value":"top-picks",class:"relative mr-auto w-full"},{default:i(()=>[o(p,{class:"w-fit justify-start rounded-none border-b bg-transparent p-0"},{default:i(()=>[o(r,{value:"top-picks",class:"relative rounded-none border-b-2 border-b-transparent dark:bg-transparent px-4 pb-3 pt-2 text-muted-foreground shadow-none transition-all focus-visible:ring-0 data-[state=active]:border-b-primary data-[state=active]:text-foreground data-[state=active]:shadow-none"},{default:i(()=>[me(d(e(l)("group.myAgentsTab.tabTitle")),1)]),_:1})]),_:1})]),_:1})])}}}),Sy={class:"search-bar min-w-32 relative"},Ty={key:0,class:"absolute mt-1 bg-white dark:bg-stone-800 dark:hover:bg-stone-900 rounded-md shadow-lg z-50 w-full p-1"},Ay=["onClick"],Cy={class:"font-semibold xl:text-md sm:text-sm line-clamp-1 whitespace-wrap overflow-hidden text-ellipsis max-w-full"},Dy={key:0,class:"bi bi-patch-check-fill text-md text-blue-500 dark:text-blue-400 ml-1"},Ly={class:"sm:text-sm line-clamp-1 opacity-40 whitespace-wrap overflow-hidden w-full"},Iy={class:"text-sm text-left text-stone-500 line-clamp-2 whitespace-wrap overflow-hidden text-ellipsis max-w-[90%]"},By={key:1,class:"backdrop-blur-2xs fixed inset-0 bg-black/80 dark:bg-stone-950/80 flex items-center justify-center z-50"},My={class:"top-dialog-buttons flex items-center justify-end gap-3"},Ey={key:0,class:"bi bi-pin mr-2"},Ry={key:0,class:"bi bi-eye-slash mr-2"},Fy={class:"text-sm"},Py={class:"flex flex-col items-center justify-center pb-5"},Ny={class:"font-semibold text-md text-center my-5"},zy={key:0,class:"bi bi-patch-check-fill text-md text-blue-500 dark:text-blue-400 ml-1"},Uy={class:"text-sm opacity-40"},Oy={class:"text-sm text-center opacity-40"},jy=oe({__name:"SearchAgentInGroup",setup(n){const l=Gt(),{pinAgent:a,unpinAgent:c,getPinAgents:r}=l,p=ys(),{agentsInGroup:m}=ie(p),g=v(""),h=v(!1),_=v(!1),x=v(null),b=v(null),S=v(null),D=v(!1),{t:y}=Ce(),I=ot(),C=ne(()=>g.value?m.value.filter(M=>M.name.toLowerCase().includes(g.value.toLowerCase())):[]);Vt(async()=>{document.addEventListener("click",E),document.addEventListener("click",N)}),ls(()=>{document.removeEventListener("click",E),document.removeEventListener("click",N)});const U=(M,W)=>{W.stopPropagation(),x.value=M,h.value=!0},E=M=>{b.value&&!b.value.contains(M.target)&&(_.value=!1)},N=M=>{h.value&&S.value&&!S.value.contains(M.target)&&(h.value=!1)},$=async M=>{try{D.value=!0,await a(M),await r(),Ue({title:y("group.toast.success.pinAgent")})}catch{Ue({title:y("group.toast.fail.generalErrorTitle"),description:y("group.toast.fail.somethingWentWrong"),variant:"destructive"})}finally{D.value=!1}},R=M=>{const{pinAgents:W}=ie(l);return W.value.some(X=>X.id===M)},B=async M=>{try{D.value=!0,await c(M),await r(),Ue({title:y("group.toast.success.unpinAgent")})}catch{Ue({title:y("group.toast.fail.generalErrorTitle"),description:y("group.toast.fail.somethingWentWrong"),variant:"destructive"})}finally{D.value=!1}},j=async M=>{I.push(`/agent/${M}`)},ee=v(!1),{protocol:se,host:G}=window.location,J=v(`${se}//${G}`),H=async M=>{try{await navigator.clipboard.writeText(`${J.value}/agent/${M}`),Ue({title:y("group.toast.success.linkCopy")}),ee.value=!0,setTimeout(()=>ee.value=!1,2e3)}catch{Ue({title:y("group.toast.fail.generalErrorTitle"),description:y("group.toast.fail.somethingWentWrong"),variant:"destructive"})}};return(M,W)=>{var A,k,L,z,Q;const X=f("Input"),O=f("DropdownMenuTrigger"),K=f("Loader"),V=f("DropdownMenuItem"),F=f("DropdownMenuContent"),P=f("DropdownMenu"),q=f("Button");return s(),u("div",{class:"my-4 relative",ref_key:"dropdownRef",ref:b},[t("div",Sy,[W[7]||(W[7]=t("i",{class:"bi bi-search absolute left-3 top-2"},null,-1)),o(X,{id:"search-agent-input",modelValue:g.value,"onUpdate:modelValue":W[0]||(W[0]=ae=>g.value=ae),type:"text",placeholder:e(y)("group.myAgentsTab.searchAgentPlaceholder"),class:"w-full pl-9 pr-4 py-2 border rounded-md shadow-xs focus:outline-hidden focus:ring-2 focus:ring-blue-400",onFocus:W[1]||(W[1]=ae=>_.value=!0)},null,8,["modelValue","placeholder"])]),_.value&&C.value.length>0?(s(),u("div",Ty,[t("ul",null,[(s(!0),u(ve,null,Le(C.value,ae=>(s(),u("li",{key:ae.id,onClick:de=>{U(ae,de),_.value=!1},class:"h-[104px] px-4 py-2 flex items-center gap-5 hover:bg-stone-100 dark:bg-stone-800 dark:hover:bg-stone-700 cursor-pointer"},[o(wt,{fallbackText:ae.name,size:"base"},null,8,["fallbackText"]),t("div",null,[t("h1",Cy,[me(d(ae.name)+" ",1),ae.verified?(s(),u("i",Dy)):w("",!0)]),t("h2",Ly,d(ae.owner.name)+" "+d(e(y)("group.myAgentsTab.searchQueryDialog.creatorLabel")),1),t("h2",Iy,d(ae.description),1)])],8,Ay))),128))])])):w("",!0),h.value?(s(),u("div",By,[t("div",{ref_key:"dialogContentRef",ref:S,class:"bg-white dark:bg-stone-800 rounded-lg shadow-lg p-4 w-full max-w-md"},[t("div",My,[o(P,null,{default:i(()=>[o(O,null,{default:i(()=>W[8]||(W[8]=[t("div",null,[t("i",{class:"bi bi-three-dots cursor-pointer"})],-1)])),_:1,__:[8]}),o(F,null,{default:i(()=>[o(V,{class:"cursor-pointer"},{default:i(()=>{var ae;return[R((ae=x.value)==null?void 0:ae.id)?(s(),u("div",{key:1,variant:"ghost",onClick:W[3]||(W[3]=de=>{var le;return B((le=x.value)==null?void 0:le.id)}),class:"p-0 m-0 flex items-center mr-2"},[D.value?w("",!0):(s(),u("i",Ry)),D.value?(s(),T(K,{key:1,class:"w-4 h-4 animate-spin"})):w("",!0),t("span",null,d(e(y)("group.myAgentsTab.searchQueryDialog.unpinButtonTitle")),1)])):(s(),u("div",{key:0,variant:"ghost",onClick:W[2]||(W[2]=de=>{var le;return $((le=x.value)==null?void 0:le.id)}),class:"p-0 m-0 flex items-center mr-2"},[D.value?w("",!0):(s(),u("i",Ey)),D.value?(s(),T(K,{key:1,class:"w-4 h-4 animate-spin"})):w("",!0),t("span",null,d(e(y)("group.myAgentsTab.searchQueryDialog.pinButtonTitle")),1)]))]}),_:1}),o(V,{class:"cursor-pointer",onClick:W[4]||(W[4]=ae=>{var de;return H((de=x.value)==null?void 0:de.id)})},{default:i(()=>[W[9]||(W[9]=t("i",{class:"bi bi-link"},null,-1)),t("span",Fy,d(e(y)("group.myAgentsTab.searchQueryDialog.copyButtonTitle")),1)]),_:1,__:[9]})]),_:1})]),_:1}),t("div",null,[t("i",{class:"bi bi-x cursor-pointer",onClick:W[5]||(W[5]=ae=>h.value=!1)})])]),t("div",Py,[o(wt,{fallbackText:(A=x.value)==null?void 0:A.name,size:"base",avatarClass:"m-auto mt-10"},null,8,["fallbackText"]),t("h1",Ny,[me(d((k=x.value)==null?void 0:k.name)+" ",1),(L=x.value)!=null&&L.verified?(s(),u("i",zy)):w("",!0)]),t("h2",Uy,d(e(y)("group.myAgentsTab.searchQueryDialog.creatorLabel",{userName:(z=x.value)==null?void 0:z.owner.name})),1),t("h2",Oy,d((Q=x.value)==null?void 0:Q.description),1),o(q,{onClick:W[6]||(W[6]=ae=>{var de;return j((de=x.value)==null?void 0:de.id)}),class:"mt-5 bg-stone-100 hover:bg-stone-200 text-black px-4"},{default:i(()=>[W[10]||(W[10]=t("i",{class:"bi bi-chat mr-2"},null,-1)),me(" "+d(e(y)("group.myAgentsTab.searchQueryDialog.startChattingButtonTitle")),1)]),_:1,__:[10]})])],512)])):w("",!0)],512)}}}),Vy={class:"mx-auto w-10/12 sm:w-3/4 flex flex-col"},Gy={class:"w-full m-auto"},Wy={class:"mid-content-title flex flex-col"},Hy={class:"text-xl font-bold"},Ky=oe({__name:"GroupGPTViewMain",setup(n){const{t:l}=Ce();return(a,c)=>{const r=f("Separator");return s(),u("div",Vy,[t("div",Gy,[t("div",Wy,[t("span",Hy,d(e(l)("group.myAgentsTab.tabLabel")),1)]),o(r,{class:"my-2"}),o(jy),o($y),o(wy)])])}}}),qy={class:"relative w-full overflow-auto"},Si=oe({__name:"Table",props:{class:{}},setup(n){const l=n;return(a,c)=>(s(),u("div",qy,[t("table",{class:pe(e(Me)("w-full caption-bottom text-sm",l.class))},[we(a.$slots,"default")],2)]))}}),Ti=oe({__name:"TableBody",props:{class:{}},setup(n){const l=n;return(a,c)=>(s(),u("tbody",{class:pe(e(Me)("[&_tr:last-child]:border-0",l.class))},[we(a.$slots,"default")],2))}}),Qy=oe({__name:"TableCaption",props:{class:{}},setup(n){const l=n;return(a,c)=>(s(),u("caption",{class:pe(e(Me)("mt-4 text-sm text-muted-foreground",l.class))},[we(a.$slots,"default")],2))}}),eo=oe({__name:"TableCell",props:{class:{}},setup(n){const l=n;return(a,c)=>(s(),u("td",{class:pe(e(Me)("p-4 align-middle [&:has([role=checkbox])]:pr-0",l.class))},[we(a.$slots,"default")],2))}}),Sa=oe({__name:"TableRow",props:{class:{}},setup(n){const l=n;return(a,c)=>(s(),u("tr",{class:pe(e(Me)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",l.class))},[we(a.$slots,"default")],2))}}),Jy={class:"flex items-center justify-center py-10"},Xy=oe({__name:"TableEmpty",props:{class:{},colspan:{default:1}},setup(n){const l=n,a=ne(()=>{const{class:c,...r}=l;return r});return(c,r)=>(s(),T(Sa,null,{default:i(()=>[o(eo,He({class:e(Me)("p-4 whitespace-nowrap align-middle text-sm text-foreground",l.class)},a.value),{default:i(()=>[t("div",Jy,[we(c.$slots,"default")])]),_:3},16,["class"])]),_:3}))}}),Yy=oe({__name:"TableFooter",props:{class:{}},setup(n){const l=n;return(a,c)=>(s(),u("tfoot",{class:pe(e(Me)("border-t bg-muted/50 font-medium last:[&>tr]:border-b-0",l.class))},[we(a.$slots,"default")],2))}}),Ai=oe({__name:"TableHead",props:{class:{}},setup(n){const l=n;return(a,c)=>(s(),u("th",{class:pe(e(Me)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",l.class))},[we(a.$slots,"default")],2))}}),Ci=oe({__name:"TableHeader",props:{class:{}},setup(n){const l=n;return(a,c)=>(s(),u("thead",{class:pe(e(Me)("[&_tr]:border-b",l.class))},[we(a.$slots,"default")],2))}}),Zy={class:"rounded-md"},rn=oe({__name:"DataTable",props:{columns:{},data:{},noDataAvailableMessage:{}},setup(n){const l=n;Ce();const a=Hc({get data(){return l.data},get columns(){return l.columns},getCoreRowModel:Kc(),getPaginationRowModel:qc(),initialState:{pagination:{pageSize:10}}});return(c,r)=>(s(),u("div",null,[t("div",Zy,[o(e(Si),null,{default:i(()=>[o(e(Ci),null,{default:i(()=>[(s(!0),u(ve,null,Le(e(a).getHeaderGroups(),p=>(s(),T(e(Sa),{key:p.id},{default:i(()=>[(s(!0),u(ve,null,Le(p.headers,m=>(s(),T(e(Ai),{key:m.id},{default:i(()=>[m.isPlaceholder?w("",!0):(s(),T(e(Pn),{key:0,render:m.column.columnDef.header,props:m.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),o(e(Ti),null,{default:i(()=>{var p;return[(p=e(a).getRowModel().rows)!=null&&p.length?(s(!0),u(ve,{key:0},Le(e(a).getRowModel().rows,m=>(s(),T(e(Sa),{key:m.id,"data-state":m.getIsSelected()?"selected":void 0},{default:i(()=>[(s(!0),u(ve,null,Le(m.getVisibleCells(),g=>(s(),T(e(eo),{key:g.id},{default:i(()=>[o(e(Pn),{render:g.column.columnDef.cell,props:g.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1032,["data-state"]))),128)):(s(),T(e(Sa),{key:1},{default:i(()=>[o(e(eo),{colspan:c.columns.length,class:"text-2xl font-semibold text-center opacity-50 mt-2"},{default:i(()=>[me(d(l.noDataAvailableMessage),1)]),_:1},8,["colspan"])]),_:1}))]}),_:1})]),_:1})])]))}}),cn=oe({__name:"DropdownMenu",props:{defaultOpen:{type:Boolean},open:{type:Boolean},dir:{},modal:{type:Boolean}},emits:["update:open"],setup(n,{emit:l}){const r=$t(n,l);return(p,m)=>(s(),T(e(Qc),At(Ct(e(r))),{default:i(()=>[we(p.$slots,"default")]),_:3},16))}}),dn=oe({__name:"DropdownMenuContent",props:{forceMount:{type:Boolean},loop:{type:Boolean},side:{},sideOffset:{default:4},align:{},alignOffset:{},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},updatePositionStrategy:{},prioritizePosition:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","closeAutoFocus"],setup(n,{emit:l}){const a=n,c=l,r=ne(()=>{const{class:m,...g}=a;return g}),p=$t(r,c);return(m,g)=>(s(),T(e(Xc),null,{default:i(()=>[o(e(Jc),He(e(p),{class:e(Me)("z-50 min-w-32 overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a.class)}),{default:i(()=>[we(m.$slots,"default")]),_:3},16,["class"])]),_:3}))}}),ex=oe({__name:"DropdownMenuGroup",props:{asChild:{type:Boolean},as:{}},setup(n){const l=n;return(a,c)=>(s(),T(e(Yc),At(Ct(l)),{default:i(()=>[we(a.$slots,"default")]),_:3},16))}}),ta=oe({__name:"DropdownMenuItem",props:{disabled:{type:Boolean},textValue:{},asChild:{type:Boolean},as:{},class:{},inset:{type:Boolean}},setup(n){const l=n,a=ne(()=>{const{class:r,...p}=l;return p}),c=Pt(a);return(r,p)=>(s(),T(e(Zc),He(e(c),{class:e(Me)("relative flex cursor-pointer select-none items-center rounded-sm gap-2 px-2 py-1.5 text-sm outline-hidden transition-colors focus:bg-accent focus:text-accent-foreground data-disabled:pointer-events-none data-disabled:opacity-50  [&>svg]:size-4 [&>svg]:shrink-0",r.inset&&"pl-8",l.class)}),{default:i(()=>[we(r.$slots,"default")]),_:3},16,["class"]))}}),tx=oe({__name:"DropdownMenuSub",props:{defaultOpen:{type:Boolean},open:{type:Boolean}},emits:["update:open"],setup(n,{emit:l}){const r=$t(n,l);return(p,m)=>(s(),T(e(ed),At(Ct(e(r))),{default:i(()=>[we(p.$slots,"default")]),_:3},16))}}),sx=oe({__name:"DropdownMenuSubContent",props:{forceMount:{type:Boolean},loop:{type:Boolean},sideOffset:{},alignOffset:{},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},updatePositionStrategy:{},prioritizePosition:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","entryFocus","openAutoFocus","closeAutoFocus"],setup(n,{emit:l}){const a=n,c=l,r=ne(()=>{const{class:m,...g}=a;return g}),p=$t(r,c);return(m,g)=>(s(),T(e(td),He(e(p),{class:e(Me)("z-50 min-w-32 overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a.class)}),{default:i(()=>[we(m.$slots,"default")]),_:3},16,["class"]))}}),ax=oe({__name:"DropdownMenuSubTrigger",props:{disabled:{type:Boolean},textValue:{},asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:r,...p}=l;return p}),c=Pt(a);return(r,p)=>(s(),T(e(sd),He(e(c),{class:e(Me)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-hidden focus:bg-accent data-[state=open]:bg-accent",l.class)}),{default:i(()=>[we(r.$slots,"default"),o(e($l),{class:"ml-auto h-4 w-4"})]),_:3},16,["class"]))}}),un=oe({__name:"DropdownMenuTrigger",props:{disabled:{type:Boolean},asChild:{type:Boolean},as:{}},setup(n){const a=Pt(n);return(c,r)=>(s(),T(e(ad),He({class:"outline-hidden"},e(a)),{default:i(()=>[we(c.$slots,"default")]),_:3},16))}}),Di=oe({__name:"AlertDialogDescription",props:{asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:c,...r}=l;return r});return(c,r)=>(s(),T(e(od),He(a.value,{class:e(Me)("text-sm text-muted-foreground",l.class)}),{default:i(()=>[we(c.$slots,"default")]),_:3},16,["class"]))}}),ox={key:0,class:"bi bi-three-dots"},nx={variant:"ghost"},lx=oe({__name:"DataTableDropDown",props:{member:{}},setup(n){const{t:l}=Ce(),a=tt(),c=ys(),{changeGroupMemberRole:r,removeMemberFromGroup:p,getGroupDataTableMember:m}=c,{currentDataTableOffset:g}=ie(c),h=v(!1),_=v(!1),x=()=>{_.value=!0},b=async(I,C,U)=>{if(!h.value){h.value=!0;try{await r(I,C,U)}catch(E){console.error("Error changing member role:",E),Ue({title:l("group.toast.fail.generalErrorTitle"),description:l("group.toast.fail.generalError"),variant:"destructive"})}finally{await m({group_id:I,offset:g.value,limit:20}),h.value=!1}}},S=v(!1),D=async(I,C)=>{if(h.value=!0,C==="ADMIN"||C==="MEMBER"){const U=a.params.id;try{await p(U,I,C)}catch(E){console.error("Failed to remove member:",E),Ue({title:l("home.toast.fail.generalErrorTitle"),description:l("home.toast.fail.generalError"),variant:"destructive"})}finally{h.value=!1}S.value=!1,_.value=!1}else console.error("Invalid role type")},y=()=>{S.value=!0};return(I,C)=>{const U=f("Loader"),E=f("DropdownMenuSubTrigger"),N=f("DropdownMenuSubContent"),$=f("DropdownMenuSub"),R=f("AlertDialogTrigger"),B=f("AlertDialogTitle"),j=f("AlertDialogHeader"),ee=f("AlertDialogCancel"),se=f("AlertDialogFooter"),G=f("AlertDialogContent"),J=f("AlertDialog"),H=f("DropdownMenuGroup");return s(),T(e(cn),{open:S.value,"onUpdate:open":C[4]||(C[4]=M=>S.value=M)},{default:i(()=>[o(e(un),{"as-child":""},{default:i(()=>[o(e(ts),{variant:"ghost",class:"w-8 h-8 p-0",onClick:y},{default:i(()=>[h.value?w("",!0):(s(),u("i",ox)),h.value?(s(),T(U,{key:1,class:"w-4 h-4 animate-spin"})):w("",!0)]),_:1})]),_:1}),o(e(dn),null,{default:i(()=>[o(H,null,{default:i(()=>[o($,null,{default:i(()=>[o(E,{class:"cursor-pointer"},{default:i(()=>[t("div",nx,[C[5]||(C[5]=t("i",{class:"bi bi-arrow-down-up mr-2"},null,-1)),me(" "+d(e(l)("group.membersTab.tableOption.changeMemberRoleLabel")),1)])]),_:1}),o(N,null,{default:i(()=>[o(e(ta),{class:"cursor-pointer",onClick:C[0]||(C[0]=Ye(M=>b(e(a).params.id,I.member.id,"ADMIN"),["stop"]))},{default:i(()=>C[6]||(C[6]=[t("div",null,"ADMIN",-1)])),_:1,__:[6]}),o(e(ta),{class:"cursor-pointer",onClick:C[1]||(C[1]=Ye(M=>b(e(a).params.id,I.member.id,"MEMBER"),["stop"]))},{default:i(()=>C[7]||(C[7]=[t("div",null,"MEMBER",-1)])),_:1,__:[7]})]),_:1})]),_:1}),o(e(ta),null,{default:i(()=>[o(J,{open:_.value,"onUpdate:open":C[3]||(C[3]=M=>_.value=M)},{default:i(()=>[o(R,{class:"cursor-pointer"},{default:i(()=>[t("div",{variant:"ghost",onClick:Ye(x,["stop"]),class:"text-red-500"},[C[8]||(C[8]=t("i",{class:"bi bi-eraser mr-2"},null,-1)),me(" "+d(e(l)("group.membersTab.tableOption.removeMemberLabel",{memberName:I.member.name})),1)])]),_:1}),o(G,{class:"sm:max-w-[425px]"},{default:i(()=>[o(j,null,{default:i(()=>[o(B,null,{default:i(()=>[me(d(e(l)("group.membersTab.dialog.removeMemberDialogHeader")),1)]),_:1})]),_:1}),o(Di,null,{default:i(()=>[me(d(e(l)("group.membersTab.dialog.removeMemberDialogDescription",{memberName:I.member.name})),1)]),_:1}),o(se,{class:"flex"},{default:i(()=>[o(ee,{"as-child":""},{default:i(()=>[o(e(ts),{type:"button",variant:"outline"},{default:i(()=>[me(d(e(l)("group.button.cancel")),1)]),_:1})]),_:1}),o(e(ts),{disabled:h.value,onClick:C[2]||(C[2]=Ye(M=>D(I.member.id,I.member.role),["stop"])),type:"button",class:"bg-red-600 text-white hover:bg-red-500"},{default:i(()=>[h.value?(s(),T(U,{key:0,class:"w-5 h-5 mr-3 animate-spin"})):w("",!0),me(" "+d(e(l)("group.membersTab.dialog.removeMemberButtonLabel")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])}}}),ix={class:"container px-0 sm:px-8 sm:py-10 sm:mx-auto"},rx={key:0,class:"flex flex-col items-start space-y-3"},cx={key:0,class:"flex gap-3 justify-center items-center mt-4"},dx=["disabled"],ux={class:"text-sm text-stone-500"},px=["disabled"],Io="text-left font-bold text-md",Bo="text-left",mx=oe({__name:"GroupMemberTableData",props:{tab:{},members:{}},setup(n){const{t:l}=Ce(),a=v(0),c=v(!1),r=tt(),p=ys(),{changeGroupMemberRole:m,getGroupDataTableMember:g,removeMemberFromGroup:h}=p,{currentUserGroupRoleInGroup:_,currentUserIdInGroup:x,totalMember:b,searchQuery:S}=ie(p),D=us(async $=>{a.value=0,await y($.toLowerCase())},300);Te(S,$=>{D($)});const y=async($="")=>{const R=r.params.id,B={email:$,group_id:R,offset:a.value,limit:10};if(R){c.value=!0;try{await g(B)}catch(j){console.error(j),Ue({title:l("group.toast.fail.generalErrorTitle"),description:l("group.toast.fail.somethingWentWrong"),variant:"destructive"})}finally{c.value=!1}}},I=[{accessorKey:"name",header:()=>Oe("div",{class:Io},l("group.membersTab.tableNameLabel")),cell:({row:$})=>Oe("div",{class:Bo},$.getValue("name"))},{accessorKey:"email",header:()=>Oe("div",{class:Io},l("group.membersTab.tableEmailLabel")),cell:({row:$})=>{const R=$.original,B=x.value===R.id;return Oe("div",{class:Bo},[B?Oe("span",{class:"text-sm"},`(${l("group.membersTab.currentUserLabel")}) `):null,Oe("span",{},$.getValue("email"))])}},{accessorKey:"role",header:()=>Oe("div",{class:Io},l("group.membersTab.tableRoleLabel")),cell:({row:$})=>Oe("div",{class:Bo},$.getValue("role"))},{id:"actions",cell:({row:$})=>{const R=$.original,B=r.params.id;if(_.value[B]==="ADMIN"&&x.value!==R.id)return Oe("div",{class:"relative"},Oe(lx,{member:R,onRoleChange:j=>{const{id:ee,role:se}=j;m(B,ee,se)},onRemove:j=>{const{id:ee,role:se}=j;h(B,ee,se)}}))}}],C=ne(()=>Math.floor(a.value/10)+1),U=ne(()=>Math.ceil((b.value||0)/10)),E=()=>{C.value<U.value&&(a.value+=10,y())},N=()=>{a.value>0&&(a.value-=10,y())};return Dt(()=>{y()}),Te(()=>r.params.id,$=>{$&&(a.value=0,y())}),($,R)=>{const B=f("Skeleton");return s(),u("div",ix,[t("div",null,[c.value?(s(),u("div",rx,[o(B,{class:"h-8 w-full"}),o(B,{class:"h-8 w-11/12"}),o(B,{class:"h-8 w-full"}),o(B,{class:"h-8 w-11/12"}),o(B,{class:"h-8 w-full"}),o(B,{class:"h-8 w-11/12"}),o(B,{class:"h-8 w-full"}),o(B,{class:"h-8 w-11/12"})])):(s(),T(rn,{key:1,columns:I,data:$.members,noDataAvailableMessage:e(l)("group.unavailableMessage.noMemberAvailable")},null,8,["data","noDataAvailableMessage"]))]),t("div",null,[!c.value&&e(b)!==0?(s(),u("div",cx,[t("button",{variant:"ghost",class:pe(["px-4 py-2 cursor-pointer",a.value===0?"opacity-20":""]),disabled:a.value===0,onClick:N},R[0]||(R[0]=[t("i",{class:"bi bi-caret-left"},null,-1)]),10,dx),t("span",ux,d(C.value)+" / "+d(U.value),1),t("button",{variant:"ghost",class:pe(["px-4 py-2 cursor-pointer",C.value===U.value?"opacity-20":""]),disabled:C.value===U.value,onClick:E},R[1]||(R[1]=[t("i",{class:"bi bi-caret-right"},null,-1)]),10,px)])):w("",!0)])])}}}),Li="/assets/ExceluploadExample-DdLBppuC.png",gx={key:0,class:"text-red-500 text-sm"},fx={class:"flex flex-col"},vx={key:0},Ii=oe({__name:"SearchMailAutoComplete",props:bs({targetUsers:{},isSearching:{type:Boolean},hasSearched:{type:Boolean}},{"query-value":{default:[]},"query-valueModifiers":{}}),emits:bs(["triggerDebounce"],["update:query-value"]),setup(n,{emit:l}){const a=n,c=l,r=Ce(),{t:p}=We(r.t),m=v(!1),g=v(""),h=Os(n,"query-value");Te(()=>g.value,x=>{c("triggerDebounce",x)});const _=x=>{h.value=h.value.filter(b=>b.id!==x.id)};return(x,b)=>{const S=f("TagsInputItemText"),D=f("TagsInputItemDelete"),y=f("TagsInputItem"),I=f("TagsInputInput"),C=f("CommandItem"),U=f("CommandGroup"),E=f("CommandList"),N=f("TagsInput");return s(),u(ve,null,[x.hasSearched&&!x.isSearching&&x.targetUsers.length===0&&g.value.length!==0?(s(),u("p",gx,d(e(p)("group.membersTab.dialog.addMember.error.invalidEmail")),1)):w("",!0),o(N,{class:pe([x.hasSearched&&!x.isSearching&&x.targetUsers.length===0&&g.value.length!==0?"border-red-500":"","px-0 gap-0 w-full"]),"model-value":h.value},{default:i(()=>[t("div",{class:pe([h.value.length?"py-2":"","flex gap-2 flex-wrap items-center px-3 max-h-24 overflow-y-auto"])},[(s(!0),u(ve,null,Le(h.value,$=>(s(),T(y,{key:$,value:$.email},{default:i(()=>[o(S,{class:"wrap-anywhere line-clamp-1"}),o(D,{onClick:R=>_($)},{default:i(()=>b[4]||(b[4]=[t("i",{class:"bi bi-x"},null,-1)])),_:2,__:[4]},1032,["onClick"])]),_:2},1032,["value"]))),128))],2),o(e(Sl),{modelValue:h.value,"onUpdate:modelValue":b[1]||(b[1]=$=>h.value=$),"search-term":g.value,"onUpdate:searchTerm":b[2]||(b[2]=$=>g.value=$),"display-value":$=>$.email,open:m.value,"onUpdate:open":b[3]||(b[3]=$=>m.value=$),class:"w-full"},{default:i(()=>[o(e(nd),{"as-child":""},{default:i(()=>[o(e(Tl),{placeholder:e(p)("group.membersTab.dialog.searchMemberPlaceHolder"),"as-child":""},{default:i(()=>[o(I,{class:pe(["w-full px-3",h.value.length>0?"mt-2":""]),onKeydown:b[0]||(b[0]=yt(Ye(()=>{},["prevent"]),["enter"]))},null,8,["class"])]),_:1},8,["placeholder"])]),_:1}),o(e(ld),null,{default:i(()=>[o(e(Al),null,{default:i(()=>[g.value?(s(),T(E,{key:0,position:"popper",class:"z-50 w-(--radix-popper-anchor-width) rounded-md mt-2 bg-popover text-popover-foreground shadow-md outline-hidden data-[stateopen]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2"},{default:i(()=>[o(U,null,{default:i(()=>[(s(!0),u(ve,null,Le(a.targetUsers,$=>(s(),T(C,{class:"cursor-pointer",key:$.id,value:$,disabled:$.isAdded,onSelect:Ye(()=>{h.value.push({id:$.id,email:$.email,name:$.name}),m.value=!1},["prevent"])},{default:i(()=>[t("div",fx,[t("span",null,d($.email),1),$.isAdded?(s(),u("span",vx,d(e(p)("group.membersTab.dialog.userAddedToGroup")),1)):w("",!0)])]),_:2},1032,["value","disabled","onSelect"]))),128))]),_:1})]),_:1})):w("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue","search-term","display-value","open"])]),_:1},8,["class","model-value"])],64)}}}),Bi=oe({__name:"DialogDescription",props:{asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:r,...p}=l;return p}),c=Pt(a);return(r,p)=>(s(),T(e(id),He(e(c),{class:e(Me)("text-sm",l.class)}),{default:i(()=>[we(r.$slots,"default")]),_:3},16,["class"]))}}),hx={class:"ml-2"},_x={class:"flex items-center justify-between"},bx={class:"text-sm text-stone-400"},kx={class:"text-xs text-stone-400 w-full"},yx={class:"w-full flex justify-end"},xx={for:"fileInput",class:"cursor-pointer hover:bg-stone-100 dark:hover:bg-stone-800 px-3 py-2 text-sm border rounded-full"},wx={key:0,class:"text-xs text-stone-400 max-h-36 overflow-y-auto"},$x=["alt"],Sx=oe({__name:"AddMemberToGroupDialog",setup(n){const l=v([]),{t:a}=Ce(),c=ys(),{addMemberToGroupById:r,getUserData:p}=c,{currentGroupNameById:m,users:g,memberDataTable:h}=ie(c),{toast:_}=gt(),x=v(!1),b=v(!1),S=v([]),D=()=>{b.value=!1,l.value=[],x.value=!0,S.value=[]},y=v(!1),I=tt(),C=async se=>{b.value=!0,se.length===0?(_({title:a("group.toast.fail.addMember.noUsersFound.title"),description:a("group.toast.fail.addMember.noUsersFound.description"),variant:"destructive"}),b.value=!1):(await r(I.params.id,se),x.value=!1)},U=v(null),E=se=>{const G=se.target;if(G.files&&G.files.length>0){const J=G.files[0],H=J.name.toLowerCase(),M=H.endsWith(".csv"),W=H.endsWith(".xlsx")||H.endsWith(".xls");if(!M&&!W){G.value="",_({title:a("group.toast.fail.uploadCSV"),description:a("group.toast.fail.uploadCSV.description"),variant:"destructive"});return}U.value=J,M?N(U.value):$(U.value),G.value=""}},N=se=>{const G=new FileReader;G.onload=J=>{if(J.target&&J.target.result){const M=J.target.result.split(`
`).map(W=>W.trim().replace("\r","")).filter(W=>W);S.value=M.map(W=>({id:"",name:"",email:W}))}},G.readAsText(se)},$=se=>{const G=new FileReader;G.onload=J=>{var H;if((H=J.target)!=null&&H.result){const M=new Uint8Array(J.target.result),W=El(M,{type:"array"}),X=W.SheetNames[0],O=W.Sheets[X],V=Rl.sheet_to_json(O,{header:1}).map(F=>{var P;return(P=F[0])==null?void 0:P.trim()}).filter(F=>F);S.value=V.map(F=>({id:"",name:"",email:F}))}},G.readAsArrayBuffer(se)},R=v(!1),B=v(!1),ee=us(async se=>{if(!se){l.value=[],B.value=!1;return}R.value=!0,B.value=!1,await p({email:se.toLowerCase(),offset:0,limit:10}),l.value=g.value.filter(G=>!S.value.some(J=>J.id===G.id)).map(G=>({...G,isAdded:h.value.some(J=>J.id===G.id)})),R.value=!1,B.value=!0},300);return(se,G)=>{const J=f("Button"),H=f("DialogTitle"),M=f("DialogHeader"),W=f("Separator"),X=f("DialogClose"),O=f("Loader"),K=f("DialogFooter"),V=f("DialogContent"),F=f("Dialog");return s(),T(F,{open:x.value,"onUpdate:open":G[3]||(G[3]=P=>x.value=P)},{default:i(()=>[o(J,{class:"p-5 rounded-3xl",onClick:D},{default:i(()=>[G[4]||(G[4]=t("i",{class:"bi bi-plus-lg"},null,-1)),t("span",hx,d(e(a)("group.button.inviteMember")),1)]),_:1,__:[4]}),o(V,{class:"w-full max-w-sm sm:max-w-lg rounded-md sm:rounded-lg"},{default:i(()=>[o(M,null,{default:i(()=>[o(H,{class:"whitespace-normal wrap-anywhere line-clamp-1"},{default:i(()=>[me(d(e(a)("group.membersTab.dialog.addMemberDialogHeader",{groupName:e(m)})),1)]),_:1}),o(Bi,null,{default:i(()=>[me(d(e(a)("group.membersTab.dialog.addMemberDialogDescription")),1)]),_:1})]),_:1}),o(W),o(Ii,{"query-value":S.value,"onUpdate:queryValue":G[0]||(G[0]=P=>S.value=P),onTriggerDebounce:e(ee),targetUsers:l.value,isSearching:R.value,hasSearched:B.value,class:"w-full"},null,8,["query-value","onTriggerDebounce","targetUsers","isSearching","hasSearched"]),o(W),t("div",_x,[t("div",null,[t("p",bx,d(e(a)("group.membersTab.dialog.importCSV")),1),t("div",kx,d(e(a)("group.membersTab.dialog.importCSVDes")),1),t("p",{class:"text-xs text-stone-400 underline cursor-pointer w-fit",onClick:G[1]||(G[1]=P=>y.value=!y.value)},d(y.value?e(a)("group.membersTab.dialog.hideExampleButtonLabel"):e(a)("group.membersTab.dialog.showExampleButtonLabel")),1)]),t("div",yx,[t("input",{type:"file",accept:".csv, application/vnd.ms-excel, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",onChange:E,class:"hidden",id:"fileInput"},null,32),t("label",xx,d(e(a)("group.membersTab.dialog.uploadCSVorExcelButtonLabel")),1)])]),y.value?(s(),u("div",wx,[t("img",{src:Li,alt:e(a)("group.membersTab.dialog.excel.imageFallbackText"),class:"rounded-md my-5"},null,8,$x)])):w("",!0),o(K,{class:"gap-2 mt-4"},{default:i(()=>[o(X,{"as-child":""},{default:i(()=>[o(J,{type:"button",variant:"outline",class:"rounded-full"},{default:i(()=>[me(d(e(a)("group.button.cancel")),1)]),_:1})]),_:1}),o(J,{type:"button",class:"rounded-full",onClick:G[2]||(G[2]=P=>C(S.value)),disabled:b.value||S.value.length===0||l.value.length===0&&B.value||R.value},{default:i(()=>[b.value?(s(),T(O,{key:0,class:"w-4 h-4 animate-spin mr-2"})):w("",!0),t("span",null,d(e(a)("group.membersTab.dialog.addMemberButtonLabel")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])}}}),Tx={class:"mx-auto w-10/12 sm:w-3/4 flex flex-col"},Ax={class:"mid-content-title flex flex-col"},Cx={class:"text-xl font-bold"},Dx={key:0,class:"flex items-center gap-2 p-2"},Lx={key:1,class:"mt-3"},Ix={class:"flex text-sm"},Bx={key:0},Mx={key:1},Ex={class:"flex flex-wrap xl:flex-nowrap items-center justify-between py-6 gap-2 sm:gap-6"},Rx={class:"flex justify-end items-center gap-1 sm:gap-6 w-full"},Fx={class:"search-bar min-w-32 relative w-full"},Px={class:"font-semibold"},Nx={key:0,class:"text-red-500 text-center"},zx=oe({__name:"GroupMemberViewMain",setup(n){const{t:l}=Ce(),a=ot(),c=tt(),r=ys(),{groupDataById:p}=r,{leaveGroupById:m,getAllGroupData:g,limit:h}=r,{activeGroupId:_,groups:x,memberDataTable:b,searchQuery:S,totalMember:D,currentDataTableOffset:y}=ie(r),I=v(""),C=v(!0),U=v(!1),E=v(!1),N=()=>{se.value=!1,B(),U.value=!0},$=()=>{U.value=!1},R=v(!1),B=()=>{R.value=!1},j=()=>{R.value=!0},ee=async H=>{C.value=!0;const M=await p(H);M&&(I.value=M.name),C.value=!1};Te(()=>c.params.id,H=>{S.value="",H&&ee(H)},{immediate:!0});const se=v(!1),G=async H=>{se.value=!1,C.value=!0;try{if(await m(H),await g({group_name:"",offset:y.value,limit:h}),$(),x.value.length===0)_.value=null,a.push("/groups");else{const M=x.value[0].id,W=c.name||"group-agents";_.value=M,a.push({name:W,params:{id:M}})}E.value=!1}catch(M){console.error(M),se.value=!0,j()}finally{C.value=!1}},J=ne(()=>(D.value??0)>1);return(H,M)=>{const W=f("Skeleton"),X=f("Separator"),O=f("Input"),K=f("Button"),V=f("DropdownMenuTrigger"),F=f("DialogClose"),P=f("Loader"),q=f("DialogFooter"),A=f("DialogContent"),k=f("Dialog"),L=f("DropdownMenuItem"),z=f("DropdownMenuContent"),Q=f("DropdownMenu"),ae=f("TabsContent"),de=f("Tabs");return s(),u("div",Tx,[t("div",Ax,[t("span",Cx,d(e(l)("group.membersTab.tabLabel")),1)]),C.value?(s(),u("div",Dx,[o(W,{class:"h-4 w-[230px]"})])):(s(),u("div",Lx,[t("div",Ix,[me(d(e(l)("group.membersTab.groupMembersLabel"))+" ",1),t("div",null,[t("span",null,d(e(D))+" ",1)]),J.value?(s(),u("div",Bx,d(e(l)("group.membersTab.memberPluralLabel")),1)):(s(),u("div",Mx,d(e(l)("group.membersTab.memberSingularLabel")),1))])])),o(X),o(de,{"default-value":"all-member"},{default:i(()=>[t("div",Ex,[t("div",Rx,[t("div",Fx,[M[4]||(M[4]=t("i",{class:"bi bi-search absolute left-3 top-2 cursor-pointer"},null,-1)),o(O,{placeholder:e(l)("group.membersTab.searchMemberPlaceHolder"),class:"pl-10",modelValue:e(S),"onUpdate:modelValue":M[0]||(M[0]=le=>kt(S)?S.value=le:null)},null,8,["placeholder","modelValue"])]),o(Sx),o(Q,{open:E.value,"onUpdate:open":M[3]||(M[3]=le=>E.value=le)},{default:i(()=>[o(V,{"as-child":""},{default:i(()=>[o(K,{variant:"outline",class:"p-5 rounded-3xl focus-visible:none"},{default:i(()=>M[5]||(M[5]=[t("i",{class:"bi bi-three-dots"},null,-1)])),_:1,__:[5]})]),_:1}),o(z,null,{default:i(()=>[o(L,{class:"p-0"},{default:i(()=>[o(k,{open:U.value,"onUpdate:open":M[2]||(M[2]=le=>U.value=le)},{default:i(()=>[o(K,{variant:"ghost",onClick:Ye(N,["stop"])},{default:i(()=>[M[6]||(M[6]=t("i",{class:"bi bi-box-arrow-left mr-2"},null,-1)),me(" "+d(e(l)("group.membersTab.dialog.leaveGroupButtonLabel")),1)]),_:1,__:[6]}),o(A,null,{default:i(()=>[t("span",Px,d(e(l)("group.membersTab.dialog.leaveGroupDialogHeader")),1),R.value?(s(),u("span",Nx,d(e(l)("group.membersTab.dialog.needOneLeaderWarningText")),1)):w("",!0),o(q,{class:"gap-2"},{default:i(()=>[o(F,{"as-child":""},{default:i(()=>[o(K,{type:"button",variant:"outline",class:"rounded-full"},{default:i(()=>[me(d(e(l)("group.button.cancel")),1)]),_:1})]),_:1}),o(K,{onClick:M[1]||(M[1]=le=>G(e(c).params.id)),disabled:C.value||se.value,type:"button",variant:"secondary",class:"rounded-full bg-red-600 text-white hover:bg-red-500"},{default:i(()=>[C.value?(s(),T(P,{key:0,class:"w-5 h-5 mr-3 animate-spin"})):w("",!0),me(" "+d(e(l)("group.membersTab.dialog.leaveGroupButtonLabel")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1})]),_:1})]),_:1},8,["open"])])]),o(ae,{value:"all-member"},{default:i(()=>[o(mx,{members:e(b),tab:"allMember"},null,8,["members"])]),_:1})]),_:1})])}}}),Ux={class:"mx-auto w-10/12 sm:w-3/4 flex flex-col"},Ox={class:"mid-content-title flex flex-col"},jx={class:"text-xl font-bold"},Vx={key:0},Gx={class:"flex flex-col"},Wx={class:"font-bold"},Hx={class:"opacity-40 text-xs"},Kx={class:"w-full flex flex-col gap-2"},qx={class:"text-sm"},Qx={class:"w-full flex flex-col gap-2"},Jx={class:"text-sm"},Xx={key:0,class:"text-red-600 mb-3 text-sm font-semibold"},Yx={class:"flex flex-col"},Zx={class:"font-bold text-red-500"},ew={class:"opacity-40 text-xs"},tw={class:"w-full"},sw={class:"font-semibold"},aw={class:"text-stone-400 text-sm mt-2"},ow={key:1,class:"flex flex-col"},nw={class:"flex flex-col gap-3"},lw={key:2,class:"flex flex-col items-center justify-center h-48 text-stone-500"},iw={class:"text-2xl font-semibold opacity-50 mt-2"},rw=oe({__name:"GroupSettingView",setup(n){const l=tt(),a=ot(),c=ys(),{updateGroupNameById:r,deleteGroupById:p,groupDataById:m}=c,{currentGroupNameById:g,newGroupName:h,groups:_,activeGroupId:x,currentDataTableOffset:b,loading:S,groupName:D,currentUserGroupRoleInGroup:y}=ie(c),{t:I}=Ce(),C=v(l.params.id);Te(()=>l.params.id,q=>{C.value=q});const N=Ho({newGroupName:{required:Ko}},{newGroupName:h},{$scope:!1}),$=v(!1),R=v(!1),B=v(!1),j=v(!1),ee=v(!1),se=()=>ee.value=!0,G=()=>ee.value=!1,J=v(0),H=v(!0),M=()=>j.value=!1,W=()=>{R.value=!1,M(),h.value="",$.value=!0},X=async q=>{if(await N.value.$validate()&&!R.value&&!B.value){B.value=!0,R.value=!0;try{await r(q),$.value=!1;const k=_.value.find(L=>L.id===q);k&&(k.name=h.value)}catch(k){console.error("Error updating group name:",k),Ue({title:I("group.toast.fail.generalErrorTitle"),description:I("group.toast.fail.generalError"),variant:"destructive"})}finally{B.value=!1}}else j.value=!0},O=async q=>{try{S.value=!0;const A=await m(q);A&&(D.value=A.name),S.value=!1}catch(A){console.log("Failed to get group data: ",A),Ue({title:I("group.toast.fail.generalErrorTitle"),description:I("group.toast.fail.generalError"),variant:"destructive"})}},K=async q=>{const A=[..._.value];try{if(R.value=!0,await p(q),_.value.length===0)x.value=null,a.push("/groups");else{const k=_.value[0].id,L=l.name||"group-agents";x.value=k,a.push({name:L,params:{id:k}})}J.value=b.value,H.value=!0,Ue({title:I("group.toast.success.deleteGroup")})}catch(k){console.error("Error deleting group:",k),_.value=A,Ue({title:I("group.toast.fail.generalErrorTitle"),description:I("group.toast.fail.generalError"),variant:"destructive"})}finally{R.value=!1,G()}},V=ne(()=>y.value[C.value]),F=v(!1),P=async()=>{if(C.value){F.value=!0;try{await O(C.value)}catch(q){console.error(q),Ue({title:I("group.toast.fail.generalErrorTitle"),description:I("group.toast.fail.generalError"),variant:"destructive"})}finally{F.value=!1}}};return Te(()=>l.params.id,q=>{q&&P()}),Dt(()=>{P()}),(q,A)=>{const k=f("Separator"),L=f("DialogTrigger"),z=f("DialogTitle"),Q=f("DialogHeader"),ae=f("Input"),de=f("Button"),le=f("DialogClose"),te=f("Loader"),Z=f("DialogFooter"),re=f("DialogContent"),ue=f("Dialog"),he=f("AlertDialogTrigger"),$e=f("AlertDialogCancel"),Se=f("AlertDialogFooter"),be=f("AlertDialogContent"),Ge=f("AlertDialog"),fe=f("Skeleton");return s(),u("div",Ux,[t("div",Ox,[t("span",jx,d(e(I)("group.settingsTab.tabLabel")),1)]),o(k,{class:"my-2"}),V.value==="ADMIN"&&!F.value?(s(),u("div",Vx,[o(ue,{open:$.value,"onUpdate:open":A[4]||(A[4]=Y=>$.value=Y)},{default:i(()=>[o(L,{"as-child":""},{default:i(()=>[t("div",{onClick:Ye(W,["stop"]),class:"flex gap-5 items-center cursor-pointer dark:hover:bg-stone-800 hover:bg-stone-100 p-3 rounded-md"},[A[7]||(A[7]=t("div",null,[t("i",{class:"bi bi-pencil"})],-1)),t("div",null,[t("div",Gx,[t("div",Wx,d(e(I)("group.settingsTab.updateGroupLabel")),1),t("div",Hx,d(e(I)("group.settingsTab.updateGroupSubLabel")),1)])])])]),_:1}),o(re,{class:"max-w-sm rounded-md sm:max-w-lg sm:rounded-lg"},{default:i(()=>[o(Q,null,{default:i(()=>[o(z,null,{default:i(()=>[me(d(e(I)("group.settingsTab.dialog.editDialog.dialogHeader")),1)]),_:1})]),_:1}),t("div",Kx,[t("span",qx,d(e(I)("group.settingsTab.dialog.editDialog.currentGroupNameLabel")),1),o(ae,{disabled:"",id:"name",modelValue:e(g),"onUpdate:modelValue":A[0]||(A[0]=Y=>kt(g)?g.value=Y:null)},null,8,["modelValue"])]),t("div",Qx,[t("span",Jx,d(e(I)("group.settingsTab.dialog.editDialog.newGroupNameLabel")),1),o(ae,{onKeyup:A[1]||(A[1]=yt(Y=>X(C.value),["enter"])),id:"name",disabled:R.value,placeholder:e(I)("group.settingsTab.dialog.editDialog.newGroupNamePlaceholder"),modelValue:e(h),"onUpdate:modelValue":A[2]||(A[2]=Y=>kt(h)?h.value=Y:null),class:pe(["col-span-3 focus-visible:ring-offset-0",j.value?"focus-visible:ring-red-600":null])},null,8,["disabled","placeholder","modelValue","class"]),j.value?(s(),u("p",Xx,d(e(I)("group.settingsTab.dialog.validError.newGroupNameEmpty")),1)):w("",!0)]),o(Z,{class:"gap-2"},{default:i(()=>[o(le,{"as-child":""},{default:i(()=>[o(de,{type:"button",variant:"outline",class:"rounded-full"},{default:i(()=>[me(d(e(I)("group.button.cancel")),1)]),_:1})]),_:1}),o(de,{disabled:e(N).newGroupName.$invalid||R.value,onClick:A[3]||(A[3]=Y=>X(C.value)),type:"button",class:"rounded-full"},{default:i(()=>[R.value?(s(),T(te,{key:0,class:"w-5 h-5 mr-3 animate-spin"})):w("",!0),me(" "+d(e(I)("group.settingsTab.dialog.editDialog.updateButtonLabel")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),o(Ge,{open:ee.value,"onUpdate:open":A[6]||(A[6]=Y=>ee.value=Y)},{default:i(()=>[o(he,{"as-child":""},{default:i(()=>[t("div",{onClick:Ye(se,["stop"]),class:"flex gap-5 items-center cursor-pointer dark:hover:bg-stone-800 hover:bg-stone-100 p-3 rounded-md"},[A[8]||(A[8]=t("div",null,[t("i",{class:"bi bi-trash3 text-red-500"})],-1)),t("div",null,[t("div",Yx,[t("div",Zx,d(e(I)("group.settingsTab.deleteGroupLabel")),1),t("div",ew,d(e(I)("group.settingsTab.deleteGroupSubLabel")),1)])])])]),_:1}),o(be,{class:"max-w-sm rounded-md sm:max-w-lg sm:rounded-lg"},{default:i(()=>[t("div",tw,[t("div",sw,d(e(I)("group.settingsTab.dialog.deleteDialog.dialogHeader")),1),t("div",aw,[t("span",null,d(e(I)("group.settingsTab.dialog.deleteDialog.dialogDescription")),1)])]),o(Se,null,{default:i(()=>[o($e,{"as-child":""},{default:i(()=>[o(de,{type:"button",variant:"outline",class:"rounded-full"},{default:i(()=>[me(d(e(I)("group.button.cancel")),1)]),_:1})]),_:1}),o(de,{disabled:e(S),onClick:A[5]||(A[5]=Y=>K(C.value)),type:"button",variant:"secondary",class:"rounded-full bg-red-600 text-white hover:bg-red-500"},{default:i(()=>[e(S)?(s(),T(te,{key:0,class:"w-5 h-5 mr-3 animate-spin"})):w("",!0),me(" "+d(e(I)("group.settingsTab.dialog.deleteDialog.deleteButtonLabel")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])])):w("",!0),F.value?(s(),u("div",ow,[(s(),u(ve,null,Le(2,Y=>t("div",{key:Y,class:"flex items-center gap-4 p-4"},[t("div",nw,[o(fe,{class:"h-4 w-[250px]"}),o(fe,{class:"h-4 w-[200px]"})])])),64))])):w("",!0),V.value==="MEMBER"&&!F.value?(s(),u("div",lw,[t("p",iw,d(e(I)("group.unavailableMessage.noSettingAccessMessage")),1)])):w("",!0)])}}}),cw={class:"flex items-center justify-center space-x-1"},dw={class:"text-sm"},uw={class:"flex items-center justify-center space-x-1"},pw={class:"text-sm"},mw={class:"flex flex-col space-y-4"},gw={class:"line-clamp-1 whitespace-normal wrap-anywhere"},fw={key:0},vw={class:"font-semibold"},hw={class:"flex flex-col min-h-36 max-h-36 overflow-y-auto space-y-2"},_w={class:"flex items-start space-x-2 w-full"},bw={class:"flex flex-col"},kw={key:0,class:"font-semibold"},yw={key:1,class:"font-semibold"},xw={class:"text-sm"},ww={class:"flex"},$w={class:"flex items-start space-x-2"},Sw={class:"flex flex-col"},Tw={class:"text-base font-bold"},Aw={class:"text-xs"},Cw={class:"flex items-start space-x-2"},Dw={class:"flex flex-col"},Lw={class:"text-base font-bold"},Iw={class:"text-xs"},Bw={class:"flex items-center space-x-2 text-red-600"},Mw={class:"flex flex-col"},Ew={class:"text-base font-bold"},Rw={class:"flex flex-col space-y-4"},Fw={class:"line-clamp-1 whitespace-normal wrap-anywhere"},Pw={key:0},Nw={class:"font-semibold"},zw={class:"flex flex-col min-h-36 max-h-36 overflow-y-auto space-y-2"},Uw={class:"flex items-center space-x-2 w-full"},Ow={class:"flex flex-col"},jw={class:"font-semibold whitespace-normal wrap-anywhere line-clamp-2"},Vw={class:"flex"},Gw={class:"flex items-start space-x-2"},Ww={class:"flex flex-col"},Hw={class:"text-base font-bold"},Kw={class:"text-xs"},qw={class:"flex items-start space-x-2"},Qw={class:"flex flex-col"},Jw={class:"text-base font-bold"},Xw={class:"text-xs"},Yw={class:"flex items-center space-x-2 text-red-600"},Zw={class:"flex flex-col"},e2={class:"text-base font-bold"},t2={class:"flex-col pt-6"},s2={class:"font-semibold"},a2={class:"flex items-center justify-between p-2"},o2={class:"flex items-center"},n2={class:"flex flex-col"},l2={key:0,class:"text-xs px-3"},i2={key:1,class:"text-xs px-3"},r2={class:"text-sm"},c2={class:"text-sm"},Mi=oe({__name:"ShareAgentDialog",setup(n){const{toast:l}=gt(),a=Ce(),{t:c}=We(a.t),r=tt(),p=Gt(),{getAcl:m,updateAcl:g}=p,{currentAgent:h,currentAgentAcl:_}=ie(p),x=ys(),b=at(),{users:S,groups:D}=ie(x),{getUserData:y,getAllGroupData:I}=x,{isMobileSize:C}=ie(b),U=v([]),E=v([]),N=v([]),$=v([]),R=v(!1),B=v(!0),j=v("NOTENANT"),ee={type:"ALL",permission:"READ"};Te(()=>{var te;return(te=h.value)==null?void 0:te.status},async te=>{var Z,re;te==="PUBLISH"&&((re=(Z=h.value)==null?void 0:Z.currentUserInfo)==null?void 0:re.permission)==="OWNER"&&await m(h.value.id)});const se=async()=>{var te,Z,re,ue;(te=_.value)!=null&&te.tenant&&(j.value="TENANT"),B.value=!0,E.value=[],$.value=[],N.value=[],(Z=_.value)==null||Z.users.forEach(he=>E.value.push(he)),(re=_.value)!=null&&re.groups&&((ue=_.value)==null||ue.groups.forEach(he=>$.value.push(he)))},G=te=>{const Z=te.relatedTarget;Z&&Z.closest(".command-list-people")||Z&&Z.closest(".command-list-groups")||(P.value=!1,q.value=!1)},J=te=>{const Z=E.value.findIndex(re=>te.id===re.id);Z!==-1&&E.value.splice(Z,1)},H=te=>{const Z=$.value.findIndex(re=>te.id===re.id);Z!==-1&&$.value.splice(Z,1)},M=r.params.id,{protocol:W,host:X}=window.location,O=v(`${W}//${X}`),K=v(!1),V=async()=>{try{await navigator.clipboard.writeText(`${O.value}/agent/${M}`),l({title:c("home.toast.success.linkCopy")}),K.value=!0,setTimeout(()=>K.value=!1,2e3)}catch{l({title:c("home.toast.fail.generalErrorTitle"),description:c("home.toast.fail.generalError"),variant:"destructive"})}},F=async()=>{var te,Z;if(h.value)try{R.value=!0,j.value==="NOTENANT"?await g((te=h.value)==null?void 0:te.id,E.value,$.value,null):await g((Z=h.value)==null?void 0:Z.id,E.value,$.value,ee),await m(h.value.id),l({title:c("home.toast.success.updateAgentAcl")})}catch{l({title:c("home.toast.fail.generalErrorTitle"),description:c("home.toast.fail.generalError"),variant:"destructive"})}finally{R.value=!1,B.value=!1,setTimeout(()=>B.value=!0,1)}},P=v(!1),q=v(!1),A=v(""),k=v(""),L=us(async te=>{await y({email:te.toLowerCase(),offset:0,limit:10}),U.value=S.value.map(Z=>({...Z,isAdded:E.value.some(re=>re.id===Z.id)})),P.value=!0},300),z=us(async te=>{await I({group_name:te.toLowerCase(),offset:0,limit:10}),N.value=D.value.map(Z=>({id:Z.id,name:Z.name,isAdded:$.value.some(re=>re.id===Z.id)})),q.value=!0},300);Te(A,async te=>{te&&L(te)}),Te(k,async te=>{te&&z(te)});const Q=te=>{te.isAdded||(E.value.push({id:te.id,email:te.email,permission:"READ",name:te.name}),P.value=!1,A.value="")},ae=te=>{te.isAdded||($.value.push({id:te.id,type:"ALL",permission:"READ",name:te.name}),q.value=!1,k.value="")},de=(te,Z)=>{Z==="DELETED"?J(te):te.permission=Z},le=(te,Z)=>{Z==="DELETED"?H(te):te.permission=Z};return(te,Z)=>{var jt;const re=f("Button"),ue=f("TooltipTrigger"),he=f("TooltipContent"),$e=f("Tooltip"),Se=f("TooltipProvider"),be=f("DialogTrigger"),Ge=f("DialogTitle"),fe=f("DialogHeader"),Y=f("Separator"),ce=f("TabsTrigger"),ge=f("TabsList"),ye=f("CommandInput"),_e=f("CommandItem"),Re=f("CommandGroup"),ke=f("CommandList"),qe=f("Command"),lt=f("SelectValue"),St=f("ChevronDown"),Nt=f("SelectTrigger"),Mt=f("SelectItemText"),vt=f("SelectItem"),zt=f("SelectGroup"),bt=f("SelectContent"),Ve=f("Select"),Ze=f("TabsContent"),ze=f("Tabs"),Be=f("Avatar"),et=f("Loader"),ft=f("DialogFooter"),ht=f("DialogContent"),pt=f("Dialog");return s(),u("div",null,[((jt=e(h))==null?void 0:jt.status)==="DRAFT"&&!e(C)?(s(),T(Se,{key:0},{default:i(()=>[o($e,null,{default:i(()=>[o(ue,{"as-child":""},{default:i(()=>[o(re,{disabled:"",variant:"outline"},{default:i(()=>[t("div",cw,[Z[3]||(Z[3]=t("i",{class:"bi bi-person-lock text-lg"},null,-1)),t("span",dw,d(e(c)("editAgent.button.shareButtonLabel")),1)])]),_:1})]),_:1}),o(he,null,{default:i(()=>[t("p",null,d(e(c)("editAgent.topBar.button.disabled.noPublishedAgent")),1)]),_:1})]),_:1})]),_:1})):B.value?(s(),T(pt,{key:1},{default:i(()=>[o(be,{"as-child":""},{default:i(()=>{var st,Fe;return[((st=e(h))==null?void 0:st.status)==="PUBLISH"||((Fe=e(h))==null?void 0:Fe.status)==="DRAFT"&&!e(C)?(s(),T(re,{key:0,variant:"outline",onClick:se,class:pe([e(h).currentUserInfo&&e(h).currentUserInfo.permission!=="OWNER"?"hidden":"","rounded-3xl py-2 px-3.5 w-full"])},{default:i(()=>[t("div",uw,[Z[4]||(Z[4]=t("i",{class:"bi bi-person-lock text-lg"},null,-1)),t("span",pw,d(e(c)("editAgent.button.shareButtonLabel")),1)])]),_:1},8,["class"])):w("",!0)]}),_:1}),o(ht,{class:"max-w-sm rounded-md sm:rounded-lg sm:max-w-[600px]"},{default:i(()=>[o(fe,null,{default:i(()=>[o(Ge,null,{default:i(()=>[me(d(e(c)("editAgent.dialog.share.shareAgentToPeopleButtonLabel")),1)]),_:1})]),_:1}),o(Y),o(ze,{"default-value":"people",class:"w-full"},{default:i(()=>[o(ge,{class:"grid w-full grid-cols-2"},{default:i(()=>[o(ce,{value:"people"},{default:i(()=>[me(d(e(c)("editAgent.dialog.share.shareAgentToPeopleButtonLabel")),1)]),_:1}),o(ce,{value:"groups"},{default:i(()=>[me(d(e(c)("editAgent.dialog.share.shareAgentToGroupsButtonLabel")),1)]),_:1})]),_:1}),o(Ze,{value:"people"},{default:i(()=>[t("div",mw,[o(qe,{class:"overflow-visible relative h-10"},{default:i(()=>[o(ye,{class:"h-9 z-10 w-full",placeholder:e(c)("editAgent.dialog.share.peopleTab.addPeoplePlaceholder"),modelValue:A.value,"onUpdate:modelValue":Z[0]||(Z[0]=st=>A.value=st),onFocus:P.value,onBlur:G},null,8,["placeholder","modelValue","onFocus"]),P.value&&A.value?(s(),T(ke,{key:0,class:"command-list-people"},{default:i(()=>[o(Re,{class:"absolute bg-white dark:bg-stone-900 mt-1 shadow-lg max-h-48 overflow-y-auto rounded-lg w-full z-50"},{default:i(()=>[(s(!0),u(ve,null,Le(U.value,st=>(s(),T(_e,{key:st.id,value:st,disabled:st.isAdded,class:"flex flex-col items-start",onSelect:Fe=>Q(st)},{default:i(()=>[t("div",gw,d(st.email),1),st.isAdded?(s(),u("div",fw,d(e(c)("editAgent.dialog.share.alreadySharedLabel")),1)):w("",!0)]),_:2},1032,["value","disabled","onSelect"]))),128))]),_:1})]),_:1})):w("",!0)]),_:1}),t("div",vw,d(e(c)("editAgent.dialog.share.peopleTab.peopleListLabel")),1),t("div",hw,[(s(!0),u(ve,null,Le(E.value,(st,Fe)=>{var xe,rt,nt;return s(),u("div",{class:"flex",key:Fe},[t("div",_w,[o(wt,{fallbackText:st.name,size:"xs"},null,8,["fallbackText"]),t("div",bw,[(xe=e(h))!=null&&xe.currentUserInfo&&st.id===((rt=e(h))==null?void 0:rt.currentUserInfo.id)?(s(),u("span",kw,d(st.name)+" (you)",1)):(s(),u("span",yw,d(st.name),1)),t("span",xw,d(st.email),1)])]),t("div",ww,[st.id!==((nt=e(h))==null?void 0:nt.owner.id)?(s(),T(Ve,{key:0,id:"user-permission-select",defaultValue:"READ",modelValue:st.permission,"onUpdate:modelValue":Je=>de(st,Je)},{default:i(()=>[o(Nt,{class:"max-w-fit focus:ring-0 focus:ring-offset-0 border-none bg-transparent hover:bg-slate-100 dark:hover:bg-stone-800 space-x-1 ml-auto"},{default:i(()=>[o(lt),o(St,{class:"w-5 h-5 opacity-50 shrink-0 z-0"})]),_:1}),o(bt,null,{default:i(()=>[o(zt,null,{default:i(()=>[o(vt,{value:"READ"},{default:i(()=>[t("div",$w,[Z[5]||(Z[5]=t("i",{class:"bi bi-chat"},null,-1)),t("div",Sw,[o(Mt,null,{default:i(()=>[t("span",Tw,d(e(c)("editAgent.dialog.share.peopleTab.option.canChatLabel")),1)]),_:1}),t("span",Aw,d(e(c)("editAgent.dialog.share.peopleTab.option.canChatSubLabel")),1)])])]),_:1}),o(vt,{value:"EDIT"},{default:i(()=>[t("div",Cw,[Z[6]||(Z[6]=t("i",{class:"bi bi-sliders"},null,-1)),t("div",Dw,[o(Mt,null,{default:i(()=>[t("span",Lw,d(e(c)("editAgent.dialog.share.peopleTab.option.canEditLabel")),1)]),_:1}),t("span",Iw,d(e(c)("editAgent.dialog.share.peopleTab.option.canEditSubLabel")),1)])])]),_:1}),o(Y,{class:"my-2"}),o(vt,{value:"DELETED",class:"flex justify-start w-full"},{default:i(()=>[t("div",Bw,[Z[7]||(Z[7]=t("i",{class:"bi bi-trash"},null,-1)),t("div",Mw,[t("span",Ew,d(e(c)("editAgent.dialog.share.peopleTab.option.removePersonLabel")),1)])])]),_:1})]),_:1})]),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue"])):w("",!0)])])}),128))])])]),_:1}),o(Ze,{value:"groups"},{default:i(()=>[t("div",Rw,[o(qe,{class:"overflow-visible relative h-10"},{default:i(()=>[o(ye,{class:"h-9 z-10 w-full",placeholder:e(c)("editAgent.dialog.share.groupsTab.addGroupPlaceholder"),modelValue:k.value,"onUpdate:modelValue":Z[1]||(Z[1]=st=>k.value=st),onFocus:q.value,onBlur:G},null,8,["placeholder","modelValue","onFocus"]),q.value&&k.value?(s(),T(ke,{key:0,class:"command-list-groups"},{default:i(()=>[o(Re,{class:"absolute bg-white dark:bg-stone-900 mt-1 max-h-48 overflow-y-auto shadow-lg rounded-lg w-full z-50"},{default:i(()=>[(s(!0),u(ve,null,Le(N.value,st=>(s(),T(_e,{key:st.id,value:st,disabled:st.isAdded,class:"flex flex-col items-start",onSelect:Fe=>ae(st)},{default:i(()=>[t("div",Fw,d(st.name),1),st.isAdded?(s(),u("div",Pw,d(e(c)("editAgent.dialog.share.alreadySharedLabel")),1)):w("",!0)]),_:2},1032,["value","disabled","onSelect"]))),128))]),_:1})]),_:1})):w("",!0)]),_:1}),t("div",Nw,d(e(c)("editAgent.dialog.share.groupsTab.groupListLabel")),1),t("div",zw,[(s(!0),u(ve,null,Le($.value,(st,Fe)=>(s(),u("div",{class:"flex",key:Fe},[t("div",Uw,[o(wt,{fallbackText:st.name,size:"xs"},null,8,["fallbackText"]),t("div",Ow,[t("span",jw,d(st.name),1)])]),t("div",Vw,[o(Ve,{id:"group-permission-select",defaultValue:"chat",modelValue:st.permission,"onUpdate:modelValue":xe=>le(st,xe)},{default:i(()=>[o(Nt,{class:"max-w-fit focus:ring-0 focus:ring-offset-0 border-none bg-transparent hover:bg-gray-100 dark:hover:bg-stone-800 space-x-1 ml-auto"},{default:i(()=>[o(lt),o(St,{class:"w-5 h-5 opacity-50 shrink-0 z-0"})]),_:1}),o(bt,null,{default:i(()=>[o(zt,null,{default:i(()=>[o(vt,{value:"READ"},{default:i(()=>[t("div",Gw,[Z[8]||(Z[8]=t("i",{class:"bi bi-chat"},null,-1)),t("div",Ww,[o(Mt,null,{default:i(()=>[t("span",Hw,d(e(c)("editAgent.dialog.share.groupsTab.option.canChatLabel")),1)]),_:1}),t("span",Kw,d(e(c)("editAgent.dialog.share.groupsTab.option.canChatSubLabel")),1)])])]),_:1}),o(vt,{value:"EDIT"},{default:i(()=>[t("div",qw,[Z[9]||(Z[9]=t("i",{class:"bi bi-sliders"},null,-1)),t("div",Qw,[o(Mt,null,{default:i(()=>[t("span",Jw,d(e(c)("editAgent.dialog.share.groupsTab.option.canEditLabel")),1)]),_:1}),t("span",Xw,d(e(c)("editAgent.dialog.share.groupsTab.option.canEditSubLabel")),1)])])]),_:1}),o(Y,{class:"my-2"}),o(vt,{value:"DELETED",class:"flex justify-start w-full"},{default:i(()=>[t("div",Yw,[Z[10]||(Z[10]=t("i",{class:"bi bi-trash"},null,-1)),t("div",Zw,[t("span",e2,d(e(c)("editAgent.dialog.share.groupsTab.option.removeGroupLabel")),1)])])]),_:1})]),_:1})]),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue"])])]))),128))])])]),_:1})]),_:1}),t("div",t2,[t("div",s2,d(e(c)("editAgent.dialog.share.shareAgentGeneralAccess")),1),t("div",a2,[t("div",o2,[j.value==="NOTENANT"?(s(),T(Be,{key:0,class:"w-7 h-7"},{default:i(()=>Z[11]||(Z[11]=[t("i",{class:"bi bi-person-fill-lock text-lg"},null,-1)])),_:1,__:[11]})):(s(),T(Be,{key:1,class:"w-7 h-7"},{default:i(()=>Z[12]||(Z[12]=[t("i",{class:"bi bi-globe text-lg"},null,-1)])),_:1,__:[12]})),t("div",n2,[o(Ve,{id:"tenant-permission-select",defaultValue:"NOTENANT",modelValue:j.value,"onUpdate:modelValue":Z[2]||(Z[2]=st=>j.value=st)},{default:i(()=>[o(Nt,{class:"max-w-fit font-semibold py-0 h-8 text-base bg-transparent focus:ring-0 focus:ring-offset-0 border-none hover:bg-stone-200 dark:hover:bg-stone-800 space-x-1 mr-auto"},{default:i(()=>[o(lt),o(St,{class:"w-5 h-5 opacity-50 shrink-0 z-0"})]),_:1}),o(bt,null,{default:i(()=>[o(zt,null,{default:i(()=>[o(vt,{value:"NOTENANT"},{default:i(()=>[o(Mt,null,{default:i(()=>[me(d(e(c)("editAgent.dialog.share.shareStatusRestrictedLabel")),1)]),_:1})]),_:1}),o(vt,{value:"TENANT"},{default:i(()=>[o(Mt,null,{default:i(()=>[me(d(e(c)("editAgent.dialog.share.shareStatusAnyoneLabel")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),j.value==="NOTENANT"?(s(),u("span",l2,d(e(c)("editAgent.dialog.share.shareStatusRestrictedSubLabel")),1)):(s(),u("span",i2,d(e(c)("editAgent.dialog.share.shareStatusAnyoneSubLabel")),1))])])])]),o(ft,{class:"sm:justify-end gap-2"},{default:i(()=>[o(re,{variant:"outline",class:"rounded-3xl py-2 px-3.5",onClick:V},{default:i(()=>[t("span",r2,d(e(c)("editAgent.button.copyLinkButtonLabel")),1)]),_:1}),o(re,{class:"rounded-3xl py-2 px-3.5 items-center space-x-1",onClick:F,disabled:R.value},{default:i(()=>[t("span",c2,d(e(c)("editAgent.button.saveButtonLabel")),1),R.value?(s(),T(et,{key:0,class:"w-4 h-4 animate-spin"})):w("",!0)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})):w("",!0)])}}}),d2={class:"flex items-center gap-3"},u2={key:0,class:"text-sm"},p2={key:1,class:"text-sm"},m2={key:0,class:"text-sm"},g2={key:1,class:"text-sm"},f2={class:"text-sm"},v2={class:"flex items-center space-x-2 p-6 bg-slate-100 dark:bg-stone-900 rounded-lg"},h2={class:"flex flex-col max-w-48 sm:max-w-64 truncate"},_2={key:0,class:"break-words font-semibold"},b2={key:1,class:"whitespace-nowrap font-semibold"},k2={class:"text-xs"},y2={class:"text-xs"},x2={key:0,class:"font-semibold"},w2={key:1,class:"font-semibold"},$2={key:2,class:"font-semibold"},S2={class:"text-sm"},T2={class:"text-sm"},A2={class:"text-sm"},Ei=oe({__name:"UpdateOrPublishAgentDialog",props:{name:{},saveAnimation:{type:Boolean},publishAnimation:{type:Boolean},isDialogOpen:{type:Boolean}},emits:["submitForm","updatePublishedAgent","publishAgent","update:open"],setup(n,{emit:l}){const{toast:a}=gt(),{t:c}=Ce(),r=Gt(),{currentAgent:p,pinAgents:m,currentAgentId:g,currentAgentAcl:h,isUpdatedAgentFail:_,agentUpdateBeforePublishStatus:x}=ie(r),{pinAgent:b,unpinAgent:S,getPinAgents:D}=r,y=ot(),I=Ot(),{authenticationResult:C}=ie(I),U=c("editAgent.topBar.newAgentTitle"),E=v(!1),N=n,$=l,R=ne({get:()=>N.isDialogOpen,set:J=>$("update:open",J)}),B=ne(()=>Array.isArray(m.value)&&m.value.some(J=>{var H;return J.id===((H=p.value)==null?void 0:H.id)})),j=async()=>{try{E.value=!0,g.value&&(await S(g.value),await D(),a({title:c("editAgent.toast.success.unpinAgent")}))}catch{a({title:c("editAgent.toast.fail.generalErrorTitle"),description:c("editAgent.toast.fail.generalError"),variant:"destructive"})}finally{E.value=!1}},ee=()=>{$("submitForm")},se=()=>{var J,H;return(J=h.value)!=null&&J.tenant?"EVERYONE":((H=h.value)==null?void 0:H.users.length)===1?"ONLYME":"SHARED"},G=async()=>{try{E.value=!0,g.value&&(await b(g.value),await D(),a({title:c("editAgent.toast.success.pinAgent")}))}catch{a({title:c("editAgent.toast.fail.generalErrorTitle"),description:c("editAgent.toast.fail.generalError"),variant:"destructive"})}finally{E.value=!1}};return(J,H)=>{const M=f("Button"),W=f("DialogTitle"),X=f("DialogHeader"),O=f("Separator"),K=f("Loader"),V=f("DialogFooter"),F=f("DialogContent"),P=f("Dialog");return s(),u("div",null,[o(P,{open:R.value,"onUpdate:open":H[3]||(H[3]=q=>R.value=q)},{default:i(()=>{var q,A,k,L,z,Q,ae;return[t("div",d2,[(q=e(p))!=null&&q.id&&((A=e(p))==null?void 0:A.status)==="DRAFT"?(s(),T(M,{key:0,disabled:N.saveAnimation,class:pe(["rounded-3xl py-2 px-3.5 w-full",(k=e(p))!=null&&k.currentUserInfo&&e(p).currentUserInfo.permission==="READ"?"hidden":""]),onClick:ee},{default:i(()=>[e(_)?w("",!0):(s(),u("span",u2,d(e(c)("editAgent.button.updateButtonLabel")),1)),e(_)?(s(),u("span",p2,d(e(c)("editAgent.button.updateButtonLabel")),1)):w("",!0)]),_:1},8,["disabled","class"])):w("",!0),(L=e(p))!=null&&L.id&&((z=e(p))==null?void 0:z.status)==="PUBLISH"?(s(),T(M,{key:1,disabled:N.saveAnimation,class:pe(["rounded-3xl py-2 px-3.5 w-full",(Q=e(p))!=null&&Q.currentUserInfo&&e(p).currentUserInfo.permission==="READ"?"hidden":""]),onClick:H[0]||(H[0]=de=>$("updatePublishedAgent"))},{default:i(()=>[e(_)?w("",!0):(s(),u("span",m2,d(e(c)("editAgent.button.updateButtonLabel")),1)),e(_)?(s(),u("span",g2,d(e(c)("editAgent.button.updateButtonLabel")),1)):w("",!0)]),_:1},8,["disabled","class"])):w("",!0),((ae=e(p))==null?void 0:ae.status)!=="PUBLISH"?(s(),T(M,{key:2,disabled:!e(p)||N.publishAnimation||e(x)==="updating",class:"rounded-3xl py-2 px-3.5 w-full",onClick:H[1]||(H[1]=de=>$("publishAgent"))},{default:i(()=>[t("span",f2,d(e(c)("editAgent.button.publishButtonLabel")),1)]),_:1},8,["disabled"])):w("",!0)]),o(F,{class:"max-w-sm rounded-md sm:max-w-[425px] sm:rounded-lg"},{default:i(()=>{var de;return[o(X,null,{default:i(()=>[o(W,{class:"flex space-x-2"},{default:i(()=>[t("span",null,d(e(c)("editAgent.dialog.update.updateDialogHeader")),1)]),_:1})]),_:1}),o(O),t("div",v2,[o(wt,{fallbackText:N.name},null,8,["fallbackText"]),t("div",h2,[N.name?(s(),u("span",_2,d(N.name),1)):(s(),u("span",b2,d(e(U)),1)),t("span",k2,[me(d((de=e(C))==null?void 0:de.account.name)+" "+d(e(c)("editAgent.dialog.update.agentCreator"))+" ",1),H[4]||(H[4]=t("i",{class:"bi bi-person"},null,-1))])]),H[5]||(H[5]=t("div",{class:"flex grow justify-end"},[t("i",{class:"bi bi-check-lg text-green-500 text-xl"})],-1))]),t("span",y2,d(e(c)("editAgent.dialog.update.accessLabel")),1),se()==="ONLYME"?(s(),u("span",x2,[H[6]||(H[6]=t("i",{class:"bi bi-person-fill-lock"},null,-1)),me(" "+d(e(c)("editAgent.dialog.update.updateStatusOnlyMe")),1)])):se()==="SHARED"?(s(),u("span",w2,[H[7]||(H[7]=t("i",{class:"bi bi-person-fill"},null,-1)),me(" "+d(e(c)("editAgent.dialog.update.updateStatusAnyoneWithPermission")),1)])):(s(),u("span",$2,[H[8]||(H[8]=t("i",{class:"bi bi-globe"},null,-1)),me(" "+d(e(c)("editAgent.dialog.update.updateStatusEveryone")),1)])),o(V,{class:"sm:justify-end gap-2"},{default:i(()=>[B.value?B.value?(s(),T(M,{key:1,variant:"outline",class:"rounded-3xl py-2 px-3.5 space-x-1",disabled:N.saveAnimation,onClick:j},{default:i(()=>[H[10]||(H[10]=t("i",{class:"bi bi-eye-slash"},null,-1)),t("span",T2,d(e(c)("editAgent.dialog.option.unpinAgentButtonLabel")),1),E.value?(s(),T(K,{key:0,class:"w-4 h-4 animate-spin"})):w("",!0)]),_:1,__:[10]},8,["disabled"])):w("",!0):(s(),T(M,{key:0,variant:"outline",class:"rounded-3xl py-2 px-3.5 space-x-1",disabled:N.saveAnimation,onClick:G},{default:i(()=>[H[9]||(H[9]=t("i",{class:"bi bi-pin-angle"},null,-1)),t("span",S2,d(e(c)("editAgent.dialog.option.pinAgentButtonLabel")),1),E.value?(s(),T(K,{key:0,class:"w-4 h-4 animate-spin"})):w("",!0)]),_:1,__:[9]},8,["disabled"])),o(M,{class:"rounded-3xl py-2 px-3.5 space-x-1",onClick:H[2]||(H[2]=le=>{var te;return e(y).push(`/agent/${(te=e(p))==null?void 0:te.id}`)})},{default:i(()=>[t("span",A2,d(e(c)("editAgent.dialog.update.startConversationLabel")),1)]),_:1})]),_:1})]}),_:1})]}),_:1},8,["open"])])}}}),C2={class:"flex gap-3 justify-between items-center px-3 h-14 w-full shrink-0"},D2={class:"flex flex-row items-center justify-evenly space-x-2"},L2={class:"flex flex-col shrink-0 justify-start"},I2={key:1,class:"whitespace-nowrap text-sm font-semibold truncate max-w-40 sm:max-w-lg"},B2={key:0,class:"bi bi-patch-check-fill text-md text-blue-500 dark:text-blue-400 ml-1"},M2={key:2,class:"whitespace-nowrap text-sm font-semibold"},E2={key:4,class:"flex items-center space-x-1"},R2={class:"text-xs"},F2={key:5,class:"flex items-center space-x-1"},P2={class:"text-xs"},N2={key:0,class:"text-xs"},z2={key:1,class:"text-xs"},U2={key:2,class:"text-xs"},O2={class:"flex gap-2 items-center justify-between select-none"},j2={key:0,class:"flex items-center"},V2={key:1,class:"bi bi-check2 mr-2 text-green-500 text-xl"},G2={class:"text-xs sm:text-sm"},W2={class:"text-sm"},H2={class:"flex gap-1"},K2={class:"flex items-center justify-center space-x-1"},q2={class:"text-sm"},Q2={key:1},J2={class:"text-sm"},X2={class:"text-sm"},Y2={class:"text-sm"},Z2={class:"text-sm"},e$={class:"text-sm"},t$=oe({__name:"CreateAgentTopbar",props:{isDialogOpen:{type:Boolean},name:{},loadingAnimation:{type:Boolean},publishAnimation:{type:Boolean},saveAnimation:{type:Boolean}},emits:["submitForm","updatePublishedAgent","publishAgent","routeLeave","update:open"],setup(n,{emit:l}){const{toast:a}=gt(),{t:c}=Ce(),r=at(),p=Gt(),{currentAgent:m,currentAgentId:g,currentAgentAcl:h,pinAgents:_,agentUpdateBeforePublishStatus:x}=ie(p),{deleteAgentById:b,pinAgent:S,unpinAgent:D,getPinAgents:y}=p,{isMobileSize:I}=ie(r),C=c("editAgent.topBar.newAgentTitle"),U=v(!1),E=v(!1),N=v(!1),$=ot(),R=n,B=l,j=ne({get:()=>R.isDialogOpen,set:X=>B("update:open",X)}),ee=()=>{const X=h.value,O=(X==null?void 0:X.users)??[],K=(X==null?void 0:X.groups)??[];return(X==null?void 0:X.tenant)??null?"EVERYONE":O.length===1&&K.length===0?"ONLYME":"SHARED"},se=ne(()=>{switch(x.value){case"updating":return c("editAgent.button.updateButtonLabel.updating");case"updated":return c("editAgent.button.updateButtonLabel.updated");default:return c("editAgent.button.updateButtonLabel.updated")}}),G=ne(()=>Array.isArray(_.value)&&_.value.some(X=>{var O;return X.id===((O=m.value)==null?void 0:O.id)})),J=async()=>{try{U.value=!0,g.value&&(await S(g.value),await y(),a({title:c("editAgent.toast.success.pinAgent")}))}catch(X){console.log(X),a({title:c("editAgent.toast.fail.generalErrorTitle"),description:c("editAgent.toast.fail.generalError"),variant:"destructive"})}finally{U.value=!1}},H=async()=>{try{U.value=!0,g.value&&(await D(g.value),await y(),a({title:c("editAgent.toast.success.unpinAgent")}))}catch{a({title:c("editAgent.toast.fail.generalErrorTitle"),description:c("editAgent.toast.fail.generalError"),variant:"destructive"})}finally{U.value=!1}},M=()=>{window.history.length>1?$.back():$.push("/agents/mine")},W=async()=>{try{E.value=!0,g.value&&(await b(g.value),a({title:c("editAgent.toast.success.deleteAgent")}),M())}catch{a({title:c("editAgent.toast.fail.generalErrorTitle"),description:c("editAgent.toast.fail.generalError"),variant:"destructive"})}finally{N.value=!1,E.value=!1}};return Dt(()=>y()),(X,O)=>{var be,Ge,fe,Y,ce,ge,ye,_e;const K=f("Skeleton"),V=f("Loader"),F=f("Button"),P=f("DropdownMenuTrigger"),q=f("AlertDialogTrigger"),A=f("AlertDialogTitle"),k=f("AlertDialogDescription"),L=f("AlertDialogHeader"),z=f("AlertDialogCancel"),Q=f("AlertDialogAction"),ae=f("AlertDialogFooter"),de=f("AlertDialogContent"),le=f("AlertDialog"),te=f("DropdownMenuItem"),Z=f("DropdownMenuContent"),re=f("DropdownMenu"),ue=f("TooltipTrigger"),he=f("TooltipContent"),$e=f("Tooltip"),Se=f("TooltipProvider");return s(),u("div",C2,[t("div",D2,[o(Pe,{icon:"bi bi-chevron-left",variant:"ghost",size:"icon",tooltip:e(c)("editAgent.topBar.button.goBack"),onClick:O[0]||(O[0]=Re=>B("routeLeave")),disabled:R.saveAnimation},null,8,["tooltip","disabled"]),t("div",null,[R.loadingAnimation?(s(),T(K,{key:1,class:"h-10 w-10 rounded-full"})):(s(),T(wt,{key:0,fallbackText:R.name,size:"sm",avatarClass:"transition-all duration-700"},null,8,["fallbackText"]))]),t("div",L2,[R.loadingAnimation?(s(),T(K,{key:0,class:"h-4 w-72"})):R.name?(s(),u("span",I2,[me(d(R.name)+" ",1),(be=e(m))!=null&&be.verified?(s(),u("i",B2)):w("",!0)])):(s(),u("span",M2,d(e(C)),1)),R.loadingAnimation?(s(),T(K,{key:3,class:"h-4 w-72"})):!e(m)||e(m).status==="DRAFT"?(s(),u("span",E2,[O[11]||(O[11]=t("i",{class:"bi bi-circle-fill text-stone-400 text-[0.5rem]"},null,-1)),t("span",R2,d(e(c)("editAgent.topBar.activeStatusDraft")),1)])):(s(),u("span",F2,[O[15]||(O[15]=t("i",{class:"bi bi-circle-fill text-green-400 text-[0.5rem]"},null,-1)),t("span",P2,d(e(c)("editAgent.topBar.activeStatusLive")),1),O[16]||(O[16]=t("span",null,"",-1)),ee()==="ONLYME"?(s(),u("span",N2,[O[12]||(O[12]=t("i",{class:"bi bi-person-fill-lock"},null,-1)),me(" "+d(e(c)("editAgent.topBar.activeStatusPublishOnlyMe")),1)])):ee()==="SHARED"?(s(),u("span",z2,[O[13]||(O[13]=t("i",{class:"bi bi-person-fill"},null,-1)),me(" "+d(e(c)("editAgent.topBar.activeStatusPublishAnyoneWithPermission")),1)])):(s(),u("span",U2,[O[14]||(O[14]=t("i",{class:"bi bi-globe"},null,-1)),me(" "+d(e(c)("editAgent.topBar.activeStatusPublishEveryone")),1)]))]))])]),t("div",O2,[(Ge=e(m))!=null&&Ge.id&&e(x)!=="notUpdated"?(s(),u("div",j2,[e(x)==="updating"?(s(),T(V,{key:0,class:"w-4 h-4 animate-spin mr-2"})):w("",!0),e(x)!=="updating"?(s(),u("i",V2)):w("",!0),t("span",G2,d(se.value),1)])):w("",!0),e(I)?(s(),T(re,{key:2,open:N.value,"onUpdate:open":O[6]||(O[6]=Re=>N.value=Re)},{default:i(()=>[o(P,null,{default:i(()=>[e(m)?(s(),T(F,{key:0,variant:"ghost",class:"p-5 rounded-3xl"},{default:i(()=>O[22]||(O[22]=[t("i",{class:"bi bi-three-dots"},null,-1)])),_:1,__:[22]})):w("",!0)]),_:1}),o(Z,{class:"rounded-xl"},{default:i(()=>{var Re,ke,qe,lt;return[!G.value&&((Re=e(m))==null?void 0:Re.status)==="PUBLISH"?(s(),T(te,{key:0,onClick:J,class:"cursor-pointer"},{default:i(()=>[O[23]||(O[23]=t("i",{class:"bi bi-pin-angle"},null,-1)),t("span",Y2,d(e(c)("editAgent.dialog.option.pinAgentButtonLabel")),1),U.value?(s(),T(V,{key:0,class:"w-4 h-4 animate-spin"})):w("",!0)]),_:1,__:[23]})):G.value&&((ke=e(m))==null?void 0:ke.status)==="PUBLISH"?(s(),T(te,{key:1,onClick:H,class:"cursor-pointer"},{default:i(()=>[O[24]||(O[24]=t("i",{class:"bi bi-eye-slash"},null,-1)),t("span",Z2,d(e(c)("editAgent.dialog.option.unpinAgentButtonLabel")),1),U.value?(s(),T(V,{key:0,class:"w-4 h-4 animate-spin"})):w("",!0)]),_:1,__:[24]})):w("",!0),((lt=(qe=e(m))==null?void 0:qe.currentUserInfo)==null?void 0:lt.permission)==="OWNER"?(s(),T(te,{key:2},{default:i(()=>[o(le,null,{default:i(()=>[o(q,{onClick:O[4]||(O[4]=Ye(()=>{},["stop"])),class:"text-red-600 flex gap-2"},{default:i(()=>[O[25]||(O[25]=t("i",{class:"bi bi-trash"},null,-1)),t("span",e$,d(e(c)("editAgent.dialog.deleteAgent.deleteAgentDialogHeader")),1)]),_:1,__:[25]}),o(de,null,{default:i(()=>[o(L,null,{default:i(()=>[o(A,null,{default:i(()=>[me(d(e(c)("editAgent.dialog.deleteAgent.deleteAgentDialogHeader")),1)]),_:1}),o(k,null,{default:i(()=>[me(d(e(c)("editAgent.dialog.deleteAgent.deleteAgentDialogDescription")),1)]),_:1})]),_:1}),o(ae,null,{default:i(()=>[o(z,{onClick:O[5]||(O[5]=St=>N.value=!1)},{default:i(()=>[me(d(e(c)("editAgent.button.cancelButtonLabel")),1)]),_:1}),o(Q,{onClick:W,class:"bg-red-600 hover:bg-red-500"},{default:i(()=>[me(d(e(c)("editAgent.button.deleteButtonLabel"))+" ",1),E.value?(s(),T(V,{key:0,class:"w-4 h-4 animate-spin"})):w("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):w("",!0)]}),_:1})]),_:1},8,["open"])):(s(),u(ve,{key:1},[o(re,{open:N.value,"onUpdate:open":O[3]||(O[3]=Re=>N.value=Re)},{default:i(()=>[o(P,null,{default:i(()=>{var Re,ke;return[((ke=(Re=e(m))==null?void 0:Re.currentUserInfo)==null?void 0:ke.permission)==="OWNER"?(s(),T(F,{key:0,variant:"ghost",class:"p-5 rounded-3xl dark:hover:bg-stone-700"},{default:i(()=>O[17]||(O[17]=[t("i",{class:"bi bi-three-dots"},null,-1)])),_:1,__:[17]})):w("",!0)]}),_:1}),o(Z,{class:"rounded-xl"},{default:i(()=>{var Re,ke;return[((ke=(Re=e(m))==null?void 0:Re.currentUserInfo)==null?void 0:ke.permission)==="OWNER"?(s(),T(te,{key:0},{default:i(()=>[o(le,null,{default:i(()=>[o(q,{onClick:O[1]||(O[1]=Ye(()=>{},["stop"])),class:"text-red-600 flex gap-2"},{default:i(()=>[O[18]||(O[18]=t("i",{class:"bi bi-trash"},null,-1)),t("span",W2,d(e(c)("editAgent.dialog.deleteAgent.deleteAgentDialogHeader")),1)]),_:1,__:[18]}),o(de,null,{default:i(()=>[o(L,null,{default:i(()=>[o(A,null,{default:i(()=>[me(d(e(c)("editAgent.dialog.deleteAgent.deleteAgentDialogHeader")),1)]),_:1}),o(k,null,{default:i(()=>[me(d(e(c)("editAgent.dialog.deleteAgent.deleteAgentDialogDescription")),1)]),_:1})]),_:1}),o(ae,null,{default:i(()=>[o(z,{onClick:O[2]||(O[2]=qe=>N.value=!1)},{default:i(()=>[me(d(e(c)("editAgent.button.cancelButtonLabel")),1)]),_:1}),o(Q,{onClick:W,class:"bg-red-600 hover:bg-red-500"},{default:i(()=>[me(d(e(c)("editAgent.button.deleteButtonLabel"))+" ",1),E.value?(s(),T(V,{key:0,class:"w-4 h-4 animate-spin"})):w("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):w("",!0)]}),_:1})]),_:1},8,["open"]),o(Mi),t("div",H2,[((fe=e(m))==null?void 0:fe.status)==="DRAFT"&&!e(I)?(s(),T(Se,{key:0},{default:i(()=>[o($e,null,{default:i(()=>[o(ue,{"as-child":""},{default:i(()=>[o(F,{disabled:"",variant:"outline"},{default:i(()=>[t("div",K2,[O[19]||(O[19]=t("i",{class:"bi bi-pin-angle text-lg mr-2"},null,-1)),t("span",q2,d(e(c)("editAgent.dialog.option.pinAgentButtonLabel")),1)])]),_:1})]),_:1}),o(he,null,{default:i(()=>[t("p",null,d(e(c)("editAgent.topBar.button.disabled.noPublishedAgent")),1)]),_:1})]),_:1})]),_:1})):(s(),u("div",Q2,[!G.value&&(((Y=e(m))==null?void 0:Y.status)==="PUBLISH"||((ce=e(m))==null?void 0:ce.status)==="DRAFT")?(s(),T(F,{key:0,variant:"outline",onClick:J},{default:i(()=>[O[20]||(O[20]=t("i",{class:"bi bi-pin-angle text-lg mr-2"},null,-1)),t("span",J2,d(e(c)("editAgent.dialog.option.pinAgentButtonLabel")),1),U.value?(s(),T(V,{key:0,class:"w-4 h-4 animate-spin ml-2"})):w("",!0)]),_:1,__:[20]})):w("",!0),G.value&&(((ge=e(m))==null?void 0:ge.status)==="PUBLISH"||((ye=e(m))==null?void 0:ye.status)==="DRAFT")?(s(),T(F,{key:1,disabled:((_e=e(m))==null?void 0:_e.status)==="DRAFT",variant:"outline",onClick:H},{default:i(()=>[O[21]||(O[21]=t("i",{class:"bi bi-eye-slash text-lg mr-2"},null,-1)),t("span",X2,d(e(c)("editAgent.dialog.option.unpinAgentButtonLabel")),1),U.value?(s(),T(V,{key:0,class:"w-4 h-4 animate-spin ml-2"})):w("",!0)]),_:1,__:[21]},8,["disabled"])):w("",!0)]))])],64)),o(Ei,{open:j.value,"onUpdate:open":O[7]||(O[7]=Re=>j.value=Re),name:R.name,saveAnimation:R.saveAnimation,publishAnimation:R.publishAnimation,isDialogOpen:R.isDialogOpen,onSubmitForm:O[8]||(O[8]=Re=>B("submitForm")),onPublishAgent:O[9]||(O[9]=Re=>B("publishAgent")),onUpdatePublishedAgent:O[10]||(O[10]=Re=>B("updatePublishedAgent")),class:"hidden sm:block"},null,8,["open","name","saveAnimation","publishAnimation","isDialogOpen"])])])}}}),s$={class:"flex justify-end gap-2"},to=oe({__name:"ConfirmLeavingDialog",props:{isOpen:{type:Boolean},isWaiting:{type:Boolean},title:{},description:{},showCancelButton:{type:Boolean,default:!0},cancelButton:{},confirmButton:{}},emits:["cancel","confirm"],setup(n,{emit:l}){const a=Ce(),{t:c}=We(a.t),r=n,p=l;return(m,g)=>{const h=f("AlertDialogTitle"),_=f("AlertDialogHeader"),x=f("AlertDialogDescription"),b=f("Button"),S=f("Loader"),D=f("AlertDialogFooter"),y=f("AlertDialogContent"),I=f("AlertDialog");return s(),T(I,{open:r.isOpen,class:"w-full"},{default:i(()=>[o(y,null,{default:i(()=>[o(_,null,{default:i(()=>[o(h,null,{default:i(()=>[me(d(r.title),1)]),_:1})]),_:1}),o(x,null,{default:i(()=>[me(d(r.description),1)]),_:1}),o(D,null,{default:i(()=>[t("div",s$,[r.showCancelButton?(s(),T(b,{key:0,onClick:g[0]||(g[0]=C=>p("cancel")),class:"col-span-2"},{default:i(()=>[t("span",null,d(r.cancelButton??e(c)("kaigikun.dialog.confirmLeaving.footer.button.cancel")),1)]),_:1})):w("",!0),o(b,{onClick:g[1]||(g[1]=C=>p("confirm")),variant:"secondary",class:"rounded-full bg-red-600 text-white hover:bg-red-500"},{default:i(()=>[t("span",null,d(r.confirmButton??e(c)("kaigikun.dialog.confirmLeaving.footer.button.leave")),1),r.isWaiting?(s(),T(S,{key:0,class:"ml-2 w-4 h-4 animate-spin"})):w("",!0)]),_:1})])]),_:1})]),_:1})]),_:1},8,["open"])}}}),a$={key:0,class:"relative flex flex-row max-w-full border border-input bg-white dark:bg-stone-700 py-2 px-4 items-center justify-between rounded-lg"},o$={class:"flex flex-row items-center gap-2 pr-2"},n$={class:"flex flex-col"},l$={class:"wrap-anywhere"},i$={key:0,class:"text-xs"},r$={key:0},el=oe({__name:"AgentFileItem",props:{fileId:{},fileName:{},isProcessing:{type:Boolean},isQueueing:{type:Boolean}},setup(n){const{t:l}=Ce(),a=n,c=Rt(a.fileName),r=qs(),p=Gt(),{currentAgentId:m,currentAgent:g}=ie(p);return(h,_)=>{var S,D;const x=f("Loader"),b=f("Button");return a.fileName!==void 0?(s(),u("div",a$,[t("div",o$,[t("i",{class:pe(["bi",`bi-filetype-${e(c)}`,"text-3xl"])},null,2),t("div",n$,[t("p",l$,d(a.fileName),1),a.isQueueing?(s(),u("p",i$,d(e(l)("editAgent.waitingToUploadLabel")),1)):w("",!0)])]),t("div",null,[a.isProcessing?(s(),T(x,{key:0,class:"w-4 h-4 animate-spin"})):w("",!0)]),!a.isProcessing&&!a.isQueueing?(s(),u("div",r$,[o(b,{variant:"default",size:"smicon",class:"absolute top-[-6px] right-[-6px] rounded-full w-4 h-4 flex",onClick:_[0]||(_[0]=y=>e(r).deleteAgentFile(e(m),a.fileId)),disabled:((S=e(g))==null?void 0:S.currentUserInfo)&&((D=e(g))==null?void 0:D.currentUserInfo.permission)==="READ"},{default:i(()=>_[1]||(_[1]=[t("i",{class:"bi bi-x"},null,-1)])),_:1,__:[1]},8,["disabled"])])):w("",!0)])):w("",!0)}}}),c$={class:"w-full flex h-[calc(100dvh-3.5rem)]"},d$={class:"w-full sm:w-1/2 flex justify-center overflow-y-auto"},u$={class:"flex flex-col w-11/12 mt-7"},p$={class:"flex items-center gap-4 mb-6"},m$={key:0,class:"w-1/2 sm:w-1/3"},g$={class:"space-y-6"},f$={key:0,class:"flex flex-col gap-1"},v$={key:0,class:"flex flex-col gap-1"},h$={key:0},_$={key:0,class:"flex flex-col gap-2 mt-2"},b$={class:"flex items-center gap-3"},k$={class:"text-md font-medium"},y$={class:"flex flex-col mt-6 gap-2"},x$={class:"text-base font-bold"},w$={key:0,class:"flex flex-col gap-1 mb-2"},$$={class:"focus-visible:ring-offset-0 dark:bg-background border rounded-lg"},S$={class:"flex justify-end items-center px-2.5 mt-2"},T$={key:0,class:"flex items-center justify-between gap-2 bg-stone-100 dark:bg-stone-800 w-full p-2 rounded-lg my-1"},A$={class:"wrap-anywhere max-w-9/10 text-sm px-2"},C$={class:"flex flex-col mt-6 gap-2"},D$={class:"text-base font-bold"},L$={key:0,class:"flex flex-col gap-1 mb-2"},I$={class:"knowledge space-y-6 mt-6"},B$={class:"text-sm text-muted-foreground mt-2"},M$={key:0,class:"flex flex-col items-start justify-start gap-3"},E$={key:0,class:"flex items-center gap-3"},R$={class:"text-md font-medium"},F$={class:"text-sm text-muted-foreground max-w-full"},P$={class:"flex flex-col gap-3"},N$={class:"flex flex-row gap-2 items-center"},z$={class:"flex flex-row gap-2 items-center"},U$={key:0,class:"py-4"},O$={class:"flex w-full flex-col-reverse gap-2"},j$={class:"max-sm:hidden w-1/2 border-l"},V$=oe({__name:"CreateAgentView",setup(n){const l=at(),{isMobileSize:a}=ie(l),c=Gt(),r=qs(),{agentFiles:p,selectedFiles:m,isPolling:g,isDroppingFileToAgent:h,uploadingFileCount:_}=ie(r),{isUpdatedAgentFail:x,currentAgentId:b,currentAgent:S,supportModelsForAgent:D,sampleQuestions:y,sampleQuestion:I,agentUpdateStatus:C,agentInfoChanged:U,agentUpdateBeforePublishStatus:E,userCategoryList:N}=ie(c),{createAgent:$,publishAgent:R,editAgent:B,getAgentById:j,getLLMForAgentList:ee,getUserCategories:se}=c,G=ps(),{currentLanguage:J}=ie(G),H=Ce(),{t:M}=We(H.t),W=ot(),X=tt(),O=v(!1),K=v(!1),V=v(void 0),F=v(!0),P=v(!1),q=v(!0),A=v(null),k=ne({get:()=>A.value??null,set:ze=>{A.value=ze??null}}),L=v(!1),z=ze=>{ae.value=ze.modelId,de.value=ze.name,le.value=ze.description,te.value=ze.instructions,F.value=ze.allowDownload,q.value=ze.showInstructions,y.value=ze.sampleQuestions,k.value=ze.category?ze.category.id:null};ia(()=>{S.value=void 0,b.value=void 0}),Dt(async()=>{var ze,Be;C.value="notUpdated",E.value="notUpdated",r.clearState();try{I.value="",K.value=!0;const et=X.params.id;if(D.value.length===0&&await ee(),ae.value=D.value[0].modelId,await se(),et){be.value=!0;const ft=await j(et);(ze=S.value)!=null&&ze.currentUserInfo&&((Be=S.value)==null?void 0:Be.currentUserInfo.permission)==="NONE"?W.replace("/agent/access-denied"):(b.value=et,z(ft),await r.retrieveAllAgentFiles(et),r.startPolling())}else{y.value=[];return}}catch(et){console.error(et),W.replace("/agent/access-denied"),Z({title:M("editAgent.toast.fail.retrieveAgent"),variant:"destructive"})}finally{K.value=!1}});const Q=(ze,Be)=>ze-Be<=2,ae=v(""),de=v(""),le=v(""),te=v(""),{toast:Z}=gt(),re=ze=>{a.value||(ze.preventDefault(),he(I.value))},ue=ze=>{var Be;(Be=y.value)==null||Be.splice(ze,1)},he=ze=>{var Be;!ze||y.value&&(y.value.length>=Ns||I.value.length>fs)||((Be=y.value)==null||Be.push(ze),I.value="")};Te([de,le,te],()=>{b.value||Ze()});const $e=v(!1),Se=()=>{$e.value=!1},be=v(!1),Ge=async()=>{V.value=!0;try{!b.value&&!S.value&&(await $(de.value??"",le.value??"",te.value??"",ae.value,F.value,q.value,y.value,k.value),de.value||(de.value=""),le.value||(le.value=""),te.value||(te.value=""),Te(()=>b.value,async Be=>{Be&&Be!==""&&(W.replace({path:`/agents/editor/${Be}`}),await j(Be))},{immediate:!0})()),be.value=!0}catch(ze){console.error(ze),Z({title:M("editAgent.toast.fail.createAgent"),variant:"destructive"})}finally{V.value=!1}},fe=async()=>{try{L.value=!1,O.value=!0,b.value&&(Ve.cancel(),await vt(),await R(b.value),await j(b.value),Z({title:M("editAgent.toast.success.createAgent")}))}catch(ze){console.error(ze),Z({title:M("editAgent.toast.fail.generalErrorTitle"),description:M("editAgent.toast.fail.generalError"),variant:"destructive"})}finally{O.value=!1,L.value=!0}},Y=v(!1),ce=async ze=>{var ht;if(h.value=!0,ze.preventDefault(),!((ht=ze.dataTransfer)!=null&&ht.files))return;const Be=Array.from(ze.dataTransfer.files);if(r.wouldExceedUploadAgentFileLimit(Be.length)){Z({title:M("home.toast.fail.generalErrorTitle"),description:M("editAgent.toast.fail.exceedLimitNumberOfFile",{maxFilesPerAgent:ja}),variant:"destructive"}),ge.value.value="";return}const et=Be.map(r.handleSingleFileUpload);_.value+=et.filter(pt=>pt.isValidExtension&&pt.isValidSize).length,_e(et.flatMap(pt=>pt.isValidExtension?[]:[pt.file]),"home.toast.fail.fileExtensionInvalid"),_e(et.flatMap(pt=>pt.isValidSize?[]:[pt.file]),"home.toast.fail.fileSizeInvalid");const ft=Te(()=>b.value,pt=>{pt&&pt!==""&&W.replace({path:`/agents/editor/${pt}`})},{immediate:!0});try{S.value||(await $("","","",ae.value,F.value,q.value),ft()),await r.uploadSelectedFiles(b.value),r.stopPolling(),r.startPolling()}catch(pt){console.log(pt),Z({title:M("home.toast.fail.generalErrorTitle"),description:M("home.toast.fail.generalError"),variant:"destructive"})}finally{h.value=!1}},ge=v(null),ye=()=>{var ze;(ze=ge.value)==null||ze.click()};ls(()=>{Ze.cancel(),r.clearState()});const _e=(ze,Be)=>{if(ze.length===0)return;const et=ze.map(ht=>ht.name).join(", "),ft=ze.length===1?M("home.toast.fail.uploadFileFailSingle",{fileName:et}):M("home.toast.fail.uploadFileFailPlural",{fileName:et});Z({title:M(Be),description:ft,variant:"destructive"})},Re=async ze=>{const Be=ze.target;if(!Be.files)return;const et=Array.from(Be.files);if(r.wouldExceedUploadAgentFileLimit(et.length)){Z({title:M("home.toast.fail.generalErrorTitle"),description:M("editAgent.toast.fail.exceedLimitNumberOfFile",{maxFilesPerAgent:ja}),variant:"destructive"}),ge.value.value="";return}const ft=et.map(r.handleSingleFileUpload);_.value+=ft.filter(ht=>ht.isValidExtension&&ht.isValidSize).length,_e(ft.flatMap(ht=>ht.isValidExtension?[]:[ht.file]),"home.toast.fail.fileExtensionInvalid"),_e(ft.flatMap(ht=>ht.isValidSize?[]:[ht.file]),"home.toast.fail.fileSizeInvalid"),ge.value.value="",!S.value&&m.value&&(await $("","","",ae.value,F.value,q.value),Te(()=>b.value,pt=>{pt&&pt!==""&&W.replace({path:`/agents/editor/${pt}`})},{immediate:!0})()),await r.uploadSelectedFiles(b.value),r.stopPolling(),r.startPolling()};Te(()=>g.value.length,async(ze,Be)=>{Be>ze&&ze<Ul&&(await r.uploadSelectedFiles(b.value),r.stopPolling(),r.startPolling())});const ke=v(!1),qe=v(!1);let lt;const St=async()=>{qe.value=!0,ke.value=!1,W.push(lt)},Nt=()=>{ke.value=!1},Mt=(ze,Be,et)=>{if(et&&et.path==="/agents/editor/"){Be();return}m.value.some(ft=>ft.isQueueing)&&!qe.value?(Be(!1),ke.value=!0,lt=ze.path):Be()};qo((ze,Be,et)=>{Mt(ze,et,Be)}),Qo((ze,Be,et)=>{Mt(ze,et)});const vt=async()=>{Ve.cancel(),C.value="updating",E.value="updating";try{V.value=!0,b.value&&await B(b.value,de.value??"",le.value??"",te.value??"",ae.value,F.value,q.value,y.value,k.value??null)}catch(ze){console.error(ze),Z({title:M("editAgent.toast.fail.updateAgent"),variant:"destructive"})}finally{V.value=!1,C.value="updated",E.value="updated",U.value=!1}},zt=async()=>{var ze,Be,et,ft;(((Be=(ze=S.value)==null?void 0:ze.currentUserInfo)==null?void 0:Be.permission)==="EDIT"||((ft=(et=S.value)==null?void 0:et.currentUserInfo)==null?void 0:ft.permission)==="OWNER")&&U.value&&await vt(),W.back()},bt=async()=>{if(await vt(),x.value){L.value=!1;return}Z({title:M("editAgent.toast.success.updateAgent")}),L.value=!0},Ve=us(vt,jl),Ze=us(Ge,Vl);return Te([de,le,te,ae,F,q,k],(ze,Be)=>{const[et,ft,ht]=Be;[et,ft,ht].every(pt=>pt==="")||b.value&&(U.value=!0,Ve())}),Te(y,()=>{b.value&&P.value&&(U.value=!0,Ve()),P.value=!0},{deep:!0}),(ze,Be)=>{var nt,Je,Ee,je,Ie,ct,Wt,Zt,Xt,_t,Xe,qt,Yt,rs,cs,vs,ds,Es,xs,Xs;const et=f("Label"),ft=f("Skeleton"),ht=f("Input"),pt=f("Switch"),jt=f("Textarea"),st=f("ToggleGroupItem"),Fe=f("ToggleGroup"),xe=f("Button"),rt=Kt("auto-animate");return s(),u("div",{class:"flex flex-col h-dvh w-full divide-y",onDragover:Be[12]||(Be[12]=Ye(dt=>Y.value=!0,["prevent"])),onDragleave:Be[13]||(Be[13]=dt=>Y.value=!1),onDrop:Be[14]||(Be[14]=dt=>{Y.value=!1,ce(dt)})},[o(t$,{open:L.value,"onUpdate:open":Be[0]||(Be[0]=dt=>L.value=dt),name:(nt=e(S))==null?void 0:nt.name,loadingAnimation:K.value,publishAnimation:O.value,saveAnimation:V.value,isDialogOpen:L.value,onSubmitForm:vt,onRouteLeave:zt,onPublishAgent:fe,onUpdatePublishedAgent:bt,class:"sticky top-0 dark:bg-stone-800 bg-white z-10"},null,8,["open","name","loadingAnimation","publishAnimation","saveAnimation","isDialogOpen"]),o(to,{title:e(M)("editAgent.dialog.confirmLeaving.title"),description:e(M)("kaigikun.dialog.confirmLeaving.description"),isOpen:ke.value,onCancel:Nt,onConfirm:St},null,8,["title","description","isOpen"]),t("div",c$,[t("div",d$,[t("div",u$,[t("div",p$,[o(et,{for:"models",class:"text-base font-bold"},{default:i(()=>[me(d(e(M)("editAgent.modelLabel")),1)]),_:1}),K.value?(s(),T(ft,{key:1,class:"h-10 w-1/4 mt-3"})):(s(),u("div",m$,[o(Ds,{disabled:((Je=e(S))==null?void 0:Je.currentUserInfo)!==null&&((Ee=e(S))==null?void 0:Ee.currentUserInfo.permission)==="READ",modelValue:ae.value,"onUpdate:modelValue":Be[1]||(Be[1]=dt=>ae.value=dt),icon:"bi bi-chevron-down",items:e(D),itemKey:"modelId",itemText:"displayName"},null,8,["disabled","modelValue","items"])]))]),t("div",g$,[t("div",null,[o(et,{class:"text-base font-bold"},{default:i(()=>[me(d(e(M)("editAgent.nameLabel")),1)]),_:1}),K.value?(s(),T(ft,{key:1,class:"h-10 w-full mt-3"})):(s(),u("div",f$,[Ke(o(ht,{id:"name",type:"name",class:"text-sm focus-visible:ring-offset-0 mt-2",maxLength:"50",placeholder:e(M)("editAgent.namePlaceholder"),modelValue:de.value,"onUpdate:modelValue":Be[2]||(Be[2]=dt=>de.value=dt),disabled:((je=e(S))==null?void 0:je.currentUserInfo)&&((Ie=e(S))==null?void 0:Ie.currentUserInfo.permission)==="READ"},null,8,["placeholder","modelValue","disabled"]),[[e(Jt),!0]]),t("span",{class:pe(["self-end text-xs px-3 max-sm:hidden",[Q(50,de.value.length)?"text-red-400 font-semibold":"text-stone-400"]])},d(e(M)("home.chat.message.maxLengthCharacters",{inputLength:de.value.length,maxLength:50})),3)]))]),t("div",null,[o(et,{for:"description",class:"text-base font-bold"},{default:i(()=>[me(d(e(M)("editAgent.descriptionLabel")),1)]),_:1}),K.value?(s(),T(ft,{key:1,class:"h-10 w-full mt-3"})):(s(),u("div",v$,[o(ht,{id:"description",type:"description",maxLength:"300",class:"text-sm focus-visible:ring-offset-0 mt-2",placeholder:e(M)("editAgent.descriptionPlaceholder"),modelValue:le.value,"onUpdate:modelValue":Be[3]||(Be[3]=dt=>le.value=dt),disabled:((ct=e(S))==null?void 0:ct.currentUserInfo)&&((Wt=e(S))==null?void 0:Wt.currentUserInfo.permission)==="READ"},null,8,["placeholder","modelValue","disabled"]),t("span",{class:pe(["self-end text-xs px-3 max-sm:hidden",[Q(300,le.value.length)?"text-red-400 font-semibold":"text-stone-400"]])},d(e(M)("home.chat.message.maxLengthCharacters",{inputLength:le.value.length,maxLength:300})),3)]))]),(!e(X).params.id||e(S)&&e(X).params.id)&&(((Xt=(Zt=e(S))==null?void 0:Zt.currentUserInfo)==null?void 0:Xt.permission)!=="READ"||e(S).showInstructions)?(s(),u("div",h$,[o(et,{for:"prompt",class:"text-base font-bold"},{default:i(()=>[me(d(e(M)("editAgent.instructionLabel")),1)]),_:1}),K.value?(s(),T(ft,{key:1,class:"h-28 w-full mt-3"})):(s(),u("div",_$,[t("div",b$,[t("span",k$,d(e(M)("editAgent.showInstructions")),1),o(pt,{size:"base",checked:q.value,"onUpdate:checked":Be[4]||(Be[4]=dt=>q.value=dt),disabled:((_t=e(S))==null?void 0:_t.currentUserInfo)&&((Xe=e(S))==null?void 0:Xe.currentUserInfo.permission)==="READ"},null,8,["checked","disabled"])]),o(jt,{id:"prompt",type:"prompt",maxlength:e(xo),class:"min-h-28 overflow-auto resize-none text-sm focus-visible:ring-offset-0 dark:bg-background mt-2",placeholder:e(M)("editAgent.instructionPlaceholder"),modelValue:te.value,"onUpdate:modelValue":Be[5]||(Be[5]=dt=>te.value=dt),disabled:((qt=e(S))==null?void 0:qt.currentUserInfo)&&((Yt=e(S))==null?void 0:Yt.currentUserInfo.permission)==="READ"},null,8,["maxlength","placeholder","modelValue","disabled"]),t("span",{class:pe(["self-end text-xs px-3 max-sm:hidden",[Q(e(xo),te.value.length)?"text-red-400 font-semibold":"text-stone-400"]])},d(e(M)("home.chat.message.maxLengthCharacters",{inputLength:te.value.length,maxLength:e(xo)})),3)]))])):w("",!0)]),t("div",y$,[t("p",x$,d(e(M)("editAgent.exampleQuestion")),1),K.value?(s(),T(ft,{key:1,class:"h-24 w-full mt-3"})):(s(),u("div",w$,[t("div",$$,[o(jt,{id:"sample-question-textarea",class:"max-h-24 overflow-auto resize-none text-sm dark:bg-background border-none",onCompositionstart:Be[6]||(Be[6]=dt=>$e.value=!0),onCompositionend:Se,placeholder:e(y)&&e(y).length<e(Ns)?e(M)("editAgent.exampleQuestion.placeholder",{limit:e(fs)}):e(M)("editAgent.exampleQuestion.placeholder.reachedLimit",{limit_questions:e(Ns)}),modelValue:e(I),"onUpdate:modelValue":Be[7]||(Be[7]=dt=>kt(I)?I.value=dt:null),disabled:((rs=e(S))==null?void 0:rs.currentUserInfo)&&((cs=e(S))==null?void 0:cs.currentUserInfo.permission)==="READ"||e(y)&&e(y).length>=e(Ns),onKeydown:yt(Ye(re,["exact"]),["enter"]),maxlength:e(fs)},null,8,["placeholder","modelValue","disabled","onKeydown","maxlength"]),t("div",S$,[o(Pe,{variant:"default",disabled:!e(I)||e(y)&&e(y).length>=e(Ns)||e(I).length>e(fs),icon:"bi bi-save text-sm",className:"my-2",size:"icon",tooltip:e(M)("editAgent.exampleQuestion.button.label"),onClick:Be[8]||(Be[8]=dt=>he(e(I)))},null,8,["disabled","tooltip"])])]),t("span",{class:pe(["self-end text-xs px-4 max-sm:hidden select-none",[Q(e(fs),e(I).length)?"text-red-400 font-semibold":"text-stone-400"]])},d(e(M)("home.chat.message.maxLengthCharacters",{inputLength:e(I).length,maxLength:e(fs)})),3)])),Ke((s(),u("div",null,[(s(!0),u(ve,null,Le(e(y),(dt,Qt)=>{var Ut,ws,$s,hs;return s(),u("div",{key:Qt,class:"w-full flex items-center gap-4"},[Be[15]||(Be[15]=t("div",null,[t("i",{class:"bi bi-patch-question"})],-1)),dt!==""?(s(),u("div",T$,[t("span",A$,d(dt),1),((ws=(Ut=e(S))==null?void 0:Ut.currentUserInfo)==null?void 0:ws.permission)==="OWNER"||((hs=($s=e(S))==null?void 0:$s.currentUserInfo)==null?void 0:hs.permission)==="EDIT"?(s(),T(Pe,{key:0,icon:"bi bi-trash3",variant:"ghost",size:"icon",tooltip:e(M)("editAgent.exampleQuestion.deleteButton.label"),className:"text-red-500 hover:text-red-400",onClick:Ba=>ue(Qt)},null,8,["tooltip","onClick"])):w("",!0)])):w("",!0)])}),128))])),[[rt]])]),t("div",C$,[t("p",D$,d(e(M)("editAgent.categoryLabel")),1),K.value?(s(),T(ft,{key:1,class:"h-24 w-full mt-3"})):(s(),u("div",L$,[o(Fe,{type:"single",modelValue:k.value,"onUpdate:modelValue":Be[9]||(Be[9]=dt=>k.value=dt),class:"flex flex-wrap gap-3 justify-start"},{default:i(()=>[(s(!0),u(ve,null,Le(e(N),dt=>{var Qt,Ut;return s(),T(st,{key:dt.id,value:dt.id,disabled:((Qt=e(S))==null?void 0:Qt.currentUserInfo)&&((Ut=e(S))==null?void 0:Ut.currentUserInfo.permission)==="READ",class:"px-4 rounded-full font-semibold dark:text-black text-gray-700 bg-gray-100 hover:bg-blue-100 data-[state=on]:bg-blue-500 data-[state=on]:text-white dark:data-[state=on]:text-white focus:ring-2 focus:ring-blue-500 ring-offset-2"},{default:i(()=>[me(d(dt.displayName[e(J)??"en_US"]),1)]),_:2},1032,["value","disabled"])}),128))]),_:1},8,["modelValue"])]))]),t("div",I$,[o(et,{for:"knowledge",class:"text-base font-bold"},{default:i(()=>[me(d(e(M)("editAgent.knowledgeLabel")),1)]),_:1}),t("p",B$,d(e(M)("editAgent.knowledgeSubLabel",{maxFilesPerAgent:e(ja),maxFileSize:e(La)+"MB",supportFileFormats:"pdf, txt, pptx, xlsx, csv, docx, md"})),1),Ke((s(),u("div",null,[e(p).length>0?(s(),u("div",M$,[K.value?(s(),T(ft,{key:1,class:"h-7 w-full"})):(s(),u("div",E$,[t("p",R$,d(e(M)("editAgent.showRefFile")),1),o(pt,{disabled:((vs=e(S))==null?void 0:vs.currentUserInfo)&&((ds=e(S))==null?void 0:ds.currentUserInfo.permission)==="READ",size:"base",checked:F.value,"onUpdate:checked":Be[10]||(Be[10]=dt=>F.value=dt)},null,8,["disabled","checked"])])),t("p",F$,d(e(M)("editAgent.showRefFileSubLabel")),1)])):w("",!0)])),[[rt]]),o(xe,{variant:"outline",class:"rounded-full font-semibold px-4",onClick:ye,disabled:((Es=e(S))==null?void 0:Es.currentUserInfo)&&((xs=e(S))==null?void 0:xs.currentUserInfo.permission)==="READ"},{default:i(()=>[me(d(e(M)("editAgent.button.uploadFileButtonLabel")),1)]),_:1},8,["disabled"]),t("div",P$,[(s(!0),u(ve,null,Le(e(m),(dt,Qt)=>(s(),u("div",{key:Qt},[t("div",N$,[Be[16]||(Be[16]=t("div",null,[t("i",{class:"bi bi-dot"})],-1)),(s(),T(el,{fileId:dt.fileId,fileName:dt.file.name,isProcessing:dt.isProcessing,isQueueing:dt.isQueueing,key:Qt},null,8,["fileId","fileName","isProcessing","isQueueing"]))])]))),128)),(s(!0),u(ve,null,Le(e(p),(dt,Qt)=>{var Ut,ws;return s(),u("div",{key:Qt},[t("div",z$,[Be[17]||(Be[17]=t("div",null,"",-1)),(s(),T(el,{fileId:dt.id,fileName:dt.fileName,isProcessing:e(g).includes(dt.id),key:Qt,class:pe({"opacity-50":((ws=(Ut=e(S))==null?void 0:Ut.currentUserInfo)==null?void 0:ws.permission)==="READ"})},null,8,["fileId","fileName","isProcessing","class"]))])])}),128))]),t("input",{id:"agent-file-input",type:"file",class:"hidden",ref_key:"fileInput",ref:ge,accept:".pdf,.txt,.md,.pptx,.xlsx,.csv,.docx",onChange:Re,multiple:""},null,544),t("input",{id:"agent-folder-input",type:"file",class:"hidden",ref:"folderInput",webkitdirectory:"",onChange:Re,multiple:""},null,544)]),e(a)?(s(),u("div",U$,[t("div",O$,[o(Mi),o(Ei,{open:L.value,"onUpdate:open":Be[11]||(Be[11]=dt=>L.value=dt),name:(Xs=e(S))==null?void 0:Xs.name,publishAnimation:O.value,saveAnimation:V.value,isDialogOpen:L.value,onSubmitForm:vt,onPublishAgent:fe,onUpdatePublishedAgent:bt},null,8,["open","name","publishAnimation","saveAnimation","isDialogOpen"])])])):w("",!0)])]),t("div",j$,[o(yi,{isUsingPreviewAgent:!0,isAllowedToPreviewChat:be.value},null,8,["isAllowedToPreviewChat"])])])],32)}}}),G$={key:0,class:"bg-stone-50 dark:bg-stone-800 flex flex-col gap-1 justify-between pt-2 xl:pt-3 px-2 xl:px-3 pb-1 transition-all duration-300"},W$=["src"],H$={class:"flex flex-col gap-1 pl-2 max-sm:pr-2 xl:pl-3"},K$={class:"flex-1 pl-2 xl:pl-3 max-sm:pr-2 pt-2 xl:pt-4"},q$={key:0,class:"text-xs font-semibold p-2 mt-2 pointer-events-none"},Q$={class:"flex-1 text-xs text-ellipsis overflow-hidden whitespace-nowrap h-full p-2"},J$={class:"truncate text-xs"},X$={class:"max-w-md line-clamp-2"},Y$={class:"absolute right-0 top-0"},Z$={class:"conversation-tools"},eS={class:"ml-2"},tS={class:"ml-2"},sS={key:0,class:"mb-2"},aS={class:"sticky bottom-0 left-0 w-full bg-stone-50 dark:bg-stone-900 p-2 flex items-center gap-3 sm:hidden"},Ia=oe({__name:"AppSubSidebarShell",props:{loading:{type:Boolean},hasMoreItems:{type:Boolean},items:{},activeItemId:{},disableDeleteActive:{type:Boolean},disableHeader:{type:Boolean}},emits:["editItem","deleteItem","arrivedBottom","navigateHome"],setup(n,{expose:l,emit:a}){const c=v();Te(()=>Ht.global.locale,H=>{c.value=H.replace("_","-")});const{t:r}=We(Ce().t),p=xt(),m=at(),{isMobileSize:g}=ie(m),{privateGPTSidebarState:h}=ie(p),_=n,x=a,b=()=>{x("navigateHome"),ee()},S=H=>{H.preventDefault()};Dt(async()=>{c.value=Ht.global.locale.replace("_","-")});const D=H=>tc(new Date,H),y=H=>H.charAt(0).toUpperCase()+H.slice(1),I=(H,M)=>H===0?r("home.subSidebar.label.createdTime.today"):H===1?r("home.subSidebar.label.createdTime.yesterday"):1<H&&H<=7?r("home.subSidebar.label.createdTime.thisWeek"):7<H&&H<=30?r("home.subSidebar.label.createdTime.thisMonth"):y(new Intl.DateTimeFormat(c.value,{month:"long",year:"numeric"}).format(M.updatedAt)),C=ne(()=>{let H="";return _.items.map(M=>{const W=D(M.updatedAt),X=I(W,M);return H!=X?(H=X,{...M,label:X,shouldDisplayLabel:!0}):{...M,label:X,shouldDisplayLabel:!1}})}),U=v(),E=v(""),N=v({}),$=H=>{N.value[H]=!1},R=H=>{h.value=!0,U.value=H.id,E.value=H.name},B=H=>{U.value=null,E.value="",$(H)},j=async H=>{E.value.trim()!=H.name&&E.value.length>0&&U.value&&x("editItem",U.value,E.value),B(H.id)},ee=()=>{g.value&&p.privateGPTSidebarState&&p.toggleVisibleState(h)},se=Bt("contentContainer"),G=v(!0);l({scrollToTop:()=>{var H;(H=se.value)==null||H.scrollToTop()}});const J=ne(()=>g.value?p.mobileSidebarState:p.privateGPTSidebarState);return(H,M)=>{const W=f("Input"),X=f("TooltipTrigger"),O=f("TooltipContent"),K=f("Tooltip"),V=f("TooltipProvider"),F=f("Button"),P=f("DropdownMenuTrigger"),q=f("DropdownMenuItem"),A=f("DropdownMenuContent"),k=f("DropdownMenu"),L=f("RouterLink"),z=f("Skeleton");return s(),u("div",{class:pe(["bg-stone-50 dark:bg-stone-800 shrink-0 border-none h-dvh flex flex-col overflow-hidden transition-all duration-300",[J.value?"w-64":"w-0"]])},[_.disableHeader?w("",!0):(s(),u("div",G$,[t("img",{src:e(si),alt:"FPT Logo",class:"block sm:hidden hover:cursor-pointer w-10 ml-2 mb-2",onClick:b},null,8,W$),we(H.$slots,"stickyHeader")])),o(sn,{class:pe(["w-full",{"pt-2 xl:pt-3":_.disableHeader}]),ref_key:"contentContainer",ref:se,"shadow-style-top":"h-8 right-0 via-stone-50/80 to-stone-50","disable-scroll-to-bottom":!0,onArrivedTop:M[2]||(M[2]=Q=>G.value=!0),onLeaveTop:M[3]||(M[3]=Q=>G.value=!1),onArrivedBottom:M[4]||(M[4]=Q=>x("arrivedBottom"))},{default:i(()=>[o(ii,{class:"sm:hidden mb-3"}),t("div",H$,[we(H.$slots,"subNavList")]),t("div",K$,[(s(!0),u(ve,null,Le(C.value,Q=>(s(),u("div",{key:Q.id,class:"group flex flex-col rounded-md mb-1"},[Q.shouldDisplayLabel?(s(),u("p",q$,d(Q.label),1)):w("",!0),o(L,{to:Q.link},{default:i(()=>[t("div",{class:pe(["flex items-stretch rounded-md cursor-pointer hover:bg-stone-200 dark:hover:bg-stone-700 justify-between",[_.activeItemId&&(_.activeItemId===Q.id?"bg-stone-200 dark:bg-stone-700":"")]]),onClick:ee},[t("div",Q$,[U.value&&U.value===Q.id?Ke((s(),T(W,{key:0,modelValue:E.value,"onUpdate:modelValue":M[0]||(M[0]=ae=>E.value=ae),onBlur:ae=>j(Q),onKeyup:yt(ae=>j(Q),["enter"]),class:"h-4 w-full rounded-none text-xs px-0 py-1 pointer-events-auto"},null,8,["modelValue","onBlur","onKeyup"])),[[e(Jt),!0]]):(s(),T(V,{key:1},{default:i(()=>[o(K,null,{default:i(()=>[o(X,{"as-child":""},{default:i(()=>[t("p",J$,d(Q.name),1)]),_:2},1024),o(O,null,{default:i(()=>[t("p",X$,d(Q.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))]),U.value?w("",!0):(s(),u("div",{key:0,class:pe(["relative group-hover:w-4 transition-all duration-300",e(g)?"w-4":"w-0"])},[t("div",Y$,[o(k,{open:N.value[Q.id??""],"onUpdate:open":ae=>N.value[Q.id??""]=ae},{default:i(()=>[o(P,{"as-child":""},{default:i(()=>[o(F,{variant:"ghost",size:"mdicon",class:pe(["h-8 transition-opacity duration-300 hover:bg-transparent","sm:group-hover:opacity-100",e(g)?"opacity-100":"opacity-0"]),onClick:M[1]||(M[1]=Ye(()=>{},["stop"]))},{default:i(()=>M[5]||(M[5]=[t("i",{class:"bi bi-three-dots"},null,-1)])),_:1,__:[5]},8,["class"])]),_:1}),o(A,{onCloseAutoFocus:S},{default:i(()=>[t("div",Z$,[o(q,{class:"cursor-pointer py-2.5",variant:"ghost",size:"full",onSelect:ae=>R(Q)},{default:i(()=>[M[6]||(M[6]=t("i",{class:"bi bi-pencil ml-1"},null,-1)),t("span",eS,d(e(r)("home.subSidebar.button.renameConversation")),1)]),_:2,__:[6]},1032,["onSelect"]),o(Za,{title:e(r)("home.subSidebar.dialog.deleteConversation.title"),description:e(r)("home.subSidebar.dialog.deleteConversation.description"),onCancel:ae=>$(Q.id),onConfirm:ae=>x("deleteItem",Q.id),onDisabled:ae=>_.disableDeleteActive&&Q.id===_.activeItemId},{trigger:i(()=>[o(F,{variant:"destructive",size:"full"},{default:i(()=>[M[7]||(M[7]=t("i",{class:"bi bi-trash ml-0.5"},null,-1)),t("span",tS,d(e(r)("home.subSidebar.button.deleteConversation")),1)]),_:1,__:[7]})]),_:2},1032,["title","description","onCancel","onConfirm","onDisabled"])])]),_:2},1024)]),_:2},1032,["open","onUpdate:open"])])],2))],2)]),_:2},1032,["to"])]))),128))]),H.hasMoreItems?(s(),u("div",sS,[t("div",{class:pe([_.loading?"opacity-100":"opacity-0","transition-all opacity-0"])},[(s(),u(ve,null,Le(2,Q=>t("div",{class:"flex items-center justify-between space-x-1 pl-4 p-1.5",key:Q},[o(z,{class:"-ml-0.5 h-4 w-full bg-stone-200 dark:bg-stone-900/80"})])),64))],2)])):w("",!0)]),_:3},8,["class"]),t("div",aS,[o(ln,{"is-show-account-name-btn":!0})])],2)}}}),oS={class:"truncate max-w-36 text-xs"},nS={class:"truncate max-w-36 text-xs"},lS=["onClick"],iS={class:"flex gap-2 items-center min-w-0"},rS={class:"truncate w-full text-xs"},cS={class:"w-fit text-xs"},dS={key:0,class:"bi bi-patch-check-fill text-md text-blue-500 dark:text-blue-400"},Mo=10,tl=oe({__name:"AppSubSidebar",setup(n){const l=v();Te(()=>Ht.global.locale,k=>{l.value=k.replace("_","-")});const{t:a}=Ce(),{toast:c}=gt(),r=ot(),p=tt(),m=xt(),g=ms(),{conversations:h,currentOffset:_,totalConversations:x,currentConversation:b,currentParentMessageId:S,generatingResponse:D,hasMore:y,shouldLeaveWhiteSpace:I}=ie(g),C=ne(()=>h.value.map(k=>({id:k.id||"",name:k.conversationName,link:k.agentId?`/agent/${k.agentId}/chat/${k.id}`:`/chat/${k.id}`,updatedAt:k.updatedAt}))),U=Is(),{contextFiles:E,readyFiles:N,attachments:$}=ie(U),R=Gt(),{pinAgents:B}=ie(R),{unpinAgent:j,getPinAgents:ee}=R,se=at(),{isMobileSize:G}=ie(se),{privateGPTSidebarState:J}=ie(m),{setIgnore:H}=m,M=()=>{$.value=[],E.value=[],N.value=[],b.value=void 0,S.value=null,r.push("/"),A()},W=async k=>{r.push(`/agent/${k}`),I.value=!1,A()},X=v(!1);Dt(async()=>{try{l.value=Ht.global.locale.replace("_","-"),await ee(),h.value.length===0&&(X.value=!0,await g.fetchConversations(_.value,28),_.value+=28)}catch(k){console.error(k),c({title:a("home.toast.fail.generalErrorTitle"),description:a("home.toast.fail.generalError"),variant:"destructive"})}finally{X.value=!1}});const O=async()=>{if(!(X.value||!y.value||_.value>x.value)){X.value=!0;try{const k=await g.fetchConversations(_.value,Mo);k&&k.length<Mo&&(y.value=!1),_.value+=Mo}catch(k){console.error("Error loading more data, ",k)}finally{X.value=!1}}},K=Bt("shell"),V=async k=>{try{await j(k),await ee(),c({title:a("home.toast.success.unpinAgent")})}catch(L){console.error(L),c({title:a("home.toast.fail.generalErrorTitle"),description:a("home.toast.fail.generalError"),variant:"destructive"})}},F=async(k,L)=>{try{await g.editConversationTitle(L,k)}catch(z){console.error(z),c({title:a("home.subSidebar.toast.fail.renameConversation"),variant:"destructive"})}},P=async k=>{try{await g.deleteConversation(k),c({title:a("home.toast.success.deleteConversation"),description:a("home.toast.success.deleteConversationDescription")}),r.replace("/")}catch(L){console.error(L),c({title:a("home.toast.fail.generalErrorTitle"),description:a("home.toast.fail.generalError"),variant:"destructive"})}},q=()=>{r.push("/agents"),U.clearState(),A()},A=()=>{G.value&&m.privateGPTSidebarState&&m.toggleVisibleState(J)};return Te(()=>D.value,()=>{var k;(k=K.value)==null||k.scrollToTop()}),(k,L)=>(s(),T(Ia,{loading:X.value,items:C.value,"has-more-items":e(y),"active-item-id":e(p).params.id,onEditItem:F,onDeleteItem:P,onNavigateHome:M,onArrivedBottom:O,ref_key:"shell",ref:K},{stickyHeader:i(()=>[t("div",{onClick:M,class:"hidden sm:flex w-full items-center gap-1 justify-start p-1.5 rounded-md hover:bg-stone-200 dark:hover:bg-stone-700 cursor-pointer"},[L[1]||(L[1]=t("div",{class:"rounded-full h-7 w-7 flex justify-center items-center"},[t("i",{class:"bi bi-pencil-square text-lg"})],-1)),t("div",oS,d(e(a)("home.subSidebar.tooltip.newChat")),1)])]),subNavList:i(()=>[t("div",{onClick:q,class:"w-full flex items-center gap-1 justify-start max-sm:px-2.5 p-1.5 py-1 rounded-md hover:bg-stone-200 dark:hover:bg-stone-700 cursor-pointer"},[L[2]||(L[2]=t("div",{class:"rounded-full h-6 w-6 -ml-1 sm:ml-0 sm:h-7 sm:w-7 flex justify-center items-center"},[t("i",{class:"bi bi-grid text-lg"})],-1)),t("div",nS,d(e(a)("home.subSidebar.button.searchAgent")),1)]),(s(!0),u(ve,null,Le(e(B),(z,Q)=>(s(),u("div",{key:Q,class:"flex group items-center py-1.5 pl-1.5 xl:pl-2.5 rounded-md w-full cursor-pointer hover:bg-stone-200 dark:hover:bg-stone-700 justify-between",size:"full",onClick:ae=>W(z.id)},[t("div",iS,[o(wt,{fallbackText:z.name,size:e(G)?"xxs":"xs",class:"xl:-ml-1"},null,8,["fallbackText","size"]),o(Aa,null,{trigger:i(()=>[t("span",rS,d(z.name),1)]),content:i(()=>[t("span",cS,d(z.name),1)]),_:2},1024),z.verified?(s(),u("i",dS)):w("",!0)]),t("div",null,[t("div",{onClick:L[0]||(L[0]=Ye(()=>{},["stop"]))},[o(na,{buttonVariant:"ghost",icon:"bi bi-three-dots",size:"mdicon",buttonClass:["transition-opacity duration-300 hover:bg-transparent","sm:group-hover:opacity-100",e(G)?"opacity-100":"opacity-0"].join(" "),items:[{id:z.id,disabled:!1}],itemKey:"id",onOnSelect:ae=>V(z.id),onOnTrigger:e(H)},{item:i(()=>[L[3]||(L[3]=t("i",{class:"bi bi-eye-slash"},null,-1)),t("span",null,d(e(a)("home.subSidebar.button.unpinAgent")),1)]),_:2},1032,["buttonClass","items","onOnSelect","onOnTrigger"])])])],8,lS))),128))]),_:1},8,["loading","items","has-more-items","active-item-id"]))}}),uS=oe({__name:"ChatMainView",setup(n){const l=at(),{isMobileSize:a}=ie(l);return(c,r)=>{const p=f("RouterView");return s(),u(ve,null,[e(a)?(s(),T(Cs,{key:0,defer:"",to:"#mobile-sub-sidebar"},[o(tl)])):(s(),T(Cs,{key:1,defer:"",to:"#sub-sidebar"},[o(tl)])),o(p)],64)}}}),pS=[{path:"/",name:"private-gpt",component:uS,children:[{path:"",name:"home",component:f0,meta:{allowDragAndDrop:!0}},{path:"/chat/:id?",name:"chat",component:Xn,meta:{allowDragAndDrop:!0}},{path:"/agent/:agentId",name:"agent-chat-home",component:yi,meta:{allowDragAndDrop:!0}},{path:"/agent/:agentId/chat/:id?",name:"agent-chat",component:Xn,meta:{allowDragAndDrop:!0}},{path:"/agents",component:pk,meta:{allowDragAndDrop:!1}},{path:"/agents/mine",name:"my-agent",component:Yk,meta:{allowDragAndDrop:!1}}]}],mS=[{path:"/groups",component:Q0,children:[{path:":id/agents",name:"group-agents",component:Ky},{path:":id/member",name:"group-member",component:zx},{path:":id/setting",name:"group-setting",component:rw}],meta:{allowDragAndDrop:!1,requiresAuth:!0,title:"PrivateGPT"}},{path:"/agents/editor/:id?",name:"create-agent",component:V$,meta:{allowDragAndDrop:!1,requiresAuth:!0,title:"PrivateGPT"}},{path:"/agent/access-denied",name:"agent-access-denied",component:ti,meta:{allowDragAndDrop:!1,title:"Access denied"}}],sl={withSidebarRoutes:pS,noSidebarRoutes:mS},Gs=Ft("recordingStore",()=>{const n=v(!1),l=v(),a=v(!0),c=v(!1),r=v(),p=v(),m=v(),g=v([]),h=ne(()=>{var Y;return((Y=m.value)==null?void 0:Y.summary.map(ce=>ce.topic))??[]}),_=ne(()=>{var Y;return(Y=m.value)==null?void 0:Y.summary.map(ce=>`# ${ce.topic}

${ce.content}`).join(`

`)}),x=v([]),b=v([]),S=v([]),D=v(new Set),y=v([]),I=v(!1),C=v(!0),U=v(!1),E=v(!1),N=v(!1),$=v(!1),R=v(!1),B=v(!0),j=v(!1),ee=v(""),se=v(""),G=v(),J=v(!1),H=v("default"),M=v([]),W=async Y=>{try{const ce=await Qe.post("/recordings",Y),ge=Gn(ce.data);return b.value.unshift(ge),ge}catch(ce){console.error("Error create new recording: ",ce)}},X=Y=>{var ce,ge;(ge=(ce=l.value)==null?void 0:ce.messageList)==null||ge.push({id:Y.recording_message_id,transcription:Y.transcription,translation:Y.translation,timestamp:String(Math.floor(Math.ceil(Y.timestamp)/60)).padStart(2,"0")+":"+String(Math.floor(Math.ceil(Y.timestamp)%60)).padStart(2,"0"),timestampNumb:Y.timestamp,speakerId:Y.speaker_id,note:null}),Y.speaker_id&&!D.value.has(Y.speaker_id)&&D.value.add(Y.speaker_id)},O=async Y=>{try{(await Qe.put(`/recordings/${Y}/audio/stop`)).status===200&&(l.value.status="STOP")}catch(ce){console.error(`Error stop the recording of id ${Y}: `,ce)}},K=async Y=>{const ce=await Qe.get(`/recordings/${Y}`);l.value=Gn(ce.data),a.value=l.value.enableTranslation},V=async(Y,ce)=>{try{const ge=await Qe.get("/recordings",{params:{offset:Y,limit:ce}}),ye=Up(ge.data);return Y===0?b.value=[...ye.items]:b.value.push(...ye.items),ye.total}catch(ge){console.error("Error get the recording list: ",ge)}},F=async Y=>{const ce=b.value.findIndex(ge=>ge.id===Y);await Qe.delete(`/recordings/${Y}`),b.value.splice(ce,1)},P=async(Y,ce)=>{var ye;const ge=b.value.find(_e=>_e.id===Y);ge&&(await Qe.put(`/recordings/${Y}`,{new_name:ce}),ge.name=ce,((ye=l.value)==null?void 0:ye.id)===Y&&(l.value.name=ce))},q=v();return{isFetching:U,isFetchingSpeaker:E,isFetchingBookmark:N,isFetchingSummary:$,isGeneratingSummary:c,selectedTemplate:r,topics:h,summaryContent:_,currentRecordingSummary:m,currentRecordingLocaleList:x,isCreateRecordingDialogOpen:I,recordings:b,recordingTemplateList:g,isNewRecording:n,currentRecording:l,audioAvailable:j,recordUrl:ee,showTranslation:a,currentRecordingSpeakerIds:D,currentRecordingSpeakers:S,currentRecordingContent:p,currentRecordingBookmarks:y,timeStampNumber:q,newBookmarkId:se,editingBookmarkId:G,isLoadingRecord:R,hasMoreRecording:B,isRecordDialogFirstStep:C,allowToShareScreenAudio:J,createNewRecording:W,addRecordingMessage:X,stopRecording:O,fetchRecordingById:K,fetchRecordingList:V,deleteRecording:F,renameRecording:P,updateMessageSpeaker:async(Y,ce,ge)=>{var ye;try{await Qe.put(`recordings/${Y}/messages/${ce}/speaker`,ge);const _e=(ye=l.value)==null?void 0:ye.messageList.find(ke=>ke.id===ce),Re=S.value.find(ke=>ke.speakerId===ge.new_speaker);_e&&Re&&(_e.speakerId=ge.new_speaker)}catch(_e){console.error(`Error update the speaker of the message with ${ce}: `,_e)}},renameSpeaker:async(Y,ce,ge)=>{const ye=await Qe.put(`recordings/${Y}/speakers/${ce}`,{new_name:ge}),_e=S.value.findIndex(Re=>Re.speakerId===ce);return _e!==-1&&(S.value[_e]=jp(ye.data)),ye},fetchRecordingSpeakerList:async Y=>{try{const ce=await Qe.get(`/recordings/${Y}/speakers`);S.value=Op(ce.data)}catch(ce){console.error(`Error fetch the speaker list of the recording with the id of ${Y}: `,ce)}},checkAudioAvailable:async Y=>{try{await Qe.get(`/recordings/${Y}/audio/available`),j.value=!0}catch(ce){console.error(ce),j.value=!1}},getRecordFileUrl:async Y=>{const ce=await Qe.get(`/recordings/${Y}/audio/download`,{responseType:"blob"});ee.value=URL.createObjectURL(ce.data)},updateMessage:async(Y,ce,ge)=>{if(!l.value)return;const ye=await Qe.put(`recordings/${l.value.id}/messages/${Y.id}/edit`,{new_transcription:ce,new_translation:ge}),_e=Wn(ye.data),Re=l.value.messageList.find(ke=>ke.id===Y.id);return Re&&(Re.transcription=_e.transcription,Re.translation=_e.translation),_e},translateMessage:async Y=>{if(!l.value)return;const ce=await Qe.put(`recordings/${l.value.id}/messages/${Y.id}/translate`),ge=Wn(ce.data),ye=l.value.messageList.find(_e=>_e.id===Y.id);return ye&&(ye.translation=ge.translation),ge},fetchBookmarksList:async Y=>{const ce=await Qe.get(`/recordings/${Y}/bookmarks`);y.value=ce.data.map(Ja)},bookmark:async(Y,ce,ge)=>{const ye=await Qe.post(`/recordings/${Y}/messages/${ce}/bookmarks`,ge),_e=Ja(ye.data);if(se.value=_e.id,y.value.length===0)y.value.push(_e);else{const Re=y.value.findIndex(ke=>ke.timestamp>_e.timestamp);Re===-1?y.value.push(_e):y.value.splice(Re,0,_e)}},editBookmark:async(Y,ce,ge,ye)=>{const _e=await Qe.put(`/recordings/${Y}/messages/${ce}/bookmarks/${ge}`,ye),Re=y.value.find(ke=>ke.id===ge);Re&&(Re.content=_e.data.content)},deleteBookmark:async(Y,ce,ge)=>{const ye=y.value.findIndex(_e=>_e.id===ge);await Qe.delete(`/recordings/${Y}/messages/${ce}/bookmarks/${ge}`),y.value.splice(ye,1)},generateSummary:async(Y,ce)=>{try{c.value=!0;const ge=await Qe.post(`/recordings/${Y}/summary`,ce);m.value=ua(ge.data)}finally{c.value=!1}},fetchSummary:async(Y,ce="en_US")=>{const ge=await Qe.get(`recordings/${Y}/summary`,{params:{locale:ce}});m.value=ua(ge.data)},fetchLocale:async Y=>{const{data:ce}=await Qe.get(`/recordings/${Y}/available-locale`);x.value=ce.map(Yo)},fetchRecordingTemplates:async()=>{const Y=await Qe.get("/recordings/summary-templates");g.value=Jl(Y.data)},regenerateSummary:async(Y,ce)=>{c.value=!0;const ge=await Qe.put(`/recordings/${Y}/summary/regenerate`,ce),ye=ua(ge.data);return c.value=!1,ye},deleteSummary:async(Y,ce)=>{await Qe.delete(`/recordings/${Y}/summary`,{params:{locale:ce}})},clearState:()=>{l.value=void 0,ee.value="",j.value=!1,S.value=[],D.value=new Set,p.value=void 0,y.value=[]},selectedDeviceId:H,audioInputDevices:M}}),Qs=Ft("presentationStore",()=>{const n=v(!1),l=v(!1),a=v(!1),c=v(!1),r=v(!0),p=v(),m=v(),g=v([]),h=v(),_=v([]),x=v(),b=v(!1),S=v(!0),D=v([]),y=v(),I=v(),C=v(!1),U=v([]),E=v(),N=ne(()=>{var Y;return((Y=E.value)==null?void 0:Y.summary.map(ce=>ce.topic))??[]}),$=ne(()=>{var Y;return(Y=E.value)==null?void 0:Y.summary.map(ce=>`${ce.topic}
${ce.content}`).join(`

`)}),R=v(1),B=v(1),j=v(100),ee=v(!1),se=()=>{B.value+=.1,j.value+=10,ee.value=!1},G=()=>{B.value-=.1,j.value-=10,ee.value=!1},J=()=>{R.value>1&&R.value--},H=()=>{var Y;(Y=I.value)!=null&&Y.value&&R.value<I.value.value&&R.value++},M=()=>{ee.value=!ee.value},W=v(1),X=["text-sm","text-md","text-lg","text-xl","text-2xl","text-3xl"];return{isNewPresentation:n,isFetching:a,isFetchingSummary:c,presentationList:_,isCreatePresentationDialogOpen:l,showTranslation:r,currentPresentation:p,presentationFile:h,currentPresentationFileInfo:m,currentPresentationSpeakers:g,timeStampNumber:x,uploadPresentationFile:async()=>{const Y=new FormData;if(h.value){Y.append("file",h.value);const{data:ce}=await Qe.post("/presentations/files/upload",Y,{headers:{"Content-Type":"multipart/form-data"}});m.value=sp(ce)}},createNewPresentation:async Y=>{try{const ce=await Qe.post("/presentations",Y),ge=Vn(ce.data);return _.value.unshift(ge),ee.value=!1,ge}catch(ce){console.error("Error create new presentation: ",ce)}},addPresentationMessage:Y=>{var ce,ge;(ge=(ce=p.value)==null?void 0:ce.messageList)==null||ge.push({id:Y.presentation_message_id,transcription:Y.transcription,translation:Y.translation,timestamp:String(Math.floor(Math.ceil(Y.timestamp)/60)).padStart(2,"0")+":"+String(Math.floor(Math.ceil(Y.timestamp)%60)).padStart(2,"0"),timestampNumb:Y.timestamp,speakerId:Y.speaker_id,note:null})},stopPresentation:async Y=>{try{(await Qe.put(`/presentations/${Y}/audio/stop`)).status===200&&(p.value.status="STOP")}catch(ce){console.error(`Error stop the presentation of id ${Y}: `,ce)}},fetchPresentationById:async Y=>{ee.value=!1;const ce=await Qe.get(`/presentations/${Y}`);p.value=Vn(ce.data),r.value=p.value.enableTranslation},fetchPresentationList:async(Y,ce)=>{try{const ge=await Qe.get("/presentations",{params:{offset:Y,limit:ce}}),ye=Np(ge.data);return Y===0?_.value=[...ye.items]:_.value.push(...ye.items),ye.total}catch(ge){console.error("Error get the presentation list: ",ge)}},deletePresentation:async Y=>{const ce=_.value.findIndex(ge=>ge.id===Y);await Qe.delete(`/presentations/${Y}`),_.value.splice(ce,1)},renamePresentation:async(Y,ce)=>{var ye;const ge=_.value.find(_e=>_e.id===Y);ge&&(await Qe.put(`/presentations/${Y}`,{new_name:ce}),ge.name=ce,((ye=p.value)==null?void 0:ye.id)===Y&&(p.value.name=ce))},updateMessageSpeaker:async(Y,ce,ge)=>{var ye;try{await Qe.put(`presentations/${Y}/messages/${ce}/speaker`,ge);const _e=(ye=p.value)==null?void 0:ye.messageList.find(ke=>ke.id===ce),Re=g.value.find(ke=>ke.speakerId===ge.new_speaker);_e&&Re&&(_e.speakerId=ge.new_speaker)}catch(_e){console.error(`Error update the speaker of the message with ${ce}: `,_e)}},renameSpeaker:async(Y,ce,ge)=>{const ye=await Qe.put(`presentations/${Y}/speakers/${ce}`,{new_name:ge}),_e=g.value.findIndex(Re=>Re.speakerId===ce);return _e!==-1&&(g.value[_e]=ql(ye.data)),ye},fetchPresentationSpeakerList:async Y=>{try{const ce=await Qe.get(`/presentations/${Y}/speakers`);g.value=Kl(ce.data)}catch(ce){console.error(`Error fetch the speaker list of the presentation with the id of ${Y}: `,ce)}},getPresentationAudioFileUrl:async Y=>{try{const ce=await Qe.get(`/presentations/${Y}/audio/download`,{responseType:"blob"});if(ce.status!==200)throw new Error(`Failed to fetch the file: ${ce.statusText}`);return URL.createObjectURL(ce.data)}catch(ce){console.log("Failed to get presentation audio file: ",ce)}},updateMessage:async(Y,ce,ge)=>{if(!p.value)return;const ye=await Qe.put(`presentations/${p.value.id}/messages/${Y.id}/edit`,{new_transcription:ce,new_translation:ge}),_e=Qa(ye.data),Re=p.value.messageList.find(ke=>ke.id===Y.id);return Re&&(Re.transcription=_e.transcription,Re.translation=_e.translation),_e},translateMessage:async Y=>{if(!p.value)return;const ce=await Qe.put(`presentations/${p.value.id}/messages/${Y.id}/translate`),ge=Qa(ce.data),ye=p.value.messageList.find(_e=>_e.id===Y.id);return ye&&(ye.translation=ge.translation),ge},getPresentationFile:async Y=>{const ce=await Qe.get(`/presentations/${Y}/files/download`,{responseType:"blob"});if(ce.status!==200)throw new Error(`Failed to fetch the file: ${ce.statusText}`);const ge=URL.createObjectURL(ce.data),ye=Ku(ge);return y.value=ye.pdf,I.value=ye.pages,B.value=1,j.value=100,ge},zoomIn:se,zoomOut:G,prevPage:J,nextPage:H,pdf:y,pages:I,page:R,scale:B,scaleNumb:j,isFitParent:ee,toggleFitParent:M,isLoadingPresent:b,sizeIndex:W,sizeClasses:X,hasMorePresentation:S,increaseTextSize:()=>{W.value<X.length-1&&W.value++},decreaseTextSize:()=>{W.value>0&&W.value--},generateSummary:async(Y,ce)=>{try{C.value=!0;const ge=await Qe.post(`/presentations/${Y}/summary`,ce);E.value=To(ge.data)}finally{C.value=!1}},fetchLocale:async Y=>{const{data:ce}=await Qe.get(`/presentations/${Y}/available-locale`);U.value=ce.map(Yo)},fetchSummary:async(Y,ce="en_US")=>{const ge=await Qe.get(`/presentations/${Y}/summary`,{params:{locale:ce}});E.value=To(ge.data)},regenerateSummary:async(Y,ce)=>{C.value=!0;const ge=await Qe.put(`/presentations/${Y}/summary/regenerate`,ce),ye=To(ge.data);return C.value=!1,ye},deleteSummary:async(Y,ce)=>{await Qe.delete(`/presentations/${Y}/summary`,{params:{locale:ce}})},topics:N,isGeneratingSummary:C,currentPresentationLocaleList:U,currentPresentationSummary:E,summaryContent:$,fetchPresentationTemplates:async()=>{const Y=await Qe.get("/presentations/summary-templates");D.value=Pp(Y.data)},presentationTemplateList:D,clearState:()=>{p.value=void 0,E.value=void 0}}}),gS="/assets/ClickMeBro-C8SZeN54.png",fS="/assets/ClickMeBroDark-BN9RL7cj.png",vS="/assets/PrivateGPTKaigiInstruction-D3mmPq8q.mp4",hS={class:"hidden"},_S={class:"flex flex-col gap-4"},bS={class:"flex flex-col gap-y-4"},kS={class:"grid grid-cols-5 items-center gap-1"},yS={class:"col-span-3"},xS={class:"grid grid-cols-5 items-center gap-1"},wS={class:"col-span-3"},$S={class:"space-y-4"},SS={class:"flex items-center justify-between"},TS={class:"text-xs opacity-50"},AS={key:0,class:"grid grid-cols-5 items-center gap-1"},CS={class:"col-span-3"},DS={class:"overflow-y-auto max-h-32"},LS={class:""},IS={class:"font-bold mb-2"},BS={class:"text-sm opacity-60"},MS={class:"mb-2"},ES={class:"font-bold"},RS={class:"flex items-start gap-4 mt-3"},FS={class:"text-sm opacity-60"},PS={class:"flex items-start gap-4 mt-3"},NS={class:"text-sm opacity-60"},zS={class:"flex items-start gap-4 mt-3"},US={class:"flex flex-col"},OS={class:"text-sm opacity-60"},jS={class:"text-sm opacity-60 italic"},VS={class:"flex items-center justify-center gap-3 p-2 border-2 rounded-lg mt-2"},GS={class:"text-md font-semibold"},WS=oe({__name:"CreateRecordingDialog",setup(n){const l=at(),{isMobileSize:a}=ie(l),c=Ce(),{t:r}=We(c.t),{toast:p}=gt(),m=ot(),g=Gs(),{isCreateRecordingDialogOpen:h,allowToShareScreenAudio:_,currentRecording:x,isNewRecording:b,showTranslation:S}=ie(g),y=new Date().toLocaleDateString(),I=ne(()=>[{name:r("supportedLang.ja-JP"),value:"ja-JP"},{name:r("supportedLang.en-US"),value:"en-US"},{name:r("supportedLang.vi-VN"),value:"vi-VN"},{name:r("supportedLang.zh-CN"),value:"zh-CN"},{name:r("supportedLang.zh-HK"),value:"zh-HK"},{name:r("supportedLang.ko-KR"),value:"ko-KR"}]),C=v(!1),U=ne(()=>r("kaigikun.dialog.recording.configurations.form.titleInput.defaultTitle",{date:y})),E=ne(()=>x.value?{sourceLang:x.value.sourceLang,translateLang:x.value.translateLang}:{sourceLang:I.value[0].value,translateLang:I.value[1].value}),N=v(U.value),$=v(E.value.sourceLang),R=v(E.value.translateLang),B=v(!0),j=async()=>{C.value=!0,S.value||(R.value="");const M=await g.createNewRecording({source_lang:$.value,translate_lang:R.value,name:N.value,multi_speakers:B.value,is_share_screen:_.value,enable_translation:S.value});M?(b.value=!0,m.push(`/kaigikun/record/recording/${M.id}`),p({title:r("kaigikun.toast.success.createNewRecording.title"),description:r("kaigikun.toast.success.createNewRecording.description")})):p({title:r("kaigikun.toast.fail.createNewRecording.title"),description:r("kaigikun.toast.fail.createNewRecording.description"),variant:"destructive"}),C.value=!1,h.value=!1,N.value=U.value,$.value=E.value.sourceLang,R.value=E.value.translateLang,B.value=!0},ee=ne(()=>!S.value||!!R.value),se=ne(()=>!(N.value.trim()&&$.value&&ee.value)),G=v(1),J=()=>{G.value===1&&(G.value=2)},H=()=>{G.value===2&&(G.value=1)};return(M,W)=>{const X=f("DialogTitle"),O=f("DialogHeader"),K=f("Label"),V=f("Input"),F=f("Switch"),P=f("DialogDescription"),q=f("Button"),A=f("Loader"),k=f("DialogFooter"),L=f("DialogContent"),z=f("Dialog"),Q=Kt("auto-animate");return s(),u("div",hS,[o(z,{class:"w-full",open:e(h),"onUpdate:open":W[5]||(W[5]=ae=>kt(h)?h.value=ae:null),onOpenToggle:G.value=1},{default:i(()=>[o(L,{class:pe([e(a)?"rounded-xl":""])},{default:i(()=>[o(O,null,{default:i(()=>[o(X,null,{default:i(()=>[me(d(e(r)("kaigiHome.subSidebar.dialog.createInstantRecordHeader")),1)]),_:1})]),_:1}),o(P,null,{default:i(()=>[t("div",_S,[Ke(t("div",null,[t("div",bS,[t("div",kS,[o(K,{class:"col-span-2"},{default:i(()=>[me(d(e(r)("kaigiHome.subSidebar.dialog.recordTitleLabel")),1)]),_:1}),t("div",yS,[o(V,{modelValue:N.value,"onUpdate:modelValue":W[0]||(W[0]=ae=>N.value=ae),placeholder:e(r)("kaigiHome.subSidebar.dialog.recordTitlePlaceholder")},null,8,["modelValue","placeholder"])])]),t("div",xS,[o(K,{class:"col-span-2"},{default:i(()=>[me(d(e(r)("kaigiHome.subSidebar.dialog.transcriptionLanguageDropdownLabel")),1)]),_:1}),t("div",wS,[o(Ds,{modelValue:$.value,"onUpdate:modelValue":W[1]||(W[1]=ae=>$.value=ae),placeholder:e(r)("kaigiHome.subSidebar.dialog.chooseLanguagePlaceholder"),items:I.value,itemKey:"value",itemText:"name"},null,8,["modelValue","placeholder","items"])])]),Ke((s(),u("div",$S,[t("div",null,[o(K,{for:"translateLanguage"},{default:i(()=>[me(d(e(r)("kaigiHome.dialog.createRecording.autoTranslation.label")),1)]),_:1}),t("div",SS,[t("p",TS,d(e(r)("kaigiHome.dialog.createRecording.autoTranslation.description")),1),o(F,{checked:e(S),"onUpdate:checked":W[2]||(W[2]=ae=>kt(S)?S.value=ae:null),size:"base"},null,8,["checked"])])]),e(S)?(s(),u("div",AS,[o(K,{class:"col-span-2"},{default:i(()=>[me(d(e(r)("kaigiHome.subSidebar.dialog.realtimeTranslationDropdownLabel")),1)]),_:1}),t("div",CS,[o(Ds,{modelValue:R.value,"onUpdate:modelValue":W[3]||(W[3]=ae=>R.value=ae),placeholder:e(r)("kaigiHome.subSidebar.dialog.chooseLanguagePlaceholder"),items:I.value,itemKey:"value",itemText:"name"},null,8,["modelValue","placeholder","items"])])])):w("",!0)])),[[Q]])])],512),[[es,G.value===1]]),Ke(t("div",null,[W[9]||(W[9]=t("div",{class:"flex justify-between"},[t("video",{width:"full",autoplay:"",muted:"",loop:"",class:"mb-2 rounded-xs sticky top-0 z-10"},[t("source",{src:vS,type:"video/mp4"})])],-1)),t("div",DS,[t("div",LS,[t("p",IS,d(e(r)("kaigiHome.subSidebar.dialog.stepper.2.content.title")),1),t("p",BS,d(e(r)("kaigiHome.subSidebar.dialog.stepper.2.content.titleDescription")),1)]),t("div",MS,[t("p",ES,d(e(r)("kaigiHome.subSidebar.dialog.stepper.2.content.guideTitle")),1),t("div",RS,[W[6]||(W[6]=t("i",{class:"bi bi-1-circle"},null,-1)),t("p",FS,d(e(r)("kaigiHome.subSidebar.dialog.stepper.2.content.guideContent.1")),1)]),t("div",PS,[W[7]||(W[7]=t("i",{class:"bi bi-2-circle"},null,-1)),t("p",NS,d(e(r)("kaigiHome.subSidebar.dialog.stepper.2.content.guideContent.2")),1)]),t("div",zS,[W[8]||(W[8]=t("i",{class:"bi bi-3-circle"},null,-1)),t("div",US,[t("p",OS,d(e(r)("kaigiHome.subSidebar.dialog.stepper.2.content.guideContent.3")),1),t("p",jS,d(e(r)("kaigiHome.subSidebar.dialog.stepper.2.content.guideContent.3.1")),1)])])])]),t("div",VS,[o(F,{checked:e(_),"onUpdate:checked":W[4]||(W[4]=ae=>kt(_)?_.value=ae:null),size:"base"},null,8,["checked"]),t("p",GS,d(e(r)("kaigiHome.subSidebar.dialog.stepper.2.content.shareAudio.title")),1)])],512),[[es,G.value===2]])])]),_:1}),o(k,{class:"grid grid-cols-4 justify-end gap-2"},{default:i(()=>[G.value===1?(s(),T(q,{key:0,onClick:J,class:"col-span-4",disabled:se.value},{default:i(()=>[me(d(e(r)("kaigiHome.subSidebar.dialog.nextStep")),1)]),_:1},8,["disabled"])):w("",!0),G.value===2?(s(),T(q,{key:1,variant:"outline",class:"col-span-2",onClick:H},{default:i(()=>[t("span",null,d(e(r)("kaigiHome.subSidebar.dialog.stepper.2.content.button.goBackStep1")),1)]),_:1})):w("",!0),G.value===2?(s(),T(q,{key:2,disabled:C.value,class:"col-span-2",onClick:j},{default:i(()=>[t("span",null,d(e(r)("kaigiHome.subSidebar.dialog.stepper.2.content.button.screenShare")),1),C.value?(s(),T(A,{key:0,class:"ml-2 h-4 w-4 animate-spin"})):w("",!0)]),_:1},8,["disabled"])):w("",!0)]),_:1})]),_:1},8,["class"])]),_:1},8,["open","onOpenToggle"])])}}}),HS={class:"hidden"},KS={class:"space-y-4"},qS={class:"grid grid-cols-2 bg-stone-100 dark:bg-stone-800 p-4 rounded-lg"},QS={class:"text-xl"},JS={key:0,class:"bi-check-circle-fill"},XS={class:"flex flex-col justify-left"},YS={class:"font-bold"},ZS={class:"text-xs opacity-60"},eT={class:"text-sm text-stone-500 dark:text-white"},tT={class:"w-full rounded-md text-stone-500"},sT={key:0,class:"h-32 border-2 border-dashed flex flex-col items-center justify-center"},aT={key:1,class:"h-32 flex flex-col justify-between"},oT={class:"grid grid-cols-5 gap-3"},nT={class:"col-span-3"},lT={class:"font-medium text-black dark:text-white"},iT={class:"wrap-anywhere line-clamp-4"},rT={class:"col-span-1"},cT={class:"font-medium text-black dark:text-white"},dT={class:"text-sm"},uT={class:"text-xs text-stone-400"},pT={key:1},mT={class:"flex flex-col gap-y-4"},gT={class:"grid grid-cols-5 items-center"},fT={class:"col-span-3"},vT={class:"grid grid-cols-5 items-center"},hT={class:"col-span-3"},_T={class:"space-y-4"},bT={class:"flex items-center justify-between"},kT={class:"text-xs opacity-50"},yT={key:0,class:"grid grid-cols-5 items-center gap-1"},xT={class:"col-span-3"},wT=oe({__name:"CreatePresentationDialog",setup(n){const l=Ce(),{t:a}=We(l.t),{toast:c}=gt(),r=ot(),p=Qs(),{isCreatePresentationDialogOpen:m,presentationFile:g,currentPresentationFileInfo:h,currentPresentation:_,isNewPresentation:x,showTranslation:b}=ie(p),S=v(!1),y=new Date().toLocaleDateString(),I=ne(()=>[{name:a("supportedLang.ja-JP"),value:"ja-JP"},{name:a("supportedLang.en-US"),value:"en-US"},{name:a("supportedLang.vi-VN"),value:"vi-VN"},{name:a("supportedLang.zh-CN"),value:"zh-CN"},{name:a("supportedLang.zh-HK"),value:"zh-HK"},{name:a("supportedLang.ko-KR"),value:"ko-KR"}]),C=ne(()=>!b.value||!!B.value),U=ne(()=>!($.value.trim()&&R.value&&C.value)),E=ne(()=>a("kaigikun.dialog.presentation.configurations.form.presentationTitleInput.defaultTitle",{date:y})),N=ne(()=>_.value?{sourceLang:_.value.sourceLang,translateLang:_.value.translateLang}:{sourceLang:I.value[1].value,translateLang:I.value[0].value}),$=v(E.value),R=v(N.value.sourceLang),B=v(N.value.translateLang),j=async()=>{ee.value=!0,S.value=!0,b.value||(B.value="");const k=await p.createNewPresentation({source_lang:R.value,translate_lang:B.value,name:$.value,file_id:h.value.id,enable_translation:b.value});k?(r.push(`/kaigikun/present/presentation/${k.id}`),x.value=!0,c({title:a("kaigikun.toast.success.createNewPresentation.title"),description:a("kaigikun.toast.success.createNewPresentation.description")})):c({title:a("kaigikun.toast.fail.createNewPresentation.title"),description:a("kaigikun.toast.fail.createNewPresentation.description"),variant:"destructive"}),S.value=!1,m.value=!1,ee.value=!1,g.value=void 0,se.value=!1,$.value=E.value,R.value=N.value.sourceLang,B.value=N.value.translateLang},ee=v(!1),se=v(!1),G=v(!1),J=v(null),H=()=>{J.value&&J.value.click()},M=()=>{g.value=void 0},W=k=>k.type!=="application/pdf"?(c({title:a("kaigikun.toast.fail.invalidFileExtension.title"),description:a("kaigikun.toast.fail.invalidFileExtension.description",{fileName:k.name}),variant:"destructive"}),!1):k.size>20*1024*1024?(c({title:a("kaigikun.toast.fail.fileSizeExceed.title"),description:a("kaigikun.toast.fail.fileSizeExceed.description"),variant:"destructive"}),!1):(g.value=k,!0),X=async k=>{try{ee.value=!0,await p.uploadPresentationFile(),se.value=!0,c({title:a("kaigikun.toast.success.invalidFileExtension.title"),description:a("kaigikun.toast.success.invalidFileExtension.description",{fileName:k.name})})}catch(L){se.value=!1,console.error(L),c({title:a("home.toast.fail.generalErrorTitle"),description:a("home.toast.fail.generalError"),variant:"destructive"})}finally{ee.value=!1}},O=k=>{var z;const L=(z=k.target.files)==null?void 0:z[0];L&&W(L)&&(J.value.value="",X(L))},K=k=>{var z,Q;k.preventDefault();const L=(Q=(z=k.dataTransfer)==null?void 0:z.files)==null?void 0:Q[0];L&&W(L)&&X(L)},V=v(1),F=ne(()=>[{step:1,title:a("kaigikun.dialog.presentation.upload.title"),description:ne(()=>g.value?a("kaigikun.dialog.presentation.upload.description.readyFile"):a("kaigikun.dialog.presentation.upload.description.noFiles"))},{step:2,title:a("kaigikun.dialog.presentation.configurations.title"),description:a("kaigikun.dialog.presentation.configurations.description")}]),P=()=>{V.value===1&&(V.value=2)},q=()=>{V.value===2&&(V.value=1)},A=()=>{V.value=1,g.value=void 0};return(k,L)=>{const z=f("DialogTitle"),Q=f("DialogHeader"),ae=f("Label"),de=f("Input"),le=f("Switch"),te=f("DialogDescription"),Z=f("Button"),re=f("Loader"),ue=f("DialogFooter"),he=f("DialogContent"),$e=f("Dialog"),Se=Kt("auto-animate");return s(),u("div",HS,[o($e,{class:"w-full",open:e(m),"onUpdate:open":[L[7]||(L[7]=be=>kt(m)?m.value=be:null),A]},{default:i(()=>[o(he,null,{default:i(()=>[o(Q,null,{default:i(()=>[V.value===1?(s(),T(z,{key:0},{default:i(()=>[me(d(e(a)("kaigikun.dialog.presentation.upload.header")),1)]),_:1})):(s(),T(z,{key:1},{default:i(()=>[me(d(e(a)("kaigikun.dialog.presentation.configurations.title")),1)]),_:1}))]),_:1}),o(te,null,{default:i(()=>[t("div",KS,[t("div",qS,[(s(!0),u(ve,null,Le(F.value,(be,Ge)=>(s(),u("div",{key:Ge},[t("div",{class:pe(["flex flex-row gap-2",{"opacity-50":be.step!==V.value}])},[t("div",QS,[V.value>be.step?(s(),u("i",JS)):(s(),u("i",{key:1,class:pe(`bi bi-${be.step}-circle-fill`)},null,2))]),t("div",XS,[t("div",YS,d(be.title),1),t("div",ZS,d(be.description),1)])],2)]))),128))]),V.value===1?(s(),u("div",{key:0,class:"space-y-2",onDragover:L[0]||(L[0]=Ye(be=>G.value=!0,["prevent"])),onDragleave:L[1]||(L[1]=be=>G.value=!1),onDrop:L[2]||(L[2]=be=>{G.value=!1,K(be)})},[t("p",eT,d(e(a)("kaigikun.dialog.presentation.upload.description.maximumFileSize")),1),t("div",tT,[e(g)?(s(),u("div",aT,[t("div",oT,[t("div",nT,[t("p",lT,d(e(a)("kaigikun.dialog.presentation.upload.fileNameColumn")),1),t("p",iT,d(e(g).name),1)]),t("div",rT,[t("p",cT,d(e(a)("kaigikun.dialog.presentation.upload.fileSizeColumn")),1),t("p",null,d(e(on)(e(g).size)),1)]),o(Pe,{onClick:M,variant:"ghost",size:"icon",icon:"bi bi-x"})]),t("div",null,[t("p",dT,[me(d(e(a)("kaigikun.dialog.presentation.upload.description.chooseAnotherFile"))+" ",1),t("span",{class:"text-black underline hover:cursor-pointer dark:text-white",onClick:H},d(e(a)("kaigikun.dialog.presentation.upload.dragAndDrop.button.browse")),1)])])])):(s(),u("div",sT,[t("p",null,d(e(a)("kaigikun.dialog.presentation.upload.description.dragAndDrop")),1),t("p",null,[me(d(e(a)("kaigikun.dialog.presentation.upload.dragAndDrop.or"))+" ",1),t("span",{class:"text-black underline hover:cursor-pointer dark:text-white",onClick:H},d(e(a)("kaigikun.dialog.presentation.upload.dragAndDrop.button.browse")),1)])]))]),t("input",{id:"presentation-file-input",ref_key:"fileInput",ref:J,type:"file",class:"hidden",accept:".pdf",onChange:O},null,544),t("p",uT,d(e(a)("kaigikun.dialog.presentation.upload.description.supportedFormats"))+": pdf ",1)],32)):(s(),u("div",pT,[t("div",mT,[t("div",gT,[o(ae,{class:"col-span-2"},{default:i(()=>[me(d(e(a)("kaigikun.dialog.presentation.configurations.form.presentationTitleInput.label")),1)]),_:1}),t("div",fT,[o(de,{modelValue:$.value,"onUpdate:modelValue":L[3]||(L[3]=be=>$.value=be),id:"presentationTitle",placeholder:e(a)("kaigikun.dialog.presentation.configurations.form.presentationTitleInput.placeholder")},null,8,["modelValue","placeholder"])])]),t("div",vT,[o(ae,{class:"col-span-2"},{default:i(()=>[me(d(e(a)("kaigikun.dialog.presentation.configurations.form.transcriptionLanguageDropdown.title")),1)]),_:1}),t("div",hT,[o(Ds,{modelValue:R.value,"onUpdate:modelValue":L[4]||(L[4]=be=>R.value=be),placeholder:e(a)("kaigikun.dialog.presentation.configurations.form.chooseLanguageDropdown.placeholder"),items:I.value,itemKey:"value",itemText:"name"},null,8,["modelValue","placeholder","items"])])]),Ke((s(),u("div",_T,[t("div",null,[o(ae,{for:"translateLanguage"},{default:i(()=>[me(d(e(a)("kaigiHome.dialog.createRecording.autoTranslation.label")),1)]),_:1}),t("div",bT,[t("p",kT,d(e(a)("kaigiHome.dialog.createRecording.autoTranslation.description")),1),o(le,{checked:e(b),"onUpdate:checked":L[5]||(L[5]=be=>kt(b)?b.value=be:null),size:"base"},null,8,["checked"])])]),e(b)?(s(),u("div",yT,[o(ae,{class:"col-span-2"},{default:i(()=>[me(d(e(a)("kaigiHome.subSidebar.dialog.realtimeTranslationDropdownLabel")),1)]),_:1}),t("div",xT,[o(Ds,{modelValue:B.value,"onUpdate:modelValue":L[6]||(L[6]=be=>B.value=be),placeholder:e(a)("kaigikun.dialog.presentation.configurations.form.chooseLanguageDropdown.placeholder"),items:I.value,itemKey:"value",itemText:"name"},null,8,["modelValue","placeholder","items"])])])):w("",!0)])),[[Se]])])]))])]),_:1}),o(ue,{class:"grid grid-cols-4 justify-end gap-2 mt-3"},{default:i(()=>[V.value===2?(s(),T(Z,{key:0,variant:"outline",class:"col-start-1 col-span-2",onClick:q},{default:i(()=>[me(d(e(a)("kaigikun.dialog.presentation.configurations.button.back")),1)]),_:1})):w("",!0),V.value===1?(s(),T(Z,{key:1,onClick:P,class:"col-start-4",disabled:!se.value||ee.value},{default:i(()=>[t("p",null,d(e(a)("kaigikun.dialog.presentation.upload.button.next")),1),ee.value?(s(),T(re,{key:0,class:"ml-2 h-4 w-4 animate-spin"})):w("",!0)]),_:1},8,["disabled"])):w("",!0),V.value===2?(s(),T(Z,{key:2,class:"col-start-3 col-span-2",disabled:U.value||ee.value,onClick:j},{default:i(()=>[t("p",null,d(e(a)("kaigikun.dialog.presentation.configurations.button.present")),1),S.value?(s(),T(re,{key:0,class:"ml-2 h-4 w-4 animate-spin"})):w("",!0)]),_:1},8,["disabled"])):w("",!0)]),_:1})]),_:1})]),_:1},8,["open"])])}}}),$T={class:"hidden"},ST={class:"space-y-4"},TT={class:"grid grid-cols-2 bg-stone-100 dark:bg-stone-800 p-4 rounded-lg"},AT={class:"text-xl"},CT={key:0,class:"bi-check-circle-fill"},DT={class:"flex flex-col justify-left"},LT={class:"font-bold text-xs sm:text-md"},IT={class:"text-xs opacity-60"},BT={class:"text-sm text-stone-500"},MT={class:"w-full rounded-md text-stone-500"},ET={key:0,class:"h-32 border-2 border-dashed flex flex-col items-center justify-center"},RT={key:1,class:"h-32 flex flex-col justify-between"},FT={class:"grid grid-cols-8 gap-3"},PT={class:"col-span-3"},NT={class:"font-medium text-black dark:text-white"},zT={class:"wrap-anywhere line-clamp-4"},UT={class:"col-span-2 justify-self-end"},OT={class:"font-medium text-black dark:text-white"},jT={class:"col-span-2 justify-self-end"},VT={class:"font-medium text-black dark:text-white"},GT={class:"text-sm"},WT=["src"],HT={class:"text-xs text-stone-400"},KT={key:1},qT={class:"flex flex-col gap-y-4"},QT={class:"grid grid-cols-4 items-center gap-1"},JT={class:"col-span-3"},XT={class:"grid grid-cols-4 items-center gap-1"},YT={class:"col-span-3"},ZT={class:"space-y-4"},eA={class:"flex items-center justify-between"},tA={class:"text-xs opacity-50"},sA={key:0,class:"grid grid-cols-4 items-center gap-1"},aA={class:"col-span-3"},oA=oe({__name:"UploadAndTranscribeDialog",setup(n){const l=at(),{isMobileSize:a}=ie(l),c=Ce(),r=ot(),{t:p}=We(c.t),{toast:m}=gt(),g=Ks(),{isUploadAndTranscribeDialogOpen:h,recordingFile:_,currentUploadedRecordingFileInfo:x,showTranslation:b}=ie(g),{uploadRecordingFile:S,createNewFileRecording:D,setStatus:y}=g,I=v(!1),U=new Date().toLocaleDateString(),E=v(""),N=v(null),$=ne(()=>[{name:p("supportedLang.ja-JP"),value:"ja-JP"},{name:p("supportedLang.en-US"),value:"en-US"},{name:p("supportedLang.vi-VN"),value:"vi-VN"},{name:p("supportedLang.zh-CN"),value:"zh-CN"},{name:p("supportedLang.zh-HK"),value:"zh-HK"},{name:p("supportedLang.ko-KR"),value:"ko-KR"}]),R=ne(()=>!b.value||!!G.value),B=ne(()=>!(ee.value.trim()&&se.value&&R.value)),j=ne(()=>p("kaigikun.dialog.audio.configurations.form.audioTitleInput.defaultTitle",{date:U})),ee=v(j.value),se=v(""),G=v(""),J=async()=>{I.value=!0,h.value=!1,b.value||(G.value="");try{const te=await D({name:ee.value,source_lang:se.value,translate_lang:G.value,file_id:x.value.id,enable_translation:b.value});y(te.id,te.status),r.push(`/kaigikun/upload-transcribe/file/${te.id}`),m({title:p("kaigikun.toast.success.createNewAudioRecording.title"),description:p("kaigikun.toast.success.createNewAudioRecording.description")})}catch(te){console.error(te),m({title:p("kaigikun.toast.fail.createNewAudioRecording.title"),description:p("kaigikun.toast.fail.createNewAudioRecording.description"),variant:"destructive"})}finally{I.value=!1,_.value=void 0,ee.value=j.value,se.value="",G.value=""}},H=v(!1),M=v(!1),W=v(!1),X=v(null),O=()=>{X.value&&X.value.click()},K=()=>{_.value=void 0},V=["audio/mpeg","audio/x-m4a","audio/mp4","video/mp4","video/webm","audio/webm","audio/wav","audio/x-wav"],F=te=>V.includes(te.type)?te.size>yo*1024*1024?(m({title:p("kaigikun.toast.fail.fileSizeExceed.title"),description:p("kaigikun.toast.fail.audioFileSizeExceed.description",{fileSize:yo.toString()}),variant:"destructive"}),!1):(_.value=te,!0):(m({title:p("kaigikun.toast.fail.invalidFileExtension.title"),description:p("kaigikun.toast.fail.invalidFileExtension.description",{fileName:te.name}),variant:"destructive"}),!1),P=async te=>{try{H.value=!0,await S(),m({title:p("kaigikun.toast.success.invalidFileExtension.title"),description:p("kaigikun.toast.success.invalidFileExtension.description",{fileName:te.name})}),M.value=!0}catch(Z){M.value=!1,console.error(Z),m({title:p("home.toast.fail.generalErrorTitle"),description:p("home.toast.fail.generalError"),variant:"destructive"})}finally{H.value=!1}},q=te=>{var re;const Z=(re=te.target.files)==null?void 0:re[0];Z&&F(Z)&&(E.value=URL.createObjectURL(Z),X.value.value="",P(Z))},A=te=>{var re,ue;te.preventDefault();const Z=(ue=(re=te.dataTransfer)==null?void 0:re.files)==null?void 0:ue[0];Z&&F(Z)&&(E.value=URL.createObjectURL(Z),P(Z))},k=te=>{const Z=te.target;N.value=Z.duration,URL.revokeObjectURL(E.value)},L=ne(()=>{if(N.value===null)return;const te=Math.floor(N.value),Z=Math.floor(te/3600),re=Math.floor(te%3600/60),ue=te%60,he=[];return Z>0&&he.push(`${Z}h`),re>0&&he.push(`${re}min`),he.push(`${ue}s`),he.join(" ")}),z=v(1),Q=ne(()=>[{step:1,title:p("kaigikun.dialog.audio.upload.title"),description:ne(()=>_.value?p("kaigikun.dialog.audio.upload.description.readyFile"):p("kaigikun.dialog.audio.upload.description.noFiles"))},{step:2,title:p("kaigikun.dialog.audio.configurations.title"),description:p("kaigikun.dialog.audio.configurations.description")}]),ae=()=>{z.value===1&&(z.value=2)},de=()=>{z.value===2&&(z.value=1)},le=()=>{z.value=1,_.value=void 0};return(te,Z)=>{const re=f("DialogTitle"),ue=f("DialogHeader"),he=f("Label"),$e=f("Input"),Se=f("Switch"),be=f("DialogDescription"),Ge=f("Button"),fe=f("Loader"),Y=f("DialogFooter"),ce=f("DialogContent"),ge=f("Dialog"),ye=Kt("auto-animate");return s(),u("div",$T,[o(ge,{class:"w-full",open:e(h),"onUpdate:open":[Z[7]||(Z[7]=_e=>kt(h)?h.value=_e:null),le]},{default:i(()=>[o(ce,{class:pe([e(a)?"rounded-xl":""])},{default:i(()=>[o(ue,null,{default:i(()=>[z.value===1?(s(),T(re,{key:0},{default:i(()=>[me(d(e(p)("kaigikun.dialog.audio.upload.header")),1)]),_:1})):(s(),T(re,{key:1},{default:i(()=>[me(d(e(p)("kaigikun.dialog.audio.configurations.title")),1)]),_:1}))]),_:1}),o(be,null,{default:i(()=>[t("div",ST,[t("div",TT,[(s(!0),u(ve,null,Le(Q.value,(_e,Re)=>(s(),u("div",{key:Re},[t("div",{class:pe(["flex flex-row gap-2",{"opacity-50":_e.step!==z.value}])},[t("div",AT,[z.value>_e.step?(s(),u("i",CT)):(s(),u("i",{key:1,class:pe(`bi bi-${_e.step}-circle-fill`)},null,2))]),t("div",DT,[t("div",LT,d(_e.title),1),t("div",IT,d(_e.description),1)])],2)]))),128))]),z.value===1?(s(),u("div",{key:0,class:"space-y-2",onDragover:Z[0]||(Z[0]=Ye(_e=>W.value=!0,["prevent"])),onDragleave:Z[1]||(Z[1]=_e=>W.value=!1),onDrop:Z[2]||(Z[2]=_e=>{W.value=!1,A(_e)})},[t("p",BT,d(e(p)("kaigikun.dialog.audio.upload.description.maximumFileSize",{fileSize:e(yo)})),1),t("div",MT,[e(_)?(s(),u("div",RT,[t("div",FT,[t("div",PT,[t("p",NT,d(e(p)("kaigikun.dialog.audio.upload.fileNameColumn")),1),t("p",zT,d(e(_).name),1)]),t("div",UT,[t("p",OT,d(e(p)("kaigikun.dialog.audio.upload.fileSizeColumn")),1),t("p",null,d(e(on)(e(_).size)),1)]),t("div",jT,[t("p",VT,d(e(p)("kaigikun.dialog.audio.upload.fileDurationColumn")),1),t("p",null,d(L.value),1)]),o(Pe,{onClick:K,className:"col-span-1",variant:"ghost",size:"icon",icon:"bi bi-x"})]),t("div",null,[t("p",GT,[me(d(e(p)("kaigikun.dialog.audio.upload.description.chooseAnotherFile"))+" ",1),t("span",{class:"text-black underline hover:cursor-pointer dark:text-white",onClick:O},d(e(p)("kaigikun.dialog.audio.upload.dragAndDrop.button.browse")),1)])])])):(s(),u("div",ET,[t("p",null,d(e(p)("kaigikun.dialog.audio.upload.description.dragAndDrop")),1),t("p",null,[me(d(e(p)("kaigikun.dialog.audio.upload.dragAndDrop.or"))+" ",1),t("span",{class:"text-black underline hover:cursor-pointer dark:text-white",onClick:O},d(e(p)("kaigikun.dialog.audio.upload.dragAndDrop.button.browse")),1)])]))]),t("input",{id:"upload-and-transcribe-file-input",ref_key:"fileInput",ref:X,type:"file",class:"hidden",accept:".mp3, .mp4, .m4a, .webm, .wav",onChange:q},null,544),E.value?(s(),u("audio",{key:0,src:E.value,onLoadedmetadata:k,class:"hidden"},null,40,WT)):w("",!0),t("p",HT,d(e(p)("kaigikun.dialog.audio.upload.description.supportedFormats"))+": mp3, mp4, m4a, webm, wav ",1)],32)):(s(),u("div",KT,[t("div",qT,[t("div",QT,[o(he,null,{default:i(()=>[me(d(e(p)("kaigikun.dialog.audio.configurations.form.audioTitleInput.label")),1)]),_:1}),t("div",JT,[o($e,{modelValue:ee.value,"onUpdate:modelValue":Z[3]||(Z[3]=_e=>ee.value=_e),placeholder:e(p)("kaigikun.dialog.audio.configurations.form.audioTitleInput.placeholder")},null,8,["modelValue","placeholder"])])]),t("div",XT,[o(he,{for:"fileRecordingTranscriptionLang"},{default:i(()=>[me(d(e(p)("kaigikun.dialog.audio.configurations.form.transcriptionLanguageDropdown.title")),1)]),_:1}),t("div",YT,[o(Ds,{modelValue:se.value,"onUpdate:modelValue":Z[4]||(Z[4]=_e=>se.value=_e),placeholder:e(p)("kaigikun.dialog.audio.configurations.form.chooseLanguageDropdown.placeholder"),items:$.value,itemKey:"value",itemText:"name"},null,8,["modelValue","placeholder","items"])])]),Ke((s(),u("div",ZT,[t("div",null,[o(he,{for:"translateLanguage"},{default:i(()=>[me(d(e(p)("kaigiHome.dialog.createRecording.autoTranslation.label")),1)]),_:1}),t("div",eA,[t("p",tA,d(e(p)("kaigiHome.dialog.createRecording.autoTranslation.description")),1),o(Se,{checked:e(b),"onUpdate:checked":Z[5]||(Z[5]=_e=>kt(b)?b.value=_e:null),size:"base"},null,8,["checked"])])]),e(b)?(s(),u("div",sA,[o(he,null,{default:i(()=>[me(d(e(p)("kaigiHome.subSidebar.dialog.realtimeTranslationDropdownLabel")),1)]),_:1}),t("div",aA,[o(Ds,{modelValue:G.value,"onUpdate:modelValue":Z[6]||(Z[6]=_e=>G.value=_e),placeholder:e(p)("kaigikun.dialog.presentation.configurations.form.chooseLanguageDropdown.placeholder"),items:$.value,itemKey:"value",itemText:"name"},null,8,["modelValue","placeholder","items"])])])):w("",!0)])),[[ye]])])]))])]),_:1}),o(Y,{class:"grid grid-cols-4 justify-end gap-2 mt-3"},{default:i(()=>[z.value===2?(s(),T(Ge,{key:0,variant:"outline",class:"col-start-1 col-span-2",onClick:de},{default:i(()=>[me(d(e(p)("kaigikun.dialog.audio.configurations.button.back")),1)]),_:1})):w("",!0),z.value===1?(s(),T(Ge,{key:1,onClick:ae,class:"col-start-4",disabled:!e(_)||!M.value||H.value},{default:i(()=>[me(d(e(p)("kaigikun.dialog.audio.upload.button.next"))+" ",1),H.value?(s(),T(fe,{key:0,class:"ml-2 h-4 w-4 animate-spin"})):w("",!0)]),_:1},8,["disabled"])):w("",!0),z.value===2?(s(),T(Ge,{key:2,class:"col-start-3 col-span-2",disabled:B.value||H.value,onClick:J},{default:i(()=>[t("p",null,d(e(p)("kaigikun.dialog.audio.configurations.button.upload")),1)]),_:1},8,["disabled"])):w("",!0)]),_:1})]),_:1},8,["class"])]),_:1},8,["open"])])}}}),nA={class:"flex flex-col h-dvh w-full"},lA={class:"mx-auto flex flex-col w-full h-full justify-center px-5"},iA={class:"flex flex-col justify-center items-center gap-3 w-fit mx-auto relative"},rA=["src"],cA=["src"],dA={key:2,class:"grid grid-cols-1 gap-3"},uA={class:"text-md mt-3"},pA={key:3,class:"grid grid-cols-1 gap-3"},mA={class:"text-md mt-3"},gA={key:4,class:"grid grid-cols-1 gap-3"},fA={class:"text-md mt-3"},Eo=oe({__name:"KaigiHomeView",setup(n){const l=ps(),{mode:a}=ie(l),c=tt(),r=ne(()=>c.path.match(/record/i)),p=ne(()=>c.path.match(/present/i)),m=ne(()=>c.path.match(/upload-transcribe/i)),{t:g}=Ce(),h=Gs(),_=Qs(),{isCreateRecordingDialogOpen:x,isRecordDialogFirstStep:b}=ie(h),S=Ks(),{isCreatePresentationDialogOpen:D}=ie(_),{isUploadAndTranscribeDialogOpen:y}=ie(S),I=at(),{isMobileSize:C}=ie(I);return(U,E)=>(s(),u("div",nA,[o(WS),o(wT),o(oA),o(ks,{"justify-content":e(C)?"justify-start":"justify-end","is-show-create-new-chat":!1,"is-kaigi-view":!0},null,8,["justify-content"]),t("div",lA,[t("div",iA,[e(a)==="light"&&!e(C)?(s(),u("img",{key:0,src:e(gS),class:"w-64 absolute bottom-70 right-1/2",alt:"click me button"},null,8,rA)):w("",!0),e(a)==="dark"&&!e(C)?(s(),u("img",{key:1,src:e(fS),class:"w-64 absolute bottom-70 right-1/2",alt:"click me button"},null,8,cA)):w("",!0),r.value?(s(),u("div",dA,[t("div",{class:"flex flex-col items-center justify-center gap-3 w-64 h-64 border dark:border-stone-700 dark:bg-stone-800 rounded-3xl cursor-pointer hover:bg-stone-100 dark:hover:bg-stone-700/50 shadow-lg active:hover:bg-stone-100 active:hover:shadow-none",onClick:E[0]||(E[0]=N=>{x.value=!0,b.value=!0})},[E[3]||(E[3]=t("div",{class:"flex flex-col items-center bg-clip-text bg-linear-60 from-cyan-500 to-blue-500"},[t("i",{class:"bi bi-mic text-blue-500/5 text-5xl"})],-1)),t("span",uA,d(e(g)("kaigiHome.main.button.instantRecordButtonLabel")),1)])])):w("",!0),p.value?(s(),u("div",pA,[t("div",{class:"flex flex-col items-center justify-center gap-3 w-64 h-64 border dark:border-stone-700 dark:bg-stone-800 rounded-3xl cursor-pointer hover:bg-stone-100 dark:hover:bg-stone-700/50 shadow-lg active:hover:bg-stone-100 active:hover:shadow-none",onClick:E[1]||(E[1]=N=>D.value=!0)},[E[4]||(E[4]=t("div",{class:"flex flex-col items-center bg-clip-text bg-linear-60 from-orange-500 to-red-500"},[t("i",{class:"bi bi-file-slides text-red-500/5 text-5xl"})],-1)),t("span",mA,d(e(g)("kaigiHome.main.button.createPresentationButtonLabel")),1)])])):w("",!0),m.value?(s(),u("div",gA,[t("div",{class:"flex flex-col items-center justify-center gap-3 w-64 h-64 border dark:border-stone-700 dark:bg-stone-800 rounded-3xl cursor-pointer hover:bg-stone-100 dark:hover:bg-stone-700/50 shadow-lg active:hover:bg-stone-100 active:hover:shadow-none",onClick:E[2]||(E[2]=N=>y.value=!0)},[E[5]||(E[5]=t("div",{class:"flex flex-col items-center bg-clip-text bg-linear-60 from-lime-500 to-green-500"},[t("i",{class:"bi bi-file-earmark-arrow-up text-green-500/5 text-5xl"})],-1)),t("span",fA,d(e(g)("kaigiHome.subSidebar.button.uploadAndTranscribe")),1)])])):w("",!0)])])]))}}),vA={class:"text-xs"},hA={class:"text-xs"},_A={class:"text-xs"},za=28,Ua=28,Oa=28,al=oe({__name:"KaigiSubSidebar",setup(n){const l=Qs(),a=Gs(),c=Ks(),{fetchRecordingList:r,deleteRecording:p,renameRecording:m}=a,{isLoadingRecord:g,hasMoreRecording:h,recordings:_,currentRecording:x,isNewRecording:b}=ie(a),{isLoadingPresent:S,hasMorePresentation:D,currentPresentation:y,presentationList:I}=ie(l),{isLoadingFileRecording:C,hasMoreFileRecording:U,currentFileRecording:E,fileRecordingList:N}=ie(c),{fetchPresentationList:$,deletePresentation:R,renamePresentation:B}=l,{fetchFileRecordingList:j,deleteFileRecording:ee,renameFileRecording:se}=c,G=Ce(),{t:J}=We(G.t),{toast:H}=gt(),M=tt(),W=ot(),X=at(),{isMobileSize:O}=ie(X),K=ne(()=>M.path.match(/record/i)),V=ne(()=>M.path.match(/present/i)),F=ne(()=>M.path.match(/upload-transcribe/i)),P=(ke,qe,lt)=>K.value?ke():V.value?qe():lt(),q=()=>P(()=>A(),()=>k(),()=>L()),A=()=>{W.push("/kaigikun/record"),Z()},k=()=>{W.push("/kaigikun/present"),re()},L=()=>{W.push("/kaigikun/upload-transcribe"),ue()},z=v(0),Q=async()=>{if(!(g.value||!h.value)){g.value=!0;try{const ke=await r(z.value,za);ke&&ke<z.value&&(h.value=!1),z.value+=za}catch(ke){console.error(ke),H({title:J("kaigikun.toast.fail.fetchRecordingList.title"),description:J("kaigikun.toast.fail.fetchRecordingList.description"),variant:"destructive"})}finally{g.value=!1}}},ae=v(0),de=async()=>{if(!(S.value||!D.value)){S.value=!0;try{const ke=await $(ae.value,Ua);ke&&ke<ae.value&&(D.value=!1),ae.value+=Ua}catch(ke){console.error(ke),H({title:J("kaigikun.toast.fail.fetchRecordingList.title"),description:J("kaigikun.toast.fail.fetchRecordingList.description"),variant:"destructive"})}finally{S.value=!1}}},le=v(0),te=async()=>{if(!(C.value||!U.value)){C.value=!0;try{const ke=await j(le.value,Oa);ke&&ke<le.value&&(U.value=!1),le.value+=Oa}catch(ke){console.error(ke),H({title:J("kaigikun.toast.fail.fetchRecordingList.title"),description:J("kaigikun.toast.fail.fetchRecordingList.description"),variant:"destructive"})}finally{C.value=!1}}},Z=async()=>{try{g.value=!0,await r(z.value,za),g.value=!1,z.value+=za}catch(ke){console.error(ke),H({title:J("kaigikun.toast.fail.fetchRecordingList.title"),description:J("kaigikun.toast.fail.fetchRecordingList.description"),variant:"destructive"})}},re=async()=>{try{S.value=!0,await $(ae.value,Ua),S.value=!1,ae.value+=Ua}catch(ke){console.error(ke),H({title:J("kaigikun.toast.fail.fetchRecordingList.title"),description:J("kaigikun.toast.fail.fetchRecordingList.description"),variant:"destructive"})}},ue=async()=>{try{C.value=!0,await j(le.value,Oa),C.value=!1,le.value+=Oa}catch(ke){console.error(ke),H({title:J("kaigikun.toast.fail.fetchRecordingList.title"),description:J("kaigikun.toast.fail.fetchRecordingList.description"),variant:"destructive"})}},he=ne(()=>{var ke,qe,lt;return K.value?(ke=x.value)==null?void 0:ke.id:V.value?(qe=y.value)==null?void 0:qe.id:(lt=E.value)==null?void 0:lt.id}),$e=ne(()=>K.value?_.value.map(ke=>({id:ke.id||"",name:ke.name,link:`/kaigikun/record/recording/${ke.id}`,updatedAt:ke.updatedAt})):V.value?I.value.map(ke=>({id:ke.id||"",name:ke.name,link:`/kaigikun/present/presentation/${ke.id}`,updatedAt:ke.updatedAt})):N.value.map(ke=>({id:ke.id||"",name:ke.name,link:`/kaigikun/upload-transcribe/file/${ke.id}`,updatedAt:ke.updatedAt}))),Se=ne(()=>P(()=>h.value,()=>D.value,()=>U.value)),be=async ke=>{try{await p(ke),q()}catch(qe){console.error(qe),H({title:J("kaigikun.toast.fail.deleteRecording.title"),description:J("kaigikun.toast.fail.deleteRecording.description"),variant:"destructive"})}},Ge=async ke=>{try{await R(ke),q()}catch(qe){console.error(qe),H({title:J("kaigikun.toast.fail.deleteRecording.title"),description:J("kaigikun.toast.fail.deleteRecording.description"),variant:"destructive"})}},fe=async ke=>{try{await ee(ke),q()}catch(qe){console.error(qe),H({title:J("kaigikun.toast.fail.deleteRecording.title"),description:J("kaigikun.toast.fail.deleteRecording.description"),variant:"destructive"})}},Y=async({id:ke,newName:qe})=>{try{await m(ke,qe)}catch(lt){console.error(lt),H({title:J("kaigiHome.subSidebar.toast.fail.renameRecordingFail"),variant:"destructive"})}},ce=async({id:ke,newName:qe})=>{try{await B(ke,qe)}catch(lt){console.error(lt),H({title:J("kaigiHome.subSidebar.toast.fail.renamePresentation.title"),variant:"destructive"})}},ge=async({id:ke,newName:qe})=>{try{await se(ke,qe)}catch(lt){console.error(lt),H({title:J("kaigiHome.subSidebar.toast.fail.renameRecordingFail"),variant:"destructive"})}},ye=(ke,qe)=>{P(()=>Y({id:ke,newName:qe}),()=>ce({id:ke,newName:qe}),()=>ge({id:ke,newName:qe}))},_e=ke=>{P(()=>be(ke),()=>Ge(ke),()=>fe(ke))},Re=()=>{P(()=>Q(),()=>de(),()=>te())};return Vt(()=>{P(()=>Z(),()=>re(),()=>ue())}),(ke,qe)=>{const lt=f("Button");return s(),T(Ia,{loading:e(g)||e(S)||e(C),items:$e.value,"has-more-items":Se.value,"active-item-id":he.value,"disable-delete-active":!!(K.value&&e(b)),"disable-header":!0,onEditItem:ye,onDeleteItem:_e,onArrivedBottom:Re,onNavigateHome:q},{subNavList:i(()=>[o(lt,{variant:"ghost",class:pe([K.value?"bg-stone-200 dark:bg-stone-600":"","w-full flex items-center gap-1 justify-start p-1.5 rounded-md hover:bg-stone-200 dark:hover:bg-stone-600"]),onClick:A},{default:i(()=>[qe[0]||(qe[0]=t("div",{class:"rounded-full h-6 w-6 -ml-1 sm:ml-0 sm:h-7 sm:w-7 flex justify-center items-center bg-clip-text bg-linear-60 from-cyan-500 to-blue-500"},[t("i",{class:"bi bi-mic text-blue-500/10"})],-1)),t("span",vA,d(e(J)("kaigiHome.subSidebar.button.instantRecord")),1)]),_:1,__:[0]},8,["class"]),e(O)?w("",!0):(s(),T(lt,{key:0,variant:"ghost",class:pe([V.value?"bg-stone-200 dark:bg-stone-600":"","w-full flex items-center gap-1 justify-start p-1.5 rounded-md hover:bg-stone-200 dark:hover:bg-stone-600"]),onClick:k},{default:i(()=>[qe[1]||(qe[1]=t("div",{class:"rounded-full h-6 w-6 -ml-1 sm:ml-0 sm:h-7 sm:w-7 flex justify-center items-center bg-clip-text bg-linear-60 from-orange-500 to-red-500"},[t("i",{class:"bi bi-file-slides text-red-500/10"})],-1)),t("span",hA,d(e(J)("kaigiHome.subSidebar.button.presentation")),1)]),_:1,__:[1]},8,["class"])),o(lt,{variant:"ghost",class:pe([F.value?"bg-stone-200 dark:bg-stone-600":"","w-full flex items-center gap-1 justify-start p-1.5 rounded-md hover:bg-stone-200 dark:hover:bg-stone-600"]),onClick:L},{default:i(()=>[qe[2]||(qe[2]=t("div",{class:"rounded-full h-6 w-6 -ml-1 sm:ml-0 sm:h-7 sm:w-7 flex justify-center items-center bg-clip-text bg-linear-60 from-lime-500 to-green-500"},[t("i",{class:"bi bi-file-earmark-arrow-up text-green-500/10"})],-1)),t("span",_A,d(e(J)("kaigiHome.subSidebar.button.uploadAndTranscribe")),1)]),_:1,__:[2]},8,["class"])]),_:1},8,["loading","items","has-more-items","active-item-id","disable-delete-active"])}}}),bA=oe({__name:"KaigiMainView",setup(n){const l=at(),{isMobileSize:a}=ie(l);return(c,r)=>{const p=f("RouterView");return s(),u(ve,null,[e(a)?(s(),T(Cs,{key:0,defer:"",to:"#mobile-sub-sidebar"},[o(al)])):(s(),T(Cs,{key:1,defer:"",to:"#sub-sidebar"},[o(al)])),o(p)],64)}}}),Ri="/assets/plyr-rJqi93NC.svg",ol=n=>n.charAt(0).toUpperCase()+n.slice(1),kA={class:"flex justify-between items-center gap-10 p-3 z-20"},yA={class:"flex items-center"},xA={key:0,class:"sm:hidden"},wA={class:"flex flex-col text-left"},$A={key:1,class:"text-md flex items-center gap-2"},SA={key:1,class:"line-clamp-1 max-w-xs"},TA={key:2,class:"text-md flex items-center gap-2"},AA={key:1,class:"line-clamp-1 max-w-xs"},CA={class:"flex gap-2 text-sm opacity-60 w-full"},DA={key:1,class:"text-xs"},LA={key:2,class:"text-xs"},IA={key:1},BA={class:"flex flex-row items-center gap-2 text-xs"},MA={key:0},EA={key:1},Fi=oe({__name:"KaigiTopbar",setup(n){const l=at(),{isMobileSize:a}=ie(l),c=Ce(),{t:r,tFallback:p}=We(c.t),m=tt(),g=ot(),h=ne(()=>Ht.global.locale.replace("_","-")),{toast:_}=gt(),x=Gs(),b=Ks(),{isFetching:S,currentRecording:D}=ie(x),{renameRecording:y}=x,{isFetchingFile:I,currentFileRecording:C}=ie(b),{renameFileRecording:U}=b,E=xt(),{privateGPTSidebarState:N,renameSpeakerSidebarState:$,bookmarkSidebarState:R,summarySidebarState:B,mobileSidebarState:j}=ie(E),{setVisibleState:ee}=E,se=ne(()=>m.path.match(/record/i)),G=ne(()=>m.path.match(/upload-transcribe/i)),J=()=>{E.toggleVisibleState(N),a.value&&(j.value=!0,ee($,!1),ee(R,!1),ee(B,!1))},H=v(!1),M=v(""),W=()=>{H.value=!0,M.value=D.value.name},X=async()=>{try{D.value&&M.value.trim()&&await y(D.value.id,M.value.trim()),V()}catch(P){console.error("Error rename: ",P),_({title:r("kaigiHome.subSidebar.toast.fail.renameRecordingFail"),variant:"destructive"}),V()}},O=()=>{H.value=!0,M.value=C.value.name},K=()=>{try{C.value&&M.value.trim()&&U(C.value.id,M.value),V()}catch(P){console.error("Error rename: ",P),_({title:r("kaigiHome.subSidebar.toast.fail.renameRecordingFail"),variant:"destructive"})}},V=()=>{H.value=!1,M.value=""},F=()=>{se.value?g.push("/kaigikun/record"):g.push("/kaigikun/upload-transcribe")};return(P,q)=>{var le,te,Z,re,ue,he;const A=f("Button"),k=f("TooltipTrigger"),L=f("TooltipContent"),z=f("Tooltip"),Q=f("TooltipProvider"),ae=f("Skeleton"),de=f("Input");return s(),u("div",kA,[t("div",yA,[o(Pe,{variant:"ghost",size:"icon",className:"max-sm:hidden mr-2",tooltip:e(r)("kaigikun.topbar.button.goBack.tooltip"),icon:"bi bi-chevron-left",onClick:F},null,8,["tooltip"]),e(N)?w("",!0):(s(),u("div",xA,[o(Q,null,{default:i(()=>[o(z,null,{default:i(()=>[o(k,{"as-child":""},{default:i(()=>[o(A,{class:"mr-2",variant:"ghost",size:"icon",onClick:J},{default:i(()=>q[2]||(q[2]=[t("i",{class:"bi bi-list"},null,-1)])),_:1,__:[2]})]),_:1}),o(L,{side:"right"},{default:i(()=>[t("p",null,d(e(r)("home.mainSidebar.tooltip.openSidebar")),1)]),_:1})]),_:1})]),_:1})])),t("div",wA,[t("div",null,[e(S)||e(I)?(s(),T(ae,{key:0,class:"h-5 my-1 w-32"})):se.value?(s(),u("div",$A,[H.value?Ke((s(),T(de,{key:0,autoSelect:!0,modelValue:M.value,"onUpdate:modelValue":q[0]||(q[0]=$e=>M.value=$e),onBlur:X,onKeyup:yt(X,["enter"]),class:"-ml-[1px] h-6 w-full rounded-sm px-2 text-md"},null,8,["modelValue"])),[[e(Jt),!0]]):(s(),u("p",SA,d((le=e(D))==null?void 0:le.name),1)),e(D)&&!H.value?(s(),T(Pe,{key:2,icon:"bi bi-pencil opacity-50 hover:opacity-100",variant:"ghost",size:"smicon",tooltip:e(r)("kaigiHome.subSidebar.button.renameRecording"),tooltipSide:"right",onClick:W},null,8,["tooltip"])):w("",!0)])):G.value?(s(),u("div",TA,[H.value?Ke((s(),T(de,{key:0,autoSelect:!0,modelValue:M.value,"onUpdate:modelValue":q[1]||(q[1]=$e=>M.value=$e),onBlur:K,onKeyup:yt(K,["enter"]),class:"h-5 w-full rounded-none px-2 text-md"},null,8,["modelValue"])),[[e(Jt),!0]]):(s(),u("p",AA,d((te=e(C))==null?void 0:te.name),1)),e(C)&&!H.value?(s(),T(Pe,{key:2,icon:"bi bi-pencil opacity-50 hover:opacity-100",variant:"ghost",size:"smicon",tooltip:e(r)("kaigiHome.subSidebar.button.renameRecording"),tooltipSide:"right",onClick:O},null,8,["tooltip"])):w("",!0)])):w("",!0)]),t("div",CA,[t("div",null,[e(S)||e(I)?(s(),T(ae,{key:0,class:"h-3 w-24"})):se.value?(s(),u("p",DA,d(e(ol)(new Intl.DateTimeFormat(h.value,{day:"numeric",month:"long",year:"numeric"}).format((Z=e(D))==null?void 0:Z.createdAt))),1)):G.value?(s(),u("p",LA,d(e(ol)(new Intl.DateTimeFormat(h.value,{day:"numeric",month:"long",year:"numeric"}).format((re=e(C))==null?void 0:re.createdAt))),1)):w("",!0)]),e(S)||e(I)?(s(),T(ae,{key:0,class:"h-3 w-20"})):(s(),u("div",IA,[t("div",BA,[q[3]||(q[3]=t("i",{class:"bi bi-globe"},null,-1)),se.value?(s(),u("div",MA,d(e(p)(`supportedLang.${(ue=e(D))==null?void 0:ue.sourceLang}`,e(r)("supportedLang.unknown"))),1)):w("",!0),G.value?(s(),u("div",EA,d(e(p)(`supportedLang.${(he=e(C))==null?void 0:he.sourceLang}`,e(r)("supportedLang.unknown"))),1)):w("",!0)])]))])])]),e(a)?w("",!0):(s(),T(uo,{key:0}))])}}}),RA={class:"flex sticky top-0 z-20 py-2 bg-stone-50 dark:bg-stone-950 justify-between items-center px-4 border-b"},FA={class:"flex space-x-2"},PA={key:0,class:"flex flex-col items-start gap-2 mt-7 px-5"},NA=["onClick"],zA={class:"w-full flex items-center rounded-md hover:bg-stone-200 dark:hover:bg-stone-600 justify-between"},UA={class:"w-full"},OA={class:"flex text-xs overflow-hidden wrap-anywhere h-full p-2"},jA={key:0,class:"max-w-lg line-clamp-1"},VA={key:1,class:"max-w-lg line-clamp-1"},GA={key:0,class:"max-w-lg line-clamp-1"},WA={key:1,class:"max-w-lg line-clamp-1"},HA={key:0,class:"bi bi-pencil px-3 text-xs"},Pi=oe({__name:"KaigiRenameSpeakerSidebar",props:{isFetching:{type:Boolean},speakers:{},recordingId:{}},emits:["rename"],setup(n,{emit:l}){const a=at(),{isMobileSize:c}=ie(a),r=xt(),{renameSpeakerSidebarState:p}=ie(r),{toggleVisibleState:m}=r,{t:g}=Ce(),{toast:h}=gt(),_=n,x=l,b=()=>{m(p)},S=v(),D=v(""),y=U=>{S.value=U.speakerId,U.displayName?D.value=U.displayName:D.value=U.speakerId},I=()=>{S.value=null,D.value=""},C=async U=>{try{D.value.trim()!=U.displayName&&S.value&&_.recordingId&&await x("rename",_.recordingId,S.value,D.value),I()}catch(E){console.error(E),h({title:g("kaigiHome.subSidebar.toast.fail.renameRecordingFail"),variant:"destructive"})}};return(U,E)=>{const N=f("Button"),$=f("Skeleton"),R=f("Input"),B=f("TooltipTrigger"),j=f("TooltipContent"),ee=f("Tooltip"),se=f("TooltipProvider");return s(),u("div",{class:pe(["border-1 border-r-0 dark:border-stone-500 shadow-md w-full absolute right-0 left-0 top-0 bottom-0",e(c)?"absolute h-dvh":"rounded-tl-2xl","flex flex-col right-0 bg-stone-50 dark:bg-stone-950 space-y-2 transition-all overflow-y-auto pb-5 z-20"])},[t("div",RA,[t("div",FA,[E[1]||(E[1]=t("i",{class:"bi bi-people"},null,-1)),t("span",null,d(e(g)("kaigiInstantRecord.dropdown.changeSpeakerName.speakerList.label")),1)]),t("div",null,[o(N,{variant:"ghost",size:"icon",class:"rounded-full hover:bg-white dark:hover:bg-stone-600",onClick:b},{default:i(()=>E[2]||(E[2]=[t("i",{class:"bi bi-x"},null,-1)])),_:1,__:[2]})])]),_.isFetching?(s(),u("div",PA,[o($,{class:"h-8 w-32"}),o($,{class:"h-6 w-64 mt-1"}),o($,{class:"h-6 w-64 mt-2"}),o($,{class:"h-64 w-11/12 mt-1"}),o($,{class:"h-6 w-32 mt-3"}),o($,{class:"h-6 w-64 mt-1"})])):(s(!0),u(ve,{key:1},Le(_.speakers,G=>(s(),u("div",{key:G.speakerId,onClick:J=>y(G),class:"speakers-list flex rounded-md px-4 w-full cursor-pointer"},[t("div",zA,[t("div",UA,[t("div",OA,[S.value===G.speakerId?Ke((s(),T(R,{key:0,modelValue:D.value,"onUpdate:modelValue":E[0]||(E[0]=J=>D.value=J),onBlur:J=>C(G),onKeyup:yt(J=>C(G),["enter"]),class:"h-4 w-full rounded-none px-0 text-lg py-3"},null,8,["modelValue","onBlur","onKeyup"])),[[e(Jt),!0]]):(s(),T(se,{key:1},{default:i(()=>[o(ee,null,{default:i(()=>[o(B,{"as-child":""},{default:i(()=>[G.displayName?(s(),u("p",VA,d(G.displayName),1)):(s(),u("p",jA,d(G.speakerId),1))]),_:2},1024),o(j,null,{default:i(()=>[G.displayName?(s(),u("p",WA,d(G.displayName),1)):(s(),u("p",GA,d(G.speakerId),1))]),_:2},1024)]),_:2},1024)]),_:2},1024))])]),G.speakerId!==S.value?(s(),u("i",HA)):w("",!0)])],8,NA))),128))],2)}}}),KA={class:"flex sticky top-0 z-20 py-2 bg-stone-50 dark:bg-stone-950 justify-between items-center px-4 border-b"},qA={class:"flex space-x-2"},QA={key:0,class:"flex flex-col text-md p-5 space-y-4"},JA={class:"leading-6 opacity-60"},XA={key:1,class:"flex flex-col items-start gap-2 mt-7 px-5"},YA={key:2,class:"h-[calc(100dvh-8.5rem)] overflow-y-auto"},ZA={class:"flex justify-between w-full"},eC={class:"flex text-xs px-2 w-[10em]"},tC=["onMouseover","onMouseleave","onClick"],sC={class:"bi bi-play"},aC={key:1},oC={class:"flex"},nC=["onClick"],lC={key:1,class:"opacity-60"},iC={key:2,class:"wrap-anywhere"},Ni=oe({__name:"KaigiBookmarkSidebar",props:{isFetching:{type:Boolean},recordUrl:{},audioRef:{},currentRecording:{},currentRecordingBookmarks:{},editingBookmarkId:{},newBookmarkId:{}},emits:["update:editingBookmarkId","skip-to","bookmark-while-recording","bookmark","edit-bookmark","delete-bookmark"],setup(n,{emit:l}){const a=at(),{isMobileSize:c}=ie(a),r=xt(),{bookmarkSidebarState:p}=ie(r),{toggleVisibleState:m}=r,g=Ce(),{t:h}=We(g.t),_=n,x=l,b=v({}),S=()=>{m(p)},D=v(""),y=v(!1),I=N=>{x("update:editingBookmarkId",N.id),D.value=N.content},C=()=>{x("update:editingBookmarkId",null),D.value=""},U=N=>{D.value.trim()!==N.content&&_.editingBookmarkId&&x("edit-bookmark",N.recordingId,N.recordingMessageId,N.id,{new_content:D.value}),C()},E=N=>{x("delete-bookmark",N.recordingId,N.recordingMessageId,N.id)};return(N,$)=>{var O;const R=f("Button"),B=f("Skeleton"),j=f("TooltipTrigger"),ee=f("TooltipContent"),se=f("Tooltip"),G=f("TooltipProvider"),J=f("DropdownMenuTrigger"),H=f("DropdownMenuItem"),M=f("DropdownMenuContent"),W=f("DropdownMenu"),X=f("Textarea");return s(),u("div",{class:pe(["border-1 border-r-0 dark:border-stone-500 shadow-md w-full absolute top-0 bottom-0 left-0 right-0",e(c)?"absolute h-dvh":"rounded-tl-2xl","flex flex-col right-0 bg-stone-50 dark:bg-stone-950 space-y-2 transition-all overflow-y-auto pb-5 z-20"])},[t("div",KA,[t("div",qA,[$[6]||($[6]=t("i",{class:"bi bi-bookmark-plus"},null,-1)),t("span",null,d(e(h)("kaigiInstantRecord.label.bookmarks")),1)]),t("div",null,[o(R,{variant:"ghost",size:"icon",class:"rounded-full hover:bg-white dark:hover:bg-stone-600",onClick:S},{default:i(()=>$[7]||($[7]=[t("i",{class:"bi bi-x"},null,-1)])),_:1,__:[7]})])]),_.currentRecording&&!_.currentRecordingBookmarks.length?(s(),u("div",QA,[t("p",JA,d(e(h)("kaigiInstantRecord.label.bookmarksDescription")),1),((O=_.currentRecording)==null?void 0:O.status)==="COMPLETED"?(s(),T(R,{key:0,size:"sm",class:"rounded-md space-x-1 text-xs self-center",onClick:$[0]||($[0]=K=>x("bookmark"))},{default:i(()=>[$[8]||($[8]=t("i",{class:"bi bi-plus"},null,-1)),t("p",null,d(e(h)("kaigiInstantRecord.label.bookmarks")),1)]),_:1,__:[8]})):(s(),T(R,{key:1,size:"sm",class:"rounded-md space-x-1 text-xs self-center",disabled:(_==null?void 0:_.currentRecording.messageList.length)===0,onClick:$[1]||($[1]=K=>x("bookmark-while-recording"))},{default:i(()=>[$[9]||($[9]=t("i",{class:"bi bi-plus"},null,-1)),t("p",null,d(e(h)("kaigiInstantRecord.label.bookmarks")),1)]),_:1,__:[9]},8,["disabled"]))])):w("",!0),_.isFetching?(s(),u("div",XA,[o(B,{class:"h-8 w-32"}),o(B,{class:"h-6 w-64 mt-1"}),o(B,{class:"h-6 w-64 mt-2"}),o(B,{class:"h-64 w-11/12 mt-1"}),o(B,{class:"h-6 w-32 mt-3"}),o(B,{class:"h-6 w-64 mt-1"})])):(s(),u("div",YA,[(s(!0),u(ve,null,Le(_.currentRecordingBookmarks,K=>(s(),u("div",{key:K.id,class:"group flex flex-col rounded-md px-4 w-full"},[t("div",ZA,[t("div",eC,[_.recordUrl?(s(),T(G,{key:0},{default:i(()=>[o(se,null,{default:i(()=>[o(j,{"as-child":""},{default:i(()=>[t("div",{onMouseover:V=>b.value[K.id]=!0,onMouseleave:V=>b.value[K.id]=!1,onClick:V=>x("skip-to",K.timestampNumb),class:"flex items-center gap-1 text-blue-300 hover:text-blue-500 cursor-pointer mt-1 ease-in-out duration-200"},[Ke(t("i",sC,null,512),[[es,b.value[K.id]]]),me(" "+d(K.timestamp),1)],40,tC)]),_:2},1024),o(ee,null,{default:i(()=>[t("p",null,d(e(h)("kaigiInstantRecord.tooltip.timestamp.title"))+" "+d(K.timestamp),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)):(s(),u("p",aC,d(K.timestamp),1))]),t("div",oC,[_.editingBookmarkId?w("",!0):(s(),T(W,{key:0},{default:i(()=>[o(J,{"as-child":""},{default:i(()=>[o(R,{variant:"ghost",size:"smicon",class:"opacity-0 transition-opacity group-hover:opacity-50 hover:group-hover:opacity-100 focus:group-focus:opacity-50 duration-300"},{default:i(()=>$[10]||($[10]=[t("i",{class:"bi bi-three-dots"},null,-1)])),_:1,__:[10]})]),_:1}),o(M,null,{default:i(()=>[o(H,null,{default:i(()=>[o(R,{variant:"destructive",size:"full",class:"space-x-2 h-7",onClick:V=>E(K)},{default:i(()=>[$[11]||($[11]=t("i",{class:"bi bi-trash"},null,-1)),t("span",null,d(e(h)("kaigiInstantRecord.button.deleteBookmark")),1)]),_:2,__:[11]},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))])]),t("div",{class:"flex text-xs max-w-full h-full p-2 cursor-pointer",onClick:V=>I(K)},[N.editingBookmarkId===K.id?Ke((s(),T(X,{key:0,rows:"1",modelValue:D.value,"onUpdate:modelValue":$[2]||($[2]=V=>D.value=V),onCompositionstart:$[3]||($[3]=V=>y.value=!0),onCompositionend:$[4]||($[4]=V=>y.value=!1),onBlur:V=>U(K),onKeydown:[yt(Ye(V=>U(K),["exact","prevent"]),["enter"]),$[5]||($[5]=yt(Ye(V=>C(),["exact","prevent"]),["esc"]))],class:"flex flex-col items-center h-full w-full text-xs rounded-md border-input bg-white dark:bg-stone-950 p-2 ring-offset-background placeholder:text-muted-foreground focus-visible:outline-hidden focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 border-0 resize-none max-h-52"},null,8,["modelValue","onBlur","onKeydown"])),[[e(Jt),!0]]):K.content?K.content?(s(),u("p",iC,d(K.content),1)):w("",!0):(s(),u("p",lC,d(e(h)("kaigiInstantRecord.placeholder.bookmarks")),1))],8,nC)]))),128))]))],2)}}}),rC={class:"flex flex-row group ml-3"},cC={key:0,class:"text-xs p-2 flex justify-end mt-1 w-[10em]"},dC={key:0},uC={class:"bi bi-play"},pC={key:1},mC={class:"flex items-center gap-2"},gC={key:0,class:"flex flex-row items-center gap-2"},fC={class:"h-6 w-6 bg-stone-300 dark:bg-stone-800 rounded-full flex flex-col justify-center items-center"},vC={class:"text-xs font-bold truncate max-w-xs"},hC={key:0,class:"ml-2"},_C={class:"text-sm"},bC={key:1},kC={class:"bi bi-play"},yC={class:"text-sm"},xC={class:"opacity-0 group-hover:opacity-100"},wC={class:"max-w-lg truncate"},$C={class:"flex flex-row items-center gap-2"},SC={class:"text-xs text-stone-500"},TC={key:0,class:"flex flex-row items-center"},AC={key:0,class:"flex flex-col gap-2"},CC={key:1,class:"flex flex-col items-stretch gap-1 mt-2"},DC=oe({__name:"KaigiMessageItem",props:{mode:{},recordUrl:{},showTranscription:{type:Boolean},showTranslation:{type:Boolean},showActionTools:{type:Boolean},msg:{},isActive:{type:Boolean},isSaving:{type:Boolean},isEditing:{type:Boolean},isTranslating:{type:Boolean},speakerList:{},currentSpeaker:{},sizeIndex:{}},emits:["changeActiveMessage","editMessage","save","fetchSpeakerList","retranslateMessage","bookmarkMessage","updateMessageSpeaker","skipTo"],setup(n,{emit:l}){const a=Qs(),{sizeClasses:c}=a,r=at(),{isMobileSize:p}=ie(r),m=Ce(),{t:g}=We(m.t),h=l,_=ne(()=>c[x.sizeIndex??1]),x=n,b=v(!1),S=v(!1),D=v(x.msg.transcription),y=v(x.msg.translation),I=v({}),C=N=>{y.value=N.translation,h("editMessage",N)},U=()=>{S.value||h("save",{msgId:x.msg.id,transcriptionEdit:D.value,translationEdit:y.value})},E=()=>{D.value=x.msg.transcription,y.value=x.msg.translation,h("editMessage",void 0)};return(N,$)=>{const R=f("Button"),B=f("I18nT"),j=f("Separator"),ee=f("Skeleton"),se=f("Textarea");return s(),u("div",rC,[!e(p)&&x.mode!=="presentation"?(s(),u("div",cC,[x.recordUrl?(s(),u("div",dC,[o(Aa,{tooltipContent:e(g)("kaigiInstantRecord.tooltip.timestamp.title")+" "+N.msg.timestamp},{trigger:i(()=>[t("div",{onMouseover:$[0]||($[0]=G=>I.value[N.msg.id]=!0),onMouseleave:$[1]||($[1]=G=>I.value[N.msg.id]=!1),onClick:$[2]||($[2]=G=>h("skipTo",N.msg.timestampNumb)),class:"text-blue-300 hover:text-blue-500 cursor-pointer ease-in-out duration-200"},[Ke(t("i",uC,null,512),[[es,I.value[N.msg.id]]]),me(" "+d(N.msg.timestamp),1)],32)]),_:1},8,["tooltipContent"])])):(s(),u("div",pC,d(N.msg.timestamp),1))])):w("",!0),t("div",{class:"w-full flex flex-col gap-1",onMouseenter:$[19]||($[19]=G=>b.value=!0),onMouseleave:$[20]||($[20]=G=>b.value=!1),onMouseup:$[21]||($[21]=G=>h("changeActiveMessage",N.msg))},[t("div",{class:pe(["flex flex-col w-full p-2 rounded-md transition-all duration-200",{"bg-stone-100 dark:bg-stone-700":x.isActive||b.value||x.isSaving}])},[t("div",mC,[x.mode!=="presentation"?(s(),u("div",gC,[t("div",fC,[o(e(Cl),{size:16})]),t("p",vC,d(N.currentSpeaker),1),x.mode==="recording"&&e(p)?(s(),u("div",hC,[t("span",_C,d(N.msg.timestamp),1)])):w("",!0),x.mode==="uploadAndTranscribe"&&e(p)?(s(),u("div",bC,[o(Aa,{tooltipContent:e(g)("kaigiInstantRecord.tooltip.timestamp.title")+N.msg.timestamp},{trigger:i(()=>[t("div",{onMouseover:$[3]||($[3]=G=>I.value[N.msg.id]=!0),onMouseleave:$[4]||($[4]=G=>I.value[N.msg.id]=!1),onClick:$[5]||($[5]=G=>h("skipTo",N.msg.timestampNumb)),class:"text-blue-300 hover:text-blue-500 cursor-pointer ease-in-out duration-200"},[Ke(t("i",kC,null,512),[[es,I.value[N.msg.id]]]),t("span",yC,d(N.msg.timestamp),1)],32)]),_:1},8,["tooltipContent"])])):w("",!0),t("div",xC,[x.speakerList?(s(),T(na,{key:0,items:x.speakerList,"item-key":"speakerId",onOnTrigger:$[6]||($[6]=G=>h("fetchSpeakerList")),onOnSelect:$[7]||($[7]=G=>h("updateMessageSpeaker",G)),tooltip:e(g)("kaigiInstantRecord.tooltip.changeSpeakerName"),title:e(g)("kaigiInstantRecord.dropdown.changeSpeakerName.speakerList.label")},{item:i(({item:G})=>[t("p",wC,d(G.displayName??G.speakerId),1)]),_:1},8,["items","tooltip","title"])):w("",!0)])])):w("",!0),t("div",$C,[Ke(t("div",SC,[o(B,{keypath:"kaigiInstantRecord.label.editorHint",tag:"div",scope:"global"},{escKey:i(()=>[o(R,{variant:"link",onClick:E,class:"m-0 h-0 p-0 text-xs"},{default:i(()=>$[22]||($[22]=[me(" esc ")])),_:1,__:[22]})]),enterKey:i(()=>[o(R,{variant:"link",onClick:U,class:"m-0 h-0 p-0 text-xs"},{default:i(()=>$[23]||($[23]=[me(" enter ")])),_:1,__:[23]})]),_:1})],512),[[es,x.isEditing||x.isSaving]]),Ke(t("div",{class:"text-xs text-stone-500"},d(e(g)("kaigiInstantRecord.label.saving")),513),[[es,x.isSaving]]),Ke(t("div",{class:"text-xs text-stone-500"},d(e(g)("kaigiInstantRecord.label.translating")),513),[[es,N.isTranslating]])])]),!x.isEditing&&!x.isSaving?(s(),u("div",{key:0,class:pe(["flex flex-col items-stretch gap-1",x.mode==="presentation"?"":"mt-2"])},[x.showTranscription?(s(),u("div",TC,[t("div",{class:pe(_.value)},d(N.msg.transcription),3)])):w("",!0),x.showTranscription&&x.showTranslation?(s(),T(j,{key:1})):w("",!0),N.msg.translation&&x.showTranslation?(s(),u("div",{key:2,class:pe({"text-stone-500":x.showTranscription})},[x.isTranslating?(s(),u("div",AC,[o(ee,{class:"h-4 w-40 bg-stone-200"}),o(ee,{class:"h-4 w-80 bg-stone-200"}),o(ee,{class:"h-4 w-20 bg-stone-200"})])):(s(),u("div",{key:1,class:pe(_.value)},d(N.msg.translation),3))],2)):w("",!0)],2)):(s(),u("div",CC,[x.showTranscription?Ke((s(),T(se,{key:0,rows:"1",id:`kaigi-message-[${x.msg.id}]-transcription-textarea`,disabled:x.isSaving,modelValue:D.value,"onUpdate:modelValue":$[8]||($[8]=G=>D.value=G),modelModifiers:{lazy:!0},onCompositionstart:$[9]||($[9]=G=>S.value=!0),onCompositionend:$[10]||($[10]=G=>S.value=!1),onKeydown:[yt(Ye(U,["exact","prevent"]),["enter"]),$[11]||($[11]=yt(Ye(G=>h("editMessage",void 0),["exact","prevent"]),["esc"]))],class:"flex flex-col items-center h-full w-full rounded-md border-input bg-white dark:bg-stone-950 p-2 ring-offset-background placeholder:text-muted-foreground focus-visible:outline-hidden focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 border-0 resize-none max-h-52"},null,8,["id","disabled","modelValue","onKeydown"])),[[e(Jt)]]):w("",!0),x.showTranslation?(s(),T(se,{key:1,rows:"1",id:`kaigi-message-[${x.msg.id}]-translation-textarea`,modelValue:y.value,"onUpdate:modelValue":$[12]||($[12]=G=>y.value=G),modelModifiers:{lazy:!0},disabled:x.isSaving,onCompositionstart:$[13]||($[13]=G=>S.value=!0),onCompositionend:$[14]||($[14]=G=>S.value=!1),onKeydown:[yt(Ye(U,["exact","prevent"]),["enter"]),$[15]||($[15]=yt(Ye(G=>h("editMessage",void 0),["exact","prevent"]),["esc"]))],class:"flex flex-col items-center h-full w-full rounded-md border-input bg-white dark:bg-stone-950 p-2 ring-offset-background placeholder:text-muted-foreground focus-visible:outline-hidden focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 border-0 resize-none max-h-52"},null,8,["id","modelValue","disabled","onKeydown"])):w("",!0)]))],2),t("div",{class:pe(["flex gap-2",[x.isActive||b.value?"visible animate-fade animate-once animate-duration-500 animate-delay-100":"invisible"]])},[!x.isEditing&&x.showActionTools?(s(),T(Pe,{key:0,icon:"bi bi-pencil text-xs",tooltip:e(g)("kaigiInstantRecord.tooltip.instantEdit"),onClick:$[16]||($[16]=G=>C(N.msg)),variant:"ghost",size:"mdicon"},null,8,["tooltip"])):w("",!0),x.isEditing?(s(),T(Pe,{key:1,icon:"bi bi-check2 text-xs",tooltip:e(g)("kaigiInstantRecord.tooltip.saveMessage"),onClick:U,variant:"ghost",size:"mdicon"},null,8,["tooltip"])):w("",!0),x.isEditing?(s(),T(Pe,{key:2,icon:"bi bi-x-lg text-xs",tooltip:e(g)("kaigiInstantRecord.tooltip.cancelEdit"),onClick:E,variant:"ghost",size:"mdicon"},null,8,["tooltip"])):w("",!0),x.showActionTools&&x.showTranslation?(s(),T(Pe,{key:3,disabled:N.isTranslating,icon:"bi bi-arrow-repeat text-xs",tooltip:e(g)("kaigiInstantRecord.tooltip.translateMessage"),onClick:$[17]||($[17]=G=>h("retranslateMessage",N.msg)),variant:"ghost",size:"mdicon"},null,8,["disabled","tooltip"])):w("",!0),x.mode!=="presentation"?(s(),T(Pe,{key:4,icon:"bi bi-bookmark-plus text-xs",tooltip:e(g)("kaigiInstantRecord.tooltip.openBookmarks"),onClick:$[18]||($[18]=G=>h("bookmarkMessage",N.msg)),variant:"ghost",size:"mdicon"},null,8,["tooltip"])):w("",!0)],2)],32)])}}}),LC={class:"space-y-1"},IC={key:0},BC={class:"flex flex-row grow group ml-3 sm:ml-0"},MC={class:"flex flex-col w-full gap-1 p-2"},EC={key:0,class:"flex flex-row items-center gap-2 my-2"},RC={class:"h-6 w-6 bg-stone-300 rounded-full flex flex-col justify-center items-center"},FC={class:"text-xs font-bold"},PC={key:2},NC={class:"flex gap-2"},zC={class:"flex gap-2 mt-2"},pn=oe({__name:"KaigiMessageList",props:{mode:{},recordUrl:{},showTranscription:{type:Boolean},showTranslation:{type:Boolean,default:!0},showActionTools:{type:Boolean,default:!0},messageList:{},speakerList:{},speakerMapping:{},recognizing:{},activeEditMessageSaving:{},translatingMessage:{},sizeIndex:{}},emits:["updateMessage","fetchSpeakerList","bookmarkMessage","updateMessageSpeaker","retranslateMessage","skipTo"],setup(n,{emit:l}){const a=Qs(),{sizeClasses:c}=a,r=at(),{isMobileSize:p}=ie(r),m=Ce(),{t:g}=We(m.t),h=n,_=ne(()=>c[h.sizeIndex]),x=l,b=v(null),S=v(null),D=async E=>{x("updateMessage",{msgId:E.msgId,transcriptionEdit:E.transcriptionEdit,translationEdit:E.translationEdit}),I(void 0)},y=E=>{E.id!==b.value&&(b.value=E.id,S.value=null)},I=E=>{if(!E){S.value=null;return}b.value=E.id,S.value=E.id},C=async E=>{I(E)},U=E=>{b.value&&x("updateMessageSpeaker",b.value,E)};return(E,N)=>{const $=f("Skeleton");return s(),u("div",null,[t("div",LC,[(s(!0),u(ve,null,Le(h.messageList,(R,B)=>{var j,ee,se;return s(),u("div",{key:B,class:"last:mb-4"},[o(DC,{mode:h.mode,recordUrl:h.recordUrl,showTranscription:h.showTranscription,showTranslation:h.showTranslation,showActionTools:h.showActionTools,msg:R,isSaving:h.activeEditMessageSaving[R.id]??!1,isActive:b.value===R.id,isEditing:S.value===R.id,isTranslating:h.translatingMessage[R.id]??!1,speakerList:h.speakerList??[],currentSpeaker:((j=h.speakerMapping)==null?void 0:j[R.speakerId])??((se=(ee=h.speakerList)==null?void 0:ee.find(G=>G.speakerId===R.speakerId))==null?void 0:se.speakerId)??R.speakerId??e(g)("kaigiInstantRecord.unknownSpeakerLabel"),sizeIndex:h.sizeIndex,onFetchSpeakerList:N[0]||(N[0]=G=>x("fetchSpeakerList")),onChangeActiveMessage:y,onEditMessage:C,onSave:D,onBookmarkMessage:G=>x("bookmarkMessage",R),onRetranslateMessage:G=>x("retranslateMessage",R),onUpdateMessageSpeaker:U,onSkipTo:G=>x("skipTo",R.timestampNumb)},null,8,["mode","recordUrl","showTranscription","showTranslation","showActionTools","msg","isSaving","isActive","isEditing","isTranslating","speakerList","currentSpeaker","sizeIndex","onBookmarkMessage","onRetranslateMessage","onSkipTo"])])}),128)),h.recognizing?(s(),u("div",IC,[t("div",BC,[e(p)?w("",!0):(s(),u("div",{key:0,class:pe(["text-xs p-2",{"w-[10em]":h.mode==="recording","w-[0em]":h.mode==="presentation"}])},null,2)),t("div",MC,[h.mode!=="presentation"?(s(),u("div",EC,[t("div",RC,[o(e(Cl),{size:16})]),t("div",FC,d(e(g)("kaigiInstantRecord.unknownSpeakerLabel")),1)])):w("",!0),h.showTranscription?(s(),u("div",{key:1,class:pe(_.value)},d(h.recognizing),3)):(s(),u("div",PC,[t("div",NC,[o($,{class:"h-3 grow-3"}),o($,{class:"h-3 grow-1"}),o($,{class:"h-3 grow-2"})]),t("div",zC,[o($,{class:"h-3 w-1/4"}),o($,{class:"h-3 w-1/3"})])]))])])])):w("",!0)])])}}}),UC=[{locale:"ar_EG",langLabel:""},{locale:"az_AZ",langLabel:"Azrbaycan"},{locale:"bn_BD",langLabel:""},{locale:"cs_CZ",langLabel:"etina"},{locale:"de_CH",langLabel:"Deutsch (Schweiz)"},{locale:"en_AU",langLabel:"English (Australia)"},{locale:"en_CA",langLabel:"English (Canada)"},{locale:"en_GB",langLabel:"English (UK)"},{locale:"en_SG",langLabel:"English (Singapore)"},{locale:"en_US",langLabel:"English (US)"},{locale:"es_CL",langLabel:"Espaol (Chile)"},{locale:"es_ES",langLabel:"Espaol (Espaa)"},{locale:"fil_PH",langLabel:"Filipino"},{locale:"fr_FR",langLabel:"Franaise"},{locale:"hi_IN",langLabel:""},{locale:"id_ID",langLabel:"Bahasa Indonesia"},{locale:"ja_JP",langLabel:""},{locale:"ko_KR",langLabel:""},{locale:"lo_LA",langLabel:""},{locale:"mg_MG",langLabel:"Malagasy"},{locale:"ms_MY",langLabel:"Bahasa Melayu"},{locale:"my_MM",langLabel:""},{locale:"nds_DE",langLabel:"Deutsch"},{locale:"ne_NP",langLabel:""},{locale:"ru_RU",langLabel:""},{locale:"si_LK",langLabel:""},{locale:"sk_SK",langLabel:"Slovenina"},{locale:"th_TH",langLabel:""},{locale:"vi_VN",langLabel:"Ting Vit"},{locale:"zh_CN",langLabel:""},{locale:"zh_TW",langLabel:" ()"}],OC={class:"sticky top-0 z-20 bg-stone-50 dark:bg-stone-950 sm:rounded-tl-2xl justify-between items-center"},jC={class:"flex justify-between items-center border-b py-2 px-4"},VC={class:"flex items-center gap-2"},GC={class:"font-medium text-sm"},WC={class:"flex flex-wrap justify-end-safe px-4 py-2"},HC={class:"flex w-full items-center gap-4 py-2"},KC={class:"text-sm opacity-50 whitespace-nowrap"},qC={key:0,class:"flex gap-1.5 mt-2"},QC={key:1,class:"flex gap-2 text-sm"},JC={class:"opacity-50 text-xs"},XC={key:0,class:"flex flex-col items-start gap-2 mt-7 px-5"},YC={key:0,class:"text-sm text-red-500 text-left"},ZC={key:1},eD={class:"space-y-2"},tD={class:"grid grid-cols-2 gap-2"},sD=["onClick","onMouseenter","onMouseleave"],aD={class:"text-sm font-semibold mb-1 ml-2 line-clamp-1"},oD={class:"space-y-2 text-xs bg-white dark:bg-stone-800 rounded-md p-2"},nD={class:"font-bold line-clamp-1"},lD={class:"opacity-60 line-clamp-2"},iD={class:"absolute inset-0 flex items-center justify-center space-x-4"},rD={class:"grid grid-rows-2 gap-2"},cD={class:"font-bold"},dD={class:"opacity-60"},uD={key:2,class:"space-y-2"},pD={class:"text-base font-medium"},mD={key:0,class:"flex items-center gap-2 text-xs font-medium text-blue-500"},mn=oe({__name:"KaigiSummarySidebar",props:{currentRecordingId:{},summarySidebarDisplayState:{type:Boolean},isFetching:{type:Boolean},widthDisplay:{},heightDisplay:{},cannotSummarize:{type:Boolean},templateList:{},selectedTemplate:{},topicList:{},summaryLocale:{},summaryContent:{},isGeneratingSummary:{type:Boolean},currentRecordingSummary:{},currentRecordingLocaleList:{}},emits:["generateSummary","regenerateSummary","deleteSummary","update:summaryLocale"],setup(n,{emit:l}){const a=xt(),{renameSpeakerSidebarState:c,bookmarkSidebarState:r,privateGPTSidebarState:p}=ie(a),m=at(),g=xt(),{summarySidebarState:h}=ie(g),{setVisibleState:_}=xt(),{isMobileSize:x}=ie(m),b=v({}),S=Ce(),{t:D}=We(S.t),y=n,I=l,C=ne(()=>{var J;return(J=y.selectedTemplate)!=null&&J.content?Object.keys(y.selectedTemplate.content):y.topicList}),U=v({}),E=()=>{_(h,!1),_(c,!1),_(r,!1),x.value||_(p,!0)},N=v(""),{copy:$,copied:R,isSupported:B}=ga({source:N}),j=Object.fromEntries(UC.map(J=>[J.locale,J.langLabel])),ee=ne(()=>y.currentRecordingLocaleList.map(J=>({...J,langLabel:j[J.locale]??J.locale}))),se=ne({get:()=>y.summaryLocale,set:J=>I("update:summaryLocale",J)}),G=J=>{I("generateSummary",{summary_template_id:J.id,summary_lang:y.summaryLocale}),U.value[J.id]=!1};return(J,H)=>{var O,K,V;const M=f("Button"),W=f("Skeleton"),X=Kt("auto-animate");return s(),u("div",{class:pe(["border-1 border-r-0 dark:border-stone-500 shadow-md w-full absolute top-0 bottom-0 left-0 right-0",e(x)?"absolute h-dvh":"rounded-tl-2xl","flex flex-col bg-stone-50 dark:bg-stone-950 space-y-2 transition-all pb-5"])},[t("div",OC,[t("div",jC,[t("div",VC,[H[4]||(H[4]=t("i",{class:"bi bi-journals"},null,-1)),t("p",GC,d(e(D)("kaigiInstantRecord.drawer.summary.header.title")),1)]),o(M,{class:"rounded-full hover:bg-white dark:hover:bg-stone-600",onClick:E,variant:"ghost",size:"icon"},{default:i(()=>H[5]||(H[5]=[t("i",{class:"bi bi-x"},null,-1)])),_:1,__:[5]})]),Ke((s(),u("div",WC,[t("div",HC,[t("span",KC,d(e(D)("kaigiInstantRecord.drawer.summary.header.dropdown.selectLanguage.label")),1),o(Ds,{disabled:y.isGeneratingSummary,modelValue:se.value,"onUpdate:modelValue":H[0]||(H[0]=F=>se.value=F),placeholder:e(D)("kaigikun.dialog.presentation.configurations.form.chooseLanguageDropdown.placeholder"),items:ee.value,itemKey:"locale",itemIcon:"bi bi-check-circle text-green-500 ml-2",itemIconDisplay:"isAvailable",itemText:"langLabel"},null,8,["disabled","modelValue","placeholder","items"])]),(O=y.currentRecordingSummary)!=null&&O.summary.length&&!y.isGeneratingSummary?(s(),u("div",qC,[o(Pe,{variant:"outline",className:"dark:bg-stone-700 dark:hover:bg-stone-500",size:"icon",icon:"bi bi-arrow-clockwise text-sm",tooltip:e(D)("kaigiInstantRecord.drawer.summary.header.button.regenerate.tooltip"),onClick:H[1]||(H[1]=F=>I("regenerateSummary",y.summaryLocale))},null,8,["tooltip"]),o(ss,{size:"icon",variant:"outline",className:"dark:bg-stone-700 dark:hover:bg-stone-500 text-xs",content:y.summaryContent??"",copyFailedTooltip:e(D)("copyRichTextButton.tooltip.copyFailed"),copyDoneTooltip:e(D)("copyRichTextButton.tooltip.copyDone"),copyTooltip:e(D)("copyRichTextButton.tooltip.copy")},null,8,["content","copyFailedTooltip","copyDoneTooltip","copyTooltip"]),e(B)?(s(),T(Pe,{key:0,className:"dark:bg-stone-700 dark:hover:bg-stone-500",variant:"outline",size:"icon",icon:e(R)?"bi bi-check text-sm":"bi bi-markdown text-sm",tooltip:e(R)?e(D)("copyMarkdownButton.tooltip.copyDone"):e(D)("copyMarkdownButton.tooltip.copy"),onClick:H[2]||(H[2]=F=>e($)(y.summaryContent))},null,8,["icon","tooltip"])):w("",!0),o(Za,{title:e(D)("kaigiInstantRecord.drawer.summary.header.dialog.delete.title"),description:e(D)("kaigiInstantRecord.drawer.summary.header.dialog.delete.description"),onConfirm:H[3]||(H[3]=F=>I("deleteSummary",y.summaryLocale))},{trigger:i(()=>[o(Pe,{variant:"outline",className:"dark:bg-stone-700 dark:hover:bg-stone-500",size:"icon",icon:"bi bi-trash3 text-sm text-red-500",tooltip:e(D)("kaigiInstantRecord.drawer.summary.header.button.delete.tooltip")},null,8,["tooltip"])]),_:1},8,["title","description"])])):w("",!0),!((K=y.currentRecordingSummary)!=null&&K.summary)&&!y.cannotSummarize?(s(),u("div",QC,[H[6]||(H[6]=t("i",{class:"bi bi-info-circle"},null,-1)),t("span",JC,d(e(D)("kaigiInstantRecord.drawer.summary.body.instruction.label")),1)])):w("",!0)])),[[X]])]),y.isFetching?(s(),u("div",XC,[o(W,{class:"h-8 w-32"}),o(W,{class:"h-6 w-64 mt-1"}),o(W,{class:"h-6 w-64 mt-2"}),o(W,{class:"h-64 w-11/12 mt-1"}),o(W,{class:"h-6 w-32 mt-3"}),o(W,{class:"h-6 w-64 mt-1"})])):(s(),u("div",{key:1,class:pe([y.heightDisplay,"p-4 space-y-4 overflow-y-auto z-11 bg-stone-100 dark:bg-stone-950"])},[y.cannotSummarize?(s(),u("div",YC,d(e(D)("kaigiInstantRecord.drawer.summary.body.cannotSummarize.description",{messageNum:e(no)})),1)):!((V=y.currentRecordingSummary)!=null&&V.summary.length)&&!y.isGeneratingSummary?(s(),u("div",ZC,[t("div",eD,[t("div",tD,[(s(!0),u(ve,null,Le(y.templateList,F=>(s(),u("div",{key:F.id,class:"rounded-lg bg-blue-100 dark:bg-stone-400/50 dark:hover:bg-stone-500/50 p-2 space-y-2 shadow cursor-pointer h-fit"},[t("div",{class:"relative",onClick:Ye(P=>b.value[F.id]=!b.value[F.id],["self"]),onMouseenter:P=>b.value[F.id]=!0,onMouseleave:P=>b.value[F.id]=!1},[t("div",{class:pe({"blur-3xs":b.value[F.id]})},[t("p",aD,d(F.title),1),t("div",oD,[(s(!0),u(ve,null,Le(F.content,(P,q)=>(s(),u("div",{key:q},[t("p",nD,d(q),1),t("p",lD,d(P),1)]))),128))])],2),Ke(t("div",iD,[t("div",rD,[o(fa,{open:U.value[F.id],"onUpdate:open":P=>U.value[F.id]=P,onCancel:P=>U.value[F.id]=!1},{trigger:i(()=>[o(M,{variant:"outline",class:"border border-gray-300 text-xs"},{default:i(()=>[me(d(e(D)("kaigiInstantRecord.drawer.summary.body.button.viewTemplate.label")),1)]),_:1})]),title:i(()=>[o(M,{variant:"dull",class:"px-0",onClick:P=>U.value[F.id]=!1},{default:i(()=>[H[7]||(H[7]=t("i",{class:"bi bi-chevron-left text-xs mr-2"},null,-1)),t("span",null,d(e(D)("kaigiInstantRecord.drawer.summary.body.dialog.viewTemplate.button.back.label")),1)]),_:2,__:[7]},1032,["onClick"])]),description:i(()=>[(s(!0),u(ve,null,Le(F.content,(P,q)=>(s(),u("div",{key:q},[t("p",cD,d(q),1),t("p",dD,d(P),1)]))),128))]),confirm:i(()=>[o(M,{onClick:P=>G(F)},{default:i(()=>[me(d(e(D)("kaigiInstantRecord.drawer.summary.body.button.useTemplate.label")),1)]),_:2},1032,["onClick"])]),_:2},1032,["open","onUpdate:open","onCancel"]),o(M,{onClick:P=>I("generateSummary",{summary_template_id:F.id,summary_lang:y.summaryLocale}),class:"text-xs"},{default:i(()=>[me(d(e(D)("kaigiInstantRecord.drawer.summary.body.button.useTemplate.label")),1)]),_:2},1032,["onClick"])])],512),[[es,b.value[F.id]]])],40,sD)]))),128))])])])):(s(),u("div",uD,[(s(!0),u(ve,null,Le(C.value,(F,P)=>{var q;return Ke((s(),u("div",{class:"p-2 space-y-2",key:F},[t("div",pD,d(F),1),y.isGeneratingSummary?(s(),u("div",mD,[t("span",null,d(e(D)("kaigiInstantRecord.drawer.summary.body.generating.label")),1),H[8]||(H[8]=t("div",{class:"flex justify-center space-x-2"},[t("div",{class:"animate-ping h-[0.1rem] w-[0.1rem] bg-blue-600 rounded-full"}),t("div",{class:"animate-ping animation-delay-200 h-[0.1rem] w-[0.1rem] bg-blue-600 rounded-full"}),t("div",{class:"animate-ping animation-delay-400 h-[0.1rem] w-[0.1rem] bg-blue-600 rounded-full"})],-1))])):(q=y.currentRecordingSummary)!=null&&q.summary.length&&!y.isGeneratingSummary?(s(),T(va,{key:1,"streaming-markdown":y.currentRecordingSummary.summary[P].content,"is-completed":!0,tracking:{appName:"KAIGIKUN",viewName:"SUMMARY",additionalInfo:{recordingId:y.currentRecordingId}}},null,8,["streaming-markdown","tracking"])):w("",!0)])),[[X]])}),128))]))],2))],2)}}}),gD={key:0,class:"flex items-center gap-2"},fD={class:"text-xs opacity-80"},vD={key:1,class:"flex items-center gap-2"},hD={class:"flex items-center gap-2 max-w-32"},_D={class:"whitespace-nowrap overflow-hidden text-ellipsis max-w-[10em] text-xs text-stone-400"},bD={class:"text-xs opacity-80"},kD={class:"flex items-center w-full gap-2"},yD={class:"flex items-center gap-3 py-2.5 px-8 bg-blue-100 dark:bg-stone-700 rounded-full"},xD={class:"flex flex-row gap-1"},wD={class:"text-sm text-blue-400 dark:text-white"},$D={key:0},SD={key:1,class:"bi bi-stop text-red-500"},TD=oe({__name:"KaigiRecordingAudioRecorderContainer",props:{isStopping:{type:Boolean},isMicMuted:{type:Boolean},volumeScale:{},duration:{}},emits:["toggleMuteMic","stopThenFetch","bookmarkWhileRecording"],setup(n,{emit:l}){const a=Ce(),{t:c}=We(a.t),r=at(),p=Gs(),{isMobileSize:m}=ie(r),{currentRecording:g,selectedDeviceId:h,audioInputDevices:_}=ie(p),x=n,b=l,S=ne(()=>_.value.find(D=>D.deviceId===h.value));return(D,y)=>{var H,M,W;const I=f("SelectTrigger"),C=f("SelectItemText"),U=f("SelectItem"),E=f("SelectGroup"),N=f("SelectContent"),$=f("Select"),R=f("Loader"),B=f("Button"),j=f("TooltipTrigger"),ee=f("TooltipContent"),se=f("Tooltip"),G=f("TooltipProvider"),J=Kt("auto-animate");return((H=e(g))==null?void 0:H.status)==="INITIAL"||((M=e(g))==null?void 0:M.status)==="RECORDING"||((W=e(g))==null?void 0:W.status)==="PAUSE"?(s(),u("div",{key:0,class:pe([e(m)?"py-2.5 px-2.5":"p-3","flex items-center justify-between mx-auto gap-2 border bg-white dark:bg-stone-800 shadow-xs sticky bottom-0 z-10 rounded-tl-3xl rounded-tr-3xl"])},[e(m)?(s(),u("div",gD,[o(Pe,{disabled:x.isStopping,icon:x.isMicMuted?"bi bi-mic-mute":"bi bi-mic",className:"rounded-full pr-3 bg-white dark:bg-stone-600",size:"default",tooltip:x.isMicMuted?e(c)("kaigiInstantRecord.tooltip.unMuteMic"):e(c)("kaigiInstantRecord.tooltip.muteMic"),onClick:y[0]||(y[0]=X=>b("toggleMuteMic"))},null,8,["disabled","icon","tooltip"]),o($,{modelValue:e(h),"onUpdate:modelValue":y[1]||(y[1]=X=>kt(h)?h.value=X:null),class:"w-full",id:"audio-device-select"},{default:i(()=>[o(I,{class:"focus:ring-0 focus:ring-offset-0 border-none w-1 bg-transparent"},{default:i(()=>[o(Pe,{icon:"bi bi-chevron-up",variant:"ghost",className:"text-xs text-opacity-40",size:"default"})]),_:1}),o(N,{class:"max-h-72"},{default:i(()=>[(s(!0),u(ve,null,Le(e(_),X=>(s(),T(E,{key:X.deviceId,class:"p-0"},{default:i(()=>[o(U,{value:X.deviceId},{default:i(()=>[o(C,null,{default:i(()=>[t("span",fD,d(X.label),1)]),_:2},1024)]),_:2},1032,["value"])]),_:2},1024))),128))]),_:1})]),_:1},8,["modelValue"])])):Ke((s(),u("div",vD,[o(Pe,{disabled:D.isStopping,icon:D.isMicMuted?"bi bi-mic-mute":"bi bi-mic",variant:"outline",className:"rounded-full pr-3",size:"default",tooltip:D.isMicMuted?e(c)("kaigiInstantRecord.tooltip.unMuteMic"):e(c)("kaigiInstantRecord.tooltip.muteMic"),onClick:y[2]||(y[2]=X=>b("toggleMuteMic"))},null,8,["disabled","icon","tooltip"]),e(_).length?(s(),T($,{key:0,modelValue:e(h),"onUpdate:modelValue":y[3]||(y[3]=X=>kt(h)?h.value=X:null),class:"w-full",disabled:D.isStopping,id:"audio-device-select"},{default:i(()=>[o(I,{class:"focus:ring-0 focus:ring-offset-0 hover:bg-stone-100 dark:hover:bg-stone-700 rounded-full px-3 border"},{default:i(()=>{var X;return[t("div",hD,[t("span",_D,d(((X=S.value)==null?void 0:X.label)??""),1),y[6]||(y[6]=t("i",{class:"bi bi-chevron-down text-xs opacity-40"},null,-1))])]}),_:1}),o(N,{class:"max-h-72"},{default:i(()=>[(s(!0),u(ve,null,Le(e(_),X=>(s(),T(E,{key:X.deviceId,class:"p-0"},{default:i(()=>[o(U,{value:X.deviceId},{default:i(()=>[o(C,null,{default:i(()=>[t("span",bD,d(X.label),1)]),_:2},1024)]),_:2},1032,["value"])]),_:2},1024))),128))]),_:1})]),_:1},8,["modelValue","disabled"])):w("",!0)])),[[J]]),t("div",kD,[Ke((s(),u("div",yD,[t("div",xD,[(s(!0),u(ve,null,Le(x.volumeScale,(X,O)=>(s(),u("div",{key:O,class:pe(["w-1 h-4 bg-blue-500 dark:bg-stone-400 transition-all",{"opacity-100":X,"opacity-20":!X}])},null,2))),128))]),t("div",wD,d(String(Math.floor(x.duration/60)).padStart(2,"0"))+":"+d(String(x.duration%60).padStart(2,"0")),1)])),[[J]]),t("div",null,[o(G,null,{default:i(()=>[o(se,null,{default:i(()=>[o(j,null,{default:i(()=>[o(B,{variant:"outline",size:"icon",class:"border rounded-3xl",onClick:y[4]||(y[4]=X=>b("stopThenFetch")),disabled:D.isStopping},{default:i(()=>[D.isStopping?(s(),u("div",$D,[o(R,{class:"w-4 h-4 animate-spin text-black dark:text-white"})])):(s(),u("i",SD))]),_:1},8,["disabled"])]),_:1}),o(ee,null,{default:i(()=>[me(d(e(c)("kaigiInstantRecord.button.stopRecording")),1)]),_:1})]),_:1})]),_:1})])]),o(Pe,{icon:"bi bi-bookmark-plus",disabled:e(g).messageList.length===0||D.isStopping,variant:"outline",size:"default",tooltip:e(c)("kaigiInstantRecord.tooltip.openBookmarks"),onClick:y[5]||(y[5]=X=>b("bookmarkWhileRecording"))},null,8,["disabled","tooltip"])],2)):w("",!0)}}}),AD={key:0,class:"sticky flex flex-col gap-1 top-16 right-1 h-fit mr-1 p-1 border border-gray-300 dark:border-stone-500 rounded-lg ml-2"},CD={class:"flex gap-2 items-center"},DD={key:0},LD={class:"flex gap-2 items-center"},ID={key:0},BD={class:"flex gap-2 items-center"},MD={key:0},ED=oe({__name:"KaigiRecordingToolbox",props:{isFetching:{type:Boolean}},setup(n){const l=Ce(),{t:a}=We(l.t),c=at(),r=Gs(),p=xt(),{setVisibleState:m,toggleVisibleState:g}=p,{renameSpeakerSidebarState:h,bookmarkSidebarState:_,summarySidebarState:x}=ie(p),{isMobileSize:b}=ie(c),{currentRecording:S}=ie(r),D=n,y=()=>{m(h,!1),m(_,!1),g(x)},I=()=>{m(x,!1),m(_,!1),g(h)},C=()=>{m(x,!1),m(h,!1),g(_)};return(U,E)=>{var N;return!D.isFetching&&!e(b)?(s(),u("div",AD,[((N=e(S))==null?void 0:N.status)==="COMPLETED"?(s(),T(Pe,{key:0,active:e(x),"active-class":"bg-stone-200 dark:bg-stone-700",size:"default",tooltip:e(a)("kaigiInstantRecord.button.summary.tooltip"),onClick:y,className:"text-sm flex justify-start"},{default:i(()=>[t("div",CD,[E[0]||(E[0]=t("i",{class:"bi bi-journals text-xl"},null,-1)),!e(h)&&!e(_)&&!e(x)&&!e(b)?(s(),u("p",DD,d(e(a)("kaigiInstantRecord.button.summary.tooltip")),1)):w("",!0)])]),_:1},8,["active","tooltip"])):w("",!0),o(Pe,{active:e(h),"active-class":"bg-stone-200 dark:bg-stone-700",size:"default",tooltip:e(a)("kaigiInstantRecord.tooltip.openRenameSpeakers"),onClick:I,className:"text-sm flex justify-start"},{default:i(()=>[t("div",LD,[E[1]||(E[1]=t("i",{class:"bi bi-people text-xl"},null,-1)),!e(h)&&!e(_)&&!e(x)&&!e(b)?(s(),u("p",ID,d(e(a)("kaigiInstantRecord.tooltip.openRenameSpeakers")),1)):w("",!0)])]),_:1},8,["active","tooltip"]),o(Pe,{active:e(_),"active-class":"bg-stone-200 dark:bg-stone-700",size:"default",tooltip:e(a)("kaigiInstantRecord.tooltip.openBookmarks"),onClick:C,className:"text-sm flex justify-start"},{default:i(()=>[t("div",BD,[E[2]||(E[2]=t("i",{class:"bi bi-bookmark-plus text-xl"},null,-1)),!e(h)&&!e(_)&&!e(x)&&!e(b)?(s(),u("p",MD,d(e(a)("kaigiInstantRecord.tooltip.openBookmarks")),1)):w("",!0)])]),_:1},8,["active","tooltip"])])):w("",!0)}}}),RD={key:0,class:"flex justify-between p-1 border-y border-gray-300 dark:border-stone-500"},FD={class:"flex gap-2 items-center"},PD={key:0},ND={class:"flex gap-2 items-center"},zD={key:0},UD={class:"flex gap-2 items-center"},OD={key:0},jD=oe({__name:"KaigiRecordingMobileToolbox",props:{isFetching:{type:Boolean}},setup(n){const l=Ce(),{t:a}=We(l.t),c=at(),r=Gs(),p=xt(),{setVisibleState:m,toggleVisibleState:g}=p,{renameSpeakerSidebarState:h,bookmarkSidebarState:_,summarySidebarState:x}=ie(p),{isMobileSize:b}=ie(c),{currentRecording:S}=ie(r),D=n,y=()=>{m(h,!1),m(_,!1),g(x)},I=()=>{m(x,!1),m(_,!1),g(h)},C=()=>{m(x,!1),m(h,!1),g(_)};return(U,E)=>{var N,$,R;return!D.isFetching&&e(b)?(s(),u("div",RD,[((N=e(S))==null?void 0:N.status)==="COMPLETED"?(s(),T(Pe,{key:0,active:e(x),"active-class":"bg-stone-200 dark:bg-stone-700",size:"lg",tooltip:e(a)("kaigiInstantRecord.button.summary.tooltip"),onClick:y,className:"text-sm flex justify-start px-8"},{default:i(()=>[t("div",FD,[E[0]||(E[0]=t("i",{class:"bi bi-journals text-xl"},null,-1)),!e(h)&&!e(_)&&!e(x)&&!e(b)?(s(),u("p",PD,d(e(a)("kaigiInstantRecord.button.summary.tooltip")),1)):w("",!0)])]),_:1},8,["active","tooltip"])):w("",!0),(($=e(S))==null?void 0:$.status)==="PROCESSING"||((R=e(S))==null?void 0:R.status)==="COMPLETED"?(s(),T(Pe,{key:1,active:e(h),"active-class":"bg-stone-200 dark:bg-stone-700",size:"lg",tooltip:e(a)("kaigiInstantRecord.tooltip.openRenameSpeakers"),onClick:I,className:"text-sm flex justify-start px-8"},{default:i(()=>[t("div",ND,[E[1]||(E[1]=t("i",{class:"bi bi-people text-xl"},null,-1)),!e(h)&&!e(_)&&!e(x)&&!e(b)?(s(),u("p",zD,d(e(a)("kaigiInstantRecord.tooltip.openRenameSpeakers")),1)):w("",!0)])]),_:1},8,["active","tooltip"])):w("",!0),o(Pe,{active:e(_),"active-class":"bg-stone-200 dark:bg-stone-700",size:"lg",tooltip:e(a)("kaigiInstantRecord.tooltip.openBookmarks"),onClick:C,className:"text-sm flex justify-start px-8"},{default:i(()=>[t("div",UD,[E[2]||(E[2]=t("i",{class:"bi bi-bookmark-plus text-xl"},null,-1)),!e(h)&&!e(_)&&!e(x)&&!e(b)?(s(),u("p",OD,d(e(a)("kaigiInstantRecord.tooltip.openBookmarks")),1)):w("",!0)])]),_:1},8,["active","tooltip"])])):w("",!0)}}}),VD={class:"w-full h-full flex flex-row"},GD={class:"grow relative flex flex-col"},WD={class:"flex flex-col w-full"},HD={class:"w-full h-full mx-auto rounded-md inset-shadow-2xs flex flex-col"},KD={class:"flex flex-row justify-between items-center px-5 pt-4 sticky top-0 bg-white dark:bg-stone-900 z-1 pb-5"},qD={key:1,class:"flex items-center gap-2"},QD={class:"text-sm font-bold"},JD={class:"flex items-center gap-3"},XD={key:0},YD={key:1},ZD={key:1,class:"flex items-center gap-3"},e3={class:"text-sm space-x-1"},t3={class:"text-stone-500"},s3={class:"font-semibold"},a3={key:0,class:"flex flex-col items-center gap-3 my-auto"},o3={class:"text-sm text-stone-500 text-center px-5"},n3={key:1,class:"flex flex-col my-auto gap-3"},l3={key:2,class:"text-center pt-[25%]"},i3={class:"text-zinc-500 text-xl"},r3={key:3,class:"flex"},c3={key:0,class:"grow"},d3={class:"relative h-0"},u3={key:0,class:"flex items-center justify-center mx-auto w-full sm:w-2/3 rounded-tl-3xl rounded-tr-3xl border bg-white dark:bg-stone-800 p-3 shadow-xs gap-3 sticky bottom-0 z-10 h-15"},p3={class:"text-sm text-center"},m3={class:"font-semibold"},g3={class:"flex items-center justify-center w-full"},f3={class:"relative w-11/12"},v3=["src"],h3={key:0,class:"absolute top-1/2 -translate-y-1/2 bg-white dark:bg-stone-800 left-2 py-4 pr-3"},_3=255,b3=10,nl="h-[calc(100dvh-16rem)]",k3="sm:w-2/3",y3=oe({__name:"InstantRecordView",setup(n){const l=at(),{isMobileSize:a}=ie(l),c=Ce(),{t:r,tFallback:p}=We(c.t),{toast:m}=gt(),g=tt(),h=ot(),_=Gs(),x=Ot(),b=xt(),{renameSpeakerSidebarState:S,bookmarkSidebarState:D,privateGPTSidebarState:y,summarySidebarState:I}=ie(b),{setVisibleState:C}=b,{checkAudioAvailable:U,getRecordFileUrl:E,updateMessage:N,translateMessage:$,fetchBookmarksList:R,bookmark:B,editBookmark:j,deleteBookmark:ee,renameSpeaker:se,fetchRecordingSpeakerList:G,fetchRecordingTemplates:J,generateSummary:H,regenerateSummary:M,fetchSummary:W,fetchLocale:X,deleteSummary:O,clearState:K}=_,{isFetching:V,isFetchingSpeaker:F,isFetchingBookmark:P,isFetchingSummary:q,isNewRecording:A,currentRecording:k,audioAvailable:L,recordUrl:z,showTranslation:Q,currentRecordingSpeakerIds:ae,currentRecordingSpeakers:de,editingBookmarkId:le,newBookmarkId:te,currentRecordingBookmarks:Z,allowToShareScreenAudio:re,recordingTemplateList:ue,selectedTemplate:he,topics:$e,currentRecordingSummary:Se,currentRecordingLocaleList:be,isGeneratingSummary:Ge,summaryContent:fe,selectedDeviceId:Y,audioInputDevices:ce}=ie(_);let ge=null,ye=null,_e=null,Re=null,ke=null,qe=null;const lt=Bt("recordingContentContainer"),St=v(!0),Nt=v(!1),{y:Mt,directions:vt,measure:zt,arrivedState:bt}=Wo(lt,{onStop(){Nt.value=!1}});Te(()=>bt.bottom,()=>{St.value=!0}),Te(Mt,()=>{lt.value&&vt.top&&!Nt.value&&(St.value=!1)});const Ve=()=>{lt.value&&(Nt.value=!0,lt.value.scrollTo({top:lt.value.scrollHeight,behavior:"smooth"}),St.value=!0)},Ze=v(0),ze=v(new Array(10).fill(0));let Be,et,ft;const ht=()=>{Ze.value=Math.floor((Date.now()-Be)/1e3)},pt=()=>{if(ye){ye.getByteFrequencyData(et);const Ae=et.reduce((ut,It)=>ut+It,0)/et.length,Ne=Math.floor(Ae/_3*10);ze.value=new Array(b3).fill(0).map((ut,It)=>It<Ne?1:0),requestAnimationFrame(pt)}},jt=async()=>{try{qe=await navigator.mediaDevices.getDisplayMedia({video:!0,audio:!0});const Ae=qe.getAudioTracks();Ae.length>0&&ge&&_e&&ge.createMediaStreamSource(new MediaStream([Ae[0]])).connect(_e)}catch(Ae){console.error("Error sharing screen audio:",Ae)}},st=v(!1),Fe=()=>{st.value?(rt(),st.value=!1):(xe(),st.value=!0)},xe=()=>{ke&&ke.getAudioTracks().forEach(Ae=>{Ae.enabled=!1})},rt=()=>{ke&&ke.getAudioTracks().forEach(Ae=>{Ae.enabled=!0})},nt=v(!1),Je=v(null),Ee=async()=>{try{await navigator.mediaDevices.getUserMedia({audio:!0});const Ae=await navigator.mediaDevices.enumerateDevices();nt.value=!1;const Ne=Ae.filter(It=>It.kind==="audioinput");ce.value=Ne,!Ne.some(It=>It.deviceId===Y.value)&&Ne.length>0&&(Y.value=Ne[0].deviceId)}catch{nt.value=!0,m({title:r("kaigikun.toast.fail.getAudioInputDevice.title"),description:r("kaigikun.toast.fail.getAudioInputDevice.description"),variant:"destructive"}),await hn()}},je=async Ae=>{try{ke&&ke.getTracks().forEach(ut=>ut.stop()),Re&&(Re.disconnect(),Re=null);const Ne={audio:{deviceId:{exact:Ae}}};ke=await navigator.mediaDevices.getUserMedia(Ne),ge||(ge=new AudioContext),_e||(_e=ge.createMediaStreamDestination()),ye||(ye=ge.createAnalyser(),ye.fftSize=32),Re=ge.createMediaStreamSource(ke),Re.connect(ye),Re.connect(_e),et=new Uint8Array(ye.frequencyBinCount)}catch(Ne){console.error(Ne),m({title:r("kaigikun.toast.fail.switchAudioInputDevice.title"),description:r("kaigikun.toast.fail.switchAudioInputDevice.description"),variant:"destructive"})}};Te(Y,async Ae=>{await je(Ae),Ae&&(st.value=!1)}),ls(()=>{navigator.mediaDevices.removeEventListener("devicechange",Ee)});const Ie=v(!1),ct=v(""),Wt=v(),Zt=v(!1),Xt=v(!0);let _t=null;const Xe=v("");let qt=null,Yt=null;const rs=()=>{if(console.debug("# startRecorder"),!(_e!=null&&_e.stream)){console.debug("## startRecorder: no mixed stream, abort");return}Je.value&&cs(),Je.value=new MediaRecorder(_e.stream),Je.value.ondataavailable=async Ae=>{var It;if(!Ae.data.size||!(_t!=null&&_t.active)||!Xe.value)return;const Ne=await Ae.data.arrayBuffer(),ut=new Uint8Array(Ne);_t.publish({destination:`/app/kaigi/recording-audio/${(It=k.value)==null?void 0:It.id}/session/${Xe.value}`,binaryBody:ut})},Je.value.start(1e3)},cs=()=>{Je.value&&Je.value.state==="recording"&&(Je.value.ondataavailable=null,Je.value.stop(),Je.value=null)};let vs=0,ds=0;const Es=()=>{var Ae;_t&&_t.publish({destination:`/app/kaigi/recording/${(Ae=k.value)==null?void 0:Ae.id}/session/request-id/${sc()}`})},xs=async()=>{ds=0,qt&&(qt.unsubscribe(),qt=null),Yt&&(Yt.unsubscribe(),Yt=null),_t&&(await _t.deactivate(),_t=null),Xe.value="",ct.value="",Ba.value=!1},Xs=async()=>{_t&&await xs(),Be=Date.now();const{pause:Ae,resume:Ne}=Go(()=>ht(),1e3);ft=Ae,requestAnimationFrame(pt),_t=new Fl({brokerURL:"wss://privategpt.fptconsulting.co.jp/ws/privategpt-ws",heartbeatIncoming:0,heartbeatOutgoing:0,reconnectTimeMode:Pl.EXPONENTIAL,reconnectDelay:Va,maxReconnectDelay:da,beforeConnect:async()=>{if(console.debug("# stompClient beforeConnect"),!!k.value){try{await _.fetchRecordingById(k.value.id)}catch(ut){console.error("Failed to fetch recording",ut);return}if(_t&&(_t.connectHeaders={Authorization:` Bearer ${await x.getUserAccessToken()}`}),vs++,vs>ca)throw Zt.value=!0,await _a(),new Error("Too many connection attempts")}},onConnect:async()=>{var ut,It;if(vs=0,!_t){Zt.value=!0,await _a();return}qt=_t.subscribe(`/kaigi/recording-transcription/${(ut=k.value)==null?void 0:ut.id}`,Ss=>{const Ts=JSON.parse(Ss.body);Ts.on_event==="recognizing_event"?(ds=0,ct.value=Ts.transcription):Ts.on_event==="recognized_event"&&(ds=0,ct.value="",_.addRecordingMessage(Ts),Wt.value=Ts.recording_message_id),Et(()=>{zt(),St.value&&!bt.bottom&&(Nt.value=!0,Ve())})}),Yt=_t.subscribe(`/kaigi/recording-session-status/${(It=k.value)==null?void 0:It.id}`,async Ss=>{const Ts=JSON.parse(Ss.body);switch(Ts.on_event){case"restart_event":cs(),console.debug("# stomp session requestSessionId on restart_event"),Es();break;case"send_session_id_event":Xe.value=Ts.message,console.debug("# stomp session got session_id"),rs();break;case"error_event":{console.debug("# stomp session got error_event"),ds++;let Zs=Va*Math.pow(Nl,ds-1);Zs>=da&&(Zs=da),ds>=ca&&(m({title:r("home.toast.fail.generalErrorTitle"),description:r("home.toast.fail.generalError")}),await _a(),await xs());const{start:_o}=sa(()=>{console.debug("# stomp session requestSessionId on error_event, attempt #"+ds),Es()},Zs);_o();break}case"stop_event":cs(),await xs();break}}),Xe.value?console.debug("# stomp on connect, session exists "+Xe.value):(console.debug("# stomp session request on connect"),Es())},onStompError:ut=>{console.error("Broker error:",ut.headers.message,ut.body)}}),_t.activate()},dt=async()=>{try{await je(Y.value),re.value&&await jt(),Ie.value=!0,(!_e||!ge||!ye)&&console.error("Audio context or streams not initialized"),await Xs()}catch(Ae){console.error(Ae),m({title:r("kaigikun.toast.fail.createNewRecording.title"),description:r("kaigikun.toast.fail.createNewRecording.description"),variant:"destructive"}),h.push("/kaigikun/record")}},Qt=async Ae=>{try{V.value=!0,await _.fetchRecordingById(Ae)}catch(Ne){console.error(`Error fetch the recording with id ${Ae}: `,Ne),m({title:r("kaigikun.toast.fail.fetchRecording.title"),description:r("kaigikun.toast.fail.fetchRecording.description"),variant:"destructive"})}finally{V.value=!1}},Ut=v(!1),ws=async()=>{if(!(!k.value||z.value||Ut.value))try{Ut.value=!0,await E(k.value.id),os==null||os.play()}catch(Ae){os==null||os.stop(),console.error(Ae),m({title:r("kaigikun.toast.fail.fetchAudio.title"),description:r("kaigikun.toast.fail.fetchAudio.description"),variant:"destructive"})}finally{Ut.value=!1}},$s=v(!1),hs=v(!1),Ba=v(!1);let fn;const Zi=()=>{var Ae;_t!=null&&_t.active&&_t.publish({destination:`/app/kaigi/recording-stop/${(Ae=k.value)==null?void 0:Ae.id}/session/${Xe.value}`})},vn=()=>{ke&&(ke.getTracks().forEach(Ae=>Ae.stop()),ke=null),qe&&(qe.getTracks().forEach(Ae=>Ae.stop()),qe=null),_e&&(_e.disconnect(),_e=null),ge&&(ge.close(),ge=null),Re&&(Re.disconnect(),Re=null),ye&&(ye.disconnect(),ye=null)},er=ne(()=>{var Ae,Ne,ut;return((Ae=k.value)==null?void 0:Ae.status)!=="COMPLETED"&&((Ne=k.value)==null?void 0:Ne.status)!=="FAILED"&&((ut=k.value)==null?void 0:ut.status)!=="STOP"&&!A.value}),_a=async()=>{k.value&&($s.value=!0,Je.value&&(Je.value.stop(),Je.value=null,ft()),vs>ca||er.value||nt.value?await _.stopRecording(k.value.id):Zi(),vn(),A.value=!1,Xe.value="",Ze.value=0,ct.value="",$s.value=!1)},hn=async()=>{k.value&&(await _a(),await Qt(k.value.id),await mo(k.value.id),await kn(k.value.id),await U(k.value.id),C(I,!0),L.value&&xn())},tr=async()=>{lr(),A.value=!1,Ba.value=!0,await _a(),hs.value=!1,h.push(fn)},sr=()=>{hs.value=!1},ar=ne(()=>{var Ae,Ne;return(((Ae=k.value)==null?void 0:Ae.status)==="INITIAL"||((Ne=k.value)==null?void 0:Ne.status)==="RECORDING")&&!Ba.value&&A.value}),_n=(Ae,Ne)=>{ar.value||A.value?(Ne(!1),hs.value=!0,fn=Ae.path):(Xe.value="",Ne())};qo((Ae,Ne,ut)=>{_n(Ae,ut)}),Qo((Ae,Ne,ut)=>{_n(Ae,ut)});const gs=v(null),bn=Ae=>{gs.value&&(gs.value.currentTime=Ae)},mo=async Ae=>{try{F.value=!0,await G(Ae)}catch(Ne){console.error(Ne),m({title:r("kaigikun.toast.fail.fetchSpeaker.title"),description:r("kaigikun.toast.fail.fetchSpeaker.description"),variant:"destructive"})}finally{F.value=!1}},kn=async Ae=>{try{P.value=!0,await R(Ae)}catch(Ne){console.error(Ne),m({title:r("kaigikun.toast.fail.fetchBookmark.title"),description:r("kaigikun.toast.fail.fetchBookmark.description"),variant:"destructive"})}finally{P.value=!1}},Ma=v("en_US"),yn=async Ae=>{if(!(k.value&&$n.value))try{q.value=!0,Ge.value=!1,await W(Ae,Ma.value)}catch(Ne){console.error(Ne),m({title:r("kaigikun.toast.fail.fetchSummary.title"),description:r("kaigikun.toast.fail.fetchSummary.description"),variant:"destructive"})}finally{q.value=!1}},go=async Ae=>{try{await X(Ae)}catch(Ne){console.error(Ne),m({title:r("kaigikun.toast.fail.fetchSummary.title"),description:r("kaigikun.toast.fail.fetchSummary.description"),variant:"destructive"})}};Te(()=>Array.from(ae.value),async Ae=>{Ae.length&&await mo(k.value.id)}),Te(()=>Ma.value,async()=>{k.value&&await yn(k.value.id)});let os=null;const xn=()=>{gs.value&&(nr(),os=new gl(gs.value,{controls:["play","progress","current-time","mute","volume","settings"],iconUrl:Ri}),or())};let Ys=null;const or=()=>{if(!gs.value)return;const Ae=gs.value.closest(".plyr");Ys=Ae==null?void 0:Ae.querySelector(".plyr__controls"),Ys&&Ys.addEventListener("click",fo,{capture:!0})},nr=()=>{Ys&&Ys.removeEventListener("click",fo,{capture:!0}),os==null||os.destroy(),os=null,z.value&&URL.revokeObjectURL(z.value)},fo=async Ae=>{Ae.target.closest('[data-plyr="play"]')&&!z.value&&await ws()},lr=async()=>{A.value=!0,_t!=null&&_t.active&&(await xs(),xe(),cs(),vn())};Te(()=>g.params.id,async Ae=>{var Ne,ut,It,Ss;a.value&&C(y,!1),K(),C(S,!1),C(D,!1),C(I,!1),ue.value.length===0&&await J(),nt.value=!1,await Promise.all([Qt(Ae),go(Ae),yn(Ae),mo(Ae),kn(Ae),U(Ae)]),!a.value&&((Ne=k.value)==null?void 0:Ne.status)==="COMPLETED"&&C(I,!0),Ze.value=((It=(ut=k.value)==null?void 0:ut.messageList.at(-1))==null?void 0:It.timestampNumb)??0,((Ss=k.value)==null?void 0:Ss.status)==="INITIAL"&&A.value&&(await Ee(),await dt(),navigator.mediaDevices.addEventListener("devicechange",Ee)),L.value&&xn()},{immediate:!0});const Ea=ne(()=>de.value.reduce((Ae,Ne)=>(Ae[Ne.speakerId]=Ne.displayName,Ae),{})),vo=v({}),ho=v({}),ir=async Ae=>{ho.value[Ae.id]=!0;try{await $(Ae)}catch{m({title:r("general.toast.fail.generalErrorTitle"),description:r("general.toast.fail.generalError"),variant:"destructive"})}finally{ho.value[Ae.id]=!1}},rr=async Ae=>{var ut;vo.value[Ae.msgId]=!0;const Ne=(ut=k.value)==null?void 0:ut.messageList.find(It=>It.id===Ae.msgId);try{Ne&&await N(Ne,Ae.transcriptionEdit,Ae.translationEdit)}catch(It){console.error(It),m({title:r("general.toast.fail.generalErrorTitle"),description:r("general.toast.fail.generalError"),variant:"destructive"})}finally{vo.value[Ae.msgId]=!1}},cr=async(Ae,Ne)=>{k.value&&await _.updateMessageSpeaker(k.value.id,Ae,{new_speaker:Ne.speakerId})},dr=async Ae=>{if(D.value||C(D,!0),(S.value||I.value)&&(C(I,!1),C(S,!1)),!!k.value)try{await B(k.value.id,Ae.id,{content:"",timestamp:Ae.timestampNumb}),le.value=te.value}catch(Ne){console.error(Ne),m({title:r("general.toast.fail.generalErrorTitle"),description:r("general.toast.fail.generalError"),variant:"destructive"})}},wn=async()=>{if(D.value||C(D,!0),!!k.value)try{C(D,!0),C(S,!1),C(I,!1),Wt.value&&await B(k.value.id,Wt.value,{content:"",timestamp:Ze.value}),le.value=te.value}catch(Ae){console.error(Ae),m({title:r("general.toast.fail.generalErrorTitle"),description:r("general.toast.fail.generalError"),variant:"destructive"})}},ur=async Ae=>{if(he.value=ue.value.find(Ne=>Ne.id===Ae.summary_template_id),k.value)try{await H(k.value.id,{summary_template_id:Ae.summary_template_id,summary_lang:Ae.summary_lang}),await go(k.value.id)}catch(Ne){m({title:r("kaigikun.toast.fail.generateSummary.title"),description:r("kaigikun.toast.fail.generateSummary.description"),variant:"destructive"}),console.error("Failed to generate summary: ",Ne)}},pr=async Ae=>{if(k.value&&$e.value)try{Se.value=await M(k.value.id,{topics:$e.value,summary_lang:Ae})}catch(Ne){m({title:r("kaigikun.toast.fail.regenerateSummary.title"),description:r("kaigikun.toast.fail.regenerateSummary.description"),variant:"destructive"}),console.error("Failed to regenerate summary: ",Ne)}},mr=async Ae=>{try{k.value&&(await O(k.value.id,Ae),await go(k.value.id)),Se.value=void 0}catch(Ne){m({title:r("kaigikun.toast.fail.deleteSummary.title"),description:r("kaigikun.toast.fail.deleteSummary.description"),variant:"destructive"}),console.error("Failed to delete the summary: ",Ne)}},$n=ne(()=>{var Ae;return(((Ae=k.value)==null?void 0:Ae.messageList.length)??0)<no}),gr=ne(()=>{var Ae;return(Ae=k.value)==null?void 0:Ae.messageList.flatMap(Ne=>{var ut;return[`${Ne.timestamp} - ${((ut=Ea.value)==null?void 0:ut[Ne.speakerId])??Ne.speakerId}:`,Ne.transcription,Ne.translation]}).join(`\r
\r
`)}),fr=ne(()=>{var Ae;return(Ae=k.value)==null?void 0:Ae.messageList.flatMap(Ne=>{var ut;return[`${Ne.timestamp} - ${((ut=Ea.value)==null?void 0:ut[Ne.speakerId])??Ne.speakerId}:`,Ne.translation]}).join(`\r
\r
`)}),vr=ne(()=>{var Ae;return(Ae=k.value)==null?void 0:Ae.messageList.flatMap(Ne=>{var ut;return[`${Ne.timestamp} - ${((ut=Ea.value)==null?void 0:ut[Ne.speakerId])??Ne.speakerId}:`,Ne.transcription]}).join(`\r
\r
`)}),Sn=async()=>{try{if(C(D,!0),!k.value||!k.value.messageList||!gs.value)return;const Ae=k.value.messageList.findIndex(Ne=>Ne.timestampNumb>gs.value.currentTime);Ae===0||Ae===-1?await B(k.value.id,k.value.messageList[k.value.messageList.length-1].id,{content:"",timestamp:gs.value.currentTime}):await B(k.value.id,k.value.messageList[Ae-1].id,{content:"",timestamp:gs.value.currentTime}),le.value=te.value}catch(Ae){console.error(Ae),m({title:r("general.toast.fail.generalErrorTitle"),description:r("general.toast.fail.generalError"),variant:"destructive"})}},hr=async(Ae,Ne,ut,It)=>{try{await j(Ae,Ne,ut,It)}catch(Ss){console.error(Ss),m({title:r("kaigiHome.subSidebar.toast.fail.renameRecordingFail"),variant:"destructive"})}},_r=async(Ae,Ne,ut)=>{try{await ee(Ae,Ne,ut)}catch(It){console.error(It),m({title:r("kaigiHome.subSidebar.toast.fail.renameRecordingFail"),variant:"destructive"})}};ia(()=>{os==null||os.destroy(),z.value&&URL.revokeObjectURL(z.value),Ys&&Ys.removeEventListener("click",fo,!0)});const br=ne(()=>S.value||D.value||I.value);return(Ae,Ne)=>{var Tn,An,Cn,Dn,Ln,In,Bn,Mn;const ut=f("Skeleton"),It=f("Switch"),Ss=f("Button"),Ts=f("DropdownMenuTrigger"),Zs=f("DropdownMenuItem"),_o=f("DropdownMenuContent"),kr=f("DropdownMenu"),yr=f("Loader2");return s(),u("div",VD,[o(to,{title:e(r)("kaigikun.dialog.confirmLeaving.title"),description:e(r)("kaigikun.dialog.confirmLeaving.description"),isOpen:hs.value,isWaiting:$s.value,onCancel:sr,onConfirm:tr},null,8,["title","description","isOpen","isWaiting"]),o(to,{title:e(r)("kaigiInstantRecord.dialog.cantConnect.title"),description:e(r)("kaigiInstantRecord.dialog.cantConnect.description"),isOpen:Zt.value,showCancelButton:!1,confirmButton:e(r)("kaigiInstantRecord.dialog.cantConnect.button.confirm"),onConfirm:Ne[0]||(Ne[0]=Rs=>Zt.value=!1)},null,8,["title","description","isOpen","confirmButton"]),t("div",GD,[o(Fi),t("div",{class:pe([e(a)?"relative":"flex","h-dvh"])},[t("div",WD,[t("div",HD,[t("div",KD,[e(V)?(s(),T(ut,{key:0,class:"h-4 w-24"})):(s(),u("div",qD,[t("div",QD,d(e(r)("kaigiInstantRecord.transcriptionLabel")),1),e(Q)?(s(),T(It,{key:0,checked:Xt.value,"onUpdate:checked":Ne[1]||(Ne[1]=Rs=>Xt.value=Rs),size:"sm"},null,8,["checked"])):w("",!0)])),t("div",JD,[(Tn=e(k))!=null&&Tn.messageList.length&&((An=e(k))==null?void 0:An.status)==="COMPLETED"?(s(),T(kr,{key:0},{default:i(()=>[o(Ts,null,{default:i(()=>[o(Ss,{variant:e(a)?"ghost":"outline",size:"full",class:"p-5 flex items-center gap-1"},{default:i(()=>[Ne[6]||(Ne[6]=t("i",{class:"bi bi-copy"},null,-1)),e(a)?w("",!0):(s(),u("span",XD,d(e(r)("copyRichTextButton.tooltip.copy")),1))]),_:1,__:[6]},8,["variant"])]),_:1}),o(_o,{align:e(a)?"center":"end"},{default:i(()=>[e(k).enableTranslation?(s(),T(Zs,{key:0,class:"p-0"},{default:i(()=>[o(ss,{content:gr.value??"",showTooltip:!1,showButtonLabel:!0,variant:"ghost",copyLabel:e(r)("copyRichTextButton.copyAllContentWithTranslation.label"),size:"default"},null,8,["content","copyLabel"])]),_:1})):w("",!0),e(k).enableTranslation?(s(),T(Zs,{key:1,class:"p-0"},{default:i(()=>[o(ss,{content:fr.value??"",showTooltip:!1,showButtonLabel:!0,variant:"ghost",copyLabel:e(r)("copyRichTextButton.copyAllContentOnlyTranslation.label"),size:"default"},null,8,["content","copyLabel"])]),_:1})):w("",!0),o(Zs,{class:"p-0"},{default:i(()=>[o(ss,{content:vr.value??"",showTooltip:!1,showButtonLabel:!0,variant:"ghost",copyLabel:e(r)("copyRichTextButton.copyAllContentOnlyTranscription.label"),size:"default"},null,8,["content","copyLabel"])]),_:1})]),_:1},8,["align"])]),_:1})):w("",!0),e(Q)?(s(),u("div",YD,[e(V)?(s(),T(ut,{key:0,class:"h-4 w-20"})):(s(),u("div",ZD,[t("div",e3,[t("span",t3,d(e(r)("kaigiInstantRecord.translateToLabel")),1),t("span",s3,d(e(p)(`supportedLang.${(Cn=e(k))==null?void 0:Cn.translateLang}`,e(r)("supportedLang.unknown"))),1)])]))])):w("",!0)])]),t("div",{class:pe(["h-[calc(100dvh-11rem)] bg-white dark:bg-stone-900",[e(a)?"flex-col items-stretch ":"flex-row overflow-y-auto","flex"]]),ref_key:"recordingContentContainer",ref:lt},[o(jD,{isFetching:e(V)},null,8,["isFetching"]),t("div",{class:pe([e(a)?"h-[calc(100dvh-12rem)] overflow-y-auto pt-5":"h-full","px-0 flex flex-col w-full"])},[((Dn=e(k))==null?void 0:Dn.messageList.length)===0&&!ct.value&&((Ln=e(k))==null?void 0:Ln.status)==="INITIAL"?(s(),u("div",a3,[o(e(Dl),{color:"green"}),t("div",o3,d(e(r)("kaigiInstantRecord.suggestionLabel")),1)])):e(V)?(s(),u("div",n3,[(s(),u(ve,null,Le(4,Rs=>t("div",{key:Rs},[o(ut,{class:"h-24 w-11/12 mx-auto"})])),64))])):!((In=e(k))!=null&&In.messageList.length)&&((Bn=e(k))==null?void 0:Bn.status)==="COMPLETED"?(s(),u("div",l3,[t("p",i3,d(e(r)("kaigiInstantRecord.noContentLabel")),1)])):(s(),u("div",r3,[e(k)?(s(),u("div",c3,[o(pn,{mode:"recording",recordUrl:e(z),showTranscription:Xt.value,showTranslation:e(Q),messageList:e(k).messageList,recognizing:ct.value,speakerList:e(de),speakerMapping:Ea.value,activeEditMessageSaving:vo.value,translatingMessage:ho.value,onFetchSpeakerList:Ne[2]||(Ne[2]=Rs=>e(G)(e(k).id)),onRetranslateMessage:ir,onUpdateMessage:rr,onBookmarkMessage:dr,onUpdateMessageSpeaker:cr,onSkipTo:bn},null,8,["recordUrl","showTranscription","showTranslation","messageList","recognizing","speakerList","speakerMapping","activeEditMessageSaving","translatingMessage"])])):w("",!0)]))],2),o(ED,{isFetching:e(V)},null,8,["isFetching"])],2)]),t("div",d3,[St.value?w("",!0):(s(),T(Pe,{key:0,icon:"bi bi-arrow-down text-sm",size:"icon","class-name":"absolute h-8 w-8 rounded-full border bg-white dark:bg-stone-700 z-20 bottom-20 mx-auto shadow-md left-1/2",tooltip:e(r)("kaigiInstantRecord.button.scrollToBottom"),onClick:Ve},null,8,["tooltip"]))]),o(TD,{isStopping:$s.value,isMicMuted:st.value,selectedDeviceId:e(Y),volumeScale:ze.value,duration:Ze.value,onToggleMuteMic:Fe,onStopThenFetch:hn,onBookmarkWhileRecording:wn},null,8,["isStopping","isMicMuted","selectedDeviceId","volumeScale","duration"]),((Mn=e(k))==null?void 0:Mn.status)==="COMPLETED"&&e(L)?(s(),u("div",u3,[Ke(t("div",p3,[t("p",m3,d(e(r)("kaigiInstantRecord.label.noPlaybackOnMobile.title")),1),t("p",null,d(e(r)("kaigiInstantRecord.label.noPlaybackOnMobile.description")),1)],512),[[es,e(a)]]),Ke(t("div",g3,[t("div",f3,[t("audio",{ref_key:"audioRef",ref:gs,src:e(z),controls:"",crossorigin:"anonymous"},null,8,v3),Ut.value?(s(),u("div",h3,[o(yr,{class:"size-6 animate-spin"})])):w("",!0)]),o(Pe,{icon:"bi bi-bookmark-plus",variant:"outline",size:"icon",className:"bg-white dark:bg-background",tooltip:e(r)("kaigiInstantRecord.tooltip.openBookmarks"),onClick:Ne[3]||(Ne[3]=Rs=>Sn())},null,8,["tooltip"])],512),[[es,!e(a)]])])):w("",!0)]),t("div",{class:pe(["flex transition-all items-stretch",br.value?"w-full sm:w-2/3":"w-0",e(a)?"absolute top-0":"relative"])},[o(Ps,{name:"fade-left"},{default:i(()=>{var Rs,En,Rn;return[e(S)?(s(),T(Pi,{key:0,"is-fetching":e(F),speakers:e(de),onRename:e(se),"recording-id":(Rs=e(k))==null?void 0:Rs.id},null,8,["is-fetching","speakers","onRename","recording-id"])):w("",!0),e(D)?(s(),T(Ni,{key:1,isFetching:e(P),onSkipTo:bn,recordUrl:e(z),audioRef:gs.value,onBookmarkWhileRecording:wn,onBookmark:Sn,onEditBookmark:hr,onDeleteBookmark:_r,currentRecording:e(k),currentRecordingBookmarks:e(Z),editingBookmarkId:e(le),newBookmarkId:e(te),heightDisplay:nl,"onUpdate:editingBookmarkId":Ne[4]||(Ne[4]=bo=>le.value=bo)},null,8,["isFetching","recordUrl","audioRef","currentRecording","currentRecordingBookmarks","editingBookmarkId","newBookmarkId"])):w("",!0),e(I)?(s(),T(mn,{key:2,summaryLocale:Ma.value,"onUpdate:summaryLocale":Ne[5]||(Ne[5]=bo=>Ma.value=bo),"current-recording-id":(En=e(k))==null?void 0:En.id,isFetching:e(q),cannotSummarize:$n.value,summarySidebarDisplayState:((Rn=e(k))==null?void 0:Rn.status)==="COMPLETED",widthDisplay:k3,heightDisplay:nl,templateList:e(ue),selectedTemplate:e(he),topicList:e($e),isGeneratingSummary:e(Ge),"current-recording-locale-list":e(be),currentRecordingSummary:e(Se),summaryContent:e(fe),onGenerateSummary:ur,onRegenerateSummary:pr,onDeleteSummary:mr},null,8,["summaryLocale","current-recording-id","isFetching","cannotSummarize","summarySidebarDisplayState","templateList","selectedTemplate","topicList","isGeneratingSummary","current-recording-locale-list","currentRecordingSummary","summaryContent"])):w("",!0)]}),_:1})],2)],2)])])}}}),x3={class:"dark:bg-stone-900 flex flex-col h-[calc(100vh-4rem)] w-full items-stretch"},w3={class:"flex flex-row justify-between items-center ml-2 px-3 py-2 sticky top-0 dark:bg-stone-900 z-20"},$3={class:"flex items-center gap-2"},S3={class:"text-sm font-bold"},T3={key:0},A3={key:1,class:"flex items-center text-sm space-x-1"},C3={class:"text-zinc-500"},D3={class:"font-semibold"},L3={key:0,class:"flex flex-col items-center gap-3 my-auto"},I3={class:"px-3 text-sm text-zinc-500 text-center"},B3={key:1,class:"flex flex-col my-auto gap-3 mx-3"},M3={key:2,class:"text-center pt-[25%]"},E3={class:"text-zinc-500 text-xl"},R3={key:3},F3={key:0},P3={key:0,class:"flex w-full items-center justify-center sticky bottom-0 gap-3 p-3 z-10 bg-white dark:bg-stone-900 border-t"},N3={class:"border flex items-center rounded-full"},z3={class:"flex items-center gap-2 max-w-32"},U3={class:"whitespace-nowrap overflow-hidden text-ellipsis max-w-[8em] text-xs text-stone-400"},O3={class:"text-xs opacity-80"},j3={class:"flex items-center gap-3 py-2 px-8 bg-blue-100 dark:bg-stone-700 rounded-full"},V3={class:"flex flex-row gap-1"},G3={class:"text-sm text-blue-400 dark:text-white"},W3={key:0},H3={key:1,class:"bi bi-stop text-red-500"},K3=oe({__name:"PresentationRightPanel",setup(n){const l=Ce(),{t:a,tFallback:c}=We(l.t),{toast:r}=gt(),p=tt(),m=Qs(),g=Ot(),{stopPresentation:h,fetchPresentationById:_,addPresentationMessage:x,updateMessage:b,translateMessage:S,clearState:D}=m,{isFetching:y,currentPresentation:I,sizeIndex:C,isNewPresentation:U,showTranslation:E}=ie(m),N=v(!0),$=v(!1),R=v("");let B=null,j=null,ee=null,se=null,G=null,J=null;const H=v(0),M=v(new Array(10).fill(0));let W,X,O;const K=Bt("presentatationContentContainer"),V=async()=>{try{B=new AudioContext,J=await navigator.mediaDevices.getUserMedia({audio:!0});const Ve=B.createMediaStreamSource(J);G=B.createMediaStreamDestination(),Ve.connect(G),j=B.createAnalyser(),j.fftSize=32,ee=B.createMediaStreamSource(J),ee.connect(j),X=new Uint8Array(j.frequencyBinCount),ye()}catch(Ve){console.error("Error starting presentation: ",Ve)}},F=v(),P=v([]),q=v("default"),A=ne(()=>P.value.find(Ve=>Ve.deviceId===q.value)),k=v(!1),L=async()=>{try{await navigator.mediaDevices.getUserMedia({audio:!0});const Ve=await navigator.mediaDevices.enumerateDevices();k.value=!1;const Ze=Ve.filter(Be=>Be.kind==="audioinput");P.value=Ze,!Ze.some(Be=>Be.deviceId===q.value)&&Ze.length>0&&(q.value=Ze[0].deviceId)}catch(Ve){k.value=!0,console.error(Ve),r({title:a("kaigikun.toast.fail.getAudioInputDevice.title"),description:a("kaigikun.toast.fail.getAudioInputDevice.description"),variant:"destructive"}),Re()}},z=async Ve=>{var Ze;if(((Ze=I.value)==null?void 0:Ze.status)==="INITIAL")try{J&&J.getTracks().forEach(Be=>Be.stop()),se&&(se.disconnect(),se=null);const ze={audio:{deviceId:{exact:Ve}}};J=await navigator.mediaDevices.getUserMedia(ze),B||(B=new AudioContext),G||(G=B.createMediaStreamDestination()),j||(j=B.createAnalyser(),j.fftSize=32),se=B.createMediaStreamSource(J),se.connect(j),se.connect(G),X=new Uint8Array(j.frequencyBinCount)}catch(ze){console.error(ze),r({title:a("kaigikun.toast.fail.switchAudioInputDevice.title"),description:a("kaigikun.toast.fail.switchAudioInputDevice.description"),variant:"destructive"})}};Te(q,async Ve=>{await z(Ve),Ve&&(Q.value=!1)});const Q=v(!1),ae=v(!1),de=()=>{K.value&&(K.value.scrollTo({top:K.value.scrollHeight+8e7,behavior:"smooth"}),ae.value=!0)},le=v(0),te=()=>{const Ve=K.value.scrollTop,Ze=K.value.clientHeight,ze=K.value.scrollHeight,Be=Ve+Ze>=ze;if(le.value>Ve)ae.value=!1;else if(le.value<Ve&&Be)ae.value=!0;else return;le.value=Ve};let Z=null;const re=v("");let ue=null,he=null;const $e=()=>{G!=null&&G.stream&&(F.value=new MediaRecorder(G.stream),F.value.ondataavailable=async Ve=>{var Ze;if(Ve.data.size>0&&(Z!=null&&Z.active)&&re.value){const ze=await Ve.data.arrayBuffer(),Be=new Uint8Array(ze);Z.publish({destination:`/app/kaigi/presentation-audio/${(Ze=I.value)==null?void 0:Ze.id}/session/${re.value}`,binaryBody:Be})}})};let Se=0,be=0;const Ge=v(!1),fe=()=>{var Ve;Z&&Z.publish({destination:`/app/kaigi/presentation/${(Ve=I.value)==null?void 0:Ve.id}/session/request-id`})},Y=()=>{be=0,ue==null||ue.unsubscribe(),he==null||he.unsubscribe(),Z==null||Z.deactivate(),R.value=""},ce=()=>{F.value&&F.value.state!=="recording"&&F.value.start(1e3)},ge=()=>{F.value&&F.value.state==="recording"&&F.value.stop()},ye=async()=>{$e(),W=Date.now(),O=setInterval(lt,1e3),requestAnimationFrame(St),Z=new Fl({brokerURL:"wss://privategpt.fptconsulting.co.jp/ws/privategpt-ws",heartbeatIncoming:0,heartbeatOutgoing:0,reconnectTimeMode:Pl.EXPONENTIAL,reconnectDelay:Va,maxReconnectDelay:da,beforeConnect:async()=>{if(await m.fetchPresentationById(I.value.id),Z.connectHeaders={Authorization:` Bearer ${await g.getUserAccessToken()}`},Se++,Se>ca)throw r({title:a("home.toast.fail.generalErrorTitle"),description:a("home.toast.fail.generalError"),variant:"destructive"}),Re(),new Error("Too many connection attempts")},onConnect:()=>{var Ve,Ze,ze;Se=0,ue=Z.subscribe(`/kaigi/presentation-transcription/${(Ve=I.value)==null?void 0:Ve.id}`,Be=>{const et=JSON.parse(Be.body);if(et.on_event==="recognizing_event")be=0,R.value=et.transcription;else if(et.on_event==="recognized_event")be=0,R.value="",x(et);else return;de()}),he=Z.subscribe(`/kaigi/presentation-session-status/${(Ze=I.value)==null?void 0:Ze.id}`,Be=>{const et=JSON.parse(Be.body);switch(et.on_event){case"restart_event":ge(),$e(),fe();break;case"send_session_id_event":re.value=et.message;break;case"error_event":{be++;let ft=Va*Math.pow(Nl,be-1);ft>=da&&(ft=da),be>=ca&&(r({title:a("home.toast.fail.generalErrorTitle"),description:a("home.toast.fail.generalError")}),Re(),Y());const{start:ht}=sa(()=>fe(),ft);ht();break}case"stop_event":ge(),Y();break}}),Z.publish({destination:`/app/kaigi/presentation/${(ze=I.value)==null?void 0:ze.id}/session/request-id`})},onStompError:Ve=>{console.error("Broker error:",Ve.headers.message,Ve.body)}}),Z.activate()};Te(re,Ve=>{var Ze;Ve&&((Ze=F.value)==null?void 0:Ze.state)!=="recording"&&ce()});const _e=ne(()=>{var Ve,Ze,ze;return((Ve=I.value)==null?void 0:Ve.status)!=="COMPLETED"&&((Ze=I.value)==null?void 0:Ze.status)!=="FAILED"&&((ze=I.value)==null?void 0:ze.status)!=="STOP"&&!U.value}),Re=async()=>{$.value=!0,F.value&&(F.value.stop(),clearInterval(O)),Se>ca||_e.value||k.value?h(I.value.id):ke(),J&&(J.getTracks().forEach(Ve=>Ve.stop()),J=null),B&&(B.close(),B=null),H.value=0,R.value="",$.value=!1},ke=async()=>{var Ve;Z!=null&&Z.activate&&Z.publish({destination:`/app/kaigi/presentation-stop/${(Ve=I.value)==null?void 0:Ve.id}/session/${re.value}`})},qe=async()=>{await Re(),await Nt(I.value.id)},lt=()=>{H.value=Math.floor((Date.now()-W)/1e3)},St=()=>{if(j){j.getByteFrequencyData(X);const Ve=X.reduce((ze,Be)=>ze+Be,0)/X.length,Ze=Math.floor(Ve/255*10);M.value=new Array(10).fill(0).map((ze,Be)=>Be<Ze?1:0),requestAnimationFrame(St)}},Nt=async Ve=>{try{y.value=!0,await _(Ve)}catch(Ze){console.error(`Error fetch the presentation with id ${Ve}: `,Ze),r({title:a("kaigikun.toast.fail.fetchPresentation.title"),description:a("kaigikun.toast.fail.fetchPresentation.description"),variant:"destructive"})}finally{y.value=!1}};qo(async()=>{var Ve;((Ve=I.value)==null?void 0:Ve.status)==="INITIAL"&&await Re()}),ls(()=>{navigator.mediaDevices.removeEventListener("devicechange",L)}),ia(async()=>{await Re()}),Te(()=>p.params.id,async Ve=>{var Ze;D(),await Nt(Ve),((Ze=I.value)==null?void 0:Ze.status)==="INITIAL"&&U.value&&(await L(),await V(),navigator.mediaDevices.addEventListener("devicechange",L)),U.value=!1},{immediate:!0});const Mt=v({}),vt=v({}),zt=async Ve=>{vt.value[Ve.id]=!0;try{await S(Ve)}catch{r({title:a("general.toast.fail.generalErrorTitle"),description:a("general.toast.fail.generalError"),variant:"destructive"})}finally{vt.value[Ve.id]=!1}},bt=async Ve=>{var ze;Mt.value[Ve.msgId]=!0;const Ze=(ze=I.value)==null?void 0:ze.messageList.find(Be=>Be.id===Ve.msgId);try{Ze&&await b(Ze,Ve.transcriptionEdit,Ve.translationEdit)}catch(Be){console.error(Be),r({title:a("general.toast.fail.generalErrorTitle"),description:a("general.toast.fail.generalError"),variant:"destructive"})}finally{Mt.value[Ve.msgId]=!1}};return(Ve,Ze)=>{var je,Ie,ct,Wt,Zt,Xt,_t;const ze=f("Switch"),Be=f("Skeleton"),et=f("SelectTrigger"),ft=f("SelectItemText"),ht=f("SelectItem"),pt=f("SelectGroup"),jt=f("SelectContent"),st=f("Select"),Fe=f("Loader"),xe=f("Button"),rt=f("TooltipTrigger"),nt=f("TooltipContent"),Je=f("Tooltip"),Ee=f("TooltipProvider");return s(),u("div",x3,[t("div",w3,[t("div",$3,[t("div",S3,d(e(a)("kaigiInstantRecord.transcriptionLabel")),1),e(E)?(s(),T(ze,{key:0,checked:N.value,"onUpdate:checked":Ze[0]||(Ze[0]=Xe=>N.value=Xe),size:"sm"},null,8,["checked"])):w("",!0)]),e(E)?(s(),u("div",T3,[e(y)?(s(),T(Be,{key:0,class:"h-4 w-20"})):(s(),u("div",A3,[t("span",C3,d(e(a)("kaigiInstantRecord.translateToLabel")),1),t("span",D3,d(e(c)(`supportedLang.${(je=e(I))==null?void 0:je.translateLang}`,e(a)("supportedLang.unknown"))),1)]))])):w("",!0)]),o(to,{title:e(a)("kaigiInstantRecord.dialog.cantConnect.title"),description:e(a)("kaigiInstantRecord.dialog.cantConnect.description"),isOpen:Ge.value,showCancelButton:!1,confirmButton:e(a)("kaigiInstantRecord.dialog.cantConnect.button.confirm"),onConfirm:Ze[1]||(Ze[1]=Xe=>Ge.value=!1)},null,8,["title","description","isOpen","confirmButton"]),t("div",{class:"flex grow flex-col w-full h-full pt-4 overflow-y-auto",ref_key:"presentatationContentContainer",ref:K,onScroll:te},[((Ie=e(I))==null?void 0:Ie.messageList.length)===0&&!R.value&&((ct=e(I))==null?void 0:ct.status)==="INITIAL"?(s(),u("div",L3,[o(e(Dl),{color:"green"}),t("div",I3,d(e(a)("kaigiInstantRecord.suggestionLabel")),1)])):e(y)?(s(),u("div",B3,[(s(),u(ve,null,Le(4,Xe=>t("div",{key:Xe},[o(Be,{class:"h-24 w-full"})])),64))])):!((Wt=e(I))!=null&&Wt.messageList.length)&&((Zt=e(I))==null?void 0:Zt.status)==="COMPLETED"?(s(),u("div",M3,[t("p",E3,d(e(a)("kaigiInstantRecord.noContentLabel")),1)])):(s(),u("div",R3,[e(I)?(s(),u("div",F3,[o(pn,{mode:"presentation",showTranscription:N.value,showTranslation:e(E),showActionTools:e(I).status==="COMPLETED",messageList:e(I).messageList,recognizing:R.value,activeEditMessageSaving:Mt.value,translatingMessage:vt.value,sizeIndex:e(C),onRetranslateMessage:zt,onUpdateMessage:bt},null,8,["showTranscription","showTranslation","showActionTools","messageList","recognizing","activeEditMessageSaving","translatingMessage","sizeIndex"])])):w("",!0)]))],544),((Xt=e(I))==null?void 0:Xt.status)==="INITIAL"||((_t=e(I))==null?void 0:_t.status)==="RECORDING"?(s(),u("div",P3,[t("div",N3,[o(st,{id:"audio-device-select",modelValue:q.value,"onUpdate:modelValue":Ze[2]||(Ze[2]=Xe=>q.value=Xe),class:"w-full",disabled:$.value},{default:i(()=>[o(et,{class:"focus:ring-0 focus:ring-offset-0 hover:bg-stone-100 dark:hover:bg-stone-800 space-x-1 ml-auto rounded-full px-5 border-none"},{default:i(()=>{var Xe;return[t("div",z3,[t("span",U3,d(((Xe=A.value)==null?void 0:Xe.label)??""),1),Ze[3]||(Ze[3]=t("i",{class:"bi bi-chevron-down text-xs opacity-40"},null,-1))])]}),_:1}),o(jt,{class:"max-h-72"},{default:i(()=>[(s(!0),u(ve,null,Le(P.value,Xe=>(s(),T(pt,{key:Xe.deviceId,class:"p-0"},{default:i(()=>[o(ht,{value:Xe.deviceId},{default:i(()=>[o(ft,null,{default:i(()=>[t("span",O3,d(Xe.label),1)]),_:2},1024)]),_:2},1032,["value"])]),_:2},1024))),128))]),_:1})]),_:1},8,["modelValue","disabled"])]),t("div",j3,[t("div",V3,[(s(!0),u(ve,null,Le(M.value,(Xe,qt)=>(s(),u("div",{key:qt,class:pe(["w-1 h-4 bg-blue-500 dark:bg-stone-400 transition-all",{"opacity-100":Xe,"opacity-20":!Xe}])},null,2))),128))]),t("div",G3,d(String(Math.floor(H.value/60)).padStart(2,"0"))+":"+d(String(H.value%60).padStart(2,"0")),1)]),t("div",null,[o(Ee,null,{default:i(()=>[o(Je,null,{default:i(()=>[o(rt,null,{default:i(()=>[o(xe,{variant:"outline",size:"icon",class:"border rounded-3xl",onClick:qe,disabled:$.value},{default:i(()=>[$.value?(s(),u("div",W3,[o(Fe,{class:"w-4 h-4 animate-spin text-black dark:text-white"})])):(s(),u("i",H3))]),_:1},8,["disabled"])]),_:1}),o(nt,null,{default:i(()=>[me(d(e(a)("presentation.tooltip.stopPresentation")),1)]),_:1})]),_:1})]),_:1})])])):w("",!0)])}}}),q3={class:"flex flex-row justify-start gap-2 items-center px-3 py-1 shrink-0 sticky top-0 z-10 border-b h-16"},Q3={class:"flex items-center justify-between w-full px-2"},J3={class:"flex items-center gap-10 justify-between"},X3={class:"text-md truncate max-w-[15rem]"},Y3={class:"flex flex-row gap-4 text-sm opacity-60"},Z3={class:"opacity-60"},eL={class:"flex flex-row items-center gap-2"},tL={class:"flex gap-4 text-sm"},sL={class:"flex justify-center py-1 items-center gap-3"},aL={class:"flex justify-center items-center gap-3"},oL={class:"p-3 px-6 rounded-md border"},nL={class:"mr-5 flex items-center gap-3"},lL={class:"flex items-center gap-3"},iL={key:0},rL={class:"flex gap-4 text-sm"},cL={class:"flex justify-center py-1 items-center gap-3"},dL=oe({__name:"PresentationTopbar",setup(n){const l=xt(),{summarySidebarState:a,privateGPTSidebarState:c}=ie(l),{toggleVisibleState:r,setVisibleState:p}=l,m=at(),g=Ce(),{t:h,tFallback:_}=We(g.t),x=Qs(),{sizeIndex:b,currentPresentation:S}=ie(x),{increaseTextSize:D,decreaseTextSize:y}=x,{prevPage:I,nextPage:C,zoomIn:U,zoomOut:E,toggleFitParent:N}=x,{page:$,pages:R,scaleNumb:B,isFitParent:j}=ie(x),ee=ot(),se=()=>{ee.back()},G=()=>{J.value&&p(c,!1),r(a)},{isMobileSize:J}=ie(m),H=ne(()=>{var X;return(X=S.value)==null?void 0:X.messageList.flatMap(O=>[O.timestamp,O.transcription,O.translation]).join(`\r
\r
`)}),M=ne(()=>{var X;return(X=S.value)==null?void 0:X.messageList.flatMap(O=>[O.timestamp,O.translation]).join(`\r
\r
`)}),W=ne(()=>{var X;return(X=S.value)==null?void 0:X.messageList.flatMap(O=>[O.timestamp,O.transcription]).join(`\r
\r
`)});return(X,O)=>{var A,k,L,z,Q,ae,de,le,te;const K=f("Button"),V=f("DropdownMenuTrigger"),F=f("DropdownMenuItem"),P=f("DropdownMenuContent"),q=f("DropdownMenu");return s(),u("div",q3,[o(K,{variant:"ghost",size:"icon",class:"rounded-full",onClick:se},{default:i(()=>O[0]||(O[0]=[t("i",{class:"bi bi-chevron-left"},null,-1)])),_:1,__:[0]}),t("div",Q3,[t("div",J3,[t("div",null,[t("div",X3,d((A=e(S))==null?void 0:A.name),1),t("div",Y3,[t("div",null,[t("p",Z3,d((k=e(S))==null?void 0:k.createdAt.toDateString()),1)]),t("div",null,[t("div",eL,[O[1]||(O[1]=t("i",{class:"bi bi-globe"},null,-1)),t("div",null,d(e(_)(`supportedLang.${(L=e(S))==null?void 0:L.sourceLang}`,e(h)("supportedLang.unknown"))),1)])])])]),t("div",tL,[t("div",sL,[t("div",aL,[o(Pe,{variant:"ghost",size:"icon",icon:"bi bi-arrow-left-short",tooltip:e(h)("kaigiPresentation.tooltip.presentation.slideControl.prevSlide"),disabled:e($)===1,onClick:e(I)},null,8,["tooltip","disabled","onClick"]),t("div",null,d(e($))+" / "+d(e(R)),1),o(Pe,{variant:"ghost",size:"icon",icon:"bi bi-arrow-right-short",tooltip:e(h)("kaigiPresentation.tooltip.presentation.slideControl.nextSlide"),disabled:e($)===((z=e(R))==null?void 0:z.value),onClick:e(C)},null,8,["tooltip","disabled","onClick"])]),O[2]||(O[2]=t("div",{class:"opacity-30"},"|",-1)),o(Pe,{variant:"ghost",size:"icon",icon:"bi bi-dash",disabled:e(B)<=20,tooltip:e(h)("kaigiPresentation.tooltip.presentation.slideControl.zoomOut"),onClick:e(E)},null,8,["disabled","tooltip","onClick"]),t("div",oL,d(e(B))+" %",1),o(Pe,{variant:"ghost",size:"icon",icon:"bi bi-plus",tooltip:e(h)("kaigiPresentation.tooltip.presentation.slideControl.zoomIn"),onClick:e(U)},null,8,["tooltip","onClick"]),o(Pe,{variant:"ghost",size:"icon",icon:e(j)?"bi bi-fullscreen-exit":"bi bi-fullscreen",tooltip:e(j)?e(h)("kaigiPresentation.tooltip.presentation.slideControl.unfitParent"):e(h)("kaigiPresentation.tooltip.presentation.slideControl.fitParent"),onClick:e(N)},null,8,["icon","tooltip","onClick"])])])]),t("div",nL,[t("div",lL,[(Q=e(S))!=null&&Q.messageList.length&&((ae=e(S))==null?void 0:ae.status)==="COMPLETED"?(s(),T(q,{key:0},{default:i(()=>[o(V,null,{default:i(()=>[o(K,{variant:"outline",size:"full",class:"p-5 flex items-center gap-1"},{default:i(()=>[O[3]||(O[3]=t("i",{class:"bi bi-copy"},null,-1)),e(J)?w("",!0):(s(),u("span",iL,d(e(h)("copyRichTextButton.tooltip.copy")),1))]),_:1,__:[3]})]),_:1}),o(P,{class:"ml-2",align:e(J)?"center":"end"},{default:i(()=>[o(F,{class:"px-2 py-0"},{default:i(()=>[o(ss,{content:H.value??"",showTooltip:!1,showButtonLabel:!0,variant:"ghost",copyLabel:e(h)("copyRichTextButton.copyAllContentWithTranslation.label"),size:"default"},null,8,["content","copyLabel"])]),_:1}),o(F,{class:"px-2 py-0"},{default:i(()=>[o(ss,{content:M.value??"",showTooltip:!1,showButtonLabel:!0,variant:"ghost",copyLabel:e(h)("copyRichTextButton.copyAllContentOnlyTranslation.label"),size:"default"},null,8,["content","copyLabel"])]),_:1}),o(F,{class:"px-2 py-0"},{default:i(()=>[o(ss,{content:W.value??"",showTooltip:!1,showButtonLabel:!0,variant:"ghost",copyLabel:e(h)("copyRichTextButton.copyAllContentOnlyTranscription.label"),size:"default"},null,8,["content","copyLabel"])]),_:1})]),_:1},8,["align"])]),_:1})):w("",!0)]),O[6]||(O[6]=t("div",{class:"opacity-30"},"|",-1)),((de=e(S))==null?void 0:de.status)==="COMPLETED"?(s(),T(K,{key:0,size:"default",tooltip:e(h)("kaigiInstantRecord.button.summary.tooltip"),onClick:G,class:"px-7 dark:bg-stone-600 dark:hover:bg-stone-500 dark:text-white"},{default:i(()=>[O[4]||(O[4]=t("i",{class:"bi bi-journals mr-2"},null,-1)),t("span",null,d(e(a)?e(h)("kaigiPresentation.tooltip.presentation.summary.button.title.hide"):e(h)("kaigiPresentation.tooltip.presentation.summary.button.title.show")),1)]),_:1,__:[4]},8,["tooltip"])):w("",!0),O[7]||(O[7]=t("div",{class:"opacity-30"},"|",-1)),t("div",rL,[t("div",cL,[o(Pe,{variant:"ghost",size:"icon",disabled:e(b)===1||((le=e(S))==null?void 0:le.messageList.length)===0,icon:"bi bi-dash",tooltip:e(h)("kaigiPresentation.tooltip.presentation.slideControl.textDecrease"),onClick:e(y)},null,8,["disabled","tooltip","onClick"]),O[5]||(O[5]=t("div",{class:"p-3"},[t("i",{class:"bi bi-type text-lg"})],-1)),o(Pe,{variant:"ghost",size:"icon",icon:"bi bi-plus",disabled:e(b)===5||((te=e(S))==null?void 0:te.messageList.length)===0,tooltip:e(h)("kaigiPresentation.tooltip.presentation.slideControl.textIncrease"),onClick:e(D)},null,8,["disabled","tooltip","onClick"])])])])])])}}}),uL={class:"flex flex-row w-full"},pL={class:"grow flex flex-col w-full"},mL={class:"flex flex-col items-center justify-center h-full"},gL="h-[calc(100dvh-16rem)]",fL="w-1/3",vL=oe({__name:"PresentationView",setup(n){const l=xt(),{summarySidebarState:a}=ie(l),{setVisibleState:c}=l,r=Ce(),{t:p}=We(r.t),m=Gs(),{selectedTemplate:g}=ie(m),h=tt(),_=Qs(),{getPresentationFile:x,prevPage:b,nextPage:S,fetchLocale:D,fetchSummary:y,generateSummary:I,regenerateSummary:C,deleteSummary:U,fetchPresentationTemplates:E}=_,{page:N,pdf:$,scaleNumb:R,scale:B,isFitParent:j,topics:ee,isGeneratingSummary:se,currentPresentationLocaleList:G,currentPresentationSummary:J,summaryContent:H,currentPresentation:M,presentationTemplateList:W,isFetchingSummary:X}=ie(_),O=v(""),K=v(!1),V=async le=>{try{await D(le)}catch(te){console.error(te),Ue({title:p("kaigikun.toast.fail.fetchSummary.title"),description:p("kaigikun.toast.fail.fetchSummary.description"),variant:"destructive"})}},F=v("en_US"),P=async le=>{if(!(M.value&&de.value))try{X.value=!0,await y(le,F.value)}catch(te){console.error(`Error fetch the presentation with id ${le}: `,te),Ue({title:p("kaigikun.toast.fail.fetchSummary.title"),description:p("kaigikun.toast.fail.fetchSummary.description"),variant:"destructive"})}finally{X.value=!1}};Te(()=>F.value,async()=>{var le;M.value&&await P((le=M.value)==null?void 0:le.id)});const q=async le=>{if(g.value=W.value.find(te=>te.id===le.summary_template_id),M.value)try{await I(M.value.id,{summary_template_id:le.summary_template_id,summary_lang:le.summary_lang}),await V(M.value.id)}catch(te){Ue({title:p("kaigikun.toast.fail.generateSummary.title"),description:p("kaigikun.toast.fail.generateSummary.description"),variant:"destructive"}),console.error("Failed to generate summary: ",te)}},A=async le=>{if(M.value&&ee.value)try{J.value=await C(M.value.id,{topics:ee.value,summary_lang:le})}catch(te){Ue({title:p("kaigikun.toast.fail.regenerateSummary.title"),description:p("kaigikun.toast.fail.regenerateSummary.description"),variant:"destructive"}),console.log("Failed to regenerate summary: ",te)}},k=async le=>{try{M.value&&(await U(M.value.id,le),await V(M.value.id)),J.value=void 0}catch(te){Ue({title:p("kaigikun.toast.fail.deleteSummary.title"),description:p("kaigikun.toast.fail.deleteSummary.description"),variant:"destructive"}),console.error("Failed to delete the summary: ",te)}};Dt(async()=>{const le=h.params.id;K.value=!0,O.value=await x(le),K.value=!1}),Vt(()=>{const le=te=>{te.key==="ArrowLeft"?b():te.key==="ArrowRight"&&S()};window.addEventListener("keydown",le),ls(()=>{window.removeEventListener("keydown",le),O.value&&URL.revokeObjectURL(O.value)})});const L=v(0),z=le=>{L.value>0||(B.value=1,L.value=le.width)},Q=ne(()=>L.value*B.value);Te(()=>j.value,le=>{le&&ae.value?(B.value=ae.value.clientWidth/L.value,R.value=Math.floor(B.value*100)):(B.value=1,R.value=100)}),Te(()=>h.fullPath,()=>{c(a,!1)},{immediate:!0}),Te(()=>h.params.id,async le=>{await Promise.all([P(le),V(le)]),W.value.length===0&&await E()},{immediate:!0});const ae=Bt("pdfContainer"),de=ne(()=>{var le;return(((le=M.value)==null?void 0:le.messageList.length)??0)<no});return(le,te)=>{const Z=f("Loader2"),re=f("ResizablePanel"),ue=f("ResizableHandle"),he=f("ResizablePanelGroup");return s(),u("div",uL,[t("div",pL,[o(dL),o(he,{direction:"horizontal",class:"flex"},{default:i(()=>[o(re,{"default-size":70,maxSize:70,minSize:60,class:"flex flex-col items-center justify-center h-[calc(100vh-4rem)] bg-stone-100 dark:bg-stone-900 p-2"},{default:i(()=>[e($)?(s(),u("div",{key:0,class:"w-full overflow-auto flex justify-center",ref_key:"pdfContainer",ref:ae},[o(e(qu),{pdf:e($).value,page:e(N),width:Q.value,onLoaded:z,class:"shadow-xl"},{default:i(()=>[t("div",mL,[o(Z,{class:"w-8 h-8 m-auto animate-spin"})])]),_:1},8,["pdf","page","width"])],512)):w("",!0)]),_:1}),o(ue,{"with-handle":""}),o(re,{"default-size":30,minSize:30,maxSize:e(a)?0:40},{default:i(()=>[o(K3)]),_:1},8,["maxSize"]),t("div",{class:pe(["flex transition-all items-stretch relative",e(a)?"w-full sm:w-1/3":"w-0"])},[o(Ps,{name:"fade-left"},{default:i(()=>{var $e;return[e(a)?(s(),T(mn,{key:0,summaryLocale:F.value,"onUpdate:summaryLocale":te[0]||(te[0]=Se=>F.value=Se),"current-recording-id":($e=e(M))==null?void 0:$e.id,isFetching:e(X),summarySidebarDisplayState:e(a),heightDisplay:gL,widthDisplay:fL,templateList:e(W),selectedTemplate:e(g),topicList:e(ee),isGeneratingSummary:e(se),cannotSummarize:de.value,"current-recording-locale-list":e(G),currentRecordingSummary:e(J),summaryContent:e(H),onGenerateSummary:q,onRegenerateSummary:A,onDeleteSummary:k},null,8,["summaryLocale","current-recording-id","isFetching","summarySidebarDisplayState","templateList","selectedTemplate","topicList","isGeneratingSummary","cannotSummarize","current-recording-locale-list","currentRecordingSummary","summaryContent"])):w("",!0)]}),_:1})],2)]),_:1})])])}}}),hL={key:0,class:"sticky flex flex-col gap-1 top-20 h-fit mr-3 p-1 border border-gray-300 dark:border-stone-500 rounded-lg ml-2"},_L={class:"flex gap-2 items-center"},bL={key:0},kL={class:"flex gap-2 items-center"},yL={key:0},xL={class:"flex gap-2 items-center"},wL={key:0},$L=oe({__name:"KaigiUploadAndTranscribeToolbox",setup(n){const l=Ce(),{t:a}=We(l.t),c=at(),r=Ks(),p=xt(),{setVisibleState:m,toggleVisibleState:g}=p,{renameSpeakerSidebarState:h,bookmarkSidebarState:_,summarySidebarState:x}=ie(p),{isMobileSize:b}=ie(c),{currentFileRecording:S}=ie(r),D=()=>{m(h,!1),m(_,!1),g(x)},y=()=>{m(x,!1),m(_,!1),g(h)},I=()=>{m(x,!1),m(h,!1),g(_)};return(C,U)=>{var E,N;return((E=e(S))==null?void 0:E.status)==="COMPLETED"&&!e(b)?(s(),u("div",hL,[((N=e(S))==null?void 0:N.status)==="COMPLETED"?(s(),T(Pe,{key:0,active:e(x),"active-class":"bg-stone-200 dark:bg-stone-700",size:"default",tooltip:e(a)("kaigiInstantRecord.button.summary.tooltip"),onClick:D,className:"text-sm flex justify-start"},{default:i(()=>[t("div",_L,[U[0]||(U[0]=t("i",{class:"bi bi-journals text-xl"},null,-1)),!e(h)&&!e(_)&&!e(x)&&!e(b)?(s(),u("p",bL,d(e(a)("kaigiInstantRecord.button.summary.tooltip")),1)):w("",!0)])]),_:1},8,["active","tooltip"])):w("",!0),o(Pe,{active:e(h),"active-class":"bg-stone-200 dark:bg-stone-700",size:"default",tooltip:e(a)("kaigiInstantRecord.tooltip.openRenameSpeakers"),onClick:y,className:"text-sm flex justify-start"},{default:i(()=>[t("div",kL,[U[1]||(U[1]=t("i",{class:"bi bi-people text-xl"},null,-1)),!e(h)&&!e(_)&&!e(x)&&!e(b)?(s(),u("p",yL,d(e(a)("kaigiInstantRecord.tooltip.openRenameSpeakers")),1)):w("",!0)])]),_:1},8,["active","tooltip"]),o(Pe,{active:e(_),"active-class":"bg-stone-200 dark:bg-stone-700",size:"default",tooltip:e(a)("kaigiInstantRecord.tooltip.openBookmarks"),onClick:I,className:"text-sm flex justify-start"},{default:i(()=>[t("div",xL,[U[2]||(U[2]=t("i",{class:"bi bi-bookmark-plus text-xl"},null,-1)),!e(h)&&!e(_)&&!e(x)&&!e(b)?(s(),u("p",wL,d(e(a)("kaigiInstantRecord.tooltip.openBookmarks")),1)):w("",!0)])]),_:1},8,["active","tooltip"])])):w("",!0)}}}),SL={key:0,class:"flex justify-between p-1 border-y border-gray-300 dark:border-stone-500"},TL={class:"flex gap-2 items-center"},AL={key:0},CL={class:"flex gap-2 items-center"},DL={key:0},LL={class:"flex gap-2 items-center"},IL={key:0},BL=oe({__name:"KaigiUploadAndTranscribeMobileToolbox",setup(n){const l=Ce(),{t:a}=We(l.t),c=at(),r=Ks(),p=xt(),{setVisibleState:m,toggleVisibleState:g}=p,{renameSpeakerSidebarState:h,bookmarkSidebarState:_,summarySidebarState:x}=ie(p),{isMobileSize:b}=ie(c),{currentFileRecording:S}=ie(r),D=()=>{m(h,!1),m(_,!1),g(x)},y=()=>{m(x,!1),m(_,!1),g(h)},I=()=>{m(x,!1),m(h,!1),g(_)};return(C,U)=>{var E,N;return((E=e(S))==null?void 0:E.status)==="COMPLETED"&&e(b)?(s(),u("div",SL,[((N=e(S))==null?void 0:N.status)==="COMPLETED"?(s(),T(Pe,{key:0,active:e(x),"active-class":"bg-stone-200 dark:bg-stone-700",size:"lg",tooltip:e(a)("kaigiInstantRecord.button.summary.tooltip"),onClick:D,className:"text-sm flex justify-start px-8"},{default:i(()=>[t("div",TL,[U[0]||(U[0]=t("i",{class:"bi bi-journals text-xl"},null,-1)),!e(h)&&!e(_)&&!e(x)&&!e(b)?(s(),u("p",AL,d(e(a)("kaigiInstantRecord.button.summary.tooltip")),1)):w("",!0)])]),_:1},8,["active","tooltip"])):w("",!0),o(Pe,{active:e(h),"active-class":"bg-stone-200 dark:bg-stone-700",size:"lg",tooltip:e(a)("kaigiInstantRecord.tooltip.openRenameSpeakers"),onClick:y,className:"text-sm flex justify-start px-8"},{default:i(()=>[t("div",CL,[U[1]||(U[1]=t("i",{class:"bi bi-people text-xl"},null,-1)),!e(h)&&!e(_)&&!e(x)&&!e(b)?(s(),u("p",DL,d(e(a)("kaigiInstantRecord.tooltip.openRenameSpeakers")),1)):w("",!0)])]),_:1},8,["active","tooltip"]),o(Pe,{active:e(_),"active-class":"bg-stone-200 dark:bg-stone-700",size:"lg",tooltip:e(a)("kaigiInstantRecord.tooltip.openBookmarks"),onClick:I,className:"text-sm flex justify-start px-8"},{default:i(()=>[t("div",LL,[U[2]||(U[2]=t("i",{class:"bi bi-bookmark-plus text-xl"},null,-1)),!e(h)&&!e(_)&&!e(x)&&!e(b)?(s(),u("p",IL,d(e(a)("kaigiInstantRecord.tooltip.openBookmarks")),1)):w("",!0)])]),_:1},8,["active","tooltip"])])):w("",!0)}}}),ML={class:"grow relative flex flex-col"},EL={class:"flex flex-col w-full"},RL={class:"w-full h-full mx-auto rounded-md inset-shadow-2xs flex flex-col"},FL={class:"flex flex-row justify-between items-center px-3 pt-4 sticky top-0 bg-white dark:bg-stone-900 z-1 pb-5"},PL={key:1,class:"flex items-center gap-2"},NL={class:"text-sm font-bold"},zL={key:2},UL={key:1,class:"flex items-center gap-3"},OL={key:0},jL={class:"space-x-1"},VL={class:"text-stone-500 text-sm"},GL={class:"font-semibold"},WL={key:0,class:"text-center pt-[25%]"},HL={class:"text-zinc-500 text-xl"},KL={key:1,class:"flex flex-col my-auto gap-3"},qL={key:2,class:"flex flex-col justify-center items-center text-center space-y-2 pt-[25%]"},QL={class:"text-zinc-500 text-md w-4/5"},JL={key:3,class:"flex flex-row space-x-2 group mb-3"},XL={key:0,class:"grow"},YL={key:0,class:"flex items-center justify-center mx-auto w-full sm:w-2/3 rounded-tl-3xl rounded-tr-3xl border bg-white dark:bg-stone-800 p-3 shadow-xs gap-3 sticky bottom-0 z-10 h-15"},ZL={class:"w-11/12 relative"},eI=["src"],tI={key:0,class:"absolute top-1/2 -translate-y-1/2 bg-white dark:bg-stone-800 left-2 py-4 pr-3"},sI="h-[calc(100dvh-16rem)]",aI="md:2/3 sm:w-2/3",oI=oe({__name:"UploadAndTranscribeView",setup(n){const l=Ce(),{t:a,tFallback:c}=We(l.t),{toast:r}=gt(),p=tt(),m=Ks(),{fetchFileRecordingById:g,getFileRecordingAudio:h,updateMessage:_,translateMessage:x,fetchFileRecordingSpeakerList:b,updateMessageSpeaker:S,renameSpeaker:D,fetchBookmarksList:y,bookmark:I,editBookmark:C,deleteBookmark:U,fetchUploadTranscribeTemplates:E,fetchLocale:N,fetchSummary:$,generateSummary:R,regenerateSummary:B,deleteSummary:j,clearState:ee}=m,{isFetchingFile:se,isFetchingSpeaker:G,isFetchingBookmark:J,isFetchingSummary:H,currentFileRecording:M,currentFileRecordingSpeakers:W,currentFileRecordingBookmarks:X,editingBookmarkId:O,newBookmarkId:K,recordUrl:V,selectedTemplate:F,topics:P,showTranslation:q,currentRecordingLocaleList:A,currentRecordingSummary:k,isGeneratingSummary:L,summaryContent:z,uploadAndTranscribeTemplateList:Q}=ie(m),ae=xt(),{renameSpeakerSidebarState:de,bookmarkSidebarState:le,summarySidebarState:te}=ie(ae),{setVisibleState:Z}=ae,re=at(),{isMobileSize:ue}=ie(re),he=v(!0),$e=v(!1),Se=async()=>{if(!(!M.value||V.value||$e.value))try{$e.value=!0,await h(M.value.id),ke==null||ke.play()}catch(Ee){console.error(Ee),r({title:a("kaigikun.toast.fail.fetchAudio.title"),description:a("kaigikun.toast.fail.fetchAudio.description"),variant:"destructive"}),ke==null||ke.stop()}finally{$e.value=!1}},be=v(null),Ge=Ee=>{be.value&&(be.value.currentTime=Ee)},fe=Bt("uploadAndTranscribeContentContainer"),Y=async Ee=>{try{se.value=!0,await g(Ee)}catch(je){console.error(je),r({title:a("kaigikun.toast.fail.fetchRecording.title"),description:a("kaigikun.toast.fail.fetchRecording.description"),variant:"destructive"})}finally{se.value=!1}},ce=async Ee=>{try{G.value=!0,await b(Ee)}catch(je){console.error(je),r({title:a("kaigikun.toast.fail.fetchSpeaker.title"),description:a("kaigikun.toast.fail.fetchSpeaker.description"),variant:"destructive"})}finally{G.value=!1}},ge=async Ee=>{try{await N(Ee)}catch(je){console.error(je),r({title:a("kaigikun.toast.fail.fetchSummary.title"),description:a("kaigikun.toast.fail.fetchSummary.description"),variant:"destructive"})}},ye=v("en_US"),_e=async Ee=>{if(!(M.value&&jt.value))try{H.value=!0,L.value=!1,await $(Ee,ye.value)}catch(je){console.error(je),r({title:a("kaigikun.toast.fail.fetchSummary.title"),description:a("kaigikun.toast.fail.fetchSummary.description"),variant:"destructive"})}finally{H.value=!1}};Te(()=>ye.value,async()=>{M.value&&await _e(M.value.id)});const Re=async Ee=>{try{J.value=!0,await y(Ee)}catch(je){console.error(je),r({title:a("kaigikun.toast.fail.fetchBookmark.title"),description:a("kaigikun.toast.fail.fetchBookmark.description"),variant:"destructive"})}finally{J.value=!1}};let ke=null;const qe=()=>{be.value&&(Nt(),ke=new gl(be.value,{controls:["play","progress","current-time","mute","volume","settings"],iconUrl:Ri}),St())};let lt=null;const St=()=>{if(!be.value)return;const Ee=be.value.closest(".plyr");lt=Ee==null?void 0:Ee.querySelector(".plyr__controls"),lt&&lt.addEventListener("click",Mt,{capture:!0})},Nt=()=>{lt&&lt.removeEventListener("click",Mt,{capture:!0}),ke==null||ke.destroy(),ke=null,V.value&&URL.revokeObjectURL(V.value)},Mt=async Ee=>{Ee.target.closest('[data-plyr="play"]')&&!V.value&&await Se()};Te(()=>p.params.id,async Ee=>{var je;ee(),Z(de,!1),Z(le,!1),Z(te,!1),Q.value.length===0&&E(),await Promise.all([_e(Ee),ge(Ee),Y(Ee),ce(Ee),Re(Ee)]),!ue.value&&((je=M.value)==null?void 0:je.status)==="COMPLETED"&&Z(te,!0),qe()},{immediate:!0}),Te(()=>{var Ee;return(Ee=M.value)==null?void 0:Ee.status},async Ee=>{Ee==="COMPLETED"&&(await Et(),qe(),await h(p.params.id))});const vt=ne(()=>W.value.reduce((Ee,je)=>(Ee[je.speakerId]=je.displayName,Ee),{})),zt=v({}),bt=v({}),Ve=async Ee=>{bt.value[Ee.id]=!0;try{await x(Ee)}catch{r({title:a("general.toast.fail.generalErrorTitle"),description:a("general.toast.fail.generalError"),variant:"destructive"})}finally{bt.value[Ee.id]=!1}},Ze=async Ee=>{var Ie;zt.value[Ee.msgId]=!0;const je=(Ie=M.value)==null?void 0:Ie.messageList.find(ct=>ct.id===Ee.msgId);try{je&&await _(je,Ee.transcriptionEdit,Ee.translationEdit)}catch(ct){console.error(ct),r({title:a("general.toast.fail.generalErrorTitle"),description:a("general.toast.fail.generalError"),variant:"destructive"})}finally{zt.value[Ee.msgId]=!1}},ze=async(Ee,je)=>{await S(M.value.id,Ee,{new_speaker:je.speakerId})},Be=async Ee=>{le.value||Z(le,!0),(de.value||te.value)&&(Z(te,!1),Z(de,!1));try{await I(M.value.id,Ee.id,{content:"",timestamp:Ee.timestampNumb}),O.value=K.value}catch(je){console.error(je),r({title:a("general.toast.fail.generalErrorTitle"),description:a("general.toast.fail.generalError"),variant:"destructive"})}},et=async()=>{var Ee,je,Ie;le.value||Z(le,!0),(de.value||te.value)&&(Z(te,!1),Z(de,!1));try{if(!((Ee=M.value)!=null&&Ee.messageList))return;const ct=(je=M.value)==null?void 0:je.messageList.findIndex(Wt=>Wt.timestampNumb>be.value.currentTime);ct===0||ct===-1?await I(M.value.id,M.value.messageList[((Ie=M.value)==null?void 0:Ie.messageList.length)-1].id,{content:"",timestamp:be.value.currentTime}):await I(M.value.id,M.value.messageList[ct-1].id,{content:"",timestamp:be.value.currentTime}),O.value=K.value}catch(ct){console.error(ct),r({title:a("general.toast.fail.generalErrorTitle"),description:a("general.toast.fail.generalError"),variant:"destructive"})}},ft=async Ee=>{if(F.value=Q.value.find(je=>je.id===Ee.summary_template_id),M.value)try{await R(M.value.id,{summary_template_id:Ee.summary_template_id,summary_lang:Ee.summary_lang}),await ge(M.value.id)}catch(je){r({title:a("kaigikun.toast.fail.generateSummary.title"),description:a("kaigikun.toast.fail.generateSummary.description"),variant:"destructive"}),console.error("Failed to generate summary: ",je)}},ht=async Ee=>{if(M.value&&P.value)try{k.value=await B(M.value.id,{topics:P.value,summary_lang:Ee})}catch(je){r({title:a("kaigikun.toast.fail.regenerateSummary.title"),description:a("kaigikun.toast.fail.regenerateSummary.description"),variant:"destructive"}),console.log("Failed to regenerate summary: ",je)}},pt=async Ee=>{try{M.value&&(await j(M.value.id,Ee),await ge(M.value.id)),k.value=void 0}catch(je){r({title:a("kaigikun.toast.fail.deleteSummary.title"),description:a("kaigikun.toast.fail.deleteSummary.description"),variant:"destructive"}),console.error("Failed to delete the summary: ",je)}},jt=ne(()=>{var Ee;return(((Ee=M.value)==null?void 0:Ee.messageList.length)??0)<no}),st=ne(()=>{var Ee;return(Ee=M.value)==null?void 0:Ee.messageList.flatMap(je=>{var Ie;return[`${je.timestamp} - ${((Ie=vt.value)==null?void 0:Ie[je.speakerId])??je.speakerId}: `,je.transcription,je.translation]}).join(`\r
\r
`)}),Fe=ne(()=>{var Ee;return(Ee=M.value)==null?void 0:Ee.messageList.flatMap(je=>{var Ie;return[`${je.timestamp} - ${((Ie=vt.value)==null?void 0:Ie[je.speakerId])??je.speakerId}: `,je.translation]}).join(`\r
\r
`)}),xe=ne(()=>{var Ee;return(Ee=M.value)==null?void 0:Ee.messageList.flatMap(je=>{var Ie;return[`${je.timestamp} - ${((Ie=vt.value)==null?void 0:Ie[je.speakerId])??je.speakerId}: `,je.transcription]}).join(`\r
\r
`)}),rt=async(Ee,je,Ie,ct)=>{try{await C(Ee,je,Ie,ct)}catch(Wt){console.error(Wt),r({title:a("kaigiHome.subSidebar.toast.fail.renameRecordingFail"),variant:"destructive"})}},nt=async(Ee,je,Ie)=>{try{await U(Ee,je,Ie)}catch(ct){console.error(ct),r({title:a("kaigiHome.subSidebar.toast.fail.renameRecordingFail"),variant:"destructive"})}},Je=ne(()=>de.value||le.value||te.value);return(Ee,je)=>{var Yt,rs,cs,vs,ds,Es,xs,Xs,dt,Qt;const Ie=f("Skeleton"),ct=f("Switch"),Wt=f("Button"),Zt=f("DropdownMenuTrigger"),Xt=f("DropdownMenuItem"),_t=f("DropdownMenuContent"),Xe=f("DropdownMenu"),qt=f("Loader2");return s(),u("div",ML,[o(Fi),t("div",{class:pe([e(ue)?"relative":"flex","h-dvh"])},[t("div",EL,[t("div",RL,[t("div",FL,[e(se)?(s(),T(Ie,{key:0,class:"h-4 w-24"})):(s(),u("div",PL,[t("div",NL,d(e(a)("kaigiInstantRecord.transcriptionLabel")),1),e(q)?(s(),T(ct,{key:0,checked:he.value,"onUpdate:checked":je[0]||(je[0]=Ut=>he.value=Ut),size:"sm"},null,8,["checked"])):w("",!0)])),e(q)?(s(),u("div",zL,[e(se)?(s(),T(Ie,{key:0,class:"h-4 w-20"})):(s(),u("div",UL,[(Yt=e(M))!=null&&Yt.messageList.length&&((rs=e(M))==null?void 0:rs.status)==="COMPLETED"?(s(),T(Xe,{key:0},{default:i(()=>[o(Zt,null,{default:i(()=>[o(Wt,{variant:e(ue)?"ghost":"outline",size:"full",class:"p-5 flex items-center gap-1"},{default:i(()=>[je[4]||(je[4]=t("i",{class:"bi bi-copy"},null,-1)),e(ue)?w("",!0):(s(),u("span",OL,d(e(a)("copyRichTextButton.tooltip.copy")),1))]),_:1,__:[4]},8,["variant"])]),_:1}),o(_t,{align:e(ue)?"center":"end"},{default:i(()=>[o(Xt,{class:"p-0"},{default:i(()=>[o(ss,{content:st.value??"",showTooltip:!1,showButtonLabel:!0,variant:"ghost",copyLabel:e(a)("copyRichTextButton.copyAllContentWithTranslation.label"),size:"default"},null,8,["content","copyLabel"])]),_:1}),o(Xt,{class:"p-0"},{default:i(()=>[o(ss,{content:Fe.value??"",showTooltip:!1,showButtonLabel:!0,variant:"ghost",copyLabel:e(a)("copyRichTextButton.copyAllContentOnlyTranslation.label"),size:"default"},null,8,["content","copyLabel"])]),_:1}),o(Xt,{class:"p-0"},{default:i(()=>[o(ss,{content:xe.value??"",showTooltip:!1,showButtonLabel:!0,variant:"ghost",copyLabel:e(a)("copyRichTextButton.copyAllContentOnlyTranscription.label"),size:"default"},null,8,["content","copyLabel"])]),_:1})]),_:1},8,["align"])]),_:1})):w("",!0),t("div",jL,[t("span",VL,d(e(a)("kaigiInstantRecord.translateToLabel")),1),t("span",GL,d(e(c)(`supportedLang.${(cs=e(M))==null?void 0:cs.translateLang}`,e(a)("supportedLang.unknown"))),1)])]))])):w("",!0)]),t("div",{class:pe(["h-[calc(100dvh-11rem)] bg-white dark:bg-stone-900",[e(ue)?"flex-col items-stretch":"flex-row overflow-y-auto","flex"]]),ref_key:"uploadAndTranscribeContentContainer",ref:fe},[o(BL),t("div",{class:pe([e(ue)?"h-[calc(100dvh-12rem)] overflow-y-auto pt-5":"h-full","px-0 flex flex-col w-full"])},[(((vs=e(M))==null?void 0:vs.status)==="COMPLETED"||((ds=e(M))==null?void 0:ds.status)==="FAILED")&&!((xs=(Es=e(M))==null?void 0:Es.messageList)!=null&&xs.length)?(s(),u("div",WL,[t("p",HL,d(e(a)("kaigiInstantRecord.noContentLabel")),1)])):e(se)?(s(),u("div",KL,[(s(),u(ve,null,Le(4,Ut=>t("div",{key:Ut},[o(Ie,{class:"h-24 w-11/12 mx-auto"})])),64))])):((Xs=e(M))==null?void 0:Xs.status)==="INITIAL"||((dt=e(M))==null?void 0:dt.status)==="PROCESSING"?(s(),u("div",qL,[t("div",QL,[t("p",null,d(e(a)("kaigiUploadAndTranscribe.label.waiting")),1)]),je[5]||(je[5]=t("div",{class:"flex justify-center space-x-2"},[t("div",{class:"animate-ping h-[0.3rem] w-[0.3rem] bg-blue-600 rounded-full"}),t("div",{class:"animate-ping animation-delay-200 h-[0.3rem] w-[0.3rem] bg-blue-600 rounded-full"}),t("div",{class:"animate-ping animation-delay-400 h-[0.3rem] w-[0.3rem] bg-blue-600 rounded-full"})],-1))])):(s(),u("div",JL,[e(M)?(s(),u("div",XL,[o(pn,{mode:"uploadAndTranscribe",recordUrl:e(V),messageList:e(M).messageList,speakerList:e(W),speakerMapping:vt.value,activeEditMessageSaving:zt.value,translatingMessage:bt.value,showTranscription:he.value,showTranslation:e(q),onRetranslateMessage:Ve,onUpdateMessage:Ze,onBookmarkMessage:Be,onUpdateMessageSpeaker:ze,onSkipTo:Ge},null,8,["recordUrl","messageList","speakerList","speakerMapping","activeEditMessageSaving","translatingMessage","showTranscription","showTranslation"])])):w("",!0)]))],2),o($L)],2)]),((Qt=e(M))==null?void 0:Qt.status)==="COMPLETED"&&!e(se)?(s(),u("div",YL,[t("div",ZL,[t("audio",{ref_key:"audioRef",ref:be,src:e(V),controls:"",crossorigin:"anonymous"},null,8,eI),$e.value?(s(),u("div",tI,[o(qt,{class:"size-6 animate-spin"})])):w("",!0)]),o(Pe,{icon:"bi bi-bookmark-plus",variant:"outline",size:"icon",className:"bg-white dark:bg-background",tooltip:e(a)("kaigiInstantRecord.tooltip.openBookmarks"),onClick:je[1]||(je[1]=Ut=>et())},null,8,["tooltip"])])):w("",!0)]),t("div",{class:pe(["flex transition-all items-stretch",Je.value?"w-full sm:w-2/3":"w-0",e(ue)?"absolute top-0":"relative"])},[o(Ps,{name:"fade-left"},{default:i(()=>{var Ut,ws,$s;return[e(de)?(s(),T(Pi,{key:0,"is-fetching":e(G),speakers:e(W),onRename:e(D),"recording-id":(Ut=e(M))==null?void 0:Ut.id},null,8,["is-fetching","speakers","onRename","recording-id"])):w("",!0),e(le)?(s(),T(Ni,{key:1,isFetching:e(J),onSkipTo:Ge,recordUrl:e(V),audioRef:be.value,onBookmark:et,onEditBookmark:rt,onDeleteBookmark:nt,currentRecording:e(M),currentRecordingBookmarks:e(X),editingBookmarkId:e(O),newBookmarkId:e(K),"onUpdate:editingBookmarkId":je[2]||(je[2]=hs=>O.value=hs)},null,8,["isFetching","recordUrl","audioRef","currentRecording","currentRecordingBookmarks","editingBookmarkId","newBookmarkId"])):w("",!0),e(te)?(s(),T(mn,{key:2,summaryLocale:ye.value,"onUpdate:summaryLocale":je[3]||(je[3]=hs=>ye.value=hs),"current-recording-id":(ws=e(M))==null?void 0:ws.id,isFetching:e(H),summarySidebarDisplayState:(($s=e(M))==null?void 0:$s.status)==="COMPLETED",widthDisplay:aI,heightDisplay:sI,templateList:e(Q),selectedTemplate:e(F),topicList:e(P),isGeneratingSummary:e(L),cannotSummarize:jt.value,"current-recording-locale-list":e(A),currentRecordingSummary:e(k),summaryContent:e(z),onGenerateSummary:ft,onRegenerateSummary:ht,onDeleteSummary:pt},null,8,["summaryLocale","current-recording-id","isFetching","summarySidebarDisplayState","templateList","selectedTemplate","topicList","isGeneratingSummary","cannotSummarize","current-recording-locale-list","currentRecordingSummary","summaryContent"])):w("",!0)]}),_:1})],2)],2)])}}}),nI=[{path:"/kaigikun",name:"kaigikun",component:bA,children:[{path:"record",name:"kaigi-record",component:Eo},{path:"record/recording/:id?",name:"instant-recording",component:y3},{path:"present",name:"kaigi-presentation",component:Eo},{path:"upload-transcribe",name:"upload-transcribe",component:Eo},{path:"upload-transcribe/file/:id?",name:"upload-transcribe-file",component:oI}],meta:{allowDragAndDrop:!1,requiresAuth:!0,requiresFeature:"kaigi",title:"Kaigikun"}}],lI=[{path:"/kaigikun/present/presentation/:id?",name:"presentation",component:vL,meta:{allowDragAndDrop:!1,requiresAuth:!0,requiresFeature:"kaigi",title:"Kaigikun"}}],ll={withSidebarRoutes:nI,noSidebarRoutes:lI},Fs=js.create({baseURL:"https://privategpt.fptconsulting.co.jp/api/qms",headers:{"Content-Type":"application/json"}});Fs.interceptors.request.use(async n=>{const l=Ot();await l.initializeClient();const a=await l.getUserAccessToken();return a&&(n.headers.Authorization=`Bearer ${a}`),n},n=>Promise.reject(n));const zi=n=>n.map(l=>({id:l.id,title:l.title,description:l.description,qmsCode:l.qms_code,version:l.version})),Ui=n=>n.map(l=>({id:l.id,docId:l.doc_id,subCompany:l.sub_company,page:l.page,content:l.content})),iI=n=>({items:n.items.map(l=>({id:l.id,name:l.name,code:l.code,handbook:l.handbook,qmsUUID:l.qms_uuid,version:l.version,effectedDate:l.effected_date})),total:n.total,offset:n.offset,limit:n.limit}),rI=n=>({totalDocs:n.total_docs}),cI=n=>({id:n.id,conversationId:n.conversation_id,parentMessageId:n.parent_message_id,role:n.role,content:{text:n.content.text,references:{items:zi(n.content.references.items),total:n.content.references.total},citations:n.content.citations?Ui(n.content.citations):null},followUpQuestions:n.follow_up_questions,isCompleted:!0,feedback:n.feedback}),dI=n=>({id:n.id,conversationName:n.conversation_name,messageList:n.message_list.map(l=>cI(l)),createdAt:new Date(n.created_at),updatedAt:new Date(n.updated_at),createdBy:n.created_by,updatedBy:n.updated_by}),uI=n=>({items:n.items.map(l=>({id:l.id,createdAt:new Date(l.created_at),updatedAt:new Date(l.updated_at),createdBy:l.created_by,updatedBy:l.updated_by,conversationName:l.conversation_name})),total:n.total,offset:n.offset,limit:n.limit}),Bs=Ft("qmsStore",()=>{const n=v([]),l=v(0),a=v(0),c=v(!1),r=v(!0),p=v(),m=v(null),g=v(""),h=v(!1),_=v(""),x=v(""),b=v(!1),S=v(""),D=v(!1),y=v(!1),I="https://privategpt.fptconsulting.co.jp/api/qms",C=v(null),U=v(!1),E=v(!1),N=v([]),$=v([]),R=v(),B=v(0),j=v(0),ee=async(A,k)=>{const L=await Fs.get("/conversations",{params:{offset:A,limit:k}}),z=uI(L.data);return n.value.push(...z.items),l.value=L.data.offset,a.value=L.data.total,c.value=!0,z.items},se=async A=>{const k=await Fs.get(`/conversations/${A}`);p.value=dI(k.data),m.value=p.value.messageList[p.value.messageList.length-1].id},G=async A=>{A||(A="New Conversation");const k={id:void 0,conversationName:A,createdAt:new Date,updatedAt:new Date,messageList:[]};n.value.unshift(k),p.value=k},J=(A,k,L)=>{p.value&&p.value.messageList?p.value.messageList.push({id:L,role:k,content:{text:A,citations:null},isCompleted:!0,feedback:null}):console.error("Current conversation not existed")},H=async()=>{if(p.value){p.value.updatedAt=new Date;const A=n.value.findIndex(L=>{var z;return L.id===((z=p.value)==null?void 0:z.id)});if(A<=0)return;const k=n.value.splice(A,1)[0];k.updatedAt=new Date,n.value.unshift(k)}},M=async()=>{C.value&&C.value.abort(),E.value=!1,U.value=!1},W=(A,k,L,z)=>{switch(A){case"data":{const Q=JSON.parse(k);z+=Q.v,p.value.messageList[L-1].content.text=z;break}case"mes_info":{const Q=JSON.parse(k);p.value.messageList[L-1].id=Q.id,m.value=Q.id;break}case"conv":{const Q=JSON.parse(k);p.value.id=Q.conversation_id,p.value.conversationName=Q.generated_name;break}case"citation":{const Q=JSON.parse(k);p.value.messageList[L-1].content.citations=Ui(Q.citations);break}case"ref":{const Q=JSON.parse(k);p.value.messageList[L-1].content.references.items=zi(Q.references),p.value.messageList[L-1].content.references.total=Q.total??0;break}case"followup_questions":{const Q=JSON.parse(k);p.value.messageList[L-1].followUpQuestions=Q.followup_questions;break}case"DONE":break;default:console.warn("[Unhandled event]",JSON.stringify(A),JSON.stringify(k));break}return z};return{qmsConversations:n,fileListTable:$,currentOffset:l,totalConversations:a,totalFiles:R,totalKnowledge:B,hasMore:r,searchQuery:g,conversationsFetched:c,currentConversation:p,currentParentMessageId:m,generatingResponse:U,loadingAnimation:E,getFileList:async A=>{const{data:k}=await Fs.get("/conversations/knowledge-base",{params:A});$.value=iI(k).items,R.value=k.total,j.value=k.offset},fetchQmsTotalDocuments:async()=>{const A=await Fs.get("/conversations/knowledge-base/total-documents");B.value=rI(A.data).totalDocs},getQmsConversationList:ee,getQmsConversation:se,addMessage:J,unshiftConversation:G,isSearchMessageSent:h,isScrollTop:b,messageContent:_,messageResponse:x,isLoading:D,currentTitle:S,qmsListMessageData:N,sendQMSMessage:async(A,k,L,z,Q)=>{var de,le;await M(),U.value=!0,E.value=!0;const ae=(de=p.value)!=null&&de.messageList?p.value.messageList.length+1:1;try{(le=p.value)==null||le.messageList.push({id:"",content:{text:"",references:{items:[],total:0},citations:null},role:"AI",error:!1,isCompleted:!1,feedback:null}),y.value=!0;const te={parent_message_id:L,conversation_id:z,question:A,metadata:Q,model_id:k};await H();const Z=await ro();C.value=new AbortController;const re=await fetch(`${I}/conversations`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"text/event-stream",Authorization:`Bearer ${Z}`},body:JSON.stringify(te),signal:C.value.signal});if(!re.ok||!re.body)throw new Error(`HTTP error: ${re.status}`);y.value=!1;const ue=re.body.getReader(),he=new TextDecoder("utf-8");let $e="",Se="",be=!1;for(;!be;){const{done:Ge,value:fe}=await ue.read();if(be=Ge,E.value=!1,Ge)break;const Y=he.decode(fe,{stream:!0});$e+=Y;const ce=$e.split(`

`);$e=ce.pop();for(const ge of ce){if(!ge.trim())continue;const{event:ye,data:_e}=io(ge);Se=W(ye,_e,ae,Se)}}}catch(te){if(te instanceof Error&&te.name==="AbortError")return;p.value.messageList[ae-1].content.text=`${te}`,p.value.messageList[ae-1].error=!0}finally{E.value=!1,U.value=!1,p.value.messageList[ae-1].isCompleted=!0}},sendMessageFeedback:async(A,k,L)=>{var Q;const z=(Q=p.value)==null?void 0:Q.messageList.find(ae=>ae.id===k);z&&(await Fs.post(`/conversations/${A}/messages/${k}/feedback`,L),z.feedback=L.feedback)},removeMessageFeedback:async(A,k)=>{var z;const L=(z=p.value)==null?void 0:z.messageList.find(Q=>Q.id===k);L&&(await Fs.delete(`/conversations/${A}/messages/${k}/feedback`),L.feedback=null)},editConversationTitle:async(A,k)=>{const L=n.value.find(z=>z.id===A);L!=null&&L.id&&(await Fs.put(`/conversations/${A}`,{new_name:k}),L.conversationName=k)},deleteConversation:async A=>{await Fs.delete(`/conversations/${A}`),n.value=n.value.filter(k=>k.id!==A)}}}),pI={class:"flex w-full cursor-text flex-col rounded-3xl px-2.5 pb-2 contain-inline-size bg-white dark:bg-stone-800 border-[1px] shadow-sm focus-within:shadow-md transition-shadow duration-200 mb-3"},mI={class:"flex flex-col min-h-[44px] items-center px-2"},gI={class:"flex items-center justify-end"},Oi=oe({__name:"QMSMessageInputSection",props:{initialText:{}},emits:["handle-message"],setup(n,{expose:l,emit:a}){const c=Bs(),{currentConversation:r,currentParentMessageId:p,messageContent:m,isLoading:g,currentTitle:h,generatingResponse:_}=ie(c),{sendQMSMessage:x,addMessage:b}=c,S=ne(()=>As-m.value.length<=2),D=v(!1),y=Ce(),{t:I}=We(y.t),{toast:C}=gt(),U=a,E=n,N=v(null),$=ee=>{N.value&&(m.value=ee,N.value.setValue(ee))};l({setValue:$}),Te(()=>E.initialText,ee=>{ee!==void 0&&(m.value=ee)});const R=()=>{D.value=!1},B=ne(()=>m.value.trim()===""?!1:!_.value),j=async()=>{var ee;try{if(B.value&&!D.value){U("handle-message",m.value),g.value=!0,h.value=m.value;const se=m.value.trim();m.value="",b(se,"USER","user_temp"),await x(se,"azure-gpt-4o",p.value||null,(ee=r.value)==null?void 0:ee.id,{attachments:[]})}g.value=!1}catch(se){C({title:I("home.toast.fail.generalErrorTitle"),description:I("home.toast.fail.generalError"),variant:"destructive"}),console.error(se)}};return Te(()=>m.value,ee=>{$(ee)}),(ee,se)=>{const G=f("Textarea");return s(),u("div",pI,[t("div",mI,[Ke(o(G,{ref_key:"textareaRef",ref:N,rows:"1",maxLength:e(As),modelValue:e(m),"onUpdate:modelValue":se[0]||(se[0]=J=>kt(m)?m.value=J:null),onKeydown:yt(Ye(j,["exact","prevent"]),["enter"]),onCompositionstart:se[1]||(se[1]=J=>D.value=!0),onCompositionend:R,id:"message",placeholder:e(I)("home.chat.label.chatPlaceholder"),class:"flex flex-col items-center h-full w-full grow rounded-md border-input bg-transparent p-2 m-3 ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 border-0 resize-none max-h-52 text-sm"},null,8,["maxLength","modelValue","onKeydown","placeholder"]),[[e(Jt),!0]])]),t("div",gI,[t("span",{class:pe(["text-xs mb-2 self-end px-3 max-sm:hidden",[S.value?"text-red-400 font-semibold":"text-stone-400"]])},d(e(I)("home.chat.message.maxLengthCharacters",{inputLength:e(m).length,maxLength:e(As)})),3),t("div",null,[o(Pe,{icon:"bi bi-arrow-up",variant:"default",size:"icon",tooltip:e(I)("qms.homeChat.tooltip.chatboxPlaceholder.button.sendMessage"),onClick:j,disabled:!B.value},null,8,["tooltip","disabled"])])])])}}}),fI={class:"mx-auto flex flex-col w-full h-full justify-center gap-4 text-base md:gap-5 lg:gap-6 md:max-w-[32rem] lg:max-w-[40rem] xl:max-w-[48rem] px-5"},vI={class:"h-full flex flex-col justify-center"},hI={class:"text-2xl font-bold text-center mb-5"},_I={class:"text-xs text-center opacity-50"},bI=oe({__name:"QMSHomeChatView",setup(n){const l=Bs(),{currentConversation:a}=ie(l),{unshiftConversation:c}=l,r=Ce(),{t:p}=We(r.t),m=ot(),g=async()=>{await c(""),await Et(),m.push({path:"/qms/chat/"});const h=Te(()=>{var _;return(_=a.value)==null?void 0:_.id},_=>{_&&_!==""&&(m.replace({path:`/qms/chat/${_}`}),h())})};return(h,_)=>(s(),u("div",fI,[t("div",vI,[t("p",hI,d(e(p)("qms.homeChat.titleOnChat")),1),o(Oi,{onHandleMessage:g}),t("p",_I,d(e(p)("home.chat.label.description",{ai:"PrivateGPT"})),1)])]))}}),kI={key:0,class:"mt-10"},yI={class:"flex items-center justify-between border mb-3 cursor-pointer dark:bg-stone-800 hover:bg-stone-200 dark:hover:bg-stone-500 p-6 rounded-xl"},xI={class:"flex items-center gap-4"},wI={class:"flex flex-col"},$I={class:"text-wrap text-sm line-clamp-1 truncate"},SI={class:"opacity-50 line-clamp-2 whitespace-wrap overflow-hidden text-ellipsis text-sm"},TI=oe({__name:"QMSSource",props:{references:{},tracking:{}},setup(n){const l=n;return(a,c)=>{var m;const r=f("AvatarFallback"),p=f("Avatar");return(m=l.references)!=null&&m.length?(s(),u("div",kI,[(s(!0),u(ve,null,Le(l.references,(g,h)=>(s(),u("div",{key:g.id},[o(Hs,{href:`https://qms.fpt.com/document-detail/${g.qmsCode}/view`,tracking:l.tracking},{default:i(()=>[t("div",yI,[t("div",xI,[t("span",null,d(h+1),1),o(p,{size:"base"},{default:i(()=>[o(r,null,{default:i(()=>c[0]||(c[0]=[t("i",{class:"bi bi-file-earmark-text"},null,-1)])),_:1,__:[0]})]),_:1}),t("div",wI,[t("span",$I,d(g.title),1),t("span",SI,d(g.description),1)])])])]),_:2},1032,["href","tracking"])]))),128))])):w("",!0)}}}),AI={key:0,class:"my-5 flex gap-4 w-full items-center"},CI={class:"flex gap-4 w-full h-full border cursor-pointer bg-stone-100 dark:bg-stone-800 hover:bg-stone-200 dark:hover:bg-stone-500 p-5 rounded-xl"},DI={class:"line-clamp-2 whitespace-wrap overflow-hidden text-ellipsis opacity-50 text-sm"},LI=oe({__name:"QMSAnswerTopSourceList",props:{references:{},onRouteToSource:{type:Function},index:{},tracking:{}},setup(n){const l=n,a=c=>c.replace(/_/g,"_");return(c,r)=>{var p;return l.references&&l.references.length>0?(s(),u("div",AI,[(s(!0),u(ve,null,Le((p=l.references)==null?void 0:p.slice(0,3),m=>(s(),u("div",{key:m.id,class:"w-1/3 h-[6.5rem] flex flex-col justify-between"},[o(Hs,{href:`https://qms.fpt.com/document-detail/${m.qmsCode}/view`,tracking:c.tracking},{default:i(()=>{var g,h;return[t("div",CI,[r[0]||(r[0]=t("i",{class:"bi bi-file-earmark-text text-xl"},null,-1)),t("div",null,[t("span",{class:pe(["font-bold mt-1 text-sm whitespace-wrap overflow-hidden text-ellipsis",{"line-clamp-1":!!((g=m.description)!=null&&g.length),"line-clamp-3":!((h=m.description)!=null&&h.length)}])},d(a(m.title)),3),t("span",DI,d(m.description),1)])])]}),_:2},1032,["href","tracking"])]))),128))])):w("",!0)}}}),II=["onClick"],BI=oe({__name:"QMSFollowUpQuestion",props:{questions:{}},emits:["click"],setup(n,{emit:l}){const a=n,c=l,r=p=>{c("click",p)};return(p,m)=>{const g=f("Separator");return s(!0),u(ve,null,Le(a.questions,(h,_)=>(s(),u("div",{key:_,class:"flex flex-col justify-between cursor-pointer transition-colors duration-200 text-sm"},[t("div",{class:"flex justify-between p-3 hover:bg-gray-50 hover:text-gray-800 rounded-md",onClick:x=>r(h)},[t("span",null,d(h),1),m[0]||(m[0]=t("i",{class:"bi bi-plus-lg"},null,-1))],8,II),o(g)]))),128)}}}),MI={class:"h-full w-full"},EI={class:"w-full mt-5 flex items-center gap-3 justify-end"},RI={key:0,class:"border p-2 rounded-2xl mt-4"},FI={class:"flex justify-between text-stone-600 dark:text-stone-300"},PI={class:"flex items-center w-full"},NI={class:"text-sm text-stone-600 dark:text-stone-300 p-2 w-full"},zI={key:0,class:"grid sm:grid-cols-3 grid-cols-1 gap-2 mt-2"},UI=["onClick"],OI={key:1,class:"border cursor-text rounded-2xl px-2.5 pb-2 dark:bg-stone-800"},jI={class:"flex items-center justify-end"},VI={key:1,class:"border p-2 rounded-2xl mt-4"},GI={class:"flex justify-between text-stone-600 dark:text-stone-300"},WI={class:"flex items-center w-full"},HI={class:"text-sm text-stone-600 dark:text-stone-300 p-2 w-full"},KI={key:0,class:"grid sm:grid-cols-3 grid-cols-1 gap-2 mt-2"},qI=["onClick"],QI={key:1,class:"border cursor-text rounded-2xl px-2.5 pb-2 dark:bg-stone-800"},JI={class:"flex items-center justify-end"},XI={key:0,class:"w-full mt-8 mb-5"},YI={class:"flex items-center gap-2 mb-3"},ZI={class:"text-xl font-semibold"},e4={key:0,class:"lds-ellipsis"},t4=oe({__name:"QMSAnswer",props:{message:{},index:{},onRouteToSource:{type:Function}},setup(n){const{t:l}=Ce(),{toast:a}=gt(),c=n,r=Bs(),{messageContent:p,currentConversation:m}=ie(r),{sendMessageFeedback:g,removeMessageFeedback:h}=r,_=A=>{p.value=A},x=ne(()=>(c.message.content.text??"").replace(new RegExp("(?<![\\\\$\\\\])\\$(\\d[\\d,]*(\\.\\d+)?)\\b","g"),"\\$$$1").replace(/\\\[(.+?)\\\]/gs,(k,L)=>`$$${L.trim()}$$`).replace(/\\\((.+?)\\\)/g,(k,L)=>`$${L.trim()}$`)),b=v(c.message.feedback==="LIKE"),S=v(c.message.feedback==="DISLIKE"),D=v(!1),y=v(!1),I=v(!1),C=v(!1),U=v(!1),E=v(!1),N=v(""),$=v(""),R=v(!1),B=()=>{N.value="",$.value=""},j=()=>{I.value=!1,C.value=!1,U.value=!1,E.value=!1,B()},ee=()=>{U.value=!1,B()},se=()=>{E.value=!1,B()},G=async A=>{var k;if((k=m.value)!=null&&k.id)try{D.value=!0,y.value=!0,await g(m.value.id,c.message.id,A)}catch(L){console.error("Failed to send feedback: ",L),a({title:l("home.toast.fail.generalErrorTitle"),description:l("home.toast.fail.generalError"),variant:"destructive"})}finally{D.value=!1,y.value=!1}},J=async()=>{var A;if((A=m.value)!=null&&A.id)try{D.value=!0,y.value=!0,await h(m.value.id,c.message.id)}catch(k){console.error("Failed to send feedback: ",k)}finally{D.value=!1,y.value=!1}},H=async()=>{C.value=!1,U.value=!1,b.value?(b.value=!1,I.value=!1,await J()):(b.value=!0,S.value=!1,I.value=!0,await G({feedback:"LIKE",reason:""}))},M=async A=>{if(A.value==="Other"){U.value=!0;return}await G({feedback:"LIKE",reason:A.value}),I.value=!1},W=async()=>{R.value||!N.value.trim()||N.value.length>Ws||(await G({feedback:"LIKE",reason:N.value.trim()}),B(),I.value=!1,U.value=!1)},X=async()=>{I.value=!1,E.value=!1,S.value?(S.value=!1,C.value=!1,await J()):(S.value=!0,b.value=!1,C.value=!0,await G({feedback:"DISLIKE",reason:""}))},O=async A=>{if(A.value==="Other"){E.value=!0;return}await G({feedback:"DISLIKE",reason:A.value}),C.value=!1},K=async()=>{R.value||!$.value.trim()||$.value.length>Ws||(await G({feedback:"DISLIKE",reason:$.value.trim()}),B(),C.value=!1,E.value=!1)},V=[{label:"qms.homeChat.message.goodFeedback.upToDate",value:"Up to date"},{label:"qms.homeChat.message.goodFeedback.accurate",value:"Accurate"},{label:"qms.homeChat.message.goodFeedback.helpful",value:"Helpful"},{label:"qms.homeChat.message.goodFeedback.followedInstructions",value:"Followed Instructions"},{label:"qms.homeChat.message.goodFeedback.goodSources",value:"Good sources"},{label:"qms.homeChat.message.goodFeedback.other",value:"Other"}],F=[{label:"qms.homeChat.message.badFeedback.outOfDate",value:"Out of date"},{label:"qms.homeChat.message.badFeedback.inaccurate",value:"Inaccurate"},{label:"qms.homeChat.message.badFeedback.wrongSources",value:"Wrong sources"},{label:"qms.homeChat.message.badFeedback.tooLong",value:"Too long"},{label:"qms.homeChat.message.badFeedback.tooShort",value:"Too short"},{label:"qms.homeChat.message.badFeedback.other",value:"Other"}],P=ne(()=>({appName:"QMS",viewName:"CHAT",additionalInfo:{messageId:c.message.id,conversationId:c.message.conversationId}})),q=ne(()=>{var L;const A=c.message.content.citations??[],k=((L=c.message.content.references)==null?void 0:L.items)??[];return A.flatMap(z=>{const Q=k.find(de=>de.id===z.docId),ae=k.findIndex(de=>de.id===(Q==null?void 0:Q.id));return Q?[{id:z.id,citationNumber:ae+1,link:`https://qms.fpt.com/document-detail/${Q.qmsCode}/view`,title:Q.title,content:z.content,page:z.page}]:[]})});return(A,k)=>{var ae,de,le;const L=f("Textarea"),z=f("Separator"),Q=Kt("auto-animate");return s(),u(ve,null,[t("div",MI,[t("div",null,[o(LI,{index:A.index,references:(ae=c.message.content.references)==null?void 0:ae.items,"on-route-to-source":A.onRouteToSource,tracking:{...P.value,viewName:"CHAT_TOP_SOURCE"}},null,8,["index","references","on-route-to-source","tracking"]),o(va,{"streaming-markdown":x.value,"is-completed":A.message.isCompleted,citations:q.value,isNumberCitation:!0,tracking:P.value},null,8,["streaming-markdown","is-completed","citations","tracking"]),Ke((s(),u("div",{class:pe(["flex flex-col",[A.message.isCompleted&&!A.message.error?"visible animate-fade animate-once animate-duration-500 animate-delay-100":"invisible"]])},[t("div",EI,[o(Pe,{onClick:H,icon:b.value?"bi bi-hand-thumbs-up-fill":"bi bi-hand-thumbs-up",disabled:D.value,variant:"ghost",size:"mdicon",className:"text-stone-600 dark:text-stone-300"},null,8,["icon","disabled"]),o(Pe,{onClick:X,icon:S.value?"bi bi-hand-thumbs-down-fill":"bi bi-hand-thumbs-down",disabled:y.value,variant:"ghost",size:"mdicon",className:"text-stone-600 dark:text-stone-300"},null,8,["icon","disabled"])]),I.value?(s(),u("div",RI,[t("div",FI,[Ke((s(),u("div",PI,[U.value?(s(),T(Pe,{key:0,onClick:ee,icon:"bi bi-arrow-left-short",variant:"ghost",size:"mdicon"})):w("",!0),t("p",NI,d(e(l)("qms.homeChat.message.goodFeedback.other.textarea.label")),1)])),[[Q]]),o(Pe,{onClick:j,icon:"bi bi-x",variant:"ghost",size:"mdicon"})]),U.value?w("",!0):(s(),u("div",zI,[(s(),u(ve,null,Le(V,te=>t("div",{onClick:Z=>M(te),key:te.value,class:"p-2 border rounded-lg text-center cursor-pointer hover:bg-stone-100 dark:hover:bg-stone-800 text-sm text-stone-600 dark:text-stone-300"},d(e(l)(te.label)),9,UI)),64))])),U.value?(s(),u("div",OI,[Ke(o(L,{modelValue:N.value,"onUpdate:modelValue":k[0]||(k[0]=te=>N.value=te),class:"p-2 m-3 text-sm resize-none border-0 max-h-12",id:"good-feedback-textarea",onKeydown:yt(Ye(W,["exact","prevent"]),["enter"]),onCompositionstart:k[1]||(k[1]=te=>R.value=!0),onCompositionend:k[2]||(k[2]=te=>R.value=!1)},null,8,["modelValue","onKeydown"]),[[e(Jt),!0]]),t("div",jI,[t("span",{class:pe(["text-xs mb-2 self-end px-3 max-sm:hidden",[N.value.length>=e(Ws)?"text-red-400 font-semibold":"text-stone-400"]])},d(e(l)("home.chat.message.maxLengthCharacters",{inputLength:N.value.length,maxLength:e(Ws)})),3),o(Pe,{icon:"bi bi-arrow-up",variant:"default",size:"icon",tooltip:e(l)("qms.homeChat.tooltip.chatboxPlaceholder.button.sendMessage"),onClick:W,disabled:!N.value.trim()||N.value.length>e(Ws)},null,8,["tooltip","disabled"])])])):w("",!0)])):w("",!0),C.value?(s(),u("div",VI,[t("div",GI,[Ke((s(),u("div",WI,[E.value?(s(),T(Pe,{key:0,onClick:se,icon:"bi bi-arrow-left-short",variant:"ghost",size:"mdicon"})):w("",!0),t("p",HI,d(e(l)("qms.homeChat.message.badFeedback.other.textarea.label")),1)])),[[Q]]),o(Pe,{onClick:j,icon:"bi bi-x",variant:"ghost",size:"mdicon"})]),E.value?w("",!0):(s(),u("div",KI,[(s(),u(ve,null,Le(F,te=>t("div",{onClick:Z=>O(te),key:te.value,class:"p-2 border rounded-lg text-center cursor-pointer hover:bg-stone-100 dark:hover:bg-stone-800 text-sm text-stone-600 dark:text-stone-300"},d(e(l)(te.label)),9,qI)),64))])),E.value?(s(),u("div",QI,[Ke(o(L,{modelValue:$.value,"onUpdate:modelValue":k[3]||(k[3]=te=>$.value=te),class:"p-2 m-3 text-sm resize-none border-0 max-h-12",id:"bad-feedback-textarea",onKeydown:yt(Ye(K,["exact","prevent"]),["enter"]),onCompositionstart:k[4]||(k[4]=te=>R.value=!0),onCompositionend:k[5]||(k[5]=te=>R.value=!1)},null,8,["modelValue","onKeydown"]),[[e(Jt),!0]]),t("div",JI,[t("span",{class:pe(["text-xs mb-2 self-end px-3 max-sm:hidden",[$.value.length>=e(Ws)?"text-red-400 font-semibold":"text-stone-400"]])},d(e(l)("home.chat.message.maxLengthCharacters",{inputLength:$.value.length,maxLength:e(Ws)})),3),o(Pe,{icon:"bi bi-arrow-up",variant:"default",size:"icon",tooltip:e(l)("qms.homeChat.tooltip.chatboxPlaceholder.button.sendMessage"),onClick:K,disabled:!$.value.trim()||$.value.length>e(Ws)},null,8,["tooltip","disabled"])])])):w("",!0)])):w("",!0)],2)),[[Q,{duration:100}]]),c.message.followUpQuestions&&c.message.followUpQuestions.length>0?(s(),u("div",XI,[t("div",YI,[k[6]||(k[6]=t("i",{class:"bi bi-list-task text-xl"},null,-1)),t("span",ZI,d(e(l)("qms.searchChat.answerTab.related.title")),1)]),o(z),o(BI,{onClick:_,questions:A.message.followUpQuestions},null,8,["questions"])])):w("",!0)])]),!A.message.isCompleted&&((de=e(m))!=null&&de.messageList)&&c.index===((le=e(m))==null?void 0:le.messageList.length)/2-1?(s(),u("div",e4,k[7]||(k[7]=[t("div",null,null,-1),t("div",null,null,-1),t("div",null,null,-1),t("div",null,null,-1)]))):w("",!0)],64)}}}),s4=Vs(t4,[["__scopeId","data-v-f3fc3383"]]),a4={},o4={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512.002 512.002"};function n4(n,l){return s(),u("svg",o4,l[0]||(l[0]=[t("path",{d:"M511.267 197.258a14.995 14.995 0 00-12.107-10.209l-158.723-23.065-70.985-143.827a14.998 14.998 0 00-26.901 0l-70.988 143.827-158.72 23.065a14.998 14.998 0 00-8.312 25.585l114.848 111.954-27.108 158.083a14.999 14.999 0 0021.763 15.812l141.967-74.638 141.961 74.637a15 15 0 0021.766-15.813l-27.117-158.081 114.861-111.955a14.994 14.994 0 003.795-15.375z"},null,-1)]))}const il=Vs(a4,[["render",n4]]),l4={class:"vue3-star-ratings__outer"},i4={class:"vue3-star-ratings__inner"},r4=oe({__name:"StarRatings",props:{modelValue:{default:0},numberOfStars:{default:5},starColor:{default:"#ff9800"},inactiveColor:{default:"#707070"},starSize:{default:24},disableClick:{type:Boolean},customSvg:{default:il}},emits:["update:modelValue"],setup(n,{emit:l}){const a=n,c=l,r=ne(()=>a.customSvg||il),p={rounded(y,I){const C=Math.pow(10,I);return Math.round(y*C)/C}},m=v(),g=ne({get(){return a.modelValue},set(y){const I=p.rounded(y,1);c("update:modelValue",I)}});function h(y){if(a.disableClick)return;const I=this.getBoundingClientRect(),{pageX:C}=y,U=C-I.left,E=I.width,N=a.numberOfStars,$=U/E*N;g.value=$}const _=ne(()=>(g.value<0?0:g.value>a.numberOfStars?a.numberOfStars:g.value)/a.numberOfStars*100),x=v(null),b=ne(()=>x.value!==null?x.value:a.modelValue),S=y=>{a.disableClick||(x.value=y)},D=()=>{x.value=null};return Ir(()=>{var I;const y={"--vue3StarRatingsInnerColor":a.inactiveColor,"--vue3StarRatingsOuterColor":a.starColor,"--vue3StarRatingOuterWidth":`${_.value}%`,"--vue3StarRatingIconSize":`${a.starSize}px`};for(const[C,U]of Object.entries(y))(I=m.value)==null||I.style.setProperty(C,U)}),Vt(()=>{var y;(y=m.value)==null||y.addEventListener("click",h)}),ia(()=>{var y;(y=m.value)==null||y.removeEventListener("click",h)}),(y,I)=>(s(),u("div",{class:pe(["vue3-star-ratings",[y.disableClick?"pointer-events-none":"pointer-events-auto"]]),ref_key:"starsContainer",ref:m},[t("div",l4,[(s(!0),u(ve,null,Le(y.numberOfStars,C=>(s(),T(pa(r.value),{key:C,class:"vue3-star-ratings__icon"}))),128))]),t("div",i4,[(s(!0),u(ve,null,Le(y.numberOfStars,C=>(s(),T(pa(r.value),{key:C,class:"vue3-star-ratings__icon",style:_l({color:b.value>=C?a.starColor:a.inactiveColor}),onMouseenter:U=>S(C),onMouseleave:D},null,40,["style","onMouseenter"]))),128))])],2))}}),c4=Vs(r4,[["__scopeId","data-v-8e420f7a"]]),d4={class:"mx-auto text-xl font-semibold"},u4={class:"mt-4 text-center text-6xl"},p4={key:0},m4={key:1},g4={key:2},f4={key:3},v4={key:4},h4={class:"mx-auto mt-4"},_4={class:"mt-4 text-center"},b4={key:0},k4={key:1},y4={key:2},x4={key:3},w4={key:4},$4=15e3,S4=oe({__name:"QMSRatingDialog",setup(n){const l=Bs(),a=ps(),{sendRating:c}=a,{isRatingSent:r}=ie(a),{currentConversation:p}=ie(l),{t:m}=Ce(),g=v(0),h=v(!1),_=v(null),x=v(!1),b=v(!1);let S=null;const D=async()=>{S=setTimeout(()=>{y()},$4)},y=()=>{x.value=!1,b.value=!1,g.value=0,h.value=!0},I=async()=>{x.value=!0;try{await c({rating:0,comment:""}),r.value=!0,S&&clearTimeout(S)}catch(U){console.error(U),Ue({title:m("home.toast.fail.generalErrorTitle"),description:m("home.toast.fail.generalError"),variant:"destructive"})}finally{h.value=!1}},C=async()=>{b.value=!0;try{const U={rating:g.value,comment:_.value??""};await c(U),r.value=!0,S&&clearTimeout(S)}catch(U){console.error(U),Ue({title:m("home.toast.fail.generalErrorTitle"),description:m("home.toast.fail.generalError"),variant:"destructive"})}finally{h.value=!1}};return Te(g,U=>{const E=Math.ceil(U);U!==E&&(g.value=E)}),Te(()=>{var U,E;return(E=(U=p.value)==null?void 0:U.messageList)==null?void 0:E.length},async U=>{var E,N,$;r.value||(await new Promise(R=>setTimeout(R,1e4)),U>=4&&!r.value&&!(($=p.value)!=null&&$.messageList[((N=(E=p.value)==null?void 0:E.messageList)==null?void 0:N.length)-1].error)&&y())}),Vt(()=>{r.value||D()}),ls(()=>{S&&clearTimeout(S)}),(U,E)=>{const N=f("Textarea"),$=f("Loader2"),R=f("Button"),B=f("AlertDialogFooter"),j=f("AlertDialogContent"),ee=f("AlertDialog"),se=Kt("auto-animate");return s(),T(ee,{open:h.value,"onUpdate:open":E[2]||(E[2]=G=>h.value=G)},{default:i(()=>[o(j,null,{default:i(()=>[t("p",d4,d(e(m)("general.rating.dialog.header.title",{appName:"QMS"})),1),Ke((s(),u("div",u4,[g.value===5?(s(),u("p",p4,"")):w("",!0),g.value===4?(s(),u("p",m4,"")):w("",!0),g.value===3?(s(),u("p",g4,"")):w("",!0),g.value===2?(s(),u("p",f4,"")):w("",!0),g.value===1?(s(),u("p",v4,"")):w("",!0)])),[[se]]),t("div",h4,[o(c4,{"star-size":50,modelValue:g.value,"onUpdate:modelValue":E[0]||(E[0]=G=>g.value=G)},null,8,["modelValue"])]),Ke((s(),u("div",_4,[g.value===5?(s(),u("p",b4,d(e(m)("general.rating.dialog.text.fiveStars")),1)):w("",!0),g.value===4?(s(),u("p",k4,d(e(m)("general.rating.dialog.text.fourStars")),1)):w("",!0),g.value===3?(s(),u("p",y4,d(e(m)("general.rating.dialog.text.threeStars")),1)):w("",!0),g.value===2?(s(),u("p",x4,d(e(m)("general.rating.dialog.text.twoStars")),1)):w("",!0),g.value===1?(s(),u("p",w4,d(e(m)("general.rating.dialog.text.oneStar")),1)):w("",!0)])),[[se]]),o(N,{modelValue:_.value,"onUpdate:modelValue":E[1]||(E[1]=G=>_.value=G),placeholder:e(m)("general.rating.dialog.textArea.placeholder"),class:"px-2 mt-5 min-h-28 overflow-auto resize-none text-sm focus-visible:ring-offset-0 dark:bg-background",id:"feedback-qms"},null,8,["modelValue","placeholder"]),o(B,null,{default:i(()=>[o(R,{onClick:I,class:"bg-white text-black hover:bg-stone-100 dark:bg-black dark:text-white dark:hover:bg-stone-800 border"},{default:i(()=>[x.value?(s(),T($,{key:0,class:"w-4 h-4 animate-spin mr-2"})):w("",!0),t("p",null,d(e(m)("general.rating.dialog.button.label.cancel")),1)]),_:1}),o(R,{disabled:g.value===0,onClick:C},{default:i(()=>[b.value?(s(),T($,{key:0,class:"w-4 h-4 animate-spin mr-2"})):w("",!0),t("span",null,d(e(m)("general.rating.dialog.button.label.send")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])}}}),T4={class:pe(["sm:w-3/4 max-w-sm sm:max-w-[50rem] sm:min-w-[32rem] mx-auto"])},A4={class:"flex gap-6"},C4={class:"font-semibold"},D4={class:"font-semibold"},L4={class:"ml-2"},I4=oe({__name:"QMSMessages",setup(n){const l=tt(),a=ot(),c=Ce(),{t:r}=We(c.t),p=Bs(),{currentConversation:m}=ie(p),g=v(null),h=v([]),_=v(!0),x=v({}),b=Bt("scrollContainer"),S=()=>{if(!b.value)return;const R=b.value.scrollTop,B=b.value.clientHeight,j=b.value.scrollHeight;_.value=R+B>=j-1;for(let ee=0;ee<h.value.length;ee++){const G=h.value[ee].$el.offsetTop;x.value[ee]=R>G-10}},D=()=>{b.value&&b.value.scrollTo({top:b.value.scrollHeight,behavior:"smooth"})},y=R=>{const B=String(R);return l.query[B]==="r"?"sources":"answer"},I=(R,B)=>{const j={...l.query};j[String(R)]=B,a.replace({query:j})},C=(R,B)=>{I(R,B),E.value[R]=B==="r"?"sources":"answer";const j=h.value[R];j&&j.$el.scrollIntoView({block:"start",behavior:"smooth"})},U=R=>{const B=h.value[R];B&&B.$el.scrollIntoView({behavior:"smooth"})},E=v({}),N=ne(()=>{var j;const R=((j=m.value)==null?void 0:j.messageList)??[],B=[];for(let ee=0;ee<R.length;ee+=2){const se=R[ee],G=R[ee+1];se&&G&&B.push({user:se,ai:G})}return B}),$=v(0);return Te(N,async R=>{const B=R.length;B>$.value&&await Et(()=>{const j=B-1;U(j),$.value=B})}),Dt(async()=>{var R;(R=m.value)==null||R.messageList.forEach((B,j)=>{E.value[j]=y(j)})}),Vt(async()=>{await Et(),h.value[N.value.length-1].$el.scrollIntoView({behavior:"smooth"})}),(R,B)=>{const j=f("TabsTrigger"),ee=f("TabsList"),se=f("TabsContent"),G=f("Tabs");return s(),u("div",{ref_key:"scrollContainer",ref:g,onScroll:S,class:"relative overflow-y-auto flex flex-col dark:bg-stone-900"},[o(S4),t("div",T4,[(s(!0),u(ve,null,Le(N.value,(J,H)=>(s(),u("div",{key:H,class:"last:min-h-[calc(100vh-10rem)]"},[t("span",{class:pe([x.value[H]?"opacity-0 cursor-default select-none":"opacity-100","font-semibold w-full block transition-all duration-200"])},d(J.user.content.text),3),o(G,{"default-value":"answer",modelValue:E.value[H],"onUpdate:modelValue":M=>E.value[H]=M,ref_for:!0,ref_key:"tabBlocks",ref:h,class:"w-full relative mr-auto mb-20"},{default:i(()=>[o(ee,{class:"w-full items-start justify-start rounded-none sticky top-0 p-0 flex flex-col z-10 bg-white dark:bg-stone-900 border-b"},{default:i(()=>[t("span",{class:pe(["font-semibold w-full truncate text-black dark:text-white transition-all duration-200",x.value[H]?"opacity-100":"opacity-0 cursor-default select-none"])},d(J.user.content.text),3),t("div",A4,[o(j,{onPointerdown:M=>C(H,"d"),value:"answer",class:"relative rounded-none border-b-2 border-b-transparent dark:bg-transparent px-0 py-3 text-muted-foreground shadow-none transition-all focus-visible:ring-0 data-[state=active]:border-b-primary data-[state=active]:text-foreground data-[state=active]:shadow-none"},{default:i(()=>[B[0]||(B[0]=t("i",{class:"bi bi-chat-dots mr-2 ml-0.5"},null,-1)),t("span",C4,d(e(r)("qms.searchChat.tabsTitle.answerTab")),1)]),_:2,__:[0]},1032,["onPointerdown"]),J.ai.content.references&&J.ai.content.references.total>0?(s(),T(j,{key:0,onPointerdown:M=>C(H,"r"),value:"sources",class:"relative rounded-none border-b-2 border-b-transparent dark:bg-transparent px-0 py-3 text-muted-foreground shadow-none transition-all focus-visible:ring-0 data-[state=active]:border-b-primary data-[state=active]:text-foreground data-[state=active]:shadow-none"},{default:i(()=>{var M;return[B[1]||(B[1]=t("i",{class:"bi bi-link-45deg mr-2 ml-0.5"},null,-1)),t("span",D4,d(e(r)("qms.searchChat.tabsTitle.sourceTab")),1),t("span",L4,d((M=J.ai.content.references)==null?void 0:M.total),1)]}),_:2,__:[1]},1032,["onPointerdown"])):w("",!0)])]),_:2},1024),o(se,{value:"answer",class:"z-5 mt-5"},{default:i(()=>[o(s4,{message:J.ai,index:H,"on-route-to-source":C},null,8,["message","index"])]),_:2},1024),J.ai.content.references&&J.ai.content.references.total>0?(s(),T(se,{key:0,value:"sources",class:"z-5 mt-5"},{default:i(()=>{var M;return[o(TI,{references:(M=J.ai.content.references)==null?void 0:M.items,tracking:{appName:"QMS",viewName:"CHAT_SOURCE_TAB",additionalInfo:{messageId:J.ai.id,conversationId:J.ai.conversationId}}},null,8,["references","tracking"])]}),_:2},1024)):w("",!0)]),_:2},1032,["modelValue","onUpdate:modelValue"])]))),128))]),_.value?w("",!0):(s(),T(Pe,{key:0,icon:"bi bi-arrow-down text-sm",size:"icon","class-name":"sticky z-10 bg-clip-padding dark:bg-stone-500 rounded-full border bg-white py-2 z-20 bottom-2 left-1/2 -translate-x-1/2 shadow-md",tooltip:e(r)("qms.tooltip.searchChat.scrollDown.button"),onClick:D},null,8,["tooltip"]))],544)}}}),B4={class:"w-full sm:w-3/4 max-w-sm sm:max-w-[50rem] sm:min-w-[32rem] mx-auto flex flex-col justify-center bg-white dark:bg-stone-900"},M4={class:"max-sm:hidden text-xs text-center opacity-50 -mt-1 mb-1"},E4=oe({__name:"QMSSearchChatView",setup(n){const l=Bs(),{generatingResponse:a}=ie(l),{getQmsConversation:c}=l,r=ot(),p=tt(),m=Ce(),{t:g}=We(m.t),{toast:h}=gt(),_=v(!1);return Te(()=>p.params.id,async x=>{if(!a.value)try{_.value=!0,await c(x)}catch{h({title:g("home.toast.fail.generalErrorTitle"),description:g("home.toast.fail.generalError"),variant:"destructive"}),_.value=!1,r.push("/qms")}finally{_.value=!1}},{immediate:!0}),(x,b)=>{const S=f("Loader2");return s(),u(ve,null,[_.value?(s(),T(S,{key:0,class:"w-8 h-8 animate-spin m-auto"})):(s(),T(I4,{key:1,class:"w-full h-full"})),t("div",B4,[o(Oi),t("p",M4,d(e(g)("home.chat.label.description",{ai:"PrivateGPT"})),1)])],64)}}}),R4={class:"relative"},F4=oe({__name:"QMSSearchFile",setup(n){const l=Bs(),{searchQuery:a}=ie(l),{t:c}=Ce();return(r,p)=>{const m=f("Input");return s(),u("div",null,[t("div",R4,[p[1]||(p[1]=t("i",{class:"bi bi-search absolute left-3 top-2 cursor-pointer"},null,-1)),o(m,{placeholder:e(c)("qms.knowledgeBase.search.placeholder"),class:"pl-10",modelValue:e(a),"onUpdate:modelValue":p[0]||(p[0]=g=>kt(a)?a.value=g:null)},null,8,["placeholder","modelValue"])])])}}}),P4={class:"flex flex-col"},N4={key:0,class:"flex flex-col items-start space-y-3"},z4={key:0,class:"flex gap-3 justify-center items-center mt-4"},U4={class:"text-sm text-stone-500"},O4=oe({__name:"QMSFileTable",props:{files:{}},setup(n){const l=Ce(),{t:a}=We(l.t),c=n,r=v(0),p=v(!1),m=Bs(),{getFileList:g}=m,{totalFiles:h,searchQuery:_}=ie(m);ia(()=>{_.value=""});const x=us(async N=>{r.value=0,await b(N.toLowerCase())},300);Te(_,N=>{x(N)});const b=async(N="")=>{const $={query:N,offset:r.value,limit:10};p.value=!0;try{await g($)}catch{Ue({title:a("group.toast.fail.generalErrorTitle"),description:a("group.toast.fail.somethingWentWrong"),variant:"destructive"})}finally{p.value=!1}},S=[{accessorKey:"handbook",header:()=>Oe("div",{class:"text-left font-bold text-md"},a("qms.knowledgeBase.table.header.handbook")),cell:({row:N})=>Oe("div",{class:"text-left"},N.getValue("handbook"))},{accessorKey:"code",header:()=>Oe("div",{class:"text-left font-bold text-md"},a("qms.knowledgeBase.table.header.code")),cell:({row:N})=>Oe("div",{class:"text-left"},N.getValue("code"))},{accessorKey:"name",header:()=>Oe("div",{class:"text-left font-bold text-md"},a("qms.knowledgeBase.table.header.name")),cell:({row:N})=>{const $=N.original.qmsUUID;return Oe(Hs,{href:`https://qms.fpt.com/document-detail/${$}/view`,className:"text-blue-500 hover:underline hover:underline-offset-4",tracking:{appName:"QMS",viewName:"KNOWLEDGE_BASE",additionalInfo:{searchQuery:_.value}}},()=>[Oe("div",{class:"text-left"},[Oe("span",{},N.getValue("name"))])])}},{accessorKey:"version",header:()=>Oe("div",{class:"text-left font-bold text-md"},a("qms.knowledgeBase.table.header.version")),cell:({row:N})=>Oe("div",{class:"text-left"},N.getValue("version"))},{accessorKey:"effectedDate",header:()=>Oe("div",{class:"text-left font-bold text-md"},a("qms.knowledgeBase.table.header.effectedDate")),cell:({row:N})=>Oe("div",{class:"text-left"},N.getValue("effectedDate"))}],D=ne(()=>Math.floor(r.value/10)+1),y=ne(()=>Math.ceil((h.value||0)/10)),I=()=>{r.value=0,b(_.value)},C=()=>{r.value=(y.value-1)*10,b(_.value)},U=()=>{D.value<y.value&&(r.value+=10,b(_.value))},E=()=>{r.value>0&&(r.value-=10,b(_.value))};return Dt(()=>{b()}),(N,$)=>{const R=f("Skeleton"),B=f("Button");return s(),u("div",null,[t("div",P4,[p.value?(s(),u("div",N4,[o(R,{class:"h-8 w-full"}),o(R,{class:"h-8 w-11/12"}),o(R,{class:"h-8 w-full"}),o(R,{class:"h-8 w-11/12"}),o(R,{class:"h-8 w-full"}),o(R,{class:"h-8 w-11/12"}),o(R,{class:"h-8 w-full"}),o(R,{class:"h-8 w-11/12"})])):(s(),T(rn,{key:1,columns:S,data:c.files,noDataAvailableMessage:e(a)("qms.unavailableMessage.noDataAvailable")},null,8,["data","noDataAvailableMessage"]))]),t("div",null,[!p.value&&e(h)!==0?(s(),u("div",z4,[o(B,{variant:"ghost",disabled:D.value===1,onClick:I},{default:i(()=>$[0]||($[0]=[t("i",{class:"bi bi-chevron-double-left"},null,-1)])),_:1,__:[0]},8,["disabled"]),o(B,{variant:"ghost",disabled:r.value===0,onClick:E},{default:i(()=>$[1]||($[1]=[t("i",{class:"bi bi-caret-left"},null,-1)])),_:1,__:[1]},8,["disabled"]),t("span",U4,d(D.value)+" / "+d(y.value),1),o(B,{variant:"ghost",disabled:D.value===y.value,onClick:U},{default:i(()=>$[2]||($[2]=[t("i",{class:"bi bi-caret-right"},null,-1)])),_:1,__:[2]},8,["disabled"]),o(B,{variant:"ghost",disabled:D.value===y.value,onClick:C},{default:i(()=>$[3]||($[3]=[t("i",{class:"bi bi-chevron-double-right"},null,-1)])),_:1,__:[3]},8,["disabled"])])):w("",!0)])])}}}),j4={class:"flex flex-col h-dvh max-sm:max-w-sm mx-auto overflow-auto"},V4={class:"flex relative flex-col w-10/12 sm:w-3/4 mx-auto gap-4"},G4={class:"sticky top-0 bg-white dark:bg-stone-900 z-10 space-y-2"},W4={class:"max-sm:mt-5 sm:mb-5 space-y-2"},H4={class:"sm:text-center text-2xl sm:text-4xl font-semibold"},K4={key:0,class:"sm:text-center"},q4={class:"text-sm/6 opacity-50"},Q4=oe({__name:"QMSKnowledgeBase",setup(n){const l=Bs(),{fileListTable:a,totalKnowledge:c}=ie(l),{fetchQmsTotalDocuments:r}=l,{t:p}=Ce();return Dt(r),(m,g)=>(s(),u("div",j4,[t("div",V4,[t("div",G4,[t("div",W4,[t("h1",H4,d(e(p)("qms.knowledgeBase.title")),1),e(c)?(s(),u("div",K4,d(e(p)("qms.knowledgeBase.label.totalFiles",{total:e(c)})),1)):w("",!0)]),t("h2",q4,d(e(p)("qms.knowledgeBase.description")),1),o(F4)]),o(O4,{files:e(a)},null,8,["files"])])]))}}),J4={class:"text-xs"},X4={class:"text-xs"},Ro=10,rl=oe({__name:"QMSSubSidebar",setup(n){const l=ne(()=>g.name==="qms-home"||g.name==="qms-search"),a=ne(()=>g.name==="qms-knowledge-base"),c=v();Te(()=>Ht.global.locale,M=>{c.value=M.replace("_","-")});const{t:r}=Ce(),{toast:p}=gt(),m=ot(),g=tt(),h=xt(),_=Bs(),{qmsConversations:x,currentOffset:b,totalConversations:S,currentConversation:D,currentParentMessageId:y,hasMore:I}=ie(_),{getQmsConversationList:C}=_,U=ne(()=>x.value.map(M=>({id:M.id??"",name:M.conversationName,updatedAt:M.updatedAt,link:`/qms/chat/${M.id}`}))),E=at(),{isMobileSize:N}=ie(E),{toggleVisibleState:$}=h,{privateGPTSidebarState:R}=ie(h),B=()=>{D.value=void 0,y.value=null,m.push("/qms"),H()},j=()=>{D.value=void 0,y.value=null,m.push("/qms/files")},ee=v(!1);Dt(async()=>{try{c.value=Ht.global.locale.replace("_","-"),x.value.length===0&&(ee.value=!0,await C(b.value,28),I.value=28<S.value,b.value+=28)}catch{p({title:r("home.toast.fail.generalErrorTitle"),description:r("home.toast.fail.generalError"),variant:"destructive"})}finally{ee.value=!1}});const se=async()=>{if(!(ee.value||!I.value||b.value>S.value)){ee.value=!0;try{const M=await C(b.value,Ro);M&&M.length<Ro&&(I.value=!1),b.value+=Ro}catch(M){console.error("Error loading more data, ",M)}finally{ee.value=!1}}},G=async(M,W)=>{try{await _.editConversationTitle(M,W)}catch(X){console.error(X),p({title:r("home.subSidebar.toast.fail.renameConversation"),variant:"destructive"})}},J=async M=>{try{await _.deleteConversation(M),p({title:r("home.toast.success.deleteConversation"),description:r("home.toast.success.deleteConversationDescription")}),m.replace("/qms")}catch(W){console.error(W),p({title:r("home.toast.fail.generalErrorTitle"),description:r("home.toast.fail.generalError"),variant:"destructive"})}},H=()=>{N.value&&R.value&&$(R)};return(M,W)=>{const X=f("Button");return s(),T(Ia,{loading:ee.value,items:U.value,"active-item-id":e(g).params.id??"","has-more-items":e(I),onDeleteItem:J,onEditItem:G,onArrivedBottom:se},{stickyHeader:i(()=>[o(X,{variant:"ghost",class:pe([l.value?"bg-stone-200 dark:bg-stone-700":"","w-full flex items-center gap-1 justify-start p-1.5 rounded-md hover:bg-stone-200 dark:hover:bg-stone-700 cursor-pointer"]),onClick:B},{default:i(()=>[W[0]||(W[0]=t("div",{class:"rounded-full h-6 w-6 -ml-1 sm:ml-0 sm:h-7 sm:w-7 flex justify-center items-center"},[t("i",{class:"bi bi-search"})],-1)),t("span",J4,d(e(r)("qms.sidebar.button.label.aiSearch")),1)]),_:1,__:[0]},8,["class"]),o(X,{variant:"ghost",class:pe([a.value?"bg-stone-200 dark:bg-stone-700":"","w-full flex items-center gap-1 justify-start p-1.5 rounded-md hover:bg-stone-200 dark:hover:bg-stone-700 cursor-pointer"]),onClick:j},{default:i(()=>[W[1]||(W[1]=t("div",{class:"rounded-full h-6 w-6 -ml-1 sm:ml-0 sm:h-7 sm:w-7 flex justify-center items-center"},[t("i",{class:"bi bi-file-earmark-pdf"})],-1)),t("span",X4,d(e(r)("qms.sidebar.button.label.knowledgeBase")),1)]),_:1,__:[1]},8,["class"])]),_:1},8,["loading","items","active-item-id","has-more-items"])}}}),Y4={class:"flex flex-col w-full"},Z4=oe({__name:"QMSMainView",setup(n){const l=ps(),{getRating:a}=l,c=at(),{isMobileSize:r}=ie(c);return Dt(async()=>{await a()}),(p,m)=>{const g=f("RouterView");return s(),u(ve,null,[e(r)?(s(),T(Cs,{key:0,defer:"",to:"#mobile-sub-sidebar"},[o(rl)])):(s(),T(Cs,{key:1,defer:"",to:"#sub-sidebar"},[o(rl)])),t("div",Y4,[o(ks,{"justify-content":e(r)?"justify-start":"justify-end","is-show-create-new-chat":!1,isQMSView:!0,class:"fixed top-0"},null,8,["justify-content"]),o(g)])],64)}}}),eB=[{path:"/qms",name:"qms",component:Z4,children:[{path:"/qms",name:"qms-home",component:bI},{path:"/qms/chat/:id?",name:"qms-search",component:E4},{path:"/qms/files",name:"qms-knowledge-base",component:Q4}],meta:{allowDragAndDrop:!1,requiresAuth:!0,requiresFeature:"qms",title:"QMS"}}],tB={withSidebarRoutes:eB},sB=n=>n.map(l=>({title:l.title,postDate:l.post_date,description:l.description,url:l.url,content:l.content})),aB=n=>({id:n.id,conversationId:n.conversation_id,parentMessageId:n.parent_message_id,role:n.role,content:{text:n.content.text,references:{items:n.content.references.items.map(l=>({title:l.title,postDate:l.post_date,description:l.description,url:l.url,content:l.content})),total:n.content.references.total}},followUpQuestions:n.follow_up_questions,isCompleted:!0}),oB=n=>({id:n.id,conversationName:n.conversation_name,messageList:n.message_list.map(l=>aB(l)),createdAt:new Date(n.created_at),updatedAt:new Date(n.updated_at),createdBy:n.created_by,updatedBy:n.updated_by}),nB=n=>({items:n.items.map(l=>({id:l.id,createdAt:new Date(l.created_at),updatedAt:new Date(l.updated_at),createdBy:l.created_by,updatedBy:l.updated_by,conversationName:l.conversation_name})),total:n.total,offset:n.offset,limit:n.limit}),wa=js.create({baseURL:"https://privategpt.fptconsulting.co.jp/api/wikiFJP",headers:{"Content-Type":"application/json"}});wa.interceptors.request.use(async n=>{const l=Ot();await l.initializeClient();const a=await l.getUserAccessToken();return a&&(n.headers.Authorization=`Bearer ${a}`),n},n=>Promise.reject(n));const ha=Ft("wikiStore",()=>{const n=v([]),l=v(0),a=v(0),c=v(!1),r=v(!0),p=v(),m=v(null),g=v(""),h=v(!1),_=v(""),x=v(""),b=v(!1),S=v(""),D=v(!1),y=v(!1),I="https://privategpt.fptconsulting.co.jp/api/wikiFJP",C=v(null),U=v(!1),E=v(!1),N=v([]),$=async(W,X)=>{const O=await wa.get("/conversations",{params:{offset:W,limit:X}}),K=nB(O.data);return n.value.push(...K.items),l.value=O.data.offset,a.value=O.data.total,c.value=!0,K.items},R=async W=>{const X=await wa.get(`/conversations/${W}`);p.value=oB(X.data),m.value=p.value.messageList[p.value.messageList.length-1].id},B=async W=>{W||(W="New Conversation");const X={id:void 0,conversationName:W,createdAt:new Date,updatedAt:new Date,messageList:[]};n.value.unshift(X),p.value=X},j=(W,X,O)=>{p.value&&p.value.messageList?p.value.messageList.push({id:O,role:X,content:{text:W},isCompleted:!0}):console.error("Current conversation not existed")},ee=async()=>{if(p.value){p.value.updatedAt=new Date;const W=n.value.findIndex(O=>{var K;return O.id===((K=p.value)==null?void 0:K.id)});if(W<=0)return;const X=n.value.splice(W,1)[0];X.updatedAt=new Date,n.value.unshift(X)}},se=async()=>{C.value&&C.value.abort(),E.value=!1,U.value=!1},G=(W,X,O,K)=>{if(!p.value)return"";switch(W){case"data":{const F=JSON.parse(X);K+=F.v,p.value.messageList[O-1].content.text=K;break}case"mes_info":{const F=JSON.parse(X);p.value.messageList[O-1].id=F.id,m.value=F.id;break}case"conv":{const F=JSON.parse(X);p.value.id=F.conversation_id,p.value.conversationName=F.generated_name;break}case"ref":{const F=JSON.parse(X);p.value.messageList[O-1].content.references.items=sB(F.references),p.value.messageList[O-1].content.references.total=F.total??0;break}case"followup_questions":const V=JSON.parse(X);p.value.messageList[O-1].followUpQuestions=V.followup_questions;case"DONE":break;default:console.warn("[Unhandled event]",JSON.stringify(W),JSON.stringify(X));break}return K};return{wikiConversationList:n,currentOffset:l,totalConversations:a,hasMore:r,searchQuery:g,conversationsFetched:c,currentConversation:p,currentParentMessageId:m,generatingResponse:U,loadingAnimation:E,fetchWikiConversationList:$,fetchWikiConversation:R,addMessage:j,unshiftConversation:B,isSearchMessageSent:h,isScrollTop:b,messageContent:_,messageResponse:x,isLoading:D,currentTitle:S,wikiMessageList:N,sendMessage:async(W,X,O,K,V)=>{var P,q;await se(),U.value=!0,E.value=!0;const F=(P=p.value)!=null&&P.messageList?p.value.messageList.length+1:1;try{(q=p.value)==null||q.messageList.push({id:"",content:{text:"",references:{items:[],total:0}},role:"AI",error:!1,isCompleted:!1}),y.value=!0;const A={parent_message_id:O,conversation_id:K,question:W,metadata:V,model_id:X};await ee();const k=await ro();C.value=new AbortController;const L=await fetch(`${I}/conversations`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"text/event-stream",Authorization:`Bearer ${k}`},body:JSON.stringify(A),signal:C.value.signal});if(!L.ok||!L.body)throw new Error(`HTTP error: ${L.status}`);y.value=!1;const z=L.body.getReader(),Q=new TextDecoder("utf-8");let ae="",de="",le=!1;for(;!le;){const{done:te,value:Z}=await z.read();if(le=te,E.value=!1,te)break;const re=Q.decode(Z,{stream:!0});ae+=re;const ue=ae.split(`

`);ae=ue.pop();for(const he of ue){if(!he.trim())continue;const{event:$e,data:Se}=io(he);de=G($e,Se,F,de)}}}catch(A){if(A instanceof Error&&A.name==="AbortError")return;p.value.messageList[F-1].content.text=`${A}`,p.value.messageList[F-1].error=!0}finally{E.value=!1,U.value=!1,p.value.messageList[F-1].isCompleted=!0}},editConversationTitle:async(W,X)=>{const O=n.value.find(K=>K.id===W);O!=null&&O.id&&(await wa.put(`/conversations/${W}`,{new_name:X}),O.conversationName=X)},deleteConversation:async W=>{await wa.delete(`/conversations/${W}`),n.value=n.value.filter(X=>X.id!==W)}}}),lB={class:"truncate max-w-36 text-xs"},Fo=10,cl=oe({__name:"WikiSubSidebar",setup(n){const l=v();Te(()=>Ht.global.locale,se=>{l.value=se.replace("_","-")});const{t:a}=Ce(),{toast:c}=gt(),r=ot(),p=tt(),m=xt(),g=ha(),{wikiConversationList:h,currentOffset:_,totalConversations:x,currentConversation:b,currentParentMessageId:S,hasMore:D}=ie(g),{fetchWikiConversationList:y}=g,I=ne(()=>h.value.map(se=>({id:se.id??"",name:se.conversationName,updatedAt:se.updatedAt,link:`/wiki-fjp/chat/${se.id}`}))),C=at(),{isMobileSize:U}=ie(C),{privateGPTSidebarState:E}=ie(m),N=()=>{b.value=void 0,S.value=null,r.push("/wiki-fjp"),ee()},$=v(!1);Dt(async()=>{try{l.value=Ht.global.locale.replace("_","-"),h.value.length===0&&($.value=!0,await y(_.value,28),D.value=28>x.value,_.value+=28)}catch{c({title:a("home.toast.fail.generalErrorTitle"),description:a("home.toast.fail.generalError"),variant:"destructive"})}finally{$.value=!1}});const R=async()=>{if(!($.value||!D.value||_.value>x.value)){$.value=!0;try{const se=await y(_.value,Fo);se&&se.length<Fo&&(D.value=!1),_.value+=Fo}catch(se){console.error("Error loading more data, ",se)}finally{$.value=!1}}},B=async(se,G)=>{try{await g.editConversationTitle(se,G)}catch{c({title:a("home.subSidebar.toast.fail.renameConversation"),variant:"destructive"})}},j=async se=>{try{await g.deleteConversation(se),c({title:a("home.toast.success.deleteConversation"),description:a("home.toast.success.deleteConversationDescription")}),r.replace("/wiki-fjp")}catch(G){console.error(G),c({title:a("home.toast.fail.generalErrorTitle"),description:a("home.toast.fail.generalError"),variant:"destructive"})}},ee=()=>{U.value&&m.privateGPTSidebarState&&m.toggleVisibleState(E)};return(se,G)=>(s(),T(Ia,{loading:$.value,items:I.value,"has-more-items":e(D),"active-item-id":e(p).params.id??"",onEditItem:B,onDeleteItem:j,onArrivedBottom:R},{stickyHeader:i(()=>[t("div",{onClick:N,class:"hidden sm:flex w-full items-center gap-1 justify-start p-1.5 rounded-md hover:bg-stone-200 dark:hover:bg-stone-700 cursor-pointer"},[G[0]||(G[0]=t("div",{class:"rounded-full h-7 w-7 flex justify-center items-center"},[t("i",{class:"bi bi-pencil-square"})],-1)),t("div",lB,d(e(a)("home.subSidebar.tooltip.newChat")),1)])]),_:1},8,["loading","items","has-more-items","active-item-id"]))}}),iB={class:"flex flex-col w-full"},rB=oe({__name:"WikiMainView",setup(n){const l=at(),{isMobileSize:a}=ie(l);return(c,r)=>{const p=f("RouterView");return s(),u(ve,null,[e(a)?(s(),T(Cs,{key:0,defer:"",to:"#mobile-sub-sidebar"},[o(cl)])):(s(),T(Cs,{key:1,defer:"",to:"#sub-sidebar"},[o(cl)])),t("div",iB,[o(ks,{"justify-content":e(a)?"justify-start":"justify-end","is-show-create-new-chat":!1,isWikiFJPView:!0,class:"fixed top-0"},null,8,["justify-content"]),o(p)])],64)}}}),cB={class:"flex w-full cursor-text flex-col rounded-3xl px-2.5 pb-2 contain-inline-size bg-white dark:bg-stone-800 border-[1px] shadow-sm focus-within:shadow-md transition-shadow duration-200 mb-3"},dB={class:"flex flex-col min-h-[44px] items-center px-2"},uB={class:"flex items-center justify-end"},ji=oe({__name:"WikiMessageInput",props:{initialText:{}},emits:["handle-message"],setup(n,{expose:l,emit:a}){const c=ha(),{currentConversation:r,currentParentMessageId:p,messageContent:m,isLoading:g,currentTitle:h,generatingResponse:_}=ie(c),{sendMessage:x,addMessage:b}=c,S=ne(()=>As-m.value.length<=2),D="azure-gpt-4o",y=v(!1),I=Ce(),{t:C}=We(I.t),{toast:U}=gt(),E=a,N=n,$=v(null),R=se=>{$.value&&(m.value=se,$.value.setValue(se))};l({setValue:R}),Te(()=>N.initialText,se=>{se!==void 0&&(m.value=se)});const B=()=>{y.value=!1},j=ne(()=>m.value.trim()===""?!1:!_.value),ee=async()=>{var se;try{if(j.value&&!y.value){E("handle-message",m.value),g.value=!0,h.value=m.value;const G=m.value.trim();m.value="",b(G,"USER","user_temp"),await x(G,D,p.value||null,(se=r.value)==null?void 0:se.id,{attachments:[]})}g.value=!1}catch(G){U({title:C("home.toast.fail.generalErrorTitle"),description:C("home.toast.fail.generalError"),variant:"destructive"}),console.error(G)}};return Te(()=>m.value,se=>{R(se)}),(se,G)=>{const J=f("Textarea");return s(),u("div",cB,[t("div",dB,[Ke(o(J,{ref_key:"textareaRef",ref:$,rows:"1",maxLength:e(As),modelValue:e(m),"onUpdate:modelValue":G[0]||(G[0]=H=>kt(m)?m.value=H:null),onKeydown:yt(Ye(ee,["exact","prevent"]),["enter"]),onCompositionstart:G[1]||(G[1]=H=>y.value=!0),onCompositionend:B,id:"message",placeholder:e(C)("home.chat.label.chatPlaceholder"),class:"flex flex-col items-center h-full w-full grow rounded-md border-input bg-transparent p-2 m-3 ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 border-0 resize-none max-h-52 text-sm"},null,8,["maxLength","modelValue","onKeydown","placeholder"]),[[e(Jt),!0]])]),t("div",uB,[t("span",{class:pe(["text-xs mb-2 self-end px-3 max-sm:hidden",[S.value?"text-red-400 font-semibold":"text-stone-400"]])},d(e(C)("home.chat.message.maxLengthCharacters",{inputLength:e(m).length,maxLength:e(As)})),3),t("div",null,[o(Pe,{icon:"bi bi-arrow-up",variant:"default",size:"icon",tooltip:e(C)("wiki.homeChat.button.sendMessage.tooltip"),onClick:ee,disabled:!j.value},null,8,["tooltip","disabled"])])])])}}}),pB={class:"mx-auto flex flex-col w-full h-full justify-center gap-4 text-base md:gap-5 lg:gap-6 md:max-w-[32rem] lg:max-w-[40rem] xl:max-w-[48rem] px-5"},mB={class:"h-full flex flex-col justify-center"},gB={class:"text-2xl font-bold text-center mb-5"},fB={class:"text-xs text-center opacity-50"},vB=oe({__name:"WikiHomeView",setup(n){const l=ha(),{currentConversation:a}=ie(l),{unshiftConversation:c}=l,r=Ce(),{t:p}=We(r.t),m=ot(),g=async()=>{await c(""),await Et(),m.push({path:"/wiki-fjp/chat/"});const h=Te(()=>{var _;return(_=a.value)==null?void 0:_.id},_=>{_&&_!==""&&(m.replace({path:`/wiki-fjp/chat/${_}`}),h())})};return(h,_)=>(s(),u("div",pB,[t("div",mB,[t("p",gB,d(e(p)("wiki.homeChat.titleOnChat")),1),o(ji,{onHandleMessage:g}),t("p",fB,d(e(p)("home.chat.label.description",{ai:"PrivateGPT"})),1)])]))}}),hB={key:0,class:"mt-10"},_B={class:"flex items-center justify-between border mb-3 cursor-pointer dark:bg-stone-800 hover:bg-stone-200 dark:hover:bg-stone-500 p-6 rounded-xl"},bB={class:"flex items-center gap-4"},kB={class:"flex flex-col"},yB={class:"wrap-anywhere text-sm line-clamp-1 font-bold"},xB={class:"line-clamp-2 wrap-anywhere text-sm"},wB={class:"text-sm mt-1 opacity-50"},$B=oe({__name:"WikiSource",props:{references:{},tracking:{}},setup(n){const l=n,a=Ce(),{t:c}=We(a.t);return(r,p)=>{var h;const m=f("AvatarFallback"),g=f("Avatar");return(h=l.references)!=null&&h.length?(s(),u("div",hB,[(s(!0),u(ve,null,Le(l.references,(_,x)=>(s(),u("div",{key:_.title},[o(Hs,{href:_.url,tracking:r.tracking},{default:i(()=>[t("div",_B,[t("div",bB,[t("span",null,d(x+1),1),o(g,{size:"base"},{default:i(()=>[o(m,null,{default:i(()=>p[0]||(p[0]=[t("i",{class:"bi bi-file-earmark-text"},null,-1)])),_:1,__:[0]})]),_:1}),t("div",kB,[t("span",yB,d(_.title),1),t("span",xB,d(_.description),1),t("span",wB,d(e(c)("wiki.homeChat.source.postDate",{post_date:_.postDate})),1)])])])]),_:2},1032,["href","tracking"])]))),128))])):w("",!0)}}}),SB=["onClick"],TB=oe({__name:"WikiFollowUpQuestion",props:{questions:{}},emits:["click"],setup(n,{emit:l}){const a=n,c=l,r=p=>{c("click",p)};return(p,m)=>{const g=f("Separator");return s(!0),u(ve,null,Le(a.questions,(h,_)=>(s(),u("div",{key:_,class:"flex flex-col justify-between cursor-pointer transition-colors duration-200 text-sm"},[t("div",{class:"flex justify-between p-3 hover:bg-gray-50 hover:text-gray-800 rounded-md",onClick:x=>r(h)},[t("span",null,d(h),1),m[0]||(m[0]=t("i",{class:"bi bi-plus-lg"},null,-1))],8,SB),o(g)]))),128)}}}),AB={class:"h-full w-full"},CB={key:0,class:"w-full mt-8 mb-5"},DB={class:"flex items-center gap-2 mb-3"},LB={class:"text-xl font-semibold"},IB={key:0,class:"lds-ellipsis"},BB=oe({__name:"WikiAnswer",props:{message:{},index:{},onRouteToSource:{type:Function},tracking:{}},setup(n){const l=Ce(),{t:a}=We(l.t),c=n,r=ha(),{messageContent:p,currentConversation:m}=ie(r),g=h=>{p.value=h};return(h,_)=>{var b,S;const x=f("Separator");return s(),u(ve,null,[t("div",AB,[t("div",null,[o(va,{"streaming-markdown":h.message.content.text,"is-completed":h.message.isCompleted,tracking:h.tracking},null,8,["streaming-markdown","is-completed","tracking"]),c.message.followUpQuestions&&c.message.followUpQuestions.length>0?(s(),u("div",CB,[t("div",DB,[_[0]||(_[0]=t("i",{class:"bi bi-list-task text-xl"},null,-1)),t("span",LB,d(e(a)("wiki.searchChat.answerTab.related.title")),1)]),o(x),o(TB,{onClick:g,questions:h.message.followUpQuestions},null,8,["questions"])])):w("",!0)])]),!h.message.isCompleted&&((b=e(m))!=null&&b.messageList)&&c.index===((S=e(m))==null?void 0:S.messageList.length)/2-1?(s(),u("div",IB,_[1]||(_[1]=[t("div",null,null,-1),t("div",null,null,-1),t("div",null,null,-1),t("div",null,null,-1)]))):w("",!0)],64)}}}),MB=Vs(BB,[["__scopeId","data-v-2ce999d6"]]),EB={class:pe(["sm:w-3/4 max-w-sm sm:max-w-[50rem] sm:min-w-[32rem] mx-auto"])},RB={class:"flex gap-6"},FB={class:"font-semibold"},PB={class:"font-semibold"},NB={class:"ml-2"},zB=oe({__name:"WikiMessageList",setup(n){const l=tt(),a=ot(),c=Ce(),{t:r}=We(c.t),p=ha(),{currentConversation:m}=ie(p),g=v(null),h=v([]),_=v(!0),x=v({}),b=Bt("scrollContainer"),S=()=>{if(!b.value)return;const R=b.value.scrollTop,B=b.value.clientHeight,j=b.value.scrollHeight;_.value=R+B>=j-1;for(let ee=0;ee<h.value.length;ee++){const G=h.value[ee].$el.offsetTop;x.value[ee]=R>G-10}},D=()=>{b.value&&b.value.scrollTo({top:b.value.scrollHeight,behavior:"smooth"})},y=R=>{const B=String(R);return l.query[B]==="r"?"sources":"answer"},I=(R,B)=>{const j={...l.query};j[String(R)]=B,a.replace({query:j})},C=(R,B)=>{I(R,B),E.value[R]=B==="r"?"sources":"answer";const j=h.value[R];j&&j.$el.scrollIntoView({block:"start",behavior:"smooth"})},U=R=>{const B=h.value[R];B&&B.$el.scrollIntoView({behavior:"smooth"})},E=v({}),N=ne(()=>{var j;const R=((j=m.value)==null?void 0:j.messageList)??[],B=[];for(let ee=0;ee<R.length;ee+=2){const se=R[ee],G=R[ee+1];se&&G&&B.push({user:se,ai:G})}return B}),$=v(0);return Te(N,async R=>{const B=R.length;B>$.value&&await Et(()=>{const j=B-1;U(j),$.value=B})}),Dt(async()=>{var R;(R=m.value)==null||R.messageList.forEach((B,j)=>{E.value[j]=y(j)})}),Vt(async()=>{await Et(),h.value[N.value.length-1].$el.scrollIntoView({behavior:"smooth"})}),(R,B)=>{const j=f("TabsTrigger"),ee=f("TabsList"),se=f("TabsContent"),G=f("Tabs");return s(),u("div",{ref_key:"scrollContainer",ref:g,onScroll:S,class:"relative overflow-y-auto flex flex-col dark:bg-stone-900"},[t("div",EB,[(s(!0),u(ve,null,Le(N.value,(J,H)=>(s(),u("div",{key:H,class:"last:min-h-[calc(100vh-10rem)]"},[t("span",{class:pe([x.value[H]?"opacity-0 cursor-default select-none":"opacity-100","font-semibold w-full block transition-all duration-200"])},d(J.user.content.text),3),o(G,{"default-value":"answer",modelValue:E.value[H],"onUpdate:modelValue":M=>E.value[H]=M,ref_for:!0,ref_key:"tabBlocks",ref:h,class:"w-full relative mr-auto mb-20"},{default:i(()=>[o(ee,{class:"w-full items-start justify-start rounded-none sticky top-0 p-0 flex flex-col z-10 bg-white dark:bg-stone-900 border-b"},{default:i(()=>[t("span",{class:pe(["font-semibold w-full truncate text-black dark:text-white transition-all duration-200",x.value[H]?"opacity-100":"opacity-0 cursor-default select-none"])},d(J.user.content.text),3),t("div",RB,[o(j,{onPointerdown:M=>C(H,"d"),value:"answer",class:"relative rounded-none border-b-2 border-b-transparent dark:bg-transparent px-0 py-3 text-muted-foreground shadow-none transition-all focus-visible:ring-0 data-[state=active]:border-b-primary data-[state=active]:text-foreground data-[state=active]:shadow-none"},{default:i(()=>[B[0]||(B[0]=t("i",{class:"bi bi-chat-dots mr-2 ml-0.5"},null,-1)),t("span",FB,d(e(r)("wiki.searchChat.tabsTitle.answerTab")),1)]),_:2,__:[0]},1032,["onPointerdown"]),J.ai.content.references&&J.ai.content.references.total>0?(s(),T(j,{key:0,onPointerdown:M=>C(H,"r"),value:"sources",class:"relative rounded-none border-b-2 border-b-transparent dark:bg-transparent px-0 py-3 text-muted-foreground shadow-none transition-all focus-visible:ring-0 data-[state=active]:border-b-primary data-[state=active]:text-foreground data-[state=active]:shadow-none"},{default:i(()=>{var M;return[B[1]||(B[1]=t("i",{class:"bi bi-link-45deg mr-2 ml-0.5"},null,-1)),t("span",PB,d(e(r)("wiki.searchChat.tabsTitle.sourceTab")),1),t("span",NB,d((M=J.ai.content.references)==null?void 0:M.total),1)]}),_:2,__:[1]},1032,["onPointerdown"])):w("",!0)])]),_:2},1024),o(se,{value:"answer",class:"z-5 mt-5"},{default:i(()=>[o(MB,{message:J.ai,index:H,"on-route-to-source":C,tracking:{appName:"WIKIFJP",viewName:"CHAT",additionalInfo:{messageId:J.ai.id,conversationId:J.ai.conversationId}}},null,8,["message","index","tracking"])]),_:2},1024),J.ai.content.references&&J.ai.content.references.total>0?(s(),T(se,{key:0,value:"sources",class:"z-5 mt-5"},{default:i(()=>{var M;return[o($B,{references:(M=J.ai.content.references)==null?void 0:M.items,tracking:{appName:"WIKIFJP",viewName:"CHAT_SOURCE_TAB",additionalInfo:{messageId:J.ai.id,conversationId:J.ai.conversationId}}},null,8,["references","tracking"])]}),_:2},1024)):w("",!0)]),_:2},1032,["modelValue","onUpdate:modelValue"])]))),128))]),_.value?w("",!0):(s(),T(Pe,{key:0,icon:"bi bi-arrow-down text-sm",size:"icon","class-name":"sticky z-10 bg-clip-padding dark:bg-stone-500 rounded-full border bg-white py-2 z-20 bottom-2 left-1/2 -translate-x-1/2 shadow-md",tooltip:e(r)("wiki.searchChat.button.scrollDown.tooltip"),onClick:D},null,8,["tooltip"]))],544)}}}),UB={class:"w-full sm:w-3/4 max-w-sm sm:max-w-[50rem] sm:min-w-[32rem] mx-auto flex flex-col justify-center bg-white dark:bg-stone-900"},OB={class:"max-sm:hidden text-xs text-center opacity-50 -mt-1 mb-1"},jB=oe({__name:"WikiChatView",setup(n){const l=ha(),{generatingResponse:a}=ie(l),{fetchWikiConversation:c}=l,r=ot(),p=tt(),m=Ce(),{t:g}=We(m.t),{toast:h}=gt(),_=v(!1);return Te(()=>p.params.id,async x=>{if(!a.value)try{_.value=!0,await c(x)}catch{h({title:g("home.toast.fail.generalErrorTitle"),description:g("home.toast.fail.generalError"),variant:"destructive"}),_.value=!1,r.push("/wiki-fjp")}finally{_.value=!1}},{immediate:!0}),(x,b)=>{const S=f("Loader2");return s(),u(ve,null,[_.value?(s(),T(S,{key:0,class:"w-8 h-8 animate-spin m-auto"})):(s(),T(zB,{key:1,class:"w-full h-full"})),t("div",UB,[o(ji),t("p",OB,d(e(g)("home.chat.label.description",{ai:"PrivateGPT"})),1)])],64)}}}),VB=[{path:"/wiki-fjp",name:"wiki-fjp",component:rB,children:[{path:"/wiki-fjp",name:"wiki-fjp-home",component:vB},{path:"/wiki-fjp/chat/:id?",name:"wiki-fjp-search",component:jB}],meta:{allowDragAndDrop:!1,requiresAuth:!0,title:"WikiFJP"}}],GB={withSidebarRoutes:VB},Js=Ft("useWorkspaceFileStore",()=>{const n=as(),{currentWorkspace:l}=ie(n),a=v(null),c=v([]),r=v([]),p=v([]),m=v([]),g=v([]),h=v(0),_=N=>h.value+N>Ha||h.value+N+c.value.length>Ka,x=N=>{const $=lo(N.name),R=N.size<zl*1024*1024;if($&&R){const B={file:N,fileUrl:["png","jpg","jpeg"].includes(Rt(N.name))?URL.createObjectURL(N):"",fileId:"",isProcessing:null};r.value.push(B)}return{isValidExtension:$,isValidSize:R,file:N}},b=()=>{g.value.forEach(N=>{c.value.push({fileId:N.fileId})})},S=async(N,$)=>{const R=m.value.findIndex(B=>$===B.id);g.value.splice(R,1),await mt.delete(`/workspaces/${N}/chat/files/${$}`,{headers:{"Content-Type":"application/json"}}),m.value.splice(R,1),h.value--},D=async N=>{for(const $ of r.value.slice())try{if($.isProcessing)continue;$.isProcessing=!0;const R=new FormData;R.append("file",$.file);const B=await mt.post(`/workspaces/${N}/chat/files/upload`,R,{headers:{"Content-Type":"multipart/form-data"}}),j=Ta(B.data);j.status==="UPLOADED"?$.fileId=j.id:(r.value=r.value.filter(ee=>ee.file!==$.file),h.value--)}catch(R){console.error(R),p.value.push($),r.value=r.value.filter(B=>B.file!==$.file),h.value--}I.start(N)},I=sa(N=>{var $;if(r.value.length!==0){for(const R of r.value.slice())R.isProcessing&&mt.get(`/workspaces/${(($=l.value)==null?void 0:$.id)??N}/chat/files/${R.fileId}`,{headers:{"Content-Type":"application/json"}}).then(B=>{const j=Ta(B.data);j.status==="FAILED"?(p.value.push(R),r.value=r.value.filter(ee=>ee.fileId!==R.fileId),h.value--):j.status==="READY"&&(g.value.push({fileId:j.id,fileName:j.fileName}),m.value.push(j),r.value=r.value.filter(ee=>ee.fileId!==R.fileId))}).catch(()=>{p.value.push(R),r.value=r.value.filter(B=>B.fileId!==R.fileId),h.value--});r.value.length>0&&I.start()}},5e3,{immediate:!1});return{uploadingFileCount:h,dropArea:a,selectedFiles:r,embedFailedFiles:p,contextFiles:m,readyFiles:g,attachments:c,wouldExceedUploadFileLimit:_,handleSingleFileUpload:x,changeToMetaData:b,uploadSelectedFiles:D,deleteReadyFile:S,downloadFile:async(N,$,R,B)=>{try{const j=await mt.get(`/workspaces/${N}/agents/${$}/files/${R}/download`,{responseType:"arraybuffer"});if(j.status!==200)throw new Error(`Failed to fetch the file: ${j.statusText}`);const ee=new Uint8Array(j.data),se=new File([ee],B,{type:j.headers["content-type"]||"application/octet-stream"}),G=window.URL.createObjectURL(se),J=document.createElement("a");J.href=G,J.setAttribute("download",B),document.body.appendChild(J),J.click(),J.remove(),window.URL.revokeObjectURL(G)}catch(j){console.error(j)}},getImageUrl:async(N,$)=>{try{const R=await mt.get(`/workspaces/${N}/static/images/${$}`,{responseType:"blob"});if(R.status!==200)throw new Error(`Failed to fetch the file: ${R.statusText}`);return URL.createObjectURL(R.data)}catch(R){console.error(R)}},clearState:()=>{c.value=[],r.value=[],p.value=[],m.value=[],g.value=[],h.value=0}}}),Ms=Ft("workspaceConversationStore",()=>{const n=Js(),{readyFiles:l}=ie(n),a=v(0),c=v(0),r=v([]),p=v(!1),m=v(!1),g=v({items:[],total:0,currentOffset:0,loading:!1}),h=v(null),_=v(),x=v(!0),b=v([]),S=v(),D=v(!1),y=v(!1),I=v([]),C="https://privategpt.fptconsulting.co.jp/api/workspace/v1/workspaces",U=v(null),E=v(!1),N=v(!1),$=async(V,F,P)=>{const q=await mt.get(`/workspaces/${V}/chat`,{params:{offset:F,limit:P}}),A=qa(q.data);return r.value.push(...A.items),a.value=q.data.offset,c.value=q.data.total,p.value=!0,A.items},R=async(V,F,P,q=op)=>{try{g.value.loading=!0;const A=await mt.get(`/workspaces/${V}/chat`,{params:{agent_id:F,offset:P,limit:q}}),k=qa(A.data);if(g.value.currentOffset=A.data.offset+k.items.length,g.value.total=A.data.total,P){g.value.items.push(...k.items);return}g.value.items=[...k.items]}finally{g.value.loading=!1}},B=async(V,F)=>{l.value=[];const P=await mt.get(`/workspaces/${V}/chat/${F}`);_.value=hp(P.data),h.value=_.value.messagesList[_.value.messagesList.length-1].id;const q=_.value.messagesList,A=q[q.length-1],k=b.value.find(L=>L.modelId===A.modelId);k?S.value=k:S.value=b.value[0]},j=V=>{V||(V="New Conversation");const F={id:void 0,createdAt:new Date,updatedAt:new Date,conversationName:V,messagesList:[],conversationMetadata:{attachments:[],agentId:null},readOnly:!1};r.value.unshift(F),c.value++,_.value=F},ee=(V,F,P,q,A)=>{_.value&&_.value.messagesList?_.value.messagesList.push({id:P,createdAt:new Date,updatedAt:new Date,role:F,content:{text:V,references:A,citations:null},messageMetadata:{attachments:q},references:A,isCompleted:!0,feedback:null}):console.error("Current conversation not existed")},se=async(V,F,P)=>{const q=r.value.find(A=>A.id===F);q!=null&&q.id&&(await mt.put(`/workspaces/${V}/chat/${F}`,{new_name:P}),q.conversationName=P)},G=async(V,F)=>{await mt.delete(`/workspaces/${V}/chat/${F}`),r.value=r.value.filter(P=>P.id!==F)},J=async()=>{if(_.value){_.value.updatedAt=new Date;const V=r.value.findIndex(P=>{var q;return P.id===((q=_.value)==null?void 0:q.id)});if(V<=0)return;const F=r.value.splice(V,1)[0];F.updatedAt=new Date,r.value.unshift(F)}},H=async V=>{if(!b.value.length){const F=await mt.get(`/workspaces/${V}/chat/support-models`);b.value=F.data.map(Xo),S.value=b.value[0]}},M=async()=>{U.value&&U.value.abort(),E.value=!1,N.value=!1},W=(V,F,P,q)=>{switch(V){case"hint":I.value=JSON.parse(F);break;case"data":{const A=JSON.parse(F);q+=A.v,_.value.messagesList[P-1].content.text=q;break}case"mes_info":{const A=JSON.parse(F);_.value.messagesList[P-1].id=A.id,_.value.messagesList[P-1].modelId=A.model_id,h.value=A.id;break}case"conv":{const A=JSON.parse(F);_.value.id=A.conversation_id,_.value.conversationName=A.generated_name;break}case"citation":{const A=JSON.parse(F);_.value.messagesList[P-1].content.citations=Gl(A.citations);break}case"ref":{const A=JSON.parse(F);_.value.messagesList[P-1].references=Wl(A.references);break}case"DONE":break;default:console.warn("[Unhandled event]",JSON.stringify(V),JSON.stringify(F));break}return q};return{hasMore:x,loadingAnimation:E,generatingResponse:N,conversations:r,currentOffset:a,totalConversations:c,conversationsFetched:p,currentConversation:_,recentConversationsWithAgent:g,unshiftConversation:j,addMessage:ee,messagesRetrieved:m,currentParentMessageId:h,editConversationTitle:se,deleteConversation:G,generateAIResponse:async(V,F,P,q,A,k)=>{var z,Q;await M(),N.value=!0,E.value=!0;const L=(z=_.value)!=null&&z.messagesList?_.value.messagesList.length+1:1;try{(Q=_.value)==null||Q.messagesList.push({id:"",content:{text:"",references:[],citations:null},role:"AI",feedback:null,createdAt:new Date,updatedAt:new Date,error:!1,isCompleted:!1}),y.value=!0;const ae={parent_message_id:q,conversation_id:A,question:F,metadata:k,model_id:P};await J();const de=await ro();U.value=new AbortController;const le=await fetch(`${C}/${V}/chat`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"text/event-stream",Authorization:`Bearer ${de}`},body:JSON.stringify(ae),signal:U.value.signal});if(!le.ok||!le.body)throw new Error(`HTTP error: ${le.status}`);y.value=!1;const te=le.body.getReader(),Z=new TextDecoder("utf-8");let re="",ue="",he=!1;for(;!he;){const{done:$e,value:Se}=await te.read();if(he=$e,E.value=!1,$e)break;const be=Z.decode(Se,{stream:!0});re+=be;const Ge=re.split(`

`);re=Ge.pop();for(const fe of Ge){if(!fe.trim())continue;const{event:Y,data:ce}=io(fe);ue=W(Y,ce,L,ue)}}}catch(ae){if(ae instanceof Error&&ae.name==="AbortError")return;_.value.messagesList[L-1].content.text=`${ae}`,_.value.messagesList[L-1].error=!0}finally{E.value=!1,N.value=!1,_.value.messagesList[L-1].isCompleted=!0}},stopAIResponse:M,fetchConversations:$,fetchConversationById:B,fetchRecentConversationsWithAgent:R,supportModels:b,fetchSupportModels:H,currentModel:S,shouldLeaveWhiteSpace:D,newMessageAdded:y,sendMessageFeedback:async(V,F)=>{var q;await mt.post(`/chat/${V.conversation_id}/messages/${V.message_id}/feedback`,F);const P=(q=_.value)==null?void 0:q.messagesList.find(A=>A.id===V.message_id);P.feedback=F.feedback},deleteMessageFeedback:async V=>{var P;await mt.delete(`/conversations/${V.conversation_id}/messages/${V.message_id}/feedback`);const F=(P=_.value)==null?void 0:P.messagesList.find(q=>q.id===V.message_id);F.feedback=null},hints:I}}),WB={class:"flex flex-col"},HB={key:0,class:"relative flex border border-input bg-white dark:bg-stone-700 p-3 items-center justify-between rounded-lg mt-3"},KB={class:"flex flex-row items-center gap-2 pr-2"},qB={class:"whitespace-nowrap overflow-hidden text-ellipsis max-w-[150px]"},QB={key:1,class:"bi bi-check text-green-500 opacity-100"},JB={key:2},XB=["alt","src"],YB=["onKeydown"],ZB=["alt","src"],eM={key:2},so=oe({__name:"WorkspaceContextFileItem",props:{file:{},fileUrl:{},fileId:{},fileName:{},readyIcon:{type:Boolean,default:!1},isProcessing:{type:[Boolean,null],default:null},deleteButton:{type:Boolean,default:!1}},setup(n){const l=Js(),a=Ms(),{currentConversation:c}=ie(a),r=n,p=v(),m=Rt(r.fileName),g=v(1);setTimeout(()=>{g.value=0},1500);const h=v(!1),_=async()=>{h.value=!h.value};Vt(async()=>{r.fileName&&r.fileId&&["png","jpg","jpeg"].includes(Rt(r.fileName))&&(p.value=await l.getImageUrl(x.params.id,r.fileId),c===void 0&&(p.value=void 0))});const x=tt();return Te(()=>x.params.id,async()=>{if(p.value)p.value=void 0,r.fileName&&r.fileId&&["png","jpg","jpeg"].includes(Rt(r.fileName))&&(p.value=await l.getImageUrl(x.params.id,r.fileId));else return}),(b,S)=>{const D=f("Loader"),y=f("Button");return s(),u("div",WB,[r.fileName!==void 0&&!["png","jpg","jpeg"].includes(e(Rt)(r.fileName))?(s(),u("div",HB,[t("div",KB,[t("i",{class:pe(["bi",`bi-filetype-${e(m)}`,"text-3xl"])},null,2),t("p",qB,d(r.fileName),1)]),r.isProcessing?(s(),T(D,{key:0,class:"w-4 h-4 animate-spin"})):w("",!0),!r.isProcessing&&r.readyIcon?(s(),u("i",QB)):w("",!0),r.deleteButton&&r.isProcessing===!1?(s(),u("div",JB,[o(y,{variant:"default",size:"smicon",class:"absolute top-[-6px] right-[-6px] rounded-full w-4 h-4",onClick:S[0]||(S[0]=I=>e(l).deleteReadyFile(e(x).params.id,r.fileId))},{default:i(()=>S[2]||(S[2]=[t("i",{class:"bi bi-x"},null,-1)])),_:1,__:[2]})])):w("",!0)])):w("",!0),r.fileName!==void 0&&["png","jpg","jpeg"].includes(e(Rt)(r.fileName))?(s(),u("div",{key:1,class:pe(["relative flex shrink-0 w-16 rounded-2xl",r.isProcessing?"bg-stone-400 opacity-70":""])},[t("img",{alt:r.fileName,src:p.value??r.fileUrl,class:pe(["w-16 h-16 object-cover cursor-pointer border border-gray-300 dark:border-stone-800 rounded-2xl",r.isProcessing?"bg-stone-400 opacity-70":""]),onClick:_},null,10,XB),r.isProcessing?(s(),T(e(zs),{key:0,class:"w-8 h-8 absolute top-1/4 left-1/4 animate-spin"})):w("",!0),h.value?Ke((s(),u("div",{key:1,class:"backdrop-blur-2xs fixed top-0 left-0 w-full h-full py-4 bg-black/80 dark:bg-stone-950/80 flex items-center justify-center z-50",onKeydown:yt(Ye(_,["exact","prevent"]),["esc"]),onClick:_},[S[3]||(S[3]=t("button",{class:"absolute top-4 right-4 text-white bg-stone-800 hover:bg-stone-600 rounded-full w-8 h-8 flex items-center justify-center z-50"},[t("i",{class:"bi bi-x text-xl"})],-1)),t("img",{alt:r.fileName,src:p.value?p.value:r.fileUrl,class:"max-w-full max-h-full rounded-lg"},null,8,ZB)],40,YB)),[[e(Jt),!0]]):w("",!0),r.deleteButton&&!r.isProcessing?(s(),u("div",eM,[o(y,{variant:"default",size:"smicon",class:"absolute top-[-6px] right-[-6px] rounded-full w-4 h-4",onClick:S[1]||(S[1]=I=>e(l).deleteReadyFile(e(x).params.id,r.fileId))},{default:i(()=>S[4]||(S[4]=[t("i",{class:"bi bi-x"},null,-1)])),_:1,__:[4]})])):w("",!0)],2)):w("",!0)])}}}),tM={class:"flex cursor-text flex-col sm:rounded-3xl rounded-t-3xl px-2.5 pb-2 contain-inline-size bg-white dark:bg-stone-800 border shadow-xs focus-within:shadow-md sm:mb-5 transition-shadow duration-200 dark:outline mt-1"},sM={class:"flex flex-col min-h-20 sm:min-h-12 items-center"},aM={class:"flex w-full overflow-x-auto gap-2 items-center pt-2"},oM={key:0,class:"flex gap-2 items-end"},nM={class:"text-xs"},lM={class:"text-xs"},iM={class:"flex items-end"},ao=oe({__name:"WorkspaceMessageInput",props:{initialText:{},isUsingPreviewAgent:{type:Boolean}},emits:["handle-message"],setup(n,{expose:l,emit:a}){const c=ne(()=>Pa-X.value.length<=2),r=v(!1),p=Ce(),{t:m}=We(p.t),{toast:g}=gt(),h=a,_=n,x=at(),{isMobileSize:b}=ie(x),S=v(null),D=le=>{S.value&&(X.value=le,S.value.setValue(le))};l({setValue:D}),Te(()=>_.initialText,le=>{le!==void 0&&(X.value=le)});const y=()=>{r.value=!1},I=is(),{currentAgent:C}=ie(I),U=Js(),{selectedFiles:E,readyFiles:N,attachments:$,embedFailedFiles:R,contextFiles:B,uploadingFileCount:j}=ie(U),ee=Ms(),{currentConversation:se,generatingResponse:G,currentParentMessageId:J,currentModel:H,shouldLeaveWhiteSpace:M,hints:W}=ie(ee),X=v(""),O=tt(),K=ne(()=>O.name==="agent-chat-home"||O.name==="agent-chat"||O.name==="create-agent"),V=ne(()=>{var le;return{attachments:$.value.map(te=>({file_id:te.fileId})),agent_id:(le=C.value)==null?void 0:le.id}}),F=ne(()=>E.value.length>0||B.value.length===0&&X.value.trim()===""?!1:!G.value),P=async()=>{var le,te,Z;M.value=!0,W.value=[];try{if(F.value&&!r.value){h("handle-message",X.value),se.value.agentId=V.value.agent_id;const re=X.value.trim();X.value="",j.value=0,E.value=[],B.value=[],U.changeToMetaData(),ee.addMessage(re,"USER","user_temp",N.value),N.value=[],await ee.generateAIResponse(O.params.id,re,(le=C.value)!=null&&le.modelId||(te=H.value)==null?void 0:te.modelId,J.value||null,(Z=se.value)==null?void 0:Z.id,V.value)}}catch(re){console.error(re),g({title:m("home.toast.fail.generalErrorTitle"),description:m("home.toast.fail.generalError"),variant:"destructive"})}},q=le=>{b.value||(le.preventDefault(),P())};Te(()=>X.value,le=>{D(le)});const A=(le,te)=>{if(le.length===0)return;const Z=le.map(ue=>ue.name).join(", "),re=le.length===1?m("home.toast.fail.uploadFileFailSingle",{fileName:Z}):m("home.toast.fail.uploadFileFailPlural",{fileName:Z});g({title:m(te),description:re,variant:"destructive"})},k=v(null),L=()=>{k.value&&k.value.click()},z=v(null),Q=()=>{z.value&&z.value.click()},ae=async le=>{if(_.isUsingPreviewAgent)return;const te=le.clipboardData;if(!te||te.types.includes("text/plain"))return;const re=te.items;if(U.wouldExceedUploadFileLimit(re.length)){g({title:m("home.toast.fail.generalErrorTitle"),description:m("home.toast.fail.exceedLimitNumberOfFile",{maxFilesPerMessage:Ha,maxFilesPerConversation:Ka}),variant:"destructive"}),z.value.value="";return}const ue=Array.from(re).flatMap(he=>{const $e=he.getAsFile();return $e?[U.handleSingleFileUpload($e)]:[]});j.value+=ue.filter(he=>he.isValidExtension&&he.isValidSize).length,A(ue.flatMap(he=>he.isValidExtension?[]:[he.file]),"home.toast.fail.fileExtensionInvalid"),A(ue.flatMap(he=>he.isValidSize?[]:[he.file]),"home.toast.fail.fileSizeInvalid"),z.value.value="";try{await U.uploadSelectedFiles(O.params.id)}catch(he){console.error(he),g({title:m("home.toast.fail.generalErrorTitle"),description:m("home.toast.fail.generalError"),variant:"destructive"})}},de=async le=>{const te=le.target;if(Et(()=>{D(X.value)}),!te.files)return;const Z=Array.from(te.files);if(U.wouldExceedUploadFileLimit(Z.length)){g({title:m("home.toast.fail.generalErrorTitle"),description:m("home.toast.fail.exceedLimitNumberOfFile",{maxFilesPerMessage:Ha,maxFilesPerConversation:Ka}),variant:"destructive"}),k.value.value="",z.value.value="";return}const re=Z.map(U.handleSingleFileUpload);j.value+=re.filter(ue=>ue.isValidExtension&&ue.isValidSize).length,A(re.flatMap(ue=>ue.isValidExtension?[]:[ue.file]),"home.toast.fail.fileExtensionInvalid"),A(re.flatMap(ue=>ue.isValidSize?[]:[ue.file]),"home.toast.fail.fileSizeInvalid"),k.value.value="",z.value.value="";try{await U.uploadSelectedFiles(O.params.id)}catch(ue){console.error(ue),g({title:m("home.toast.fail.generalErrorTitle"),description:m("home.toast.fail.generalError"),variant:"destructive"})}};return Te(()=>R.value.length,le=>{if(le>0){const te=R.value.map(re=>re.file.name).join(", "),Z=R.value.length===1?m("home.toast.fail.uploadFileFailSingle",{fileName:te}):m("home.toast.fail.uploadFileFailPlural",{fileName:te});g({title:m("home.toast.fail.generalErrorTitle"),description:Z,variant:"destructive"})}R.value.splice(0,le)}),Te(()=>O.path,()=>{U.clearState(),X.value=""},{immediate:!0}),(le,te)=>{const Z=f("Textarea"),re=f("Button");return s(),u("div",tM,[t("div",sM,[t("div",aM,[(s(!0),u(ve,null,Le(e(E),(ue,he)=>(s(),u("div",{key:he,class:"p-2 shrink-0"},[(s(),T(so,{file:ue.file,fileUrl:ue.fileUrl,fileName:ue.file.name,deleteButton:!0,isProcessing:ue.isProcessing,key:he},null,8,["file","fileUrl","fileName","isProcessing"]))]))),128)),(s(!0),u(ve,null,Le(e(B),(ue,he)=>(s(),u("div",{key:he},[(s(),T(so,{fileName:ue.fileName,fileId:ue.id,deleteButton:!0,readyIcon:!0,isProcessing:!1,key:he},null,8,["fileName","fileId"]))]))),128)),te[4]||(te[4]=t("div",null,null,-1))]),K.value?Ke((s(),T(Z,{key:0,ref_key:"textareaRef",ref:S,rows:"1",maxLength:e(Pa),modelValue:X.value,"onUpdate:modelValue":te[0]||(te[0]=ue=>X.value=ue),onKeydown:yt(Ye(q,["exact"]),["enter"]),onCompositionstart:te[1]||(te[1]=ue=>r.value=!0),onCompositionend:y,onPaste:ae,id:"message",placeholder:e(C)?e(C).name+" "+e(m)("home.chat.label.agentChatPlaceholder"):e(m)("home.chat.label.chatPlaceholder"),class:"flex flex-col items-center h-full w-full grow rounded-md border-input bg-transparent p-2 mx-3 mb-3 mt-1 ring-offset-background placeholder:text-muted-foreground focus-visible:outline-hidden focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 border-0 resize-none max-h-52 text-sm"},null,8,["maxLength","modelValue","onKeydown","placeholder"])),[[e(Jt),!_.isUsingPreviewAgent]]):Ke((s(),T(Z,{key:1,ref_key:"textareaRef",ref:S,rows:"1",maxLength:e(Pa),modelValue:X.value,"onUpdate:modelValue":te[2]||(te[2]=ue=>X.value=ue),onKeydown:yt(Ye(q,["exact"]),["enter"]),onCompositionstart:te[3]||(te[3]=ue=>r.value=!0),onCompositionend:y,onPaste:ae,id:"message",placeholder:e(m)("home.chat.label.chatPlaceholder"),class:"flex flex-col items-center h-full w-full grow rounded-md border-input bg-transparent p-2 mx-3 mb-3 mt-1 ring-offset-background placeholder:text-muted-foreground focus-visible:outline-hidden focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 border-0 resize-none max-h-52 text-sm"},null,8,["maxLength","modelValue","onKeydown","placeholder"])),[[e(Jt),!0]])]),t("div",{class:pe([_.isUsingPreviewAgent?"justify-end":"justify-between","flex items-center"])},[_.isUsingPreviewAgent?w("",!0):(s(),u("div",oM,[o(Pe,{icon:"bi bi-paperclip text-xl text-stone-600 dark:text-white dark:hover:text-stone-200",className:"outline rounded-full flex gap-0.5",size:"default",onClick:L},{default:i(()=>[t("span",nM,d(e(m)("home.chat.tooltip.uploadFile")),1)]),_:1}),t("input",{id:"chat-file-input",type:"file",class:"hidden",ref_key:"fileInput",ref:k,onChange:de,accept:".pdf,.txt,.md,.pptx,.xlsx,.csv,.docx",multiple:""},null,544),o(Pe,{icon:"bi bi-images text-xl text-stone-600 dark:text-white dark:hover:text-stone-200",className:"outline rounded-full flex gap-2",size:"default",onClick:Q},{default:i(()=>[t("span",lM,d(e(m)("home.chat.tooltip.uploadImage")),1)]),_:1}),t("input",{id:"chat-image-input",type:"file",class:"hidden",ref_key:"imageInput",ref:z,onChange:de,accept:".png, .jpg, .jpeg",multiple:""},null,544)])),t("div",iM,[t("span",{class:pe(["text-xs mb-2 self-end px-3 max-sm:hidden",[c.value?"text-red-400 font-semibold":"text-stone-400"]])},d(e(m)("home.chat.message.maxLengthCharacters",{inputLength:X.value.length,maxLength:e(Pa)})),3),o(re,{size:"icon",onClick:P,disabled:!F.value},{default:i(()=>[t("i",{class:pe([e(G)?"bi text-2xl bi-arrow-repeat animate-spin":"bi text-2xl bi-arrow-up-short",F.value?"opacity-100":"opacity-50"])},null,2)]),_:1},8,["disabled"])])],2)])}}}),rM={key:0,class:"relative flex w-full h-dvh"},cM={class:"mx-auto flex flex-col h-full sm:px-6 md:px-8 lg:px-10 xl:px-12 w-full sm:max-w-md md:max-w-lg lg:max-w-xl xl:max-w-2xl"},dM={class:"flex justify-center items-center gap-2 opacity-50"},uM={class:"text-xs text-center"},pM={class:"flex flex-col flex-1 justify-center items-center w-full"},mM={class:"inline-block w-full max-w-xs sm:max-w-sm md:max-w-md lg:max-w-lg xl:max-w-xl text-wrap break-words text-center mb-8 font-bold text-2xl border-r-2 border-transparent overflow-hidden animate-typing"},gM={class:"w-full"},fM={key:1,class:"flex w-full h-full"},vM={class:"flex flex-col h-dvh w-full"},hM={class:"mx-auto flex flex-col w-full h-full justify-center gap-4 text-base md:gap-5 lg:gap-6 md:max-w-lg lg:max-w-160 xl:max-w-3xl px-5"},_M={class:"flex flex-col justify-center items-center"},bM={class:"inline-block whitespace-nowrap mb-8 font-bold text-2xl border-r-2 border-transparent overflow-hidden w-min text-center animate-typing"},kM={class:"w-full"},yM={class:"text-xs text-center opacity-50"},xM=oe({__name:"WorkspaceHomeView",setup(n){const l=Ms(),{currentConversation:a}=ie(l),c=at(),{isMobileSize:r}=ie(c),{t:p}=Ce(),m=ot(),g=tt(),h=v(null),_=()=>{l.unshiftConversation(""),m.push({path:`/workspace/${g.params.id}/chat/`});const x=Te(()=>{var b;return(b=a.value)==null?void 0:b.id},b=>{b&&b!==""&&(m.replace({path:`/workspace/${g.params.id}/chat/${b}`}),x())})};return(x,b)=>e(r)?(s(),u("div",rM,[t("div",cM,[t("div",dM,[b[0]||(b[0]=t("i",{class:"bi bi-exclamation-circle text-xs"},null,-1)),t("p",uM,d(e(p)("home.chat.label.description",{ai:"PrivateGPT"})),1)]),t("div",pM,[t("p",mM,d(e(p)("home.chat.label.greeting")),1),b[1]||(b[1]=t("div",{class:"flex flex-wrap justify-center gap-2 mb-4 md:mb-0 max-w-xs sm:max-w-sm md:max-w-md"},null,-1))]),t("div",gM,[o(ao,{ref_key:"messageInputRef",ref:h,onHandleMessage:_},null,512)])])])):(s(),u("div",fM,[t("div",vM,[t("div",hM,[t("div",_M,[t("p",bM,d(e(p)("home.chat.label.greeting")),1),t("div",kM,[o(ao,{ref_key:"messageInputRef",ref:h,onHandleMessage:_},null,512),t("p",yM,d(e(p)("home.chat.label.description",{ai:"PrivateGPT"})),1)])])])])]))}}),wM=Vs(xM,[["__scopeId","data-v-eac96229"]]),$M={class:"flex items-center gap-4 overflow-hidden justify-center w-full md:justify-start"},SM={class:"text-lg font-bold pr-1 truncate max-w-36 sm:max-w-lg"},TM={class:"flex w-64 items-center justify-between cursor-pointer"},AM={class:"flex flex-col"},CM={class:"text-xs opacity-80"},DM={class:"flex"},LM={class:"bi bi-check2"},IM=oe({__name:"SelectModelDropdown",setup(n){const l=Ms(),{currentModel:a,supportModels:c}=ie(l),r=at(),{isMobileSize:p}=ie(r),m=g=>{a.value=g};return(g,h)=>{const _=f("Button"),x=f("DropdownMenuTrigger"),b=f("DropdownMenuItem"),S=f("DropdownMenuContent"),D=f("DropdownMenu");return s(),u("div",$M,[o(D,null,{default:i(()=>[o(x,null,{default:i(()=>[o(_,{variant:"ghost",size:"full"},{default:i(()=>{var y;return[t("div",SM,d((y=e(a))==null?void 0:y.displayName),1),h[0]||(h[0]=t("i",{class:"bi bi-chevron-down pt-1"},null,-1))]}),_:1,__:[0]})]),_:1}),o(S,{align:e(p)?"center":"start"},{default:i(()=>[(s(!0),u(ve,null,Le(e(c),y=>(s(),u("div",{key:y.modelId},[o(b,{onClick:I=>m(y)},{default:i(()=>{var I;return[t("div",TM,[t("div",AM,[t("p",null,d(y.displayName),1),t("p",CM,d(y.description),1)]),t("div",DM,[Ke(t("i",LM,null,512),[[es,((I=e(a))==null?void 0:I.modelId)===y.modelId]])])])]}),_:2},1032,["onClick"])]))),128))]),_:1},8,["align"])]),_:1})])}}}),BM={class:"flex items-center px-3 gap-4 overflow-hidden justify-center w-full md:justify-start"},MM={class:"text-lg font-bold pr-1 truncate max-w-36 sm:max-w-64"},EM={key:0,class:"bi bi-chevron-down pt-1"},RM=oe({__name:"SelectAgentDropdown",setup(n){const l=is(),{currentAgent:a,currentAgentId:c}=ie(l),r=ot(),p=tt(),{toast:m}=gt(),g=Ce(),{t:h}=We(g.t),_=S=>{r.push(`/workspace/${p.params.id}/agent/${S}`)},x=async S=>{c.value=S,r.push(`/workspace/${p.params.id}/agents/editor/${S}`)},b=async()=>{try{const{origin:S}=window.location,D=String(p.params.id),y=String(p.params.agentId),I=`/workspace/${D}/agent/${y}`;await navigator.clipboard.writeText(`${S}${I}`),m({title:h("home.toast.success.linkCopy")})}catch(S){console.error(S),m({title:h("home.toast.fail.generalErrorTitle"),description:h("home.toast.fail.generalError"),variant:"destructive"})}};return(S,D)=>{const y=f("Button"),I=f("DropdownMenuTrigger"),C=f("DropdownMenuItem"),U=f("DropdownMenuContent"),E=f("DropdownMenu");return s(),u("div",BM,[o(E,null,{default:i(()=>[o(I,null,{default:i(()=>[o(y,{variant:"ghost",size:"full",class:pe({"cursor-default":!e(a)})},{default:i(()=>{var N;return[t("div",MM,d(e(a)?(N=e(a))==null?void 0:N.name:e(h)("home.chat.label.unknownAgent")),1),e(a)?(s(),u("i",EM)):w("",!0)]}),_:1},8,["class"])]),_:1}),e(a)?(s(),T(U,{key:0},{default:i(()=>[o(C,{class:"cursor-pointer",onClick:D[0]||(D[0]=N=>_(e(a).id))},{default:i(()=>[D[2]||(D[2]=t("i",{class:"bi bi-pencil-square"},null,-1)),t("span",null,d(e(h)("home.chat.agentDropdown.newChat")),1)]),_:1,__:[2]}),o(C,{class:"cursor-pointer",onClick:D[1]||(D[1]=N=>x(e(a).id))},{default:i(()=>{var N;return[((N=e(a).currentUserInfo)==null?void 0:N.id)===e(a).owner.id?(s(),u(ve,{key:0},[D[3]||(D[3]=t("i",{class:"bi bi-gear"},null,-1)),t("span",null,d(e(h)("home.chat.agentDropdown.editAgent")),1)],64)):(s(),u(ve,{key:1},[D[4]||(D[4]=t("i",{class:"bi bi-eye"},null,-1)),t("span",null,d(e(h)("home.chat.agentDropdown.viewAgent")),1)],64))]}),_:1}),o(C,{class:"cursor-pointer",onClick:b},{default:i(()=>[D[5]||(D[5]=t("i",{class:"bi bi-link"},null,-1)),t("span",null,d(e(h)("home.chat.agentDropdown.copyLink")),1)]),_:1,__:[5]})]),_:1})):w("",!0)]),_:1})])}}}),FM={class:"p-3 flex items-center"},PM={class:"sm:hidden flex items-center"},NM={key:0},zM={class:"w-full flex items-center justify-between"},UM={key:0,class:"flex items-center"},OM={class:"text-sm"},jM={class:"opacity-80 truncate line-clamp-1 max-w-96 flex-1"},VM={key:0,class:"bi bi-circle text-green-400"},GM={key:2},WM={class:"hidden sm:flex items-center gap-3"},HM={key:1,class:"bi bi-pin-angle mr-2"},KM={key:1,class:"bi bi-eye-slash mr-2"},qM={key:0,class:"bi bi-plus-lg mr-2"},QM={key:1,class:"bi bi-eye mr-2"},JM={class:"sm:hidden"},Vi=oe({__name:"WorkspaceAppTopbar",props:{isWorkspaceGroupRoute:{type:Boolean}},setup(n){const l=Ce(),{t:a}=We(l.t),{toast:c}=gt(),r=tt(),p=ot(),m=n,g=as(),{workspaceList:h,currentWorkspace:_}=ie(g),x=xt(),{mobileSidebarState:b,privateGPTSidebarState:S}=ie(x),{toggleVisibleState:D}=x,y=is(),{currentAgent:I,pinnedAgents:C}=ie(y),{pinAgent:U,unpinAgent:E}=y,N=at(),{isMobileSize:$}=ie(N),R=Ms(),{fetchSupportModels:B}=R,j=Js(),{clearState:ee}=j,se=v(""),G=()=>{p.push({name:"workspace-home",params:{id:r.params.id}})},J=()=>{p.push({name:"workspace-mine-agents",params:{id:r.params.id}})},H=()=>{p.push({name:"workspace-create-edit-agents",params:{id:r.params.id,agentId:r.params.agentId}})},M=ne(()=>!!r.path.match(/workspace\/group/i)),W=ne(()=>!!r.path.match(/agents/i)),X=ne(()=>r.name==="workspace-agent-chat-home"||r.name==="workspace-agent-chat"),O=ne(()=>!!r.path.match(/agents\/mine/i)),K=Q=>{switch(r.name){case"workspace-chat":p.push({name:"workspace-home",params:{id:Q}});break;case"workspace-knowledge":p.push({name:"workspace-knowledge",params:{id:Q}});break;case"workspace-agents":p.push({name:"workspace-agents",params:{id:Q}});break;case"workspace-members":p.push({name:"workspace-members",params:{id:Q}});break;case"workspace-settings":p.push({name:"workspace-settings",params:{id:Q}});break;case"workspace-mine-agents":p.push({name:"workspace-mine-agents",params:{id:Q}});break;default:p.push({name:"workspace-home",params:{id:Q}});break}};Te([se,_],([Q,ae],[de,le])=>{if(Q!==de&&de){if(Q==="group"){F();return}K(Q)}ae!==le&&(se.value=(ae==null?void 0:ae.id)??"")}),Dt(async()=>{await B(r.params.id)});const V=()=>{D(b),D(S)},F=()=>p.push({name:"workspace-members",params:{id:r.params.id}}),P=()=>{ee();const Q=r.name;Q==="workspace-agent-chat"||Q==="workspace-agent-chat-home"?p.push(`/workspace/${r.params.id}/agent/${r.params.agentId}`):p.push(`/workspace/${r.params.id}`)},q=ne(()=>["workspace-home","workspace-chat","workspace-agent-chat-home","workspace-agent-chat"].includes(r.name)),A=v(!1),k=ne(()=>Array.isArray(C.value)&&C.value.some(Q=>{var ae;return Q.id===((ae=I.value)==null?void 0:ae.id)})),L=async()=>{try{A.value=!0,I.value&&(await U(r.params.id,r.params.agentId),c({title:a("workspace.toast.pinAgent")}))}catch(Q){console.error(Q),c({title:a("workspace.toast.fail.generalErrorTitle"),description:a("workspace.toast.fail.pinAgent"),variant:"destructive"})}finally{A.value=!1}},z=async()=>{try{A.value=!0,I.value&&(await E(r.params.id,r.params.agentId),c({title:a("workspace.toast.unpinAgent")}))}catch(Q){console.log(Q),c({title:a("workspace.toast.fail.generalErrorTitle"),description:a("workspace.toast.fail.unpinAgent"),variant:"destructive"})}finally{A.value=!1}};return(Q,ae)=>{var ye,_e;const de=f("Button"),le=f("TooltipTrigger"),te=f("TooltipContent"),Z=f("Tooltip"),re=f("TooltipProvider"),ue=f("SelectValue"),he=f("SelectTrigger"),$e=f("SelectLabel"),Se=f("SelectItemText"),be=f("SelectItem"),Ge=f("SelectGroup"),fe=f("Separator"),Y=f("SelectContent"),ce=f("Select"),ge=f("Loader");return s(),u("div",FM,[t("div",PM,[o(re,null,{default:i(()=>[o(Z,null,{default:i(()=>[o(le,{"as-child":""},{default:i(()=>[o(de,{variant:"ghost",size:"icon",onClick:V},{default:i(()=>ae[1]||(ae[1]=[t("i",{class:"bi bi-list"},null,-1)])),_:1,__:[1]})]),_:1}),o(te,{side:"right"},{default:i(()=>[t("p",null,d(e(a)("home.mainSidebar.tooltip.openSidebar")),1)]),_:1})]),_:1})]),_:1})]),m.isWorkspaceGroupRoute?(s(),T(de,{key:0,onClick:G,class:pe([e($)?"bg-none":"dark:bg-black dark:hover:bg-stone-800 rounded-md gap-1 px-4 mr-4 shadow-sm","w-fit"]),variant:"ghost"},{default:i(()=>[ae[2]||(ae[2]=t("i",{class:"bi bi-chevron-left"},null,-1)),e($)?w("",!0):(s(),u("span",NM,d(e(a)("group.button.backToChat")),1))]),_:1,__:[2]},8,["class"])):w("",!0),t("div",zM,[M.value&&!e($)?(s(),u("div",UM,[t("p",OM,d(e(a)("workspace.appTopbar.group.label.currentWorkspace")),1),ae[5]||(ae[5]=t("i",{class:"bi bi-chevron-right mx-2"},null,-1)),t("div",null,[o(ce,{modelValue:se.value,"onUpdate:modelValue":ae[0]||(ae[0]=Re=>se.value=Re),class:"w-full"},{default:i(()=>[o(he,{class:"flex flex-row justify-between border-none gap-2 shadow-sm"},{default:i(()=>[o(ue,{placeholder:e(a)("workspace.appTopbar.group.selectWorkspace.placeholder")},null,8,["placeholder"]),ae[3]||(ae[3]=t("i",{class:"bi bi-chevron-expand"},null,-1))]),_:1,__:[3]}),o(Y,null,{default:i(()=>[o(Ge,{class:"p-0 m-0"},{default:i(()=>[o($e,{class:"px-3"},{default:i(()=>[me(d(e(a)("workspace.selectWorkspaceDialog.workspace")),1)]),_:1}),(s(!0),u(ve,null,Le(e(h),Re=>(s(),T(be,{key:Re.id,value:Re.id,class:"p-3 my-1"},{default:i(()=>[o(Se,null,{default:i(()=>[t("span",jM,d(Re.name),1)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1}),o(fe),o(Ge,{class:"p-0 m-0"},{default:i(()=>[o(be,{disabled:M.value,value:"group",class:"flex justify-between p-3 mt-1"},{default:i(()=>[t("div",null,[ae[4]||(ae[4]=t("i",{class:"bi bi-buildings mr-2"},null,-1)),t("span",null,d(e(a)("workspace.appTopbar.group.manageWorkspace")),1)]),M.value?(s(),u("i",VM)):w("",!0)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])])):w("",!0),M.value?w("",!0):(s(),u(ve,{key:1},[e(r).name==="workspace-chat"||e(r).name==="workspace-home"?(s(),T(IM,{key:0})):e(r).name==="workspace-agent-chat"||e(r).name==="workspace-agent-chat-home"?(s(),T(RM,{key:1})):(s(),u("div",GM))],64)),t("div",WM,[!k.value&&((ye=e(I))==null?void 0:ye.status)==="PUBLISH"?(s(),T(de,{key:0,variant:"outline",onClick:L},{default:i(()=>[A.value?(s(),T(ge,{key:0,class:"w-4 h-4 animate-spin mr-2"})):(s(),u("i",HM)),t("span",null,d(e(a)("home.chat.agentDropdown.pinAgent")),1)]),_:1})):k.value&&((_e=e(I))==null?void 0:_e.status)==="PUBLISH"?(s(),T(de,{key:1,variant:"outline",onClick:z},{default:i(()=>[A.value?(s(),T(ge,{key:0,class:"w-4 h-4 animate-spin mr-2"})):(s(),u("i",KM)),t("span",null,d(e(a)("home.chat.agentDropdown.unpinAgent")),1)]),_:1})):w("",!0),W.value&&!O.value?(s(),T(de,{key:2,onClick:J},{default:i(()=>[t("span",null,d(e(a)("home.myAgent.label.title")),1)]),_:1})):w("",!0),e(I)&&(W.value||X.value)&&!O.value?(s(),T(de,{key:3,onClick:H,class:"pr-5"},{default:i(()=>[X.value?(s(),u("i",QM)):(s(),u("i",qM)),me(" "+d(X.value?e(a)("workspace.createEditAgent.dialog.button.label.createEditAgent"):e(a)("home.myAgent.button.createAgent")),1)]),_:1})):w("",!0),o(uo),o(ln)]),t("div",JM,[!e(S)&&q.value?(s(),T(re,{key:0},{default:i(()=>[o(Z,null,{default:i(()=>[o(le,{"as-child":""},{default:i(()=>[o(de,{variant:"ghost",size:"icon",onClick:P},{default:i(()=>ae[6]||(ae[6]=[t("i",{class:"bi bi-pencil-square"},null,-1)])),_:1,__:[6]})]),_:1}),o(te,{side:"right"},{default:i(()=>[t("p",null,d(e(a)("home.mainSidebar.tooltip.newChat")),1)]),_:1})]),_:1})]),_:1})):w("",!0)])])])}}}),XM={class:"mb-2"},YM={class:"flex gap-2 overflow-hidden"},ZM={class:"opacity-80 truncate line-clamp-1 max-w-96 flex-1"},e8=["textContent"],t8={class:"truncate max-w-36 text-xs"},s8={class:"text-xs"},a8={class:"text-xs"},o8={class:"text-xs"},n8=["onClick"],l8={class:"flex gap-2 items-center min-w-0"},i8={class:"truncate w-full text-xs"},r8={class:"w-fit text-xs"},Po=10,dl=oe({__name:"WorkspaceSubSidebar",setup(n){const{toast:l}=gt(),{t:a}=We(Ce().t),c=tt(),r=ot(),p=xt(),{setIgnore:m}=p,{privateGPTSidebarState:g}=ie(p),h=at(),{isMobileSize:_}=ie(h),x=as(),{workspaceList:b,currentWorkspace:S}=ie(x),D=is(),{pinnedAgents:y}=ie(D),{getPinnedAgents:I,unpinAgent:C}=D,U=v(""),E=Ms(),{conversations:N,currentOffset:$,totalConversations:R,generatingResponse:B,hasMore:j,shouldLeaveWhiteSpace:ee}=ie(E),se=ne(()=>N.value.map(z=>({id:z.id??"",name:z.conversationName,updatedAt:z.updatedAt,link:z.agentId?`/workspace/${c.params.id}/agent/${z.agentId}/chat/${z.id}`:`/workspace/${c.params.id}/chat/${z.id}`}))),G=Bt("contentContainer"),J=v();Te(()=>Ht.global.locale,z=>{J.value=z.replace("_","-")});const H=z=>{switch(z){case"knowledge-base":r.push({name:"workspace-knowledge"});break;case"agents":r.push({name:"workspace-agents"});break;case"create-agent":r.push({name:"workspace-create-edit-agents"});break;default:r.push({name:"workspace-home"});break}q()},M=ne(()=>c.name==="workspace-knowledge"),W=ne(()=>c.name==="workspace-agents"),X=()=>r.push({name:"workspace-members",params:{id:c.params.id}}),O=z=>{switch(c.name){case"workspace-chat":r.push({name:"workspace-home",params:{id:z}});break;case"workspace-knowledge":r.push({name:"workspace-knowledge",params:{id:z}});break;case"workspace-agents":r.push({name:"workspace-agents",params:{id:z}});break;case"workspace-members":r.push({name:"workspace-members",params:{id:z}});break;case"workspace-settings":r.push({name:"workspace-settings",params:{id:z}});break;case"workspace-mine-agents":r.push({name:"workspace-mine-agents",params:{id:z}});break;default:r.push({name:"workspace-home",params:{id:z}});break}};Te([U,S],async([z,Q],[ae,de])=>{if(z!==ae&&ae){if(z==="group"){X();return}O(z)}Q!==de&&(U.value=(Q==null?void 0:Q.id)??"")});const K=v(!1);Te(()=>c.params.id,async z=>{if(z)try{J.value=Ht.global.locale.replace("_","-"),$.value=0,N.value=[],K.value=!0,await E.fetchConversations(z,$.value,28),$.value+=28}catch(Q){console.error(Q),l({title:a("home.toast.fail.generalErrorTitle"),description:a("home.toast.fail.generalError"),variant:"destructive"})}finally{K.value=!1}},{immediate:!0});const V=async()=>{if(!(K.value||!j.value||$.value>R.value)){K.value=!0;try{const z=await E.fetchConversations(c.params.id,$.value,Po);z&&z.length<Po&&(j.value=!1),$.value+=Po}catch(z){console.error("Error loading more data, ",z)}finally{K.value=!1}}},F=async(z,Q)=>{try{await E.editConversationTitle(c.params.id,z,Q)}catch(ae){console.error(ae),l({title:a("home.subSidebar.toast.fail.renameConversation"),variant:"destructive"})}},P=async z=>{try{await E.deleteConversation(c.params.id,z),l({title:a("home.toast.success.deleteConversation"),description:a("home.toast.success.deleteConversationDescription")}),r.replace(`/workspace/${c.params.id}`)}catch(Q){console.error(Q),l({title:a("home.toast.fail.generalErrorTitle"),description:a("home.toast.fail.generalError"),variant:"destructive"})}},q=()=>{_.value&&p.privateGPTSidebarState&&p.toggleVisibleState(g)};Te(()=>B.value,()=>{var z;(z=G.value)==null||z.scrollToTop()});const A=async z=>{try{await I(z)}catch(Q){l({title:a("workspace.toast.fail.generalErrorTitle"),description:a("workspace.toast.fail.getPinnedAgents"),variant:"destructive"}),console.error(Q)}},k=async z=>{r.push(`/workspace/${c.params.id}/agent/${z}`),ee.value=!1,q()},L=async(z,Q)=>{try{await C(z,Q),l({title:a("workspace.toast.unpinAgent"),variant:"default"})}catch(ae){l({title:a("workspace.toast.fail.generalErrorTitle"),description:a("workspace.toast.fail.unpinAgent"),variant:"destructive"}),console.error(ae)}};return Te(()=>c.params.id,async z=>{z&&await A(z)},{immediate:!0}),(z,Q)=>{const ae=f("SelectValue"),de=f("SelectTrigger"),le=f("SelectLabel"),te=f("SelectItemText"),Z=f("SelectItem"),re=f("SelectGroup"),ue=f("Separator"),he=f("SelectContent"),$e=f("Select"),Se=f("Button");return s(),T(Ia,{loading:K.value,items:se.value,"has-more-items":e(j),"active-item-id":e(c).params.chatId??"",onEditItem:F,onDeleteItem:P,onArrivedBottom:V,ref_key:"contentContainer",ref:G},{stickyHeader:i(()=>[t("div",XM,[o($e,{modelValue:U.value,"onUpdate:modelValue":Q[0]||(Q[0]=be=>U.value=be)},{default:i(()=>[o(de,{class:"flex flex-row justify-between border-none gap-2 shadow-sm"},{default:i(()=>[t("div",YM,[Q[6]||(Q[6]=t("i",{class:"bi bi-buildings"},null,-1)),o(ae,{placeholder:e(a)("workspace.appTopbar.group.selectWorkspace.placeholder"),class:"line-clamp-1"},null,8,["placeholder"])]),Q[7]||(Q[7]=t("i",{class:"bi bi-chevron-expand"},null,-1))]),_:1,__:[7]}),o(he,null,{default:i(()=>[o(re,{class:"p-0 m-0"},{default:i(()=>[o(le,{class:"px-3"},{default:i(()=>[me(d(e(a)("workspace.selectWorkspaceDialog.workspace")),1)]),_:1}),(s(!0),u(ve,null,Le(e(b),be=>(s(),T(Z,{key:be.id,value:be.id,class:"p-3 my-1"},{default:i(()=>[o(te,null,{default:i(()=>[t("span",ZM,d(be.name),1)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1}),o(ue),o(re,{class:"p-0 m-0"},{default:i(()=>[o(Z,{value:"group",class:"flex justify-between p-3 mt-1"},{default:i(()=>[t("div",null,[Q[8]||(Q[8]=t("i",{class:"bi bi-buildings mr-2"},null,-1)),t("span",{textContent:d(e(a)("workspace.appTopbar.group.manageWorkspace"))},null,8,e8)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),t("div",{onClick:Q[1]||(Q[1]=be=>H()),class:"hidden sm:flex w-full items-center gap-1 justify-start p-1.5 rounded-md hover:bg-stone-200 dark:hover:bg-stone-700 cursor-pointer"},[Q[9]||(Q[9]=t("div",{class:"rounded-full h-7 w-7 flex justify-center items-center"},[t("i",{class:"bi bi-pencil-square"})],-1)),t("div",t8,d(e(a)("home.subSidebar.tooltip.newChat")),1)])]),subNavList:i(()=>[o(Se,{variant:"ghost",class:pe([M.value?"bg-stone-200 dark:bg-stone-600":"","w-full flex items-center gap-1 justify-start p-1.5 rounded-md hover:bg-stone-200 dark:hover:bg-stone-600 mb-1"]),onClick:Q[2]||(Q[2]=be=>H("knowledge-base"))},{default:i(()=>[Q[10]||(Q[10]=t("div",{class:"rounded-full h-6 w-6 -ml-1 sm:ml-0 sm:h-7 sm:w-7 flex justify-center items-center"},[t("i",{class:"bi bi-files text-lg"})],-1)),t("span",s8,d(e(a)("workspace.subSidebar.tabs.knowledgeBase")),1)]),_:1,__:[10]},8,["class"]),o(Se,{variant:"ghost",class:"w-full flex items-center gap-1 justify-start p-1.5 rounded-md hover:bg-stone-200 dark:hover:bg-stone-600 mb-1",onClick:Q[3]||(Q[3]=be=>H("create-agent"))},{default:i(()=>[Q[11]||(Q[11]=t("div",{class:"rounded-full h-6 w-6 -ml-1 sm:ml-0 sm:h-7 sm:w-7 flex justify-center items-center"},[t("i",{class:"bi bi-plus-lg text-lg"})],-1)),t("span",a8,d(e(a)("home.myAgent.button.createAgent")),1)]),_:1,__:[11]}),o(Se,{variant:"ghost",class:pe([W.value?"bg-stone-200 dark:bg-stone-600":"","w-full flex items-center gap-1 justify-start p-1.5 rounded-md hover:bg-stone-200 dark:hover:bg-stone-600 cursor-pointer mb-1"]),onClick:Q[4]||(Q[4]=be=>H("agents"))},{default:i(()=>[Q[12]||(Q[12]=t("div",{class:"rounded-full h-6 w-6 -ml-1 sm:ml-0 sm:h-7 sm:w-7 flex justify-center items-center"},[t("i",{class:"bi bi-grid text-lg"})],-1)),t("span",o8,d(e(a)("workspace.subSidebar.tabs.searchAgents")),1)]),_:1,__:[12]},8,["class"]),(s(!0),u(ve,null,Le(e(y),(be,Ge)=>(s(),u("div",{key:Ge,class:"flex group items-center py-1.5 pl-1.5 xl:pl-2.5 rounded-md w-full cursor-pointer hover:bg-stone-200 dark:hover:bg-stone-700 justify-between",size:"full",onClick:fe=>k(be.id)},[t("div",l8,[o(wt,{fallbackText:be.name,size:e(_)?"xxs":"xs",class:"xl:-ml-1"},null,8,["fallbackText","size"]),o(Aa,null,{trigger:i(()=>[t("span",i8,d(be.name),1)]),content:i(()=>[t("span",r8,d(be.name),1)]),_:2},1024)]),t("div",{onClick:Q[5]||(Q[5]=Ye(()=>{},["stop"]))},[o(na,{buttonVariant:"ghost",icon:"bi bi-three-dots",size:"mdicon",buttonClass:["transition-opacity duration-300 hover:bg-transparent","sm:group-hover:opacity-100",e(_)?"opacity-100":"opacity-0"].join(" "),items:[{id:be.id,disabled:!1}],itemKey:"id",onOnTrigger:e(m),onOnSelect:fe=>L(e(c).params.id,be.id)},{item:i(()=>[Q[13]||(Q[13]=t("i",{class:"bi bi-eye-slash"},null,-1)),t("span",null,d(e(a)("home.subSidebar.button.unpinAgent")),1)]),_:2},1032,["buttonClass","items","onOnTrigger","onOnSelect"])])],8,n8))),128))]),_:1},8,["loading","items","has-more-items","active-item-id"])}}}),c8=oe({__name:"WorkspaceView",setup(n){const l=as(),{getAllWorkspaces:a,getCurrentWorkspace:c}=l,{isSelectWorkspaceDialogOpen:r,currentWorkspace:p,workspaceList:m}=ie(l),g=Js(),{selectedFiles:h,embedFailedFiles:_,uploadingFileCount:x}=ie(g),b=Ms(),{currentConversation:S}=ie(b),D=is(),{currentAgent:y,currentAgentId:I}=ie(D),C=at(),{isMobileSize:U}=ie(C),E=tt(),N=ot(),$=Ce(),{t:R}=We($.t),{toast:B}=gt(),j=v(!1),ee=ne(()=>E.meta.allowWorkspaceDragAndDrop);Vt(async()=>{try{if(await a(),E.params.id){r.value=!1,await c(E.params.id);return}}catch(W){return console.error(W),B({title:R("home.toast.fail.generalErrorTitle"),variant:"destructive"}),N.push("/")}if(!m.value.length)return N.push("/workspace/access-denied");if(m.value.length===1)return N.push(`/workspace/${m.value[0].id}`);if(!p.value){r.value=!0;return}return N.push(`/workspace/${p.value.id}`)}),Te(()=>E.params.id,async W=>{try{if(!W){if(!p.value){r.value=!0;return}return N.push(`/workspace/${p.value.id}`)}r.value=!1,await a(),await c(W)}catch(X){console.error(X),B({title:R("home.toast.fail.generalErrorTitle"),variant:"destructive"})}}),Qo(W=>{W.fullPath.startsWith("/workspace")||(p.value=void 0)});const se=(W,X)=>{if(W.length===0)return;const O=W.map(V=>V.name).join(", "),K=W.length===1?R("home.toast.fail.uploadFileFailSingle",{fileName:O}):R("home.toast.fail.uploadFileFailPlural",{fileName:O});B({title:R(X),description:K,variant:"destructive"})},G=async W=>{var K;if(W.preventDefault(),!((K=W.dataTransfer)!=null&&K.files)||!ee.value)return;const X=Array.from(W.dataTransfer.files);if(g.wouldExceedUploadFileLimit(X.length)){B({title:R("home.toast.fail.generalErrorTitle"),description:R("home.toast.fail.exceedLimitNumberOfFile",{maxFilesPerMessage:Ha,maxFilesPerConversation:Ka}),variant:"destructive"});return}const O=X.map(J);x.value+=O.filter(V=>V.isValidExtension&&V.isValidSize).length,se(O.flatMap(V=>V.isValidExtension?[]:[V.file]),"home.toast.fail.fileExtensionInvalid"),se(O.flatMap(V=>V.isValidSize?[]:[V.file]),"home.toast.fail.fileSizeInvalid");try{await g.uploadSelectedFiles(E.params.id)}catch(V){B({title:R("home.toast.fail.generalErrorTitle"),description:"home.toast.fail.generalError",variant:"destructive"}),console.error(V)}},J=W=>{const X=lo(W.name),O=W.size<zl*1024*1024;if(X&&O){const K={file:W,fileUrl:["png","jpg","jpeg"].includes(Rt(W.name))?URL.createObjectURL(W):"",fileId:"",isProcessing:null};h.value.push(K)}return{isValidExtension:X,isValidSize:O,file:W}};Te(_.value,()=>{if(_.value.length>0){const W=_.value.map(O=>O.file.name).join(", "),X=_.value.length===1?R("home.toast.fail.uploadFileFailSingle",{fileName:W}):R("home.toast.fail.uploadFileFailPlural",{fileName:W});B({title:R("home.toast.fail.generalErrorTitle"),description:X,variant:"destructive"})}_.value.splice(0,_.value.length)});const H=ne(()=>E.name==="workspace-chat"||E.name==="workspace-home"),M=ne(()=>E.name==="workspace-agent-chat"||E.name==="workspace-chat"||E.name==="workspace-agent-chat-home");return Te(M,()=>{M.value||(y.value=void 0,I.value=void 0,S.value=void 0)}),Te(H,()=>{H.value||(S.value=void 0)}),(W,X)=>{const O=f("router-view");return s(),u(ve,null,[e(U)?(s(),T(Cs,{key:0,defer:"",to:"#mobile-sub-sidebar"},[o(dl)])):(s(),T(Cs,{key:1,defer:"",to:"#sub-sidebar"},[o(dl)])),t("div",{class:"flex flex-col w-full",onDragover:X[0]||(X[0]=Ye(K=>j.value=!0,["prevent"])),onDragleave:X[1]||(X[1]=K=>j.value=!1),onDrop:X[2]||(X[2]=K=>{j.value=!1,G(K)})},[o(Vi,{isWorkspaceGroupRoute:!1}),o(O),o(Ls)],32)],64)}}}),d8={class:"mx-auto text-sm flex px-3 w-full flex-col gap-1 empty:hidden items-end"},u8={key:0,class:"flex flex-row pb-3 justify-end w-full"},p8={class:"grid grid-cols-3 gap-2 auto-rows-auto items-center",dir:"rtl"},m8={key:1,class:"xl:max-w-xl md:max-w-sm gap-2 rounded-3xl rounded-tr-xs pl-5 pr-3 py-3 bg-stone-100 dark:bg-stone-800 flex"},g8={class:"flex-1 relative"},f8={key:0,class:"border-double border-l border-stone-300 w-full flex gap-4 items-center bg-stone-100 dark:bg-stone-900 px-4 py-2 mt-2"},v8={class:"flex-1 overflow-hidden text-nowrap line-clamp-3 whitespace-pre-line text-xs italic text-stone-600 dark:text-stone-300"},h8={class:"whitespace-pre-wrap break-words"},_8={key:0,class:"absolute bottom-0 left-0 right-0 h-6 w-full bg-linear-to-b from-transparent via-stone-100/80 dark:via-stone-800/80 to-stone-100 dark:to-stone-800"},b8={class:"flex-0"},k8={class:"flex items-center gap-1 mr-3"},Gi=oe({__name:"WorkspaceUserMessageItem",props:{message:{}},setup(n){const l=n,a=Ce(),{t:c}=We(a.t),r=ne(()=>{if(!l.message)return{};const S=/^<quoted>([\s\S]*?)<\/quoted>(\s)*/,D=l.message.content.text.match(S);return D&&D[1]?{quoted:D[1],message:l.message.content.text.slice(D[0].length)}:{message:l.message.content.text}}),p=ne(()=>{var S,D,y;return(y=(D=(S=l.message)==null?void 0:S.messageMetadata)==null?void 0:D.attachments)==null?void 0:y.filter(I=>/\.(jpg|jpeg|png|gif|bmp|webp)$/i.test(I.fileName))}),m=ne(()=>{var S,D,y;return(y=(D=(S=l.message)==null?void 0:S.messageMetadata)==null?void 0:D.attachments)==null?void 0:y.filter(I=>!/\.(jpg|jpeg|png|gif|bmp|webp)$/i.test(I.fileName))}),g=v(!1),h=v(!1),_=Bt("contentContainer"),x=()=>{_.value&&(h.value?_.value.classList.add("line-clamp-3"):_.value.classList.remove("line-clamp-3"),h.value=!h.value)},b=async()=>{await Et(),g.value=!!_.value&&_.value.scrollHeight>_.value.clientHeight};return Vt(()=>b()),vl(()=>b()),(S,D)=>{var y,I,C,U,E,N;return s(),u("div",d8,[(C=(I=(y=l.message)==null?void 0:y.messageMetadata)==null?void 0:I.attachments)!=null&&C.length?(s(),u("div",u8,[t("div",p8,[(s(!0),u(ve,null,Le(p.value,($,R)=>(s(),u("div",{key:R,class:pe(["flex justify-center items-center",["png","jpg","jpeg"].includes(e(Rt)($.fileName))?"":"col-span-3"]),dir:"ltr"},[o(so,{fileId:$.fileId,fileName:$.fileName,deleteButton:!1},null,8,["fileId","fileName"])],2))),128)),(s(!0),u(ve,null,Le(m.value,($,R)=>(s(),u("div",{key:R,class:pe(["flex justify-center items-center",["png","jpg","jpeg"].includes(e(Rt)($.fileName))?"":"col-span-3"]),dir:"ltr"},[o(so,{fileId:$.fileId,fileName:$.fileName,deleteButton:!1},null,8,["fileId","fileName"])],2))),128))])])):w("",!0),((U=l.message)==null?void 0:U.content.text.trim())!==""?(s(),u("div",m8,[t("div",g8,[t("div",{class:"flex-1 line-clamp-3 overflow-hidden",ref_key:"contentContainer",ref:_},[(E=r.value.quoted)!=null&&E.trim()?(s(),u("div",f8,[t("div",v8,d((N=r.value.quoted)==null?void 0:N.trim()),1)])):w("",!0),t("div",h8,d(r.value.message),1)],512),g.value?(s(),u("div",_8)):w("",!0)]),t("div",b8,[g.value||h.value?(s(),T(Pe,{key:0,size:"mdicon",variant:"secondary",icon:"bi bi-chevron-up",onClick:x,"class-name":["transition-all",h.value?"rotate-0":"rotate-180"].join(" ")},null,8,["class-name"])):w("",!0)])])):w("",!0),t("div",k8,[o(oa,{className:"p-4 text-sm",content:l.message.content.text,"copy-done-tooltip":e(c)("home.chat.label.copyCodeDone"),"copy-tooltip":e(c)("home.chat.button.copyMessage.tooltip")},null,8,["content","copy-done-tooltip","copy-tooltip"])])])}}}),y8={class:"flex px-3 w-full h-full gap-4 empty:hidden items-start rtl:items-start"},x8={key:0,class:"flex flex-col w-full gap-1"},w8={key:1,class:"lds-ellipsis pb-4"},$8={class:"flex items-center gap-1 ml-2"},S8={key:0,class:"bi bi-stars text-sm text-blue-500 animate-pulse dark:text-sky-500"},T8={class:"text-sm text-blue-500 dark:text-sky-500 select-none"},A8={class:"flex justify-between"},C8={class:"text-xl"},D8={class:"text-sm my-4"},L8=["onClick"],I8={class:"flex items-center justify-between"},B8={key:0,class:"bi bi-check text-md"},M8={key:1,class:"bg-red-100 text-red-500 text-sm p-4 w-full rounded-lg"},E8=oe({__name:"WorkspaceAIMessageItem",props:{message:{},index:{},forWorkspace:{type:Boolean}},setup(n){const l=Ms(),{sendMessageFeedback:a,deleteMessageFeedback:c}=l,{currentConversation:r,supportModels:p}=ie(l);Js();const m=is();ie(m);const{t:g}=Ce(),{toast:h}=gt();tt();const _=n,x=ne(()=>{const J=p.value.find(H=>H.modelId===_.message.modelId);return(J==null?void 0:J.displayName)??g("home.chat.label.unknownModel")}),b=v(""),S=v(""),D=ne(()=>{var J;return{conversation_id:(J=r.value)==null?void 0:J.id,message_id:_.message.id}}),y=async J=>{b.value=J;const H={feedback:"DISLIKE",reason:J};await a(D.value,H),C.value=!1,h({title:g("home.toast.success.messageFeedback.header"),description:g("home.toast.success.messageFeedback.description")})},I=v(null),C=v(!1),U=()=>{C.value=!1,E.value=!1},E=v(!1),N=()=>{E.value=!E.value},$=[{id:1,choice:"home.chat.message.userBadResponse.factual",textRaw:"Not factually correct"},{id:2,choice:"home.chat.message.userBadResponse.offensive",textRaw:"Offensive/Unsafe"},{id:3,choice:"home.chat.message.userBadResponse.language",textRaw:"Wrong language"},{id:4,choice:"home.chat.message.userBadResponse.format",textRaw:"Poorly formatted"},{id:5,choice:"home.chat.message.userBadResponse.generic",textRaw:"Generic/Bland"}],R=ne(()=>{const J=_.message.content??"";return J.text.startsWith("<think>")&&J.text.indexOf(`</think>
`)<0}),B=ne(()=>{const J=_.message.content.text??"";if(!J.startsWith("<think>"))return[null,J];const H=J.indexOf(`</think>
`);return H<0?[J.substring(7),""]:[J.substring(7,H),J.substring(H+8)]}),j=v(""),{isSupported:ee}=ga({source:j}),se=ne(()=>({appName:"SAMURAI",viewName:"CHAT",additionalInfo:{messageId:_.message.id,conversationId:_.message.conversationId}})),G=ne(()=>(_.message.content.citations??[]).map(H=>({id:H.mappingId,citationNumber:H.mappingId,title:H.source,content:H.content,page:H.page})));return(J,H)=>{var O,K,V,F;const M=f("Button"),W=f("Textarea"),X=Kt("auto-animate");return s(),u("div",y8,[J.message.error?(s(),u("div",M8,d(B.value[1]),1)):Ke((s(),u("div",x8,[B.value[0]?(s(),T(bi,{key:0,content:B.value[0]??"","is-thinking":R.value,class:"-ml-5",tracking:se.value},null,8,["content","is-thinking","tracking"])):w("",!0),o(va,{"for-workspace":_.forWorkspace,"streaming-markdown":B.value[1],"is-completed":J.message.isCompleted,"enable-canvas":!0,citations:G.value,tracking:se.value,isNumberCitation:!1},null,8,["for-workspace","streaming-markdown","is-completed","citations","tracking"]),!J.message.isCompleted&&((O=e(r))!=null&&O.messagesList)&&_.index===((K=e(r))==null?void 0:K.messagesList.length)-1?(s(),u("div",w8,H[3]||(H[3]=[t("div",null,null,-1),t("div",null,null,-1),t("div",null,null,-1),t("div",null,null,-1)]))):w("",!0),t("div",{class:pe(["flex items-center gap-1",[e(ee)&&J.message.isCompleted||e(ee)&&J.message.isCompleted&&((V=e(r))!=null&&V.messagesList)&&_.index===((F=e(r))==null?void 0:F.messagesList.length)-1?"visible animate-fade animate-once animate-duration-500 animate-delay-100":"invisible"]])},[o(ss,{className:"p-4 text-sm",content:B.value[1],copyFailedTooltip:e(g)("copyRichTextButton.tooltip.copyFailed"),copyDoneTooltip:e(g)("copyRichTextButton.tooltip.copyDone"),copyTooltip:e(g)("copyRichTextButton.tooltip.copy")},null,8,["content","copyFailedTooltip","copyDoneTooltip","copyTooltip"]),o(oa,{copyIcon:"bi bi-markdown",className:"p-4 text-sm",content:B.value[1],"copy-done-tooltip":e(g)("copyMarkdownButton.tooltip.copyDone"),"copy-tooltip":e(g)("copyMarkdownButton.tooltip.copy")},null,8,["content","copy-done-tooltip","copy-tooltip"]),t("div",$8,[x.value?(s(),u("i",S8)):w("",!0),t("p",T8,d(x.value),1)])],2),C.value?(s(),u("div",{key:2,class:"my-2",ref_key:"feedbackRef",ref:I},[t("div",A8,[t("p",C8,d(e(g)("home.chat.message.userBadResponse.title.question")),1),o(M,{variant:"ghost",class:"p-4",size:"mdicon",onClick:U},{default:i(()=>H[4]||(H[4]=[t("i",{class:"bi bi-x-lg"},null,-1)])),_:1,__:[4]})]),t("p",D8,d(e(g)("home.chat.message.userBadResponse.userHelp")),1),(s(),u(ve,null,Le($,P=>t("div",{key:P.id},[t("div",{onClick:q=>y(P.textRaw),class:"p-3 w-full bg-stone-100 hover:bg-stone-200 dark:bg-stone-800 dark:hover:bg-stone-700 rounded-md cursor-pointer mb-1"},d(e(g)(P.choice)),9,L8)])),64)),t("div",{onClick:N,class:"p-3 w-full bg-stone-100 hover:bg-stone-200 dark:bg-stone-800 dark:hover:bg-stone-700 rounded-md cursor-pointer mb-1"},[t("div",I8,[t("span",null,d(e(g)("home.chat.message.userBadResponse.other")),1),E.value?(s(),u("i",B8)):w("",!0)]),E.value?(s(),T(W,{key:0,id:"dislike-reason-textarea",modelValue:S.value,"onUpdate:modelValue":H[0]||(H[0]=P=>S.value=P),onClick:H[1]||(H[1]=Ye(()=>{},["stop"])),class:"mt-3 border-black dark:border-stone-500 text-sm min-h-14"},null,8,["modelValue"])):w("",!0),E.value?(s(),T(M,{key:1,onClick:H[2]||(H[2]=Ye(P=>y(S.value),["stop"])),variant:"default",class:"mt-3 px-6"},{default:i(()=>[me(d(e(g)("home.chat.message.userBadResponse.button.label.submit")),1)]),_:1})):w("",!0)])],512)):w("",!0)])),[[X]])])}}}),Wi=Vs(E8,[["__scopeId","data-v-ed3578f4"]]),R8={class:"flex flex-col h-[calc(100dvh-4rem)] w-full"},F8={class:"flex flex-1 w-full overflow-hidden"},P8={class:"flex flex-col w-full"},N8={key:1,class:"w-11/12 sm:w-3/4 max-w-sm sm:max-w-200 sm:min-w-lg mx-auto h-full pt-5"},z8=["id"],U8={class:"w-full sm:w-3/4 sm:max-w-200 sm:min-w-lg sm:mx-auto"},O8={key:0,class:"relative w-full"},j8={key:0,class:"overflow-x-auto w-full flex items-center gap-2 px-8 pt-1.5 py-1"},V8={key:2,class:"my-8 p-4 rounded-2xl bg-red-300 flex text-center gap-4"},G8={class:"text-xl font-semibold text-rose-900"},W8={key:3,class:"max-sm:hidden text-xs text-center opacity-50 -mt-4 mb-1"},ul=oe({__name:"WorkspaceChatView",setup(n){const l=ot(),a=Ms(),{generatingResponse:c,currentConversation:r,shouldLeaveWhiteSpace:p,newMessageAdded:m,hints:g}=ie(a),h=is(),{getWorkspaceAgentById:_}=h,{currentAgent:x}=ie(h),b=tt(),S=Js(),{toast:D}=gt(),{attachments:y}=ie(S),I=at(),{isMobileSize:C}=ie(I),U=Ce(),{t:E}=We(U.t),N=v(!1),$=v(null),R=H=>{$.value&&$.value.setValue(H)},B=async(H,M)=>{try{await a.fetchConversationById(H,M)}catch(W){console.error(W),D({title:E("home.toast.fail.generalErrorTitle"),description:E("home.toast.fail.generalError"),variant:"destructive"}),N.value=!1,l.push(`/workspace/${b.params.id}`);return}},j=async H=>{var M,W;try{await _(b.params.id,H)}catch(X){N.value=!1,await Et(),(M=se.value)==null||M.scrollToBottom(!0),r.value.readOnly=!0,((W=X.response)==null?void 0:W.status)!==404&&D({title:E("home.toast.fail.generalErrorTitle"),description:E("home.toast.fail.generalError"),variant:"destructive"})}},ee=ne(()=>{var H;return(H=r.value)!=null&&H.messagesList?r.value.messagesList.flatMap((M,W,X)=>W%2?[[X[W-1],M]]:[]):[]});Te(()=>b.params.chatId,async H=>{var M,W,X,O;if(H&&!c.value){x.value=void 0,g.value=[],y.value=[],p.value=!1,N.value=!0,await B(b.params.id,H),r.value&&r.value.conversationMetadata&&(y.value=r.value.conversationMetadata.attachments);const K=(W=(M=r.value)==null?void 0:M.conversationMetadata)==null?void 0:W.agentId;!((X=r.value)!=null&&X.readOnly)&&K&&K!=="None"&&await j(K),N.value=!1,await Et(),(O=se.value)==null||O.scrollToBottom(!0)}},{immediate:!0});const se=Bt("contentContainer"),G=v([]),J=(H,M)=>{H instanceof HTMLElement&&(G.value[M]=H)};return Te(m,async H=>{if(!H)return;await Ca(100),await Et();const M=G.value[G.value.length-1];M&&M.scrollIntoView({behavior:"smooth",block:"start"})}),ls(()=>{a.stopAIResponse()}),Dt(()=>{!b.params.id&&!c.value&&l.push(`/workspace/${b.params.id}`)}),(H,M)=>{var O,K;const W=f("Button"),X=Kt("auto-animate");return s(),u("div",R8,[Ke((s(),u("div",F8,[t("div",P8,[o(sn,{ref_key:"contentContainer",ref:se,class:"flex flex-col flex-1 justify-center gap-6","disable-shadow-bottom":!0},{default:i(()=>[N.value?(s(),T(e(zs),{key:0,class:"w-8 h-8 animate-spin mx-auto"})):(s(),u("div",N8,[(s(!0),u(ve,null,Le(ee.value,(V,F)=>(s(),u("div",{key:F,class:pe([e(p)&&ee.value.length>1?"last:min-h-[var(--scrollable-container-height)]":"","last:pb-10"]),ref_for:!0,ref:P=>J(P,F),id:`msg-${V[1].id}`},[o(Gi,{message:V[0],class:"py-4"},null,8,["message"]),o(Wi,{"for-workspace":!0,message:V[1],index:F*2+1},null,8,["message","index"])],10,z8))),128))]))]),_:1},512),t("div",U8,[M[2]||(M[2]=t("div",{class:"relative h-0"},[t("div",{class:"absolute h-8 left-0 right-4 bottom-0 z-20 bg-linear-to-b from-transparent via-white/80 dark:via-stone-900/80 to-white dark:to-stone-900"})],-1)),e(g).length?(s(),u("div",O8,[M[0]||(M[0]=t("div",{class:"pointer-events-none absolute top-0 left-0 h-full w-10 -ml-1 bg-gradient-to-r from-white from-30% to-transparent to-90% dark:from-stone-900 transition-opacity duration-300 z-2"},null,-1)),e(C)?w("",!0):Ke((s(),u("div",j8,[(s(!0),u(ve,null,Le(e(g),V=>(s(),T(W,{key:V,onClick:F=>R(V),variant:"ghost",class:"border border-blue-200 text-blue-400 dark:border-blue-200 dark:text-blue-300 hover:bg-blue-100/40 hover:text-blue-400 dark:hover:bg-blue-100/20 dark:hover:text-blue-300"},{default:i(()=>[me(d(V),1)]),_:2},1032,["onClick"]))),128))])),[[X]]),M[1]||(M[1]=t("div",{class:"pointer-events-none absolute top-0 right-0 h-full w-10 bg-gradient-to-l from-white from-30% to-transparent to-80% dark:from-stone-900 transition-opacity duration-300"},null,-1))])):w("",!0),(O=e(r))!=null&&O.readOnly?(s(),u("div",V8,[t("div",G8,d(e(E)("home.chat.message.readonly")),1)])):(s(),T(ao,{key:1,ref_key:"messageInputRef",ref:$},null,512)),(K=e(r))!=null&&K.readOnly?w("",!0):(s(),u("p",W8,d(e(E)("home.chat.label.description",{ai:"PrivateGPT"})),1))])])])),[[X]])])}}}),H8={class:"sticky top-0 right-0 bg-white dark:bg-stone-900 z-20 p-3 w-full flex justify-center sm:justify-end gap-10"},K8={class:"text-xs"},q8={class:"text-xs"},Q8=oe({__name:"WorkspaceGroupTabs",setup(n){const l=Ce(),{t:a}=We(l.t),c=tt(),r=ot(),p=ne(()=>c.name||"workspace-group-knowledge"),m=g=>{r.push({name:g,params:{id:c.params.id}})};return(g,h)=>{const _=f("TabsTrigger"),x=f("TabsList"),b=f("Tabs");return s(),u("div",H8,[o(b,{"default-value":p.value,class:"bg-transparent w-full"},{default:i(()=>[o(x,{class:"p-0 flex justify-end bg-transparent w-full"},{default:i(()=>[o(_,{value:"workspace-members",class:"p-2 py-4 w-full sm:w-40 rounded-xl dark:data-[state=active]:bg-stone-800 data-[state=active]:bg-stone-100 data-[state=active]:shadow-none hover:text-black dark:hover:text-white",onClick:h[0]||(h[0]=S=>m("workspace-members"))},{default:i(()=>[h[2]||(h[2]=t("div",null,[t("i",{class:"bi bi-people-fill text-xl"})],-1)),t("span",K8,d(e(a)("workspace.group.tabTitle.membersTab")),1)]),_:1,__:[2]}),o(_,{value:"workspace-settings",class:"p-2 py-4 w-full sm:w-40 rounded-xl dark:data-[state=active]:bg-stone-800 data-[state=active]:bg-stone-100 data-[state=active]:shadow-none hover:text-black dark:hover:text-white",onClick:h[1]||(h[1]=S=>m("workspace-settings"))},{default:i(()=>[h[3]||(h[3]=t("div",null,[t("i",{class:"bi bi-gear-fill text-xl"})],-1)),t("span",q8,d(e(a)("workspace.group.tabTitle.settingsTab")),1)]),_:1,__:[3]})]),_:1})]),_:1},8,["default-value"])])}}}),J8={class:"flex h-dvh"},X8={class:"w-full"},Y8=oe({__name:"WorkspaceGroupView",setup(n){const l=tt(),a=Ce(),{t:c}=We(a.t),{toast:r}=gt(),p=as(),{getCurrentWorkspace:m,getAllWorkspaces:g}=p;return Te(()=>l.params.id,async h=>{try{await g(),await m(h)}catch(_){console.error(_),r({title:c("home.toast.fail.generalErrorTitle"),variant:"destructive"})}},{immediate:!0}),(h,_)=>{const x=f("RouterView");return s(),u("div",J8,[t("div",X8,[o(Vi,{isWorkspaceGroupRoute:!0}),o(Q8),o(x)])])}}}),Z8={key:0,class:"ml-2"},e5={class:"flex items-center justify-between"},t5={class:"text-sm text-stone-400"},s5={class:"text-xs text-stone-400 w-full"},a5={class:"w-full flex justify-end"},o5={for:"fileInput",class:"cursor-pointer hover:bg-stone-100 dark:hover:bg-stone-800 px-3 py-2 text-sm border rounded-full"},n5={key:0,class:"text-xs text-stone-400 max-h-36 overflow-y-auto"},l5=["alt"],i5=oe({__name:"AddMemberToWorkspaceDialog",setup(n){const l=v([]),{t:a}=Ce(),c=as(),r=at(),{isMobileSize:p}=ie(r),{getUsers:m,addMemberToWorkspace:g}=c,{users:h,membersInCurrentWorkspace:_,currentWorkspace:x,currentUserRoleInWorkspace:b}=ie(c),{toast:S}=gt(),D=v(!1),y=v(!1),I=v([]),C=()=>{y.value=!1,D.value=!0,I.value=[]},U=v(!1),E=tt(),N=async H=>{y.value=!0,await g(E.params.id,H),D.value=!1},$=v(null),R=H=>{const M=H.target;if(M.files&&M.files.length>0){const W=M.files[0],X=W.name.toLowerCase(),O=X.endsWith(".csv"),K=X.endsWith(".xlsx")||X.endsWith(".xls");if(!O&&!K){M.value="",S({title:a("group.toast.fail.uploadCSV"),description:a("group.toast.fail.uploadCSV.description"),variant:"destructive"});return}$.value=W,O?B($.value):j($.value),M.value=""}},B=H=>{const M=new FileReader;M.onload=W=>{if(W.target&&W.target.result){const O=W.target.result.split(`
`).map(K=>K.trim().replace("\r","")).filter(K=>K);I.value=O.map(K=>({id:"",name:"",email:K}))}},M.readAsText(H)},j=H=>{const M=new FileReader;M.onload=W=>{var X;if((X=W.target)!=null&&X.result){const O=new Uint8Array(W.target.result),K=El(O,{type:"array"}),V=K.SheetNames[0],F=K.Sheets[V],q=Rl.sheet_to_json(F,{header:1}).map(A=>{var k;return(k=A[0])==null?void 0:k.trim()}).filter(A=>A);I.value=q.map(A=>({id:"",name:"",email:A}))}},M.readAsArrayBuffer(H)},ee=v(!1),se=v(!1),J=us(async H=>{if(!H){l.value=[],se.value=!1;return}ee.value=!0,se.value=!1,await m({email:H.toLowerCase(),offset:0,limit:5}),l.value=h.value.filter(M=>!I.value.some(W=>W.id===M.id)).map(M=>({...M,isAdded:_.value.some(W=>W.id===M.id)})),ee.value=!1,se.value=!0},300);return(H,M)=>{const W=f("Button"),X=f("DialogTitle"),O=f("DialogDescription"),K=f("DialogHeader"),V=f("Separator"),F=f("DialogClose"),P=f("Loader2"),q=f("DialogFooter"),A=f("DialogContent"),k=f("Dialog");return s(),T(k,{open:D.value,"onUpdate:open":M[3]||(M[3]=L=>D.value=L)},{default:i(()=>[e(b)[e(E).params.id]==="ADMIN"?(s(),T(W,{key:0,class:"rounded-3xl",onClick:C},{default:i(()=>[M[4]||(M[4]=t("i",{class:"bi bi-plus-lg"},null,-1)),e(p)?w("",!0):(s(),u("span",Z8,d(e(a)("group.button.inviteMember")),1))]),_:1,__:[4]})):w("",!0),o(A,{class:"w-full max-w-sm sm:max-w-lg rounded-md sm:rounded-lg"},{default:i(()=>[o(K,null,{default:i(()=>[o(X,{class:"whitespace-normal wrap-anywhere line-clamp-1"},{default:i(()=>{var L;return[me(d(e(a)("group.membersTab.dialog.addMemberDialogHeader",{groupName:(L=e(x))==null?void 0:L.name})),1)]}),_:1}),o(O,null,{default:i(()=>[me(d(e(a)("group.membersTab.dialog.addMemberDialogDescription")),1)]),_:1})]),_:1}),o(V),o(Ii,{"query-value":I.value,"onUpdate:queryValue":M[0]||(M[0]=L=>I.value=L),onTriggerDebounce:e(J),targetUsers:l.value,isSearching:ee.value,hasSearched:se.value,class:"w-full"},null,8,["query-value","onTriggerDebounce","targetUsers","isSearching","hasSearched"]),o(V),t("div",e5,[t("div",null,[t("p",t5,d(e(a)("group.membersTab.dialog.importCSV")),1),t("div",s5,d(e(a)("group.membersTab.dialog.importCSVDes")),1),t("p",{class:"text-xs text-stone-400 underline cursor-pointer w-fit",onClick:M[1]||(M[1]=L=>U.value=!U.value)},d(U.value?e(a)("group.membersTab.dialog.hideExampleButtonLabel"):e(a)("group.membersTab.dialog.showExampleButtonLabel")),1)]),t("div",a5,[t("input",{type:"file",accept:".csv, application/vnd.ms-excel, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",onChange:R,class:"hidden",id:"fileInput"},null,32),t("label",o5,d(e(a)("group.membersTab.dialog.uploadCSVorExcelButtonLabel")),1)])]),U.value?(s(),u("div",n5,[t("img",{src:Li,alt:e(a)("group.membersTab.dialog.excel.imageFallbackText"),class:"rounded-md my-5"},null,8,l5)])):w("",!0),o(q,{class:"gap-2 mt-4"},{default:i(()=>[o(F,{"as-child":""},{default:i(()=>[o(W,{type:"button",variant:"outline",class:"rounded-full"},{default:i(()=>[me(d(e(a)("group.button.cancel")),1)]),_:1})]),_:1}),o(W,{type:"button",class:"rounded-full",onClick:M[2]||(M[2]=L=>N(I.value)),disabled:y.value||I.value.length===0||l.value.length===0&&se.value||ee.value},{default:i(()=>[y.value?(s(),T(P,{key:0,class:"w-4 h-4 animate-spin mr-2"})):w("",!0),t("span",null,d(e(a)("group.membersTab.dialog.addMemberButtonLabel")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])}}}),r5={key:0,class:"bi bi-three-dots"},c5={variant:"ghost"},d5=oe({__name:"DataTableDropdown",props:{member:{}},setup(n){const{t:l}=Ce(),a=tt(),c=as(),{currentDataTableOffset:r}=ie(c),{changeMemberRoleWorkspace:p,removeMemberFromWorkspace:m,getMembersInWorkspace:g}=c,h=v(!1),_=v(!1),x=()=>{_.value=!0},b=async(I,C,U)=>{if(!h.value){h.value=!0;try{await p(I,C,U)}catch(E){console.error("Error changing member role:",E),Ue({title:l("group.toast.fail.generalErrorTitle"),description:l("group.toast.fail.generalError"),variant:"destructive"})}finally{await g(I,{offset:r.value,limit:20}),h.value=!1}}},S=v(!1),D=async I=>{h.value=!0;const C=a.params.id;try{await m(C,I)}catch(U){console.error("Failed to remove member:",U),Ue({title:l("home.toast.fail.generalErrorTitle"),description:l("home.toast.fail.generalError"),variant:"destructive"})}finally{h.value=!1}S.value=!1,_.value=!1},y=()=>{S.value=!0};return(I,C)=>{const U=f("Loader"),E=f("DropdownMenuSubTrigger"),N=f("DropdownMenuSubContent"),$=f("DropdownMenuSub"),R=f("AlertDialogTrigger"),B=f("AlertDialogTitle"),j=f("AlertDialogHeader"),ee=f("AlertDialogDescription"),se=f("AlertDialogCancel"),G=f("Loader2"),J=f("AlertDialogFooter"),H=f("AlertDialogContent"),M=f("AlertDialog"),W=f("DropdownMenuGroup");return s(),T(e(cn),{open:S.value,"onUpdate:open":C[4]||(C[4]=X=>S.value=X)},{default:i(()=>[o(e(un),{"as-child":""},{default:i(()=>[o(e(ts),{variant:"ghost",class:"w-8 h-8 p-0",onClick:y},{default:i(()=>[h.value?w("",!0):(s(),u("i",r5)),h.value?(s(),T(U,{key:1,class:"w-4 h-4 animate-spin"})):w("",!0)]),_:1})]),_:1}),o(e(dn),null,{default:i(()=>[o(W,null,{default:i(()=>[o($,null,{default:i(()=>[o(E,{class:"cursor-pointer"},{default:i(()=>[t("div",c5,[C[5]||(C[5]=t("i",{class:"bi bi-arrow-down-up mr-2"},null,-1)),me(" "+d(e(l)("group.membersTab.tableOption.changeMemberRoleLabel")),1)])]),_:1}),o(N,null,{default:i(()=>[o(e(ta),{class:"cursor-pointer",onClick:C[0]||(C[0]=Ye(X=>b(e(a).params.id,I.member.id,"ADMIN"),["stop"]))},{default:i(()=>C[6]||(C[6]=[t("div",null,"ADMIN",-1)])),_:1,__:[6]}),o(e(ta),{class:"cursor-pointer",onClick:C[1]||(C[1]=Ye(X=>b(e(a).params.id,I.member.id,"MEMBER"),["stop"]))},{default:i(()=>C[7]||(C[7]=[t("div",null,"MEMBER",-1)])),_:1,__:[7]})]),_:1})]),_:1}),o(e(ta),null,{default:i(()=>[o(M,{open:_.value,"onUpdate:open":C[3]||(C[3]=X=>_.value=X)},{default:i(()=>[o(R,{class:"cursor-pointer"},{default:i(()=>[t("div",{variant:"ghost",onClick:Ye(x,["stop"]),class:"text-red-500"},[C[8]||(C[8]=t("i",{class:"bi bi-eraser mr-2"},null,-1)),me(" "+d(e(l)("group.membersTab.tableOption.removeMemberLabel",{memberName:I.member.name})),1)])]),_:1}),o(H,{class:"sm:max-w-[425px]"},{default:i(()=>[o(j,null,{default:i(()=>[o(B,null,{default:i(()=>[me(d(e(l)("group.membersTab.dialog.removeMemberDialogHeader")),1)]),_:1})]),_:1}),o(ee,null,{default:i(()=>[me(d(e(l)("group.membersTab.dialog.removeMemberDialogDescription",{memberName:I.member.name})),1)]),_:1}),o(J,{class:"flex"},{default:i(()=>[o(se,{"as-child":""},{default:i(()=>[o(e(ts),{type:"button",variant:"outline"},{default:i(()=>[me(d(e(l)("group.button.cancel")),1)]),_:1})]),_:1}),o(e(ts),{disabled:h.value,onClick:C[2]||(C[2]=Ye(X=>D(I.member.id),["stop"])),type:"button",class:"bg-red-600 text-white hover:bg-red-500"},{default:i(()=>[h.value?(s(),T(G,{key:0,class:"w-5 h-5 mr-3 animate-spin"})):w("",!0),me(" "+d(e(l)("group.membersTab.dialog.removeMemberButtonLabel")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])}}}),u5={class:"container px-0 sm:px-8 sm:py-10 sm:mx-auto"},p5={key:0,class:"flex flex-col items-start space-y-3"},m5={key:0,class:"flex gap-3 justify-center items-center mt-4"},g5=["disabled"],f5={class:"text-sm text-stone-500"},v5=["disabled"],No="text-left font-bold text-md",zo="text-left",h5=oe({__name:"WorkspaceMemberTableData",props:{tab:{},members:{}},setup(n){const{t:l}=Ce(),a=v(!1),c=tt(),r=as(),{getMembersInWorkspace:p,changeMemberRoleWorkspace:m,removeMemberFromWorkspace:g}=r,{currentUserRoleInWorkspace:h,currentUserIdInWorkspace:_,totalMember:x,userSearchMemberInput:b,currentDataTableOffset:S}=ie(r),D=us(async $=>{S.value=0,await y($.toLowerCase())},300);Te(b,$=>{D($)});const y=async($="")=>{a.value=!0;const R={email:$,offset:S.value,limit:10};try{await p(c.params.id,R)}catch(B){console.log(B),Ue({title:l("group.toast.fail.generalErrorTitle"),description:l("group.toast.fail.somethingWentWrong"),variant:"destructive"})}finally{a.value=!1}},I=[{accessorKey:"name",header:()=>Oe("div",{class:No},l("group.membersTab.tableNameLabel")),cell:({row:$})=>Oe("div",{class:zo},$.getValue("name"))},{accessorKey:"email",header:()=>Oe("div",{class:No},l("group.membersTab.tableEmailLabel")),cell:({row:$})=>{const R=$.original,B=_.value===R.id;return Oe("div",{class:zo},[B?Oe("span",{class:"text-sm"},`(${l("group.membersTab.currentUserLabel")}) `):null,Oe("span",{},$.getValue("email"))])}},{accessorKey:"role",header:()=>Oe("div",{class:No},l("group.membersTab.tableRoleLabel")),cell:({row:$})=>Oe("div",{class:zo},$.getValue("role"))},{id:"actions",cell:({row:$})=>{const R=$.original,B=c.params.id;if(h.value[B]==="ADMIN"&&_.value!==R.id)return Oe("div",{class:"relative"},Oe(d5,{member:R,onRoleChange:j=>{const{id:ee,role:se}=j;m(B,ee,se)},onRemove:j=>{const{id:ee}=j;g(B,ee)}}))}}],C=ne(()=>Math.floor(S.value/10)+1),U=ne(()=>Math.ceil((x.value||0)/10)),E=()=>{C.value<U.value&&(S.value+=10,y())},N=()=>{S.value>0&&(S.value-=10,y())};return Dt(()=>y()),Te(()=>c.params.id,$=>{$&&(S.value=0,y())}),($,R)=>{const B=f("Skeleton");return s(),u("div",u5,[t("div",null,[a.value?(s(),u("div",p5,[o(B,{class:"h-8 w-full"}),o(B,{class:"h-8 w-11/12"}),o(B,{class:"h-8 w-full"}),o(B,{class:"h-8 w-11/12"}),o(B,{class:"h-8 w-full"}),o(B,{class:"h-8 w-11/12"}),o(B,{class:"h-8 w-full"}),o(B,{class:"h-8 w-11/12"})])):(s(),T(rn,{key:1,columns:I,data:$.members,noDataAvailableMessage:e(l)("group.unavailableMessage.noMemberAvailable")},null,8,["data","noDataAvailableMessage"]))]),t("div",null,[!a.value&&e(x)!==0?(s(),u("div",m5,[t("button",{variant:"ghost",class:pe(["px-4 py-2 cursor-pointer",e(S)===0?"opacity-20":""]),disabled:e(S)===0,onClick:N},R[0]||(R[0]=[t("i",{class:"bi bi-caret-left"},null,-1)]),10,g5),t("span",f5,d(C.value)+" / "+d(U.value),1),t("button",{variant:"ghost",class:pe(["px-4 py-2 cursor-pointer",C.value===U.value?"opacity-20":""]),disabled:C.value===U.value,onClick:E},R[1]||(R[1]=[t("i",{class:"bi bi-caret-right"},null,-1)]),10,v5)])):w("",!0)])])}}}),_5={class:"h-[calc(100dvh-10.8rem)] overflow-y-auto"},b5={class:"w-10/12 sm:w-8/12 mx-auto"},k5={class:"px-1 border-b"},y5={class:"text-3xl font-bold"},x5={class:"w-full mt-5 flex gap-8"},w5={class:"min-w-32 relative w-full"},$5=oe({__name:"WorkspaceMembersTab",setup(n){const l=tt(),a=as(),{getMembersInWorkspace:c}=a,{membersInCurrentWorkspace:r,userSearchMemberInput:p,totalMember:m}=ie(a),g=Ce(),{t:h}=We(g.t);return Te(()=>l.params.id,async _=>{p.value="",_&&await c(_)},{immediate:!0}),(_,x)=>{const b=f("Input");return s(),u("div",_5,[t("div",b5,[t("div",null,[t("div",k5,[t("span",y5,d(e(h)("workspace.group.tabTitle.membersTab")),1),t("div",null,[t("span",null,d(e(h)("workspace.group.tabTitle.membersTab"))+"  ",1),t("span",null,d(e(m)),1)])]),t("div",x5,[t("div",w5,[x[1]||(x[1]=t("i",{class:"bi bi-search absolute left-3 top-2 cursor-pointer"},null,-1)),o(b,{modelValue:e(p),"onUpdate:modelValue":x[0]||(x[0]=S=>kt(p)?p.value=S:null),placeholder:e(h)("group.membersTab.searchMemberPlaceHolder"),class:"pl-10"},null,8,["modelValue","placeholder"])]),t("div",null,[o(i5)])]),t("div",null,[o(h5,{members:e(r)},null,8,["members"])])])])])}}}),S5={class:"w-10/12 sm:w-8/12 mx-auto flex flex-col"},T5={class:"mid-content-title flex flex-col"},A5={class:"text-3xl font-bold"},C5={key:0},D5={class:"flex flex-col"},L5={class:"font-bold"},I5={class:"opacity-40 text-xs"},B5={class:"w-full flex flex-col gap-2"},M5={class:"text-sm"},E5={key:0,class:"text-red-600 mb-3 text-sm font-semibold"},R5={class:"flex gap-5 items-center dark:hover:bg-stone-800 hover:bg-stone-100 p-3 rounded-md"},F5={class:"flex flex-col"},P5={class:"font-bold"},N5={class:"opacity-40 text-xs"},z5={key:1,class:"flex flex-col"},U5={class:"flex flex-col gap-3"},O5={key:2,class:"flex flex-col items-center justify-center h-48 text-stone-500"},j5={class:"text-2xl font-semibold opacity-50 mt-2"},V5=oe({__name:"WorkspaceSettingsTab",setup(n){const l=tt(),a=as(),{updateWorkspaceSettings:c,getCurrentWorkspace:r}=a,{newWorkspaceName:p,currentUserRoleInWorkspace:m,currentWorkspace:g}=ie(a),{t:h}=Ce(),_=v(l.params.id);Te(()=>l.params.id,se=>{_.value=se});const S=Ho({newWorkspaceName:{required:Ko}},{newWorkspaceName:p},{$scope:!1}),D=v(!1),y=v(!1),I=v(!1),C=v(!1),U=()=>C.value=!1,E=()=>{y.value=!1,U(),p.value="",D.value=!0},N=async se=>{if(await S.value.$validate()&&!y.value&&!I.value){I.value=!0,y.value=!0;try{const J={name:p.value};await c(se,J),await r(se),D.value=!1}catch(J){console.error("Error updating group name:",J),Ue({title:h("workspace.toast.fail.generalErrorTitle"),description:h("workspace.toast.fail.updateWorkspaceName"),variant:"destructive"})}finally{I.value=!1}}else C.value=!0},$=async()=>{try{const se={settings:{allow_download:ee.value}};await c(g.value.id,se),await r(g.value.id)}catch(se){console.error(se),Ue({title:h("workspace.toast.fail.generalErrorTitle"),description:h("workspace.toast.fail.updateWorkspaceAllowDownload"),variant:"destructive"})}},R=ne(()=>m.value[l.params.id]),B=v(!1),j=async()=>{B.value=!0;try{await r(l.params.id),ee.value=g.value.settings.allowDownload}catch{Ue({title:h("workspace.toast.fail.generalErrorTitle"),description:h("workspace.toast.fail.getWorkspaceData"),variant:"destructive"})}finally{B.value=!1}};Te(()=>l.params.id,se=>{se&&j()},{immediate:!0});const ee=v(!1);return hl(ee,()=>{$()},{debounce:1e3}),(se,G)=>{const J=f("Separator"),H=f("DialogTrigger"),M=f("DialogTitle"),W=f("DialogHeader"),X=f("Input"),O=f("Button"),K=f("DialogClose"),V=f("Loader2"),F=f("DialogFooter"),P=f("DialogContent"),q=f("Dialog"),A=f("Switch"),k=f("Skeleton");return s(),u("div",S5,[t("div",T5,[t("span",A5,d(e(h)("group.settingsTab.tabLabel")),1)]),o(J,{class:"my-2"}),R.value==="ADMIN"&&!B.value?(s(),u("div",C5,[o(q,{open:D.value,"onUpdate:open":G[3]||(G[3]=L=>D.value=L)},{default:i(()=>[o(H,{"as-child":""},{default:i(()=>[t("div",{onClick:Ye(E,["stop"]),class:"flex gap-5 items-center cursor-pointer dark:hover:bg-stone-800 hover:bg-stone-100 p-3 rounded-md"},[G[5]||(G[5]=t("div",null,[t("i",{class:"bi bi-pencil"})],-1)),t("div",null,[t("div",D5,[t("div",L5,d(e(h)("workspace.settingsTab.updateWorkspaceLabel")),1),t("div",I5,d(e(h)("workspace.settingsTab.updateWorkspaceSubLabel")),1)])])])]),_:1}),o(P,{class:"max-w-sm rounded-md sm:max-w-lg sm:rounded-lg"},{default:i(()=>[o(W,null,{default:i(()=>[o(M,null,{default:i(()=>[me(d(e(h)("workspace.settingsTab.dialog.editDialog.dialogHeader")),1)]),_:1})]),_:1}),t("div",B5,[t("span",M5,d(e(h)("workspace.settingsTab.dialog.editDialog.newWorkspaceNameLabel")),1),o(X,{onKeyup:G[0]||(G[0]=yt(L=>N(_.value),["enter"])),id:"name",disabled:y.value,placeholder:e(h)("workspace.settingsTab.dialog.editDialog.newWorkspaceNamePlaceholder"),modelValue:e(p),"onUpdate:modelValue":G[1]||(G[1]=L=>kt(p)?p.value=L:null),class:pe(["col-span-3 focus-visible:ring-offset-0",C.value?"focus-visible:ring-red-600":null])},null,8,["disabled","placeholder","modelValue","class"]),C.value?(s(),u("p",E5,d(e(h)("workspace.settingsTab.dialog.validError.newWorkspaceNameEmpty")),1)):w("",!0)]),o(F,{class:"gap-2"},{default:i(()=>[o(K,{"as-child":""},{default:i(()=>[o(O,{type:"button",variant:"outline",class:"rounded-full"},{default:i(()=>[me(d(e(h)("group.button.cancel")),1)]),_:1})]),_:1}),o(O,{disabled:e(S).newWorkspaceName.$invalid||y.value,onClick:G[2]||(G[2]=L=>N(_.value)),type:"button",class:"rounded-full"},{default:i(()=>[y.value?(s(),T(V,{key:0,class:"w-5 h-5 mr-2 animate-spin"})):w("",!0),me(" "+d(e(h)("workspace.settingsTab.dialog.editDialog.updateButtonLabel")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),t("div",R5,[G[6]||(G[6]=t("div",null,[t("i",{class:"bi bi-download"})],-1)),t("div",null,[t("div",F5,[t("div",P5,d(e(h)("workspace.settingsTab.allowDownloadLabel")),1),t("div",N5,d(e(h)("workspace.settingsTab.allowDownloadSubLabel")),1)])]),o(A,{checked:ee.value,"onUpdate:checked":G[4]||(G[4]=L=>ee.value=L),size:"base"},null,8,["checked"])])])):w("",!0),B.value?(s(),u("div",z5,[(s(),u(ve,null,Le(2,L=>t("div",{key:L,class:"flex items-center gap-4 p-4"},[t("div",U5,[o(k,{class:"h-4 w-[250px]"}),o(k,{class:"h-4 w-[200px]"})])])),64))])):w("",!0),R.value==="MEMBER"&&!B.value?(s(),u("div",O5,[t("p",j5,d(e(h)("workspace.unavailableMessage.noSettingAccessMessage")),1)])):w("",!0)])}}}),G5={class:"px-2 mt-8 h-full"},W5={class:"flex item-center gap-2 text-xl max-sm:text-base font-semibold"},H5={key:1},K5={class:"py-2"},q5={key:0,class:"grid grid-cols-1 gap-x-1.5 gap-y-1 md:gap-x-2 md:gap-y-1.5 lg:grid-cols-2 lg:gap-x-3 lg:gap-y-2.5 mt-0 sm:mt-5"},Q5={class:"space-y-2"},J5={key:1,class:"flex flex-col items-center justify-center h-48 text-stone-500"},X5={class:"text-2xl font-semibold opacity-50 mt-2"},Y5={key:2,class:"grid grid-cols-1 gap-x-1.5 gap-y-1 md:gap-x-2 md:gap-y-1.5 lg:grid-cols-2 lg:gap-x-3 lg:gap-y-2.5 mt-0 sm:mt-5"},Z5={class:"h-24 sm:h-28 hover:bg-stone-100 dark:hover:bg-stone-800 rounded-xl p-1 sm:p-5 cursor-pointer flex gap-3 transition duration-200 ease-in-out items-center"},eE={class:"flex items-center justify-center font-bold text-md w-8 h-8 rounded-full"},tE={class:"flex flex-col gap-1 w-full"},sE={class:"font-semibold text-xs line-clamp-1 sm:line-clamp-2 wrap-anywhere whitespace-wrap overflow-hidden text-ellipsis max-w-60 sm:max-w-full"},aE={class:"text-start text-xs line-clamp-2 wrap-anywhere opacity-40 whitespace-wrap overflow-hidden text-ellipsis max-w-[90%]"},oE={class:"text-sm text-stone-600 wrap-anywhere"},nE={class:"text-xs text-stone-500 truncate whitespace-wrap overflow-hidden text-ellipsis max-w-[60%]"},lE={key:0,variant:"ghost",class:"p-0 m-0 flex items-center mr-2 w-full"},iE={key:1,class:"flex items-center gap-2 w-full"},rE={class:"text-sm"},cE={class:"flex flex-col items-center justify-center pb-5"},dE={class:"font-semibold text-md my-5 wrap-anywhere text-center max-w-60 sm:max-w-200 truncate"},uE={class:"text-sm text-center wrap-anywhere opacity-40"},pE={class:"flex max-sm:flex-col items-center mt-7 gap-4"},mE={key:3,class:"w-full flex justify-center mt-8"},pl=6,gE=oe({__name:"WorkspaceAllSearchAgents",setup(n){const l=is(),{getAllAgentsWorkspace:a,pinAgent:c,unpinAgent:r}=l,{allAgents:p,allAgentsAmount:m,pinnedAgents:g}=ie(l),h=ot(),_=tt(),x=Ce(),{t:b}=We(x.t),S=as(),{currentWorkspace:D,loadingGetCurrentWorkspace:y}=ie(S),I=v(!1),C=v(!1),U=K=>{h.push({name:"workspace-create-edit-agents",params:{agentId:K}})},E=K=>{h.push({name:"workspace-agent-chat-home",params:{id:_.params.id,agentId:K}})},N=v(0),$=async()=>{const K={agent_name:"",offset:N.value,limit:pl};try{await a(_.params.id,K)}catch(V){console.error(V),Ue({title:b("home.toast.fail.generalErrorTitle"),description:b("home.toast.fail.generalError"),variant:"destructive"})}},R=async()=>{N.value+=pl,I.value=!0,await $(),I.value=!1};Te(()=>_.params.id,async K=>{if(K)N.value=0,C.value=!0,await $(),C.value=!1;else return},{immediate:!0});const B=[{key:"pin",disabled:!1},{key:"copy",disabled:!1}],j=async(K,V)=>{K.key==="pin"&&(W(V)?await O(V):await X(V)),K.key==="copy"&&await H(V)},ee=v(!1),{protocol:se,host:G}=window.location,J=v(`${se}//${G}`),H=async K=>{try{await navigator.clipboard.writeText(`${J.value}/workspace/${_.params.id}/agent/${K}`),Ue({title:b("editAgent.toast.success.linkCopy")}),ee.value=!0,setTimeout(()=>ee.value=!1,2e3)}catch{Ue({title:b("editAgent.toast.fail.generalErrorTitle"),description:b("editAgent.toast.fail.generalError"),variant:"destructive"})}},M=v(!1),W=K=>Array.isArray(g.value)&&g.value.some(V=>V.id===K),X=async K=>{try{M.value=!0,await c(_.params.id,K),Ue({title:b("workspace.toast.pinAgent")})}catch(V){console.error(V),Ue({title:b("workspace.toast.fail.generalErrorTitle"),description:b("workspace.toast.fail.pinAgent"),variant:"destructive"})}finally{M.value=!1}},O=async K=>{try{M.value=!0,await r(_.params.id,K),Ue({title:b("workspace.toast.unpinAgent")})}catch(V){console.log(V),Ue({title:b("workspace.toast.fail.generalErrorTitle"),description:b("workspace.toast.fail.unpinAgent"),variant:"destructive"})}finally{M.value=!1}};return(K,V)=>{var re;const F=f("Skeleton"),P=f("TooltipTrigger"),q=f("TooltipContent"),A=f("Tooltip"),k=f("TooltipProvider"),L=f("DialogTrigger"),z=f("DialogTitle"),Q=f("DialogDescription"),ae=f("Loader"),de=f("Button"),le=f("DialogContent"),te=f("Dialog"),Z=f("Loader2");return s(),u("div",G5,[t("div",W5,[t("p",null,d(e(b)("workspace.allAgent.workspaceName.topLabel")),1),e(y)?(s(),T(F,{key:0,class:"h-6 w-40"})):(s(),u("p",H5,d((re=e(D))==null?void 0:re.name),1))]),t("div",K5,[t("div",null,[C.value?(s(),u("div",q5,[(s(),u(ve,null,Le(6,ue=>t("div",{key:ue,class:"flex items-center gap-4 p-4"},[o(F,{class:"h-16 w-16 rounded-full"}),t("div",Q5,[o(F,{class:"h-4 w-[250px]"}),o(F,{class:"h-4 w-[100px]"}),o(F,{class:"h-4 w-[200px]"})])])),64))])):e(p).length===0?(s(),u("div",J5,[t("p",X5,d(e(b)("home.searchAgent.label.noAgent")),1)])):(s(),u("div",Y5,[(s(!0),u(ve,null,Le(e(p),(ue,he)=>(s(),T(te,{key:ue.id},{default:i(()=>[o(L,{"as-child":""},{default:i(()=>[t("div",Z5,[t("div",eE,d(he+1),1),o(wt,{fallbackText:ue.name,size:"base"},null,8,["fallbackText"]),t("div",tE,[t("h1",sE,d(ue.name),1),o(k,{"as-child":""},{default:i(()=>[o(A,null,{default:i(()=>[o(P,null,{default:i(()=>[t("h3",aE,d(ue.description),1)]),_:2},1024),o(q,{class:"m-auto max-w-xs p-2 bg-white text-left"},{default:i(()=>[t("h3",oE,d(ue.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),t("h3",nE,d(ue.owner.name),1)])])]),_:2},1024),o(le,{class:"w-full max-w-sm sm:max-w-lg rounded-md sm:rounded-lg","no-close":!1},{"extra-button":i(()=>[o(na,{items:B,"item-key":"key",icon:"bi bi-three-dots",onOnSelect:$e=>j($e,ue.id)},{item:i(({item:$e})=>[$e.key==="pin"?(s(),u("div",lE,[t("div",null,[M.value?w("",!0):(s(),u("i",{key:0,class:pe(W(ue.id)?"bi bi-eye-slash mr-2":"bi bi-pin mr-2")},null,2)),M.value?(s(),T(ae,{key:1,class:"w-4 h-4 animate-spin"})):w("",!0)]),t("span",null,d(W(ue.id)?e(b)("home.searchAgent.button.unpinAgent"):e(b)("home.searchAgent.button.pinAgent")),1)])):$e.key==="copy"?(s(),u("div",iE,[V[0]||(V[0]=t("i",{class:"bi bi-link"},null,-1)),t("span",rE,d(e(b)("home.searchAgent.button.copyLink")),1)])):w("",!0)]),_:2},1032,["onOnSelect"])]),default:i(()=>[o(z),o(Q),t("div",cE,[o(wt,{fallbackText:ue.name,size:"base","avatar-class":"m-auto mt-10"},null,8,["fallbackText"]),t("h1",dE,d(ue.name),1),me(" "+d(e(b)("home.searchAgent.label.hasCreated",{person:ue.owner.name}))+" ",1),t("h2",uE,d(ue.description),1),t("div",pE,[o(de,{onClick:$e=>U(ue.id),class:"bg-stone-100 hover:bg-stone-200 text-black"},{default:i(()=>[V[1]||(V[1]=t("i",{class:"bi bi-eye mr-2"},null,-1)),me(" "+d(e(b)("workspace.createEditAgent.dialog.button.label.createEditAgent")),1)]),_:2,__:[1]},1032,["onClick"]),o(de,{onClick:$e=>E(ue.id),class:"bg-stone-100 hover:bg-stone-200 text-black"},{default:i(()=>[V[2]||(V[2]=t("i",{class:"bi bi-chat mr-2"},null,-1)),me(" "+d(e(b)("home.searchAgent.button.newChat")),1)]),_:2,__:[2]},1032,["onClick"])])])]),_:2},1024)]),_:2},1024))),128))])),e(m)>e(p).length&&!C.value?(s(),u("div",mE,[o(de,{onClick:R,class:"w-full sm:w-1/2 my-5 text-xs",variant:"outline"},{default:i(()=>[I.value?(s(),T(Z,{key:0,class:"w-4 h-4 animate-spin mr-2"})):w("",!0),t("span",null,d(e(b)("home.searchAgent.button.seeMore")),1)]),_:1})])):w("",!0)])])])}}}),fE={key:0,class:"absolute flex items-center justify-center bg-white dark:bg-stone-800 mt-1 shadow-lg h-16 rounded-lg w-full z-50"},vE={class:"font-semibold xl:text-md sm:text-sm whitespace-nowrap overflow-hidden text-ellipsis sm:max-w-[35rem] max-w-[15rem]"},hE={class:"font-extralight dark:text-white text-sm text-left text-stone-600 whitespace-nowrap overflow-hidden text-ellipsis sm:max-w-[35rem] max-w-[15rem]"},_E={class:"sm:text-sm text-xs line-clamp-1 opacity-40 whitespace-wrap overflow-hidden w-full"},bE={key:0,class:"backdrop-blur-2xs fixed inset-0 bg-black/80 dark:bg-stone-950/80 flex items-center justify-center z-50"},kE={key:0,variant:"ghost",class:"p-0 m-0 flex items-center mr-2 w-full"},yE={key:1,class:"flex items-center gap-2 w-full"},xE={class:"text-sm"},wE={class:"flex flex-col items-center justify-center pb-5"},$E={class:"font-semibold text-md text-center my-5"},SE={class:"text-sm opacity-40"},TE={class:"text-sm text-center opacity-40"},AE={class:"flex items-center mt-7 gap-4"},CE=oe({__name:"SearchAllAgentBar",setup(n){const l=is(),{pinAgent:a,unpinAgent:c,searchAgentsWorkspace:r}=l,{pinnedAgents:p}=ie(l),m=ot(),g=tt(),{t:h}=Ce(),_=v([]),x=v(""),b=v(!1),S=us(async V=>{const F={agent_name:V};try{b.value=!0;const P=await r(g.params.id,F);_.value=P??[]}catch(P){console.error(P),Ue({title:h("home.toast.fail.generalErrorTitle"),description:h("home.toast.fail.generalError"),variant:"destructive"})}finally{b.value=!1}},300);Te(x,V=>{if(!V){_.value=[];return}S(V)});const D=v(!1),y=v(!1),I=v(),C=Bt("searchBoxRef"),U=Bt("dialogContentRef"),E=v(!1);aa(C,()=>{E.value||(D.value=!1)}),aa(U,()=>{E.value||(y.value=!1),E.value=!1});const N=V=>{I.value=V,y.value=!0},$=()=>{D.value=!0},R=async V=>{m.push({name:"workspace-agent-chat-home",params:{id:g.params.id,agentId:V}})},B=V=>{m.push({name:"workspace-create-edit-agents",params:{agentId:V}})},j=[{key:"pin",disabled:!1},{key:"copy",disabled:!1}],ee=async(V,F)=>{V.key==="pin"&&(X(F)?await K(F):await O(F)),V.key==="copy"&&await M(F)},se=v(!1),{protocol:G,host:J}=window.location,H=v(`${G}//${J}`),M=async V=>{try{await navigator.clipboard.writeText(`${H.value}/workspace/${g.params.id}/agent/${V}`),Ue({title:h("editAgent.toast.success.linkCopy")}),se.value=!0,setTimeout(()=>se.value=!1,2e3)}catch{Ue({title:h("editAgent.toast.fail.generalErrorTitle"),description:h("editAgent.toast.fail.generalError"),variant:"destructive"})}},W=v(!1),X=V=>Array.isArray(p.value)&&p.value.some(F=>F.id===V),O=async V=>{try{y.value=W.value=!0,await a(g.params.id,V),Ue({title:h("workspace.toast.pinAgent")})}catch(F){console.error(F),Ue({title:h("workspace.toast.fail.generalErrorTitle"),description:h("workspace.toast.fail.pinAgent"),variant:"destructive"})}finally{W.value=!1}},K=async V=>{try{W.value=!0,await c(g.params.id,V),Ue({title:h("workspace.toast.unpinAgent")})}catch(F){console.log(F),Ue({title:h("workspace.toast.fail.generalErrorTitle"),description:h("workspace.toast.fail.unpinAgent"),variant:"destructive"})}finally{W.value=!1}};return(V,F)=>{var ae,de,le,te;const P=f("CommandInput"),q=f("Loader"),A=f("CommandItem"),k=f("CommandGroup"),L=f("CommandList"),z=f("Command"),Q=f("Button");return s(),u("div",{class:"my-4",ref_key:"searchBoxRef",ref:C},[o(z,{class:"overflow-visible relative h-10"},{default:i(()=>[o(P,{class:"h-9 z-10 w-full",placeholder:e(h)("home.searchAgent.label.searchAgent"),modelValue:x.value,"onUpdate:modelValue":F[0]||(F[0]=Z=>x.value=Z),modelModifiers:{lazy:!0},onFocus:$},null,8,["placeholder","modelValue"]),D.value&&x.value?(s(),T(L,{key:0},{default:i(()=>[b.value?(s(),u("div",fE,[o(q,{class:"size-4 animate-spin"})])):w("",!0),o(k,{class:"absolute bg-white dark:bg-stone-800 mt-1 shadow-lg max-h-48 overflow-y-auto rounded-lg w-full z-50"},{default:i(()=>[(s(!0),u(ve,null,Le(_.value,Z=>(s(),T(A,{key:Z,value:Z,class:"flex items-center gap-4 h-22 cursor-pointer dark:hover:bg-stone-700",onSelect:re=>N(Z)},{default:i(()=>[o(wt,{fallbackText:Z.name,size:"base"},null,8,["fallbackText"]),t("div",null,[t("h1",vE,d(Z.name),1),t("h2",hE,d(Z.description),1),t("h2",_E,d(e(h)("home.searchAgent.label.hasCreated",{person:Z.owner.name})),1)])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})):w("",!0)]),_:1}),y.value?(s(),u("div",bE,[t("div",{onClick:F[6]||(F[6]=Z=>E.value=!1),ref_key:"dialogContentRef",ref:U,class:"bg-white dark:bg-stone-800 rounded-md shadow-lg p-4 w-full max-w-md"},[t("div",{onClick:F[3]||(F[3]=Ye(Z=>E.value=!0,["stop"])),class:"top-dialog-buttons flex items-center justify-end gap-3"},[o(na,{items:j,"item-key":"key",icon:"bi bi-three-dots",onOnSelect:F[1]||(F[1]=Z=>ee(Z,I.value.id))},{item:i(({item:Z})=>[Z.key==="pin"?(s(),u("div",kE,[t("div",null,[W.value?w("",!0):(s(),u("i",{key:0,class:pe(X(I.value.id)?"bi bi-eye-slash mr-2":"bi bi-pin mr-2")},null,2)),W.value?(s(),T(q,{key:1,class:"w-4 h-4 animate-spin"})):w("",!0)]),t("span",null,d(X(I.value.id)?e(h)("home.searchAgent.button.unpinAgent"):e(h)("home.searchAgent.button.pinAgent")),1)])):Z.key==="copy"?(s(),u("div",yE,[F[7]||(F[7]=t("i",{class:"bi bi-link"},null,-1)),t("span",xE,d(e(h)("home.searchAgent.button.copyLink")),1)])):w("",!0)]),_:1}),t("div",null,[t("i",{class:"bi bi-x cursor-pointer",onClick:F[2]||(F[2]=Z=>y.value=!1)})])]),t("div",wE,[o(wt,{fallbackText:(ae=I.value)==null?void 0:ae.name,size:"base",avatarClass:"m-auto mt-10"},null,8,["fallbackText"]),t("h1",$E,d((de=I.value)==null?void 0:de.name),1),t("h2",SE,d(e(h)("home.searchAgent.label.hasCreated",{person:(le=I.value)==null?void 0:le.owner.name})),1),t("h2",TE,d((te=I.value)==null?void 0:te.description),1),t("div",AE,[o(Q,{onClick:F[4]||(F[4]=Z=>{var re;return B(((re=I.value)==null?void 0:re.id)??"")}),class:"bg-stone-100 hover:bg-stone-200 text-black"},{default:i(()=>[F[8]||(F[8]=t("i",{class:"bi bi-eye mr-2"},null,-1)),me(" "+d(e(h)("workspace.createEditAgent.dialog.button.label.createEditAgent")),1)]),_:1,__:[8]}),o(Q,{onClick:F[5]||(F[5]=Z=>{var re;return R(((re=I.value)==null?void 0:re.id)??"")}),class:"bg-stone-100 hover:bg-stone-200 text-black"},{default:i(()=>[F[9]||(F[9]=t("i",{class:"bi bi-chat mr-2"},null,-1)),me(" "+d(e(h)("home.searchAgent.button.newChat")),1)]),_:1,__:[9]})])])],512)])):w("",!0)],512)}}}),DE={class:"w-full h-[calc(100dvh-4.5rem)] overflow-y-auto"},LE={class:"w-10/12 sm:w-3/4 m-auto mt-14"},IE={class:"sm:text-center text-2xl sm:text-4xl font-semibold max-sm:mt-5 sm:mb-5"},BE={class:"sm:text-center text-sm/6 opacity-50 sm:w-3/4 sm:mx-auto"},ME=oe({__name:"WorkspaceAllAgentsView",setup(n){const l=Ce(),{t:a}=We(l.t);return(c,r)=>(s(),u("div",DE,[t("div",LE,[t("div",null,[t("h1",IE,d(e(a)("workspace.allAgent.topTitle")),1),t("h2",BE,d(e(a)("home.searchAgent.label.description")),1)]),o(CE),o(gE)])]))}}),EE={class:"p-3 bg-white dark:bg-stone-800 flex items-center justify-between border-b"},RE={class:"flex items-center gap-3"},FE={class:"flex items-center"},PE={key:0},NE={class:"flex flex-col"},zE={key:0,class:"flex flex-col gap-2"},UE={key:1,class:"whitespace-nowrap text-sm font-semibold truncate max-w-40 sm:max-w-lg"},OE={key:0,class:"flex flex-col gap-2"},jE={key:1,class:"flex items-center space-x-1"},VE={class:"text-xs"},GE={key:2,class:"flex items-center gap-2"},WE={class:"text-xs"},HE={key:0,class:"flex items-center gap-3"},KE={class:"font-semibold"},qE={key:1,class:"opacity-60"},QE={key:0,class:"flex items-center gap-3"},JE={key:0,class:"flex items-center"},XE={class:"text-xs sm:text-sm"},YE={class:"text-xs sm:text-sm"},ZE={class:"text-sm"},eR={class:"text-sm"},tR={class:"text-sm"},sR={class:"text-sm"},aR={class:"text-sm"},oR=oe({__name:"CreateEditAgentTopbar",props:{name:{},currentAgentId:{},updateAgent:{type:Function},saving:{type:Boolean}},emits:["routeLeave"],setup(n,{emit:l}){const a=ot(),c=n,r=l,p=as(),m=is(),g=at(),{publishAgent:h,getWorkspaceAgentById:_,deleteWorkspaceAgent:x,pinAgent:b,getPinnedAgents:S,unpinAgent:D}=m,{loadingAgentInfo:y,agentUpdateBeforePublishStatus:I,currentAgent:C,pinnedAgents:U}=ie(m),{currentWorkspace:E}=ie(p),{getCurrentWorkspace:N}=p,{isMobileSize:$}=ie(g),R=Ce(),{t:B}=We(R.t),j=tt(),ee=j.params.id,se=v(!1),G=v(!1),J=async()=>{try{await h(ee,c.currentAgentId??""),await _(ee,c.currentAgentId??""),Ue({title:B("editAgent.toast.success.createAgent")})}catch(F){console.error(F),Ue({title:B("editAgent.toast.fail.generalErrorTitle"),description:B("editAgent.toast.fail.generalError"),variant:"destructive"})}},H=()=>{window.history.length>1?a.back():a.push({name:"workspace-mine-agents",params:{id:j.params.id}})},M=async()=>{try{G.value=!0,c.currentAgentId&&(await x(j.params.id,c.currentAgentId),Ue({title:B("editAgent.toast.success.deleteAgent")}),H())}catch(F){console.error(F),Ue({title:B("editAgent.toast.fail.generalErrorTitle"),description:B("editAgent.toast.fail.generalError"),variant:"destructive"})}finally{se.value=!1,G.value=!1}},W=()=>{a.push({name:"workspace-agent-chat-home",params:{id:j.params.id,agentId:j.params.agentId}})};Dt(async()=>{await N(j.params.id),await S(j.params.id)});const X=ne(()=>Array.isArray(U.value)&&U.value.some(F=>{var P;return F.id===((P=C.value)==null?void 0:P.id)})),O=v(!1),K=async()=>{try{O.value=!0,C.value&&(await b(j.params.id,j.params.agentId),Ue({title:B("workspace.toast.pinAgent")}))}catch(F){console.log(F),Ue({title:B("workspace.toast.fail.generalErrorTitle"),description:B("workspace.toast.fail.pinAgent"),variant:"destructive"})}finally{O.value=!1}},V=async()=>{try{O.value=!0,C.value&&(await D(j.params.id,j.params.agentId),Ue({title:B("workspace.toast.unpinAgent")}))}catch{Ue({title:B("workspace.toast.fail.generalErrorTitle"),description:B("workspace.toast.fail.unpinAgent"),variant:"destructive"})}finally{O.value=!1}};return(F,P)=>{var Ge,fe,Y,ce,ge,ye,_e,Re,ke,qe,lt,St,Nt,Mt,vt,zt;const q=f("Skeleton"),A=f("Loader2"),k=f("Button"),L=f("DropdownMenuTrigger"),z=f("AlertDialogTrigger"),Q=f("AlertDialogTitle"),ae=f("AlertDialogDescription"),de=f("AlertDialogHeader"),le=f("AlertDialogCancel"),te=f("Loader"),Z=f("AlertDialogAction"),re=f("AlertDialogFooter"),ue=f("AlertDialogContent"),he=f("AlertDialog"),$e=f("DropdownMenuItem"),Se=f("DropdownMenuContent"),be=f("DropdownMenu");return s(),u("div",EE,[t("div",RE,[t("div",FE,[o(Pe,{onClick:P[0]||(P[0]=bt=>r("routeLeave")),variant:"ghost",size:"icon",icon:"bi bi-chevron-left",tooltip:e(B)("editAgent.topBar.button.goBack"),disabled:c.saving},null,8,["tooltip","disabled"]),t("div",null,[e(y)?(s(),u("div",PE,[o(q,{class:"h-9 w-9 rounded-full dark:bg-stone-700"})])):(s(),T(wt,{key:1,fallbackText:c.name,size:"sm",avatarClass:"transition-all duration-700"},null,8,["fallbackText"]))])]),t("div",NE,[t("div",null,[e(y)?(s(),u("div",zE,[o(q,{class:"h-3 w-24 mb-2 dark:bg-stone-700"})])):(s(),u("span",UE,d(c.name??e(B)("editAgent.topBar.newAgentTitle")),1))]),t("div",null,[e(y)?(s(),u("div",OE,[o(q,{class:"h-3 w-15 dark:bg-stone-700"})])):!e(C)||e(C).status==="DRAFT"?(s(),u("div",jE,[P[6]||(P[6]=t("i",{class:"bi bi-circle-fill text-stone-400 text-[0.5rem]"},null,-1)),t("span",VE,d(e(B)("editAgent.topBar.activeStatusDraft")),1)])):(s(),u("div",GE,[P[7]||(P[7]=t("i",{class:"bi bi-circle-fill text-green-400 text-[0.5rem]"},null,-1)),t("span",WE,d(e(B)("editAgent.topBar.activeStatusLive")),1)]))])]),e($)?w("",!0):(s(),u("div",HE,[P[8]||(P[8]=t("span",null,"|",-1)),t("p",KE,d(e(B)("workspace.appTopbar.group.label.currentWorkspace"))+": ",1),e(y)?(s(),T(q,{key:0,class:"h-5 w-40 dark:bg-stone-700"})):(s(),u("span",qE,d((Ge=e(E))==null?void 0:Ge.name),1))]))]),((fe=e(C))==null?void 0:fe.owner.id)===((ce=(Y=e(C))==null?void 0:Y.currentUserInfo)==null?void 0:ce.id)?(s(),u("div",QE,[(ge=e(C))!=null&&ge.id&&e(I)!=="notUpdated"?(s(),u("div",JE,[e(I)==="updating"?(s(),u(ve,{key:0},[o(A,{class:"w-4 h-4 animate-spin mr-2"}),t("span",XE,d(e(B)("editAgent.button.updateButtonLabel.updating")),1)],64)):w("",!0),e(I)!=="updating"?(s(),u(ve,{key:1},[P[9]||(P[9]=t("i",{class:"bi bi-check2 mr-2 text-green-500 text-xl"},null,-1)),t("span",YE,d(e(B)("editAgent.button.updateButtonLabel.updated")),1)],64)):w("",!0)])):w("",!0),t("div",null,[F.currentAgentId&&(((ye=e(C))==null?void 0:ye.status)==="PUBLISH"||((_e=e(C))==null?void 0:_e.status)==="DRAFT")?(s(),T(be,{key:0,open:se.value,"onUpdate:open":P[3]||(P[3]=bt=>se.value=bt)},{default:i(()=>[o(L,null,{default:i(()=>[o(k,{variant:"ghost",class:"p-5 rounded-3xl dark:hover:bg-stone-700"},{default:i(()=>P[10]||(P[10]=[t("i",{class:"bi bi-three-dots"},null,-1)])),_:1,__:[10]})]),_:1}),o(Se,{class:"rounded-xl"},{default:i(()=>[o($e,null,{default:i(()=>[o(he,null,{default:i(()=>[o(z,{onClick:P[1]||(P[1]=Ye(()=>{},["stop"])),class:"text-red-600 flex gap-2"},{default:i(()=>[P[11]||(P[11]=t("i",{class:"bi bi-trash"},null,-1)),t("span",ZE,d(e(B)("editAgent.dialog.deleteAgent.deleteAgentDialogHeader")),1)]),_:1,__:[11]}),o(ue,null,{default:i(()=>[o(de,null,{default:i(()=>[o(Q,null,{default:i(()=>[me(d(e(B)("editAgent.dialog.deleteAgent.deleteAgentDialogHeader")),1)]),_:1}),o(ae,null,{default:i(()=>[me(d(e(B)("editAgent.dialog.deleteAgent.deleteAgentDialogDescription")),1)]),_:1})]),_:1}),o(re,null,{default:i(()=>[o(le,{onClick:P[2]||(P[2]=bt=>se.value=!1)},{default:i(()=>[me(d(e(B)("editAgent.button.cancelButtonLabel")),1)]),_:1}),o(Z,{onClick:M,class:"bg-red-600 hover:bg-red-500"},{default:i(()=>[me(d(e(B)("editAgent.button.deleteButtonLabel"))+" ",1),G.value?(s(),T(te,{key:0,class:"w-4 h-4 animate-spin"})):w("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])):w("",!0)]),X.value?X.value?(s(),T(Pe,{key:2,variant:"outline",icon:"bi bi-eye-slash text-lg mr-2",size:"default",disabled:((qe=e(C))==null?void 0:qe.status)==="DRAFT"||O.value||c.saving||e(y),onClick:V},{default:i(()=>[t("span",tR,d(e(B)("editAgent.dialog.option.unpinAgentButtonLabel")),1),O.value?(s(),T(te,{key:0,class:"w-4 h-4 animate-spin ml-2"})):w("",!0)]),_:1},8,["disabled"])):w("",!0):(s(),T(Pe,{key:1,variant:"outline",icon:"bi bi-pin-angle text-lg mr-2",size:"default",disabled:((Re=e(C))==null?void 0:Re.status)==="DRAFT"||O.value||c.saving||e(y),tooltip:((ke=e(C))==null?void 0:ke.status)==="DRAFT"?e(B)("editAgent.topBar.button.disabled.noPublishedAgent"):"",onClick:K},{default:i(()=>[t("span",eR,d(e(B)("editAgent.dialog.option.pinAgentButtonLabel")),1),O.value?(s(),T(te,{key:0,class:"w-4 h-4 animate-spin ml-2"})):w("",!0)]),_:1},8,["disabled","tooltip"])),((lt=e(C))==null?void 0:lt.status)==="PUBLISH"||((St=e(C))==null?void 0:St.status)==="DRAFT"?(s(),u(ve,{key:3},[(Nt=e(C))!=null&&Nt.id&&e(C)?(s(),T(k,{key:0,onClick:P[4]||(P[4]=bt=>F.updateAgent(e(j).params.id)),disabled:c.saving||e(y)},{default:i(()=>[t("span",sR,d(e(B)("editAgent.button.updateButtonLabel")),1)]),_:1},8,["disabled"])):w("",!0)],64)):w("",!0),((Mt=e(C))==null?void 0:Mt.status)!=="PUBLISH"?(s(),T(k,{key:4,disabled:!e(C)||e(I)==="updating"||e(y),onClick:P[5]||(P[5]=bt=>J())},{default:i(()=>[me(d(e(B)("editAgent.button.publishButtonLabel")),1)]),_:1},8,["disabled"])):w("",!0),((vt=e(C))==null?void 0:vt.status)==="PUBLISH"&&!e($)?(s(),u(ve,{key:5},[(zt=e(C))!=null&&zt.id&&e(C)?(s(),T(k,{key:0,disabled:e(y),onClick:W},{default:i(()=>[P[12]||(P[12]=t("i",{class:"bi bi-chat mr-2"},null,-1)),t("span",aR,d(e(B)("home.searchAgent.button.newChat")),1)]),_:1,__:[12]},8,["disabled"])):w("",!0)],64)):w("",!0)])):w("",!0)])}}}),nR={class:"flex flex-col justify-between items-center h-full overflow-y-auto w-full"},lR={key:0,class:"my-4 text-xl font-semibold text-center select-none"},iR={class:"sm:hidden flex justify-center items-center gap-2 opacity-50 my-4"},rR={class:"text-xs text-center"},cR={key:1,class:"agent-info flex flex-col items-center grow justify-center gap-3 w-full py-5"},dR={key:2,class:"flex items-center gap-3"},uR={class:"text-2xl font-bold text-center truncate max-w-[250px] sm:max-w-[800px]"},pR={key:4,class:"text-base text-stone-400"},mR={key:6,class:"max-w-sm sm:max-w-3xl break-words text-base text-center"},gR={class:"w-full p-2 sm:w-3/5 max-w-[800px]"},fR=["onClick"],vR={class:"text-sm select-none"},hR={class:"inline-block"},_R={key:0,class:"pt-2 flex flex-col max-w-sm sm:max-w-xl"},bR={class:"flex-1"},kR={class:"px-3 pt-4 pb-2 text-xs text-stone-400"},yR={class:"w-full gap-3 flex items-baseline contents-start overflow-hidden"},xR={class:"flex-1 text-sm text-left line-clamp-1 text-ellipsis"},wR=["href"],$R={class:"flex-1"},SR={key:3},TR={class:"w-11/12 sm:w-3/4 max-w-sm sm:max-w-200 sm:min-w-lg mx-auto h-full pt-5"},AR={class:"relative h-0"},CR={class:"relative w-full"},DR={key:0,class:"overflow-x-auto w-full flex items-center gap-2 px-8 pt-1.5 py-1"},LR={key:1,class:"max-sm:hidden text-xs text-center opacity-50 mb-2"},Hi=oe({__name:"WorkspaceAgentChatHomeView",props:{isUsingPreviewAgent:{type:Boolean},isAllowedToPreviewChat:{type:Boolean}},setup(n){const{t:l}=Ce(),a=ot(),c=tt(),{toast:r}=gt(),p=is(),{currentAgent:m}=ie(p),{getWorkspaceAgentById:g}=p,h=Ms(),{currentConversation:_,currentParentMessageId:x,newMessageAdded:b,hints:S,recentConversationsWithAgent:D}=ie(h),{fetchSupportModels:y,fetchRecentConversationsWithAgent:I}=h,C=at(),{isMobileSize:U}=ie(C),E=Js(),{clearState:N}=E,$=v(!1),R=ne(()=>c.params.agentId),B=n,j=Bt("chatContainer"),ee=v([]),se=(P,q)=>{P instanceof HTMLElement&&(ee.value[q]=P)},G=v(null),J=P=>{G.value&&G.value.setValue(P)},H=P=>{j.value&&(j.value.scrollTo({top:j.value.scrollHeight,behavior:P}),M.value=!0)},M=v(!0),W=()=>{if(!j.value)return;const P=j.value.scrollTop,q=j.value.clientHeight,A=j.value.scrollHeight;M.value=P+q>=A-10};Te(()=>{var P;return(P=_.value)==null?void 0:P.messagesList},W,{deep:!0}),Te(b,async P=>{var A,k;if(!P)return;await Ca(300);const q=ee.value[ee.value.length-2];q&&((k=(A=q.parentElement)==null?void 0:A.parentElement)==null||k.scrollTo({top:q.offsetTop-56}))});const X=async()=>{var P;if(!B.isUsingPreviewAgent){h.unshiftConversation(""),a.push({path:`/workspace/${c.params.id}/agent/${(P=m.value)==null?void 0:P.id}/chat/`});const q=Te(()=>{var A;return(A=_.value)==null?void 0:A.id},A=>{var k;A&&A!==""&&(a.replace({path:`/workspace/${c.params.id}/agent/${(k=m.value)==null?void 0:k.id}/chat/${A}`}),q())})}_.value||h.unshiftConversation("")},O=()=>{I(F.value,R.value,D.value.currentOffset)},K=(P,q)=>{const A=[...P];for(let k=A.length-1;k>0;k--){const L=Math.floor(Math.random()*(k+1));[A[k],A[L]]=[A[L],A[k]]}return A.slice(0,q)},V=v(null);Te(()=>{var P;return(P=m.value)==null?void 0:P.sampleQuestions},P=>{Array.isArray(P)&&P.length>4?V.value=K(P,4):V.value=P??[]});const F=ne(()=>c.params.id);return Te(()=>c.params.agentId,async()=>{if(_.value=void 0,S.value=[],!B.isUsingPreviewAgent)try{$.value=!0,N(),x.value=null,await g(F.value,R.value),await I(F.value,R.value,0)}catch(P){console.error(P),a.replace("/workspace/access-denied"),r({title:l("home.toast.fail.generalErrorTitle"),description:l("home.toast.fail.generalError"),variant:"destructive"})}finally{$.value=!1}await y(c.params.id)},{immediate:!0}),(P,q)=>{var z,Q,ae,de,le,te,Z,re;const A=f("RouterLink"),k=f("Button"),L=Kt("auto-animate");return s(),u("div",{class:pe([B.isUsingPreviewAgent?"h-[calc(100dvh-3.5rem)]":"h-dvh","flex flex-col items-center justify-center w-full"])},[t("div",nR,[B.isUsingPreviewAgent&&!e(_)?(s(),u("p",lR,d(e(l)("editAgent.preview.label")),1)):w("",!0),t("div",iR,[q[1]||(q[1]=t("i",{class:"bi bi-exclamation-circle text-xs"},null,-1)),t("p",rR,d(e(l)("home.chat.label.description",{ai:"PrivateGPT"})),1)]),e(_)?w("",!0):Ke((s(),u("div",cR,[$.value?(s(),T(Tt,{key:1,class:"h-16 w-16 rounded-full"})):(s(),T(wt,{key:0,fallbackText:(z=e(m))==null?void 0:z.name,size:"lg"},null,8,["fallbackText"])),$.value?(s(),T(Tt,{key:3,class:"w-32 h-7"})):(s(),u("div",dR,[t("span",uR,d((Q=e(m))==null?void 0:Q.name),1)])),$.value?(s(),T(Tt,{key:5,class:"w-60 h-7"})):(s(),u("div",pR,[t("span",null,[q[2]||(q[2]=t("i",{class:"bi bi-person"},null,-1)),me(" "+d(e(l)("home.chat.label.hasCreated",{person:(ae=e(m))==null?void 0:ae.owner.name})),1)])])),$.value?(s(),T(Tt,{key:7,class:"w-80 h-7"})):(s(),u("div",mR,d((de=e(m))==null?void 0:de.description),1)),t("div",gR,[Ke((s(),u("div",{class:pe([((te=(le=e(m))==null?void 0:le.sampleQuestions)==null?void 0:te.length)!==1?"grid grid-cols-2 gap-3":"grid grid-cols-1"])},[$.value?(s(),u(ve,{key:1},Le(4,ue=>o(Tt,{key:ue,class:"col-span-1 h-16 p-3 bg-stone-100 dark:bg-stone-800 hover:bg-stone-200 dark:hover:bg-stone-700 rounded-xl rounded-tr-xs w-full cursor-pointer wrap-anywhere"})),64)):(s(!0),u(ve,{key:0},Le(V.value,(ue,he)=>{var $e,Se,be,Ge;return s(),u("div",{key:he,class:pe([he===((Se=($e=e(m))==null?void 0:$e.sampleQuestions)==null?void 0:Se.length)-1&&((Ge=(be=e(m))==null?void 0:be.sampleQuestions)==null?void 0:Ge.length)%2!==0?"col-span-2":"col-span-1","p-3 bg-stone-100 dark:bg-stone-800 hover:bg-stone-200 dark:hover:bg-stone-700 rounded-xl rounded-tr-xs w-full cursor-pointer wrap-anywhere"]),onClick:fe=>J(ue)},[t("span",vR,d(ue),1)],10,fR)}),128))],2)),[[L]]),t("div",hR,[P.isUsingPreviewAgent?w("",!0):Ke((s(),u("div",_R,[$.value?(s(),u(ve,{key:0},[o(Tt,{class:"mx-3 mb-2 mt-4 w-12 h-5"}),(s(),u(ve,null,Le(4,ue=>t("div",{key:ue,class:"flex gap-3 items-center pl-3 py-2"},[t("div",null,[o(Tt,{class:"w-6 h-6 flex-0 rounded-full p-0"})]),t("div",bR,[o(Tt,{class:pe(["w-full h-4",{"w-64":ue%2,"w-80":!(ue%2)}])},null,8,["class"])]),t("div",null,[o(Tt,{class:"w-6 h-6 flex-0 rounded-full p-0"})])])),64)),o(Tt,{class:"mx-3 mb-2 mt-4 w-18 h-5"})],64)):w("",!0),!$.value&&((Z=e(D).items)!=null&&Z.length)?(s(),u(ve,{key:1},[t("div",kR,d(e(l)("home.chat.label.recentConversations")),1),(s(!0),u(ve,null,Le(e(D).items,ue=>(s(),u("div",{key:ue.id,class:"flex items-center"},[o(A,{to:`/workspace/${F.value}/agent/${ue.agentId}/chat/${ue.id}`,class:"flex-1 overflow-hidden"},{default:i(()=>[o(Pe,{size:"default",variant:"ghost",className:"rounded-full w-full"},{default:i(()=>{var he;return[t("div",yR,[o(wt,{fallbackText:(he=e(m))==null?void 0:he.name,size:"xxs",className:"flex-0"},null,8,["fallbackText"]),t("div",xR,d(ue.conversationName),1)])]}),_:2},1024)]),_:2},1032,["to"]),t("a",{href:`/workspace/${F.value}/agent/${ue.agentId}/chat/${ue.id}`,target:"_blank",class:"flex-0"},[o(Pe,{size:"mdicon",variant:"ghost",className:"rounded-full p-3.5 w-10 h-10"},{default:i(()=>[o(e(wl))]),_:1})],8,wR)]))),128))],64)):w("",!0),!$.value&&e(D).loading?(s(),u(ve,{key:2},Le(2,ue=>t("div",{key:ue,class:"flex gap-3 items-center pl-3 pr-2 py-3"},[t("div",null,[o(Tt,{class:"w-6 h-6 flex-0 rounded-full p-0"})]),t("div",$R,[o(Tt,{class:"w-full h-4"})]),t("div",null,[o(Tt,{class:"w-6 h-6 flex-0 rounded-full p-0"})])])),64)):w("",!0),!$.value&&e(D).currentOffset<e(D).total?(s(),u("div",SR,[o(Pe,{variant:"link",size:"sm",className:"mt-2 text-xs",onClick:O,disabled:e(D).loading},{default:i(()=>[me(d(e(l)("home.chat.button.seeMoreRecentConversation")),1)]),_:1},8,["disabled"])])):w("",!0)])),[[L]])])])])),[[L]]),e(_)?(s(),u("div",{key:2,class:"flex flex-col w-full justify-center overflow-y-auto gap-6 scroll-smooth",ref_key:"chatContainer",ref:j,onScroll:W},[t("div",TR,[(s(!0),u(ve,null,Le((re=e(_))==null?void 0:re.messagesList,(ue,he)=>(s(),u("div",{key:he,ref_for:!0,ref:$e=>se($e,he),class:"last:pb-5"},[ue.role==="USER"?(s(),T(Gi,{key:0,message:ue,class:"py-4"},null,8,["message"])):w("",!0),ue.role==="AI"?(s(),T(Wi,{key:1,message:ue,index:he,forWorkspace:!0},null,8,["message","index"])):w("",!0)]))),128))])],544)):w("",!0)]),t("div",{class:pe([B.isUsingPreviewAgent?"w-11/12":"w-full sm:w-3/4 sm:max-w-200 sm:min-w-lg sm:mx-auto"])},[t("div",AR,[M.value?w("",!0):(s(),T(Pe,{key:0,icon:"bi bi-arrow-down text-sm",size:"icon","class-name":"absolute h-8 w-8 rounded-full bg-white dark:bg-stone-700 border z-20 bottom-2 mx-auto shadow-md left-1/2",tooltip:e(l)("kaigiInstantRecord.button.scrollToBottom"),onClick:q[0]||(q[0]=ue=>H("smooth"))},null,8,["tooltip"]))]),t("div",CR,[q[3]||(q[3]=t("div",{class:"pointer-events-none absolute top-0 left-0 h-full w-10 -ml-1 bg-gradient-to-r from-white from-30% to-transparent to-90% dark:from-stone-900 transition-opacity duration-300 z-2"},null,-1)),e(U)?w("",!0):Ke((s(),u("div",DR,[(s(!0),u(ve,null,Le(e(S),ue=>(s(),T(k,{key:ue,onClick:he=>J(ue),variant:"ghost",class:"border border-blue-200 text-blue-400 dark:border-blue-200 dark:text-blue-300 hover:bg-blue-100/40 hover:text-blue-400 dark:hover:bg-blue-100/20 dark:hover:text-blue-300"},{default:i(()=>[me(d(ue),1)]),_:2},1032,["onClick"]))),128))])),[[L]]),q[4]||(q[4]=t("div",{class:"pointer-events-none absolute top-0 right-0 h-full w-10 bg-gradient-to-l from-white from-30% to-transparent to-80% dark:from-stone-900 transition-opacity duration-300"},null,-1))]),!$.value&&P.isAllowedToPreviewChat||!B.isUsingPreviewAgent?(s(),T(ao,{key:0,ref_key:"messageInputRef",ref:G,onHandleMessage:X,isUsingPreviewAgent:B.isUsingPreviewAgent},null,8,["isUsingPreviewAgent"])):w("",!0),$.value?w("",!0):(s(),u("p",LR,d(e(l)("home.chat.label.description",{ai:"PrivateGPT"})),1))],2)],2)}}}),IR={class:"h-full max-h-dvh sm:max-lg:h-[20rem] lg:max-2xl:h-[25rem] 2xl:h-[45rem] sm:max-w-2xl mx-auto"},BR=oe({__name:"SelectAgentFileDialog",props:bs({loading:{type:Boolean}},{open:{type:Boolean},openModifiers:{}}),emits:bs(["cancel","confirm"],["update:open"]),setup(n,{emit:l}){const a=Os(n,"open"),c=Ce(),{t:r}=We(c.t),p=n,m=l;return(g,h)=>{const _=f("Loader2");return s(),T(fa,{open:a.value,"onUpdate:open":h[0]||(h[0]=x=>a.value=x),"content-class":"max-w-3xl",onCancel:h[1]||(h[1]=x=>m("cancel")),onConfirm:h[2]||(h[2]=x=>m("confirm"))},Br({title:i(()=>[me(d(e(r)("workspace.selectAgentFileDialog.dialog.title")),1)]),description:i(()=>[t("div",IR,[o(nn,{"for-agent":!0,"table-height":"h-[30rem] sm:max-lg:max-h-[14rem] lg:max-2xl:max-h-[17rem] 2xl:max-h-[36rem]"})])]),_:2},[p.loading?{name:"confirm",fn:i(()=>[o(_,{class:"animate-spin"})]),key:"0"}:void 0]),1032,["open"])}}}),MR={key:0,class:"relative flex w-full border-b dark:bg-stone-700 items-center justify-between"},ER={class:"flex items-center gap-2"},RR={class:"wrap-anywhere"},FR={key:0,class:"ml-2 flex items-center px-4 py-1 rounded-full"},PR={class:"flex items-center gap-2"},NR={key:1,class:"ml-2 flex items-center px-4 py-1 rounded-full"},zR={class:"flex items-center gap-2"},UR=oe({__name:"WorkspaceAgentFileItem",props:{fileName:{},fileIndexStatus:{}},setup(n){const l=Ce(),{t:a}=We(l.t),c=n,r=Rt(c.fileName);return(p,m)=>c.fileName!==void 0?(s(),u("div",MR,[t("div",{class:pe([c.fileIndexStatus==="NONE"||c.fileIndexStatus==="FAILED"?"bg-orange-200 dark:bg-orange-400 dark:text-gray-800":"","grid grid-cols-[1fr_10rem] justify-between py-2 w-full pl-3"])},[t("div",ER,[t("i",{class:pe(["bi",`bi-filetype-${e(r)}`,"text-xl"])},null,2),t("p",RR,d(c.fileName),1)]),t("div",null,[c.fileIndexStatus==="NONE"||c.fileIndexStatus==="FAILED"?(s(),u("div",FR,[t("span",PR,[m[0]||(m[0]=t("i",{class:"bi bi-exclamation-triangle text-xs text-orange-500 dark:text-red-600"},null,-1)),t("span",null,d(e(a)("workspace.knowledgeBase.label.notIndexed")),1)])])):c.fileIndexStatus==="DONE"?(s(),u("div",NR,[t("span",zR,[m[1]||(m[1]=t("i",{class:"bi bi-check text-green-400"},null,-1)),t("span",null,d(e(a)("workspace.knowledgeBase.label.indexed")),1)])])):w("",!0)])],2)])):w("",!0)}}),OR={class:"w-full flex h-[calc(100dvh-4rem)]"},jR={class:"w-full sm:w-1/2 flex justify-center overflow-y-auto"},VR={class:"flex flex-col w-11/12 mt-7"},GR={class:"flex items-center gap-4 mb-6"},WR={class:"text-base font-bold"},HR={key:1,class:"w-1/2 sm:w-1/3"},KR={class:"flex flex-col gap-8 pb-7"},qR={class:"w-full"},QR={class:"text-base font-bold"},JR={class:"text-base font-bold"},XR={class:"text-base font-bold"},YR={class:"flex items-center gap-4"},ZR={class:"text-base font-bold"},eF={key:1,class:"w-1/2 sm:w-1/3"},tF={class:"flex flex-col"},sF={class:"block text-sm opacity-60 line-clamp-1"},aF={class:"text-base font-bold"},oF={key:1,class:"focus-visible:ring-offset-0 dark:bg-background border rounded-lg mt-3"},nF={class:"flex justify-end items-center px-2.5 mt-2"},lF={key:0},iF={key:0,class:"flex items-center justify-between gap-2 bg-stone-100 dark:bg-stone-800 w-full p-2 rounded-lg my-1"},rF={class:"wrap-anywhere max-w-9/10 text-sm px-2"},cF={class:"flex flex-col gap-2 mb-3"},dF={class:"text-base font-bold"},uF={class:"text-sm text-muted-foreground"},pF={key:0,class:"text-sm text-muted-foreground"},mF={class:"grid grid-cols-[1fr_8rem] px-3 mb-4"},gF={class:"font-semibold"},fF={class:"font-semibold"},vF={class:"flex flex-row gap-2 items-center"},hF={class:"max-sm:hidden w-1/2 border-l"},_F=oe({__name:"WorkspaceCreateEditAgent",setup(n){const l=tt(),a=ot(),c=is(),r=at(),{isMobileSize:p}=ie(r),{workspaceAgentSupportModels:m,sampleQuestion:g,sampleQuestions:h,agentAvailableTools:_,currentAgentId:x,currentAgent:b,loadingCreateEditAgent:S,agentUpdateStatus:D,agentUpdateBeforePublishStatus:y,loadingAgentInfo:I,agentInfoChanged:C,isUpdatedAgentFail:U,currentAgentKnowledgeFiles:E}=ie(c),{getWorkspaceAgentSupportModels:N,getAgentAvailableTools:$,createWorkspaceAgent:R,editWorkspaceAgent:B,getWorkspaceAgentById:j,addFileToKnowledge:ee,getAgentKnowledgeFiles:se}=c,G=co(),{convertFromPathToName:J}=G,{selectedFileIds:H}=ie(G),M=Ce(),{t:W}=We(M.t),X=v(""),O=v(""),K=v(""),V=v(""),F=v(!1),P=v(null),q=v(!1),A=v(!1),k=v(!1),L=ne({get:()=>P.value?[P.value]:[],set:fe=>{P.value=fe[0]||null}}),z=(fe,Y)=>fe-Y<=2,Q=v(!1),ae=()=>{Q.value=!1},de=async()=>{C.value&&await he(l.params.id),a.back()},le=v(!1),te=fe=>{var Y;!fe||h.value&&(h.value.length>=Ns||g.value.length>fs)||((Y=h.value)==null||Y.push(fe),g.value="")},Z=fe=>{p.value||(fe.preventDefault(),te(g.value))},re=fe=>{var Y;(Y=h.value)==null||Y.splice(fe,1)},ue=async fe=>{S.value=!0,F.value=!0;try{if(!x.value&&!b.value){const Y={model_id:X.value,name:O.value??"",description:K.value??"",instructions:V.value??"",tools:L.value??[],sample_questions:h.value??[]};await R(fe,Y),Te(x,async ge=>{ge&&ge!==""&&(a.replace({path:`/workspace/${fe}/agents/editor/${ge}`}),await j(l.params.id,ge))},{immediate:!0})()}q.value=!0}catch(Y){console.error(Y),Ue({title:W("editAgent.toast.fail.createAgent"),variant:"destructive"})}finally{S.value=!1,F.value=!1}},he=async fe=>{Se.cancel(),D.value="updating",y.value="updating",S.value=!0,U.value=!1;try{if(F.value=!0,x.value&&b.value){const Y={model_id:X.value,name:O.value??"",description:K.value??"",instructions:V.value??"",tools:L.value??[],sample_questions:h.value??[]};await B(fe,x.value,Y)}}catch(Y){U.value=!0,console.error(Y),Ue({title:W("editAgent.toast.fail.updateAgent"),variant:"destructive"})}finally{F.value=!1,S.value=!1,D.value="updated",y.value="updated",C.value=!1}},$e=us(ue,Vl),Se=us(he,jl),be=v(!1);Te([O,K,V],(fe,Y)=>{!be.value||Y.some(ce=>ce===void 0)||!x.value&&!b.value&&$e(l.params.id)}),Te([X,O,K,V,L],(fe,Y)=>{!be.value||Y.some(ge=>ge===void 0)||!fe.some((ge,ye)=>Array.isArray(ge)&&Array.isArray(Y[ye])?JSON.stringify(ge)!==JSON.stringify(Y[ye]):ge!==Y[ye])||x.value&&b.value&&(C.value=!0,Se(l.params.id))}),Te(h,()=>{x.value&&le.value&&(C.value=!0,Se(l.params.id)),le.value=!0},{deep:!0}),Dt(async()=>{var fe,Y,ce,ge,ye,_e,Re;I.value=!0,D.value="notUpdated",y.value="notUpdated";try{g.value="",await N(l.params.id),await $(l.params.id);const ke=l.params.agentId;ke?(q.value=!0,await j(l.params.id,ke),X.value=((fe=b.value)==null?void 0:fe.modelId)??m.value[0].modelId,x.value=ke,O.value=((Y=b.value)==null?void 0:Y.name)??"",K.value=((ce=b.value)==null?void 0:ce.description)??"",V.value=((ge=b.value)==null?void 0:ge.instructions)??"",L.value=((_e=(ye=b.value)==null?void 0:ye.tools)==null?void 0:_e.map(qe=>qe.code))??[],h.value=((Re=b.value)==null?void 0:Re.sampleQuestions)??[],await se(l.params.id,ke)):(b.value=void 0,X.value=m.value[0].modelId,h.value=[]),await Et()}catch(ke){console.log(ke)}finally{I.value=!1,be.value=!0}}),ia(()=>{b.value=void 0,x.value=void 0,E.value=[],be.value=!1}),ls(()=>$e.cancel());const Ge=async()=>{try{A.value=!0,await ee(l.params.id,b.value.id,H.value)}catch(fe){console.error(fe),Ue({title:W("workspace.createEditAgent.dialog.selectKnowledge.toast.failed"),variant:"destructive"})}finally{A.value=!1,k.value=!1}};return(fe,Y)=>{var bt,Ve,Ze,ze,Be,et,ft,ht,pt,jt,st,Fe,xe,rt,nt,Je,Ee,je,Ie,ct,Wt,Zt,Xt,_t;const ce=f("Skeleton"),ge=f("Input"),ye=f("Textarea"),_e=f("SelectValue"),Re=f("SelectTrigger"),ke=f("SelectItemText"),qe=f("SelectItem"),lt=f("SelectGroup"),St=f("Separator"),Nt=f("SelectContent"),Mt=f("Select"),vt=f("Button"),zt=Kt("auto-animate");return s(),u(ve,null,[o(oR,{saving:F.value,name:(bt=e(b))==null?void 0:bt.name,currentAgentId:(Ve=e(b))==null?void 0:Ve.id,updateAgent:he,onRouteLeave:de},null,8,["saving","name","currentAgentId"]),t("div",OR,[t("div",jR,[t("div",VR,[t("div",GR,[t("span",WR,d(e(W)("editAgent.modelLabel")),1),e(I)?(s(),T(ce,{key:0,class:"h-9 w-1/4"})):(s(),u("div",HR,[o(Ds,{modelValue:X.value,"onUpdate:modelValue":Y[0]||(Y[0]=Xe=>X.value=Xe),icon:"bi bi-chevron-down",items:e(m),itemKey:"modelId",itemText:"displayName",disabled:((ze=(Ze=e(b))==null?void 0:Ze.currentUserInfo)==null?void 0:ze.id)!==((Be=e(b))==null?void 0:Be.owner.id)},null,8,["modelValue","items","disabled"])]))]),t("div",KR,[t("div",qR,[t("span",QR,d(e(W)("editAgent.nameLabel")),1),e(I)?(s(),T(ce,{key:0,class:"h-9 w-full mt-3"})):(s(),T(ge,{key:1,id:"name",type:"name",class:"text-sm focus-visible:ring-offset-0 mt-2",maxLength:"50",placeholder:e(W)("editAgent.namePlaceholder"),modelValue:O.value,"onUpdate:modelValue":Y[1]||(Y[1]=Xe=>O.value=Xe),disabled:((ft=(et=e(b))==null?void 0:et.currentUserInfo)==null?void 0:ft.id)!==((ht=e(b))==null?void 0:ht.owner.id)},null,8,["placeholder","modelValue","disabled"])),t("span",{class:pe(["flex justify-end mt-2 text-xs px-3 max-sm:hidden",[z(50,O.value.length??0)?"text-red-400 font-semibold":"text-stone-400"]])},d(e(W)("home.chat.message.maxLengthCharacters",{inputLength:O.value.length??0,maxLength:50})),3)]),t("div",null,[t("span",JR,d(e(W)("editAgent.descriptionLabel")),1),e(I)?(s(),T(ce,{key:0,class:"h-9 w-full mt-3"})):(s(),T(ge,{key:1,id:"description",type:"description",class:"text-sm focus-visible:ring-offset-0 mt-2",maxLength:"300",placeholder:e(W)("editAgent.descriptionPlaceholder"),modelValue:K.value,"onUpdate:modelValue":Y[2]||(Y[2]=Xe=>K.value=Xe),disabled:((jt=(pt=e(b))==null?void 0:pt.currentUserInfo)==null?void 0:jt.id)!==((st=e(b))==null?void 0:st.owner.id)},null,8,["placeholder","modelValue","disabled"])),t("span",{class:pe(["flex justify-end mt-2 text-xs px-3 max-sm:hidden",[z(300,K.value.length??0)?"text-red-400 font-semibold":"text-stone-400"]])},d(e(W)("home.chat.message.maxLengthCharacters",{inputLength:K.value.length??0,maxLength:300})),3)]),t("div",null,[t("span",XR,d(e(W)("editAgent.instructionLabel")),1),e(I)?(s(),T(ce,{key:0,class:"h-26 w-full mt-3"})):(s(),T(ye,{key:1,id:"prompt",type:"prompt",maxlength:e(wo),class:"min-h-28 overflow-auto resize-none text-sm focus-visible:ring-offset-0 dark:bg-background mt-2",placeholder:e(W)("editAgent.instructionPlaceholder"),modelValue:V.value,"onUpdate:modelValue":Y[3]||(Y[3]=Xe=>V.value=Xe),disabled:((xe=(Fe=e(b))==null?void 0:Fe.currentUserInfo)==null?void 0:xe.id)!==((rt=e(b))==null?void 0:rt.owner.id)},null,8,["maxlength","placeholder","modelValue","disabled"])),t("span",{class:pe(["flex justify-end mt-2 text-xs px-3 max-sm:hidden",[z(e(wo),V.value.length??0)?"text-red-400 font-semibold":"text-stone-400"]])},d(e(W)("home.chat.message.maxLengthCharacters",{inputLength:V.value.length??0,maxLength:e(wo)})),3)]),t("div",YR,[t("span",ZR,d(e(W)("workspace.createEditAgent.field.fieldTitle.chooseTool")),1),e(I)?(s(),T(ce,{key:0,class:"h-10 w-1/2 sm:w-1/3 mt-3"})):(s(),u("div",eF,[o(Mt,{disabled:((Je=(nt=e(b))==null?void 0:nt.currentUserInfo)==null?void 0:Je.id)!==((Ee=e(b))==null?void 0:Ee.owner.id),modelValue:P.value,"onUpdate:modelValue":Y[4]||(Y[4]=Xe=>P.value=Xe),id:"tool-select"},{default:i(()=>[o(Re,{class:"w-full flex justify-between items-center"},{default:i(()=>[o(_e),Y[11]||(Y[11]=t("i",{class:"bi bi-chevron-down opacity-60"},null,-1))]),_:1,__:[11]}),o(Nt,null,{default:i(()=>[o(lt,{class:"p-0"},{default:i(()=>[o(qe,{value:null},{default:i(()=>[o(ke,null,{default:i(()=>[t("span",null,d(e(W)("workspace.createEditAgent.field.fieldTitle.chooseTool.placeholder.noneValue")),1)]),_:1})]),_:1})]),_:1}),o(St,{class:"my-1"}),(s(!0),u(ve,null,Le(e(_),Xe=>(s(),T(lt,{key:Xe.code,class:"p-0"},{default:i(()=>[o(qe,{value:Xe.code},{default:i(()=>[t("div",tF,[o(ke,null,{default:i(()=>[t("span",null,d(Xe.displayName),1)]),_:2},1024),t("p",sF,d(Xe.description),1)])]),_:2},1032,["value"])]),_:2},1024))),128))]),_:1})]),_:1},8,["disabled","modelValue"])]))]),t("div",null,[t("span",aF,d(e(W)("editAgent.exampleQuestion")),1),e(I)?(s(),T(ce,{key:0,class:"h-24 w-full mt-3"})):(s(),u("div",oF,[o(ye,{id:"sample-question-textarea",class:"max-h-24 overflow-auto resize-none text-sm dark:bg-background border-none",onCompositionstart:Y[5]||(Y[5]=Xe=>Q.value=!0),onCompositionend:ae,placeholder:e(h)&&e(h).length<e(Ns)?e(W)("editAgent.exampleQuestion.placeholder",{limit:e(fs)}):e(W)("editAgent.exampleQuestion.placeholder.reachedLimit",{limit_questions:e(Ns)}),modelValue:e(g),"onUpdate:modelValue":Y[6]||(Y[6]=Xe=>kt(g)?g.value=Xe:null),onKeydown:yt(Ye(Z,["exact"]),["enter"]),maxlength:e(fs),disabled:((Ie=(je=e(b))==null?void 0:je.currentUserInfo)==null?void 0:Ie.id)!==((ct=e(b))==null?void 0:ct.owner.id)},null,8,["placeholder","modelValue","onKeydown","maxlength","disabled"]),t("div",nF,[o(Pe,{variant:"default",disabled:!e(g)||e(h)&&e(h).length>=e(Ns)||e(g).length>e(fs),icon:"bi bi-save text-sm",className:"my-2",size:"icon",tooltip:e(W)("editAgent.exampleQuestion.button.label"),onClick:Y[7]||(Y[7]=Xe=>te(e(g)))},null,8,["disabled","tooltip"])])])),t("span",{class:pe(["flex justify-end mt-2 text-xs px-3 max-sm:hidden",[z(e(fs),e(g).length)?"text-red-400 font-semibold":"text-stone-400"]])},d(e(W)("home.chat.message.maxLengthCharacters",{inputLength:e(g).length,maxLength:e(fs)})),3)]),e(h)&&e(h).length>0?Ke((s(),u("div",lF,[(s(!0),u(ve,null,Le(e(h),(Xe,qt)=>{var Yt,rs,cs;return s(),u("div",{key:qt,class:"w-full flex items-center gap-4"},[Y[12]||(Y[12]=t("div",null,[t("i",{class:"bi bi-patch-question"})],-1)),Xe!==""?(s(),u("div",iF,[t("span",rF,d(Xe),1),((rs=(Yt=e(b))==null?void 0:Yt.currentUserInfo)==null?void 0:rs.id)===((cs=e(b))==null?void 0:cs.owner.id)?(s(),T(Pe,{key:0,icon:"bi bi-trash3",variant:"ghost",size:"icon",tooltip:e(W)("editAgent.exampleQuestion.deleteButton.label"),className:"text-red-500 hover:text-red-400",onClick:vs=>re(qt)},null,8,["tooltip","onClick"])):w("",!0)])):w("",!0)])}),128))])),[[zt]]):w("",!0),Ke((s(),u("div",null,[t("div",cF,[t("span",dF,d(e(W)("editAgent.knowledgeLabel")),1),t("span",uF,d(e(W)("workspace.createEditAgent.field.fieldDescription.chooseKnowledge")),1),o(vt,{variant:"outline",class:"rounded-full font-semibold px-4 w-fit",disabled:!((Wt=e(b))!=null&&Wt.id)||((Xt=(Zt=e(b))==null?void 0:Zt.currentUserInfo)==null?void 0:Xt.id)!==((_t=e(b))==null?void 0:_t.owner.id),onClick:Y[8]||(Y[8]=Xe=>k.value=!0)},{default:i(()=>[me(d(e(W)("workspace.createEditAgent.field.fieldTitle.chooseKnowledge")),1)]),_:1},8,["disabled"]),o(BR,{open:k.value,"onUpdate:open":Y[9]||(Y[9]=Xe=>k.value=Xe),onCancel:Y[10]||(Y[10]=Xe=>k.value=!1),onConfirm:Ge,loading:A.value},null,8,["open","loading"]),e(E).length>0?(s(),u("span",pF,d(e(W)("workspace.createEditAgent.label.listFile")),1)):w("",!0)]),t("div",mF,[t("span",gF,d(e(W)("workspace.knowledgeBase.table.header.name")),1),t("span",fF,d(e(W)("workspace.knowledgeBase.table.header.status")),1)]),(s(!0),u(ve,null,Le(e(E),Xe=>{var qt,Yt,rs;return s(),u("div",{key:Xe.id},[t("div",vF,[o(UR,{fileName:e(J)(Xe.name),fileIndexStatus:Xe.vectorIndexStatus,class:pe({"opacity-50":((Yt=(qt=e(b))==null?void 0:qt.currentUserInfo)==null?void 0:Yt.id)!==((rs=e(b))==null?void 0:rs.owner.id)})},null,8,["fileName","fileIndexStatus","class"])])])}),128))])),[[zt]])])])]),t("div",hF,[o(Hi,{isUsingPreviewAgent:!0,isAllowedToPreviewChat:q.value},null,8,["isAllowedToPreviewChat"])])])],64)}}}),bF={class:"h-full mt-10 overflow-y-auto"},kF={class:"mx-auto w-10/12 sm:w-3/4"},yF={class:"mb-8 text-xl font-bold md:text-2xl"},xF={class:"pb-4"},wF={class:"pb-4"},$F={class:"font-semibold text-sm"},SF={class:"text-xs opacity-50"},TF={key:0},AF={class:"space-y-2"},CF={key:1,class:"flex flex-col items-center justify-center h-48 text-stone-500"},DF={class:"text-2xl font-semibold opacity-50 mt-2"},LF={key:2},IF=["onClick"],BF={class:"flex flex-row items-center gap-5 w-1/2 min-w-32 h-20"},MF={class:"flex gap-2 items-start w-full"},EF={class:"text-sm font-semibold text-ellipsis overflow-hidden w-48 lg:w-[18rem] whitespace-wrap line-clamp-2"},RF={key:0},FF={class:"whitespace-nowrap overflow-hidden text-ellipsis wrap-anywhere max-w-48 lg:max-w-[18rem] opacity-50 text-sm text-start truncate"},PF={class:"whitespace-wrap wrap-anywhere max-w-[500px]"},NF={class:"flex flex-row items-center gap-3"},zF=["onClick"],UF={class:"hover:bg-white dark:hover:bg-stone-900 w-6 h-6 sm:w-10 sm:h-10 rounded-lg flex items-center justify-center"},OF={key:0,class:"w-full flex justify-center my-1"},Uo=6,jF=oe({__name:"WorkspaceMyAgentsView",setup(n){const l=ot(),a=tt(),c=is(),{createdAgents:r,currentAgentId:p,currentAgent:m,createdAgentsAmount:g}=ie(c),{deleteWorkspaceAgent:h,getCreatedAgents:_}=c,x=Ce(),{t:b}=We(x.t),S=v(!1),D=v(!1),y=v(!1),I=v(0),C=async(B,j)=>{p.value=B,j==="PUBLISH"?l.push(`/workspace/${a.params.id}/agent/${B}`):l.push({name:"workspace-create-edit-agents",params:{agentId:B}})},U=async()=>{const B={offset:I.value,limit:Uo};try{await _(a.params.id,B)}catch(j){console.error(j),Ue({title:b("editAgent.toast.fail.generalErrorTitle"),description:b("editAgent.toast.fail.generalError"),variant:"destructive"})}},E=async()=>{I.value+=Uo,D.value=!0,await U(),D.value=!1},N=()=>{m.value=void 0,p.value=void 0,l.push({name:"workspace-create-edit-agents"})},$=async B=>{p.value=B,l.push({name:"workspace-create-edit-agents",params:{agentId:B}})},R=async B=>{try{y.value=!0,await h(a.params.id,B);const j={offset:0,limit:Uo};await _(a.params.id,j),I.value=0}catch(j){console.error(j),Ue({title:b("home.toast.fail.generalErrorTitle"),description:b("home.toast.fail.generalError"),variant:"destructive"})}finally{y.value=!1}};return Te(()=>a.params.id,async B=>{if(B)S.value=!0,await U(),S.value=!1;else return},{immediate:!0}),(B,j)=>{const ee=f("Skeleton"),se=f("Badge"),G=f("TooltipTrigger"),J=f("TooltipContent"),H=f("Tooltip"),M=f("TooltipProvider"),W=f("Button"),X=f("AlertDialogTrigger"),O=f("AlertDialogTitle"),K=f("AlertDialogDescription"),V=f("AlertDialogHeader"),F=f("AlertDialogCancel"),P=f("Loader2"),q=f("AlertDialogAction"),A=f("AlertDialogFooter"),k=f("AlertDialogContent"),L=f("AlertDialog");return s(),u("div",bF,[t("div",kF,[t("h1",yF,d(e(b)("home.myAgent.label.title")),1),t("div",xF,[t("div",wF,[t("div",{class:"h-20 flex flex-row items-center gap-5 p-3 hover:cursor-pointer hover:bg-accent hover:text-accent-foreground rounded-md border-b",onClick:N},[j[1]||(j[1]=t("i",{class:"text-3xl bi bi-plus-circle-fill text-stone-300 dark:text-stone-500"},null,-1)),t("div",null,[t("div",$F,d(e(b)("home.myAgent.button.createAgent")),1),t("div",SF,d(e(b)("home.myAgent.label.createAgent")),1)])]),S.value?(s(),u("div",TF,[(s(),u(ve,null,Le(6,z=>t("div",{key:z,class:"flex items-center gap-4 px-2 py-3 mt-2"},[o(ee,{class:"h-10 w-10 rounded-full"}),t("div",AF,[o(ee,{class:"h-4 w-[250px]"}),o(ee,{class:"h-4 w-[200px]"})])])),64))])):e(r).length===0?(s(),u("div",CF,[t("p",DF,d(e(b)("home.searchAgent.label.noAgent")),1)])):(s(),u("div",LF,[(s(!0),u(ve,null,Le(e(r),(z,Q)=>(s(),u("div",{class:"group flex justify-between gap-3 px-3 hover:cursor-pointer hover:bg-accent hover:text-accent-foreground rounded-lg",onClick:ae=>C(z.id,z.status),key:Q},[t("div",BF,[o(wt,{fallbackText:z.name,size:"sm"},null,8,["fallbackText"]),t("div",null,[t("div",MF,[t("div",EF,[z.status==="DRAFT"?(s(),T(se,{key:0,variant:"secondary",class:"mr-2 group-hover:border-black dark:group-hover:border-white"},{default:i(()=>[me(d(e(b)("home.myAgent.tooltip.draft")),1)]),_:1})):w("",!0),me(" "+d(z.name),1)])]),z.description?(s(),u("div",RF,[o(M,null,{default:i(()=>[o(H,null,{default:i(()=>[o(G,null,{default:i(()=>[t("div",FF,d(z.description),1)]),_:2},1024),o(J,null,{default:i(()=>[t("div",PF,d(z.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)])):w("",!0)])]),t("div",NF,[t("div",{class:"hover:bg-white dark:hover:bg-stone-900 w-6 h-6 sm:w-10 sm:h-10 rounded-lg flex items-center justify-center",onClick:Ye(ae=>$(z.id),["stop"])},[o(W,{variant:"ghost",size:"smicon",class:"hover:bg-white dark:hover:bg-stone-900"},{default:i(()=>j[2]||(j[2]=[t("i",{class:"bi bi-pencil"},null,-1)])),_:1,__:[2]})],8,zF),t("div",{onClick:j[0]||(j[0]=Ye(()=>{},["stop"]))},[o(L,null,{default:i(()=>[o(X,{class:"w-full"},{default:i(()=>[t("div",UF,[o(W,{variant:"destructive",size:"smicon",class:"hover:bg-white dark:hover:bg-stone-900"},{default:i(()=>j[3]||(j[3]=[t("i",{class:"bi bi-trash"},null,-1)])),_:1,__:[3]})])]),_:1}),o(k,{class:"max-w-sm sm:max-w-lg rounded-md sm:rounded-lg"},{default:i(()=>[o(V,null,{default:i(()=>[o(O,null,{default:i(()=>[me(d(e(b)("home.myAgent.dialog.deleteAgent.title")),1)]),_:1}),o(K,null,{default:i(()=>[me(d(e(b)("home.myAgent.dialog.deleteAgent.description")),1)]),_:1})]),_:1}),o(A,null,{default:i(()=>[o(F,null,{default:i(()=>[me(d(e(b)("home.myAgent.button.cancel")),1)]),_:1}),o(q,{onClick:Ye(ae=>R(z.id),["stop"]),disabled:y.value,class:"bg-red-600 hover:bg-red-500"},{default:i(()=>[y.value?(s(),T(P,{key:0,class:"w-4 h-4 animate-spin mr-2"})):w("",!0),t("span",null,d(e(b)("home.myAgent.button.deleteAgent")),1)]),_:2},1032,["onClick","disabled"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])])],8,IF))),128)),e(g)>e(r).length&&!S.value?(s(),u("div",OF,[o(W,{onClick:E,class:"w-full sm:w-1/2 my-5 text-xs",variant:"outline"},{default:i(()=>[D.value?(s(),T(P,{key:0,class:"w-4 h-4 animate-spin mr-2"})):w("",!0),t("span",null,d(e(b)("home.myAgent.button.seeMore")),1)]),_:1})])):w("",!0)]))])])])])}}}),VF={class:"flex flex-col w-full items-center justify-center"},GF={class:"dark:bg-red-900/50 bg-red-100 border text-red-700 px-4 py-3 rounded-md flex flex-col items-center justify-center gap-6 w-4/5 md:w-1/3 text-center"},WF={class:"font-bold"},HF={class:"block sm:inline"},KF=oe({__name:"WorkspaceNoAccessView",setup(n){const l=ot(),a=Ce(),{t:c}=We(a.t),r=()=>{l.push("/")};return(p,m)=>{const g=f("Button");return s(),u("div",VF,[t("div",GF,[t("div",WF,[m[0]||(m[0]=t("i",{class:"bi bi-exclamation-circle-fill"},null,-1)),me(" "+d(e(c)("workspace.accessDenied.label")),1)]),t("span",HF,d(e(c)("workspace.accessDenied.description")),1),o(g,{onClick:r,variant:"destructive",size:"sm",class:"text-white dark:text-red-600 bg-red-500 hover:bg-red-600 w-1/2 dark:bg-red-700/50 dark:hover:bg-red-800/50"},{default:i(()=>[me(d(e(c)("workspace.accessDenied.button.goHome.label")),1)]),_:1})]),o(Ls)])}}}),qF=[{path:"/workspace",name:"workspace",component:c8,children:[{path:":id",name:"workspace-home",component:wM,meta:{allowWorkspaceDragAndDrop:!0}},{path:":id/chat/:chatId?",name:"workspace-chat",component:ul,meta:{allowWorkspaceDragAndDrop:!0}},{path:":id/knowledge-base",name:"workspace-knowledge",component:nn},{path:":id/agents",name:"workspace-agents",component:ME},{path:":id/agents/mine",name:"workspace-mine-agents",component:jF},{path:":id/agent/:agentId",name:"workspace-agent-chat-home",component:Hi,meta:{allowWorkspaceDragAndDrop:!0}},{path:":id/agent/:agentId/chat/:chatId?",name:"workspace-agent-chat",component:ul,meta:{allowWorkspaceDragAndDrop:!0}}],meta:{allowWorkspaceDragAndDrop:!1,requiresAuth:!0,requiresFeature:"workspace",title:"Workspace"}},{path:"/workspace/access-denied",name:"workspace-access-denied",component:KF,meta:{allowWorkspaceDragAndDrop:!1,requiresAuth:!0,requiresFeature:"workspace",title:"Workspace"}}],QF=[{path:"/workspace/group/:id",name:"workspace-group",component:Y8,children:[{path:"members",name:"workspace-members",component:$5},{path:"settings",name:"workspace-settings",component:V5}],meta:{allowWorkspaceDragAndDrop:!1,requiresAuth:!0,requiresFeature:"workspace",title:"Workspace"}},{path:"/workspace/:id/agents/editor/:agentId?",name:"workspace-create-edit-agents",component:_F}],ml={withSidebarRoutes:qF,noSidebarRoutes:QF},gn=Mr({history:Er("/"),routes:[{path:"/login",name:"login",component:lm,meta:{allowDragAndDrop:!1,requiresAuth:!1,title:"Login"}},{path:"/auth",name:"authorize",component:um,meta:{allowDragAndDrop:!1,requiresAuth:!0,title:"Login"}},{path:"/",component:eg,children:[...sl.withSidebarRoutes,...ll.withSidebarRoutes,...tB.withSidebarRoutes,...GB.withSidebarRoutes,...ml.withSidebarRoutes],meta:{requiresAuth:!0,title:"PrivateGPT"}},...sl.noSidebarRoutes,...ll.noSidebarRoutes,...ml.noSidebarRoutes,{path:"/access-denied",name:"access-denied",component:ti,meta:{allowDragAndDrop:!1,title:"Access denied"}},{path:"/:pathMatch(.*)*",redirect:"/"}]}),JF=(n,l)=>n.path.startsWith("/login")&&l.path!=="/auth",XF=(n,l)=>{const a=Ot(),{isAuthenticated:c,isAuthorized:r,isSecured:p}=ie(a);if(JF(n,l)&&c.value&&!r.value)return"/auth";if(n.path.startsWith("/auth")&&p.value){const m=localStorage.getItem("postLoginRedirect");return localStorage.removeItem("postLoginRedirect"),m||"/"}if(n.path.startsWith("/auth")&&!p.value)return"/access-denied";if(n.path.startsWith("/login")&&p.value)return"/"},YF=n=>{const l=n.split("/").filter(Boolean);return l.length>0?`/${l[0]}`:"/"},ZF=n=>{const l=YF(n.path),a=ea.find(c=>l==="/"?c.route==="/":c.route.startsWith(l));return(a==null?void 0:a.isShow)??!0};gn.beforeEach(async(n,l,a)=>{const c=Ot(),{authenticationResult:r,authorizationResult:p}=ie(c);c.isAuthenticated||await c.initializeClient(),c.isAuthorized||await c.checkAuthorization();const m=XF(n,l);if(m)return a(m);if(n.matched.some(g=>g.meta.requiresAuth)&&!c.isSecured&&(await c.initializeClient(),await c.checkAuthorization(),!c.isSecured))return r.value=null,p.value=null,localStorage.setItem("postLoginRedirect",n.fullPath),a("/login");if(!ZF(n))return a("/access-denied");a()});gn.afterEach(n=>{document.title=n.meta.title||"PrivateGPT"});const eP=oe({__name:"AlertDialog",props:{open:{type:Boolean},defaultOpen:{type:Boolean}},emits:["update:open"],setup(n,{emit:l}){const r=$t(n,l);return(p,m)=>(s(),T(e(rd),At(Ct(e(r))),{default:i(()=>[we(p.$slots,"default")]),_:3},16))}}),tP=oe({__name:"AlertDialogAction",props:{asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:c,...r}=l;return r});return(c,r)=>(s(),T(e(cd),He(a.value,{class:e(Me)(e(Zo)(),"border rounded-3xl dark:text-white",l.class)}),{default:i(()=>[we(c.$slots,"default")]),_:3},16,["class"]))}}),sP=oe({__name:"AlertDialogCancel",props:{asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:c,...r}=l;return r});return(c,r)=>(s(),T(e(dd),He(a.value,{class:e(Me)(e(Zo)({variant:"outline"}),"mt-2 sm:mt-0",l.class)}),{default:i(()=>[we(c.$slots,"default")]),_:3},16,["class"]))}}),aP=oe({__name:"AlertDialogContent",props:{forceMount:{type:Boolean},trapFocus:{type:Boolean},disableOutsidePointerEvents:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(n,{emit:l}){const a=n,c=l,r=ne(()=>{const{class:m,...g}=a;return g}),p=$t(r,c);return(m,g)=>(s(),T(e(md),null,{default:i(()=>[o(e(ud),{class:"backdrop-blur-2xs fixed inset-0 z-50 bg-black/80 duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0"}),o(e(pd),He(e(p),{class:e(Me)("fixed left-1/2 top-1/2 z-50 grid w-full max-w-lg -translate-x-1/2 -translate-y-1/2 gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:zoom-in-85 data-[state=closed]:zoom-out-85 sm:rounded-lg dark:bg-stone-900",a.class)}),{default:i(()=>[we(m.$slots,"default")]),_:3},16,["class"])]),_:3}))}}),oP=oe({__name:"AlertDialogFooter",props:{class:{}},setup(n){const l=n;return(a,c)=>(s(),u("div",{class:pe(e(Me)("flex flex-col-reverse sm:flex-row sm:justify-end sm:gap-x-2",l.class))},[we(a.$slots,"default")],2))}}),nP=oe({__name:"AlertDialogHeader",props:{class:{}},setup(n){const l=n;return(a,c)=>(s(),u("div",{class:pe(e(Me)("flex flex-col gap-y-2 text-center sm:text-left",l.class))},[we(a.$slots,"default")],2))}}),lP=oe({__name:"AlertDialogTitle",props:{asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:c,...r}=l;return r});return(c,r)=>(s(),T(e(gd),He(a.value,{class:e(Me)("text-lg font-semibold",l.class)}),{default:i(()=>[we(c.$slots,"default")]),_:3},16,["class"]))}}),iP=oe({__name:"AlertDialogTrigger",props:{asChild:{type:Boolean},as:{}},setup(n){const l=n;return(a,c)=>(s(),T(e(fd),At(Ct(l)),{default:i(()=>[we(a.$slots,"default")]),_:3},16))}}),rP=oe({__name:"Card",props:{class:{}},setup(n){const l=n;return(a,c)=>(s(),u("div",{class:pe(e(Me)("rounded-lg border bg-card text-card-foreground shadow-xs",l.class))},[we(a.$slots,"default")],2))}}),cP=oe({__name:"CardContent",props:{class:{}},setup(n){const l=n;return(a,c)=>(s(),u("div",{class:pe(e(Me)("p-6 pt-0",l.class))},[we(a.$slots,"default")],2))}}),dP=oe({__name:"CardDescription",props:{class:{}},setup(n){const l=n;return(a,c)=>(s(),u("p",{class:pe(e(Me)("text-sm text-muted-foreground",l.class))},[we(a.$slots,"default")],2))}}),uP=oe({__name:"CardHeader",props:{class:{}},setup(n){const l=n;return(a,c)=>(s(),u("div",{class:pe(e(Me)("flex flex-col gap-y-1.5 p-6",l.class))},[we(a.$slots,"default")],2))}}),pP=oe({__name:"CardTitle",props:{class:{}},setup(n){const l=n;return(a,c)=>(s(),u("h3",{class:pe(e(Me)("text-2xl font-semibold leading-none tracking-tight",l.class))},[we(a.$slots,"default")],2))}}),Ki=Symbol();function po(){const n=jo(Zu),l=jo(Ki);if(!n)throw new Error("useFormField should be used within <FormField>");const{name:a}=n,c=l,r={valid:Qu(a),isDirty:Ju(a),isTouched:Xu(a),error:Yu(a)};return{id:c,name:a,formItemId:`${c}-form-item`,formDescriptionId:`${c}-form-item-description`,formMessageId:`${c}-form-item-message`,...r}}const mP=oe({__name:"FormControl",setup(n){const{error:l,formItemId:a,formDescriptionId:c,formMessageId:r}=po();return(p,m)=>(s(),T(e(vd),{id:e(a),"aria-describedby":e(l)?`${e(c)} ${e(r)}`:`${e(c)}`,"aria-invalid":!!e(l)},{default:i(()=>[we(p.$slots,"default")]),_:3},8,["id","aria-describedby","aria-invalid"]))}}),gP=["id"],fP=oe({__name:"FormDescription",props:{class:{}},setup(n){const l=n,{formDescriptionId:a}=po();return(c,r)=>(s(),u("p",{id:e(a),class:pe(e(Me)("text-sm text-muted-foreground",l.class))},[we(c.$slots,"default")],10,gP))}}),vP=oe({__name:"FormItem",props:{class:{}},setup(n){const l=n,a=hd();return bl(Ki,a),(c,r)=>(s(),u("div",{class:pe(e(Me)("space-y-2",l.class))},[we(c.$slots,"default")],2))}}),qi=oe({__name:"Label",props:{for:{},asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:c,...r}=l;return r});return(c,r)=>(s(),T(e(_d),He(a.value,{class:e(Me)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",l.class)}),{default:i(()=>[we(c.$slots,"default")]),_:3},16,["class"]))}}),hP=oe({__name:"FormLabel",props:{for:{},asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,{error:a,formItemId:c}=po();return(r,p)=>(s(),T(e(qi),{class:pe(e(Me)(e(a)&&"text-destructive",l.class)),for:e(c)},{default:i(()=>[we(r.$slots,"default")]),_:3},8,["class","for"]))}}),_P=oe({__name:"FormMessage",setup(n){const{name:l,formMessageId:a}=po();return(c,r)=>(s(),T(e(ep),{id:e(a),as:"p",name:Rr(e(l)),class:"text-sm font-medium text-destructive"},null,8,["id","name"]))}}),bP=oe({__name:"Popover",props:{defaultOpen:{type:Boolean},open:{type:Boolean},modal:{type:Boolean}},emits:["update:open"],setup(n,{emit:l}){const r=Da(n,l);return(p,m)=>(s(),T(e(bd),He({"data-slot":"popover"},e(r)),{default:i(()=>[we(p.$slots,"default")]),_:3},16))}}),kP=oe({inheritAttrs:!1,__name:"PopoverContent",props:{forceMount:{type:Boolean},side:{},sideOffset:{default:4},sideFlip:{type:Boolean},align:{default:"center"},alignOffset:{},alignFlip:{type:Boolean},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},positionStrategy:{},updatePositionStrategy:{},disableUpdateOnLayoutShift:{type:Boolean},prioritizePosition:{type:Boolean},reference:{},asChild:{type:Boolean},as:{},disableOutsidePointerEvents:{type:Boolean},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(n,{emit:l}){const a=n,c=l,r=la(a,"class"),p=Da(r,c);return(m,g)=>(s(),T(e(yd),null,{default:i(()=>[o(e(kd),He({"data-slot":"popover-content"},{...e(p),...m.$attrs},{class:e(Me)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 rounded-md border p-4 shadow-md origin-(--reka-popover-content-transform-origin) outline-hidden",a.class)}),{default:i(()=>[we(m.$slots,"default")]),_:3},16,["class"])]),_:3}))}}),yP=oe({__name:"PopoverTrigger",props:{asChild:{type:Boolean},as:{}},setup(n){const l=n;return(a,c)=>(s(),T(e(xd),He({"data-slot":"popover-trigger"},l),{default:i(()=>[we(a.$slots,"default")]),_:3},16))}}),xP=oe({__name:"Separator",props:{orientation:{},decorative:{type:Boolean},asChild:{type:Boolean},as:{},class:{},label:{}},setup(n){const l=n,a=ne(()=>{const{class:c,...r}=l;return r});return(c,r)=>(s(),T(e(wd),He(a.value,{class:e(Me)("shrink-0 bg-border relative",l.orientation==="vertical"?"w-px h-full":"h-px w-full",l.class)}),{default:i(()=>[l.label?(s(),u("span",{key:0,class:pe(e(Me)("text-xs text-muted-foreground bg-background absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 flex justify-center items-center",l.orientation==="vertical"?"w-px px-1 py-2":"h-px py-1 px-2"))},d(l.label),3)):w("",!0)]),_:1},16,["class"]))}}),wP=oe({__name:"Tabs",props:{defaultValue:{},orientation:{},dir:{},activationMode:{},modelValue:{},asChild:{type:Boolean},as:{}},emits:["update:modelValue"],setup(n,{emit:l}){const r=$t(n,l);return(p,m)=>(s(),T(e($d),At(Ct(e(r))),{default:i(()=>[we(p.$slots,"default")]),_:3},16))}}),$P=oe({__name:"TabsContent",props:{value:{},forceMount:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:c,...r}=l;return r});return(c,r)=>(s(),T(e(Sd),He({class:e(Me)("mt-2 ring-offset-background focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",l.class)},a.value),{default:i(()=>[we(c.$slots,"default")]),_:3},16,["class"]))}}),SP=oe({__name:"TabsList",props:{loop:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:c,...r}=l;return r});return(c,r)=>(s(),T(e(Td),He(a.value,{class:e(Me)("inline-flex items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",l.class)}),{default:i(()=>[we(c.$slots,"default")]),_:3},16,["class"]))}}),TP={class:"truncate"},AP=oe({__name:"TabsTrigger",props:{value:{},disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:r,...p}=l;return p}),c=Pt(a);return(r,p)=>(s(),T(e(Ad),He(e(c),{class:e(Me)("inline-flex items-center justify-center whitespace-nowrap rounded px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-hidden focus-visible:ring-3 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:text-foreground data-[state=active]:shadow-sm data-[state=active]:bg-background",l.class)}),{default:i(()=>[t("span",TP,[we(r.$slots,"default")])]),_:3},16,["class"]))}}),CP=["maxlength","onKeydown"],DP=["maxlength"],LP=oe({__name:"Textarea",props:bs({class:{},defaultValue:{},maxLength:{}},{modelValue:{},modelModifiers:{}}),emits:bs(["update:modelValue"],["update:modelValue"]),setup(n,{expose:l}){const{textarea:a}=Fr(),c=n;l({focus:()=>{var _;(_=a.value)==null||_.focus()},setValue:_=>{a.value&&(a.value.value=_,a.value.focus(),a.value.style.height="auto",a.value.style.height=`${a.value.scrollHeight}px`)}});const m=()=>{a.value&&a.value.blur()},[g,h]=Os(n,"modelValue");return(_,x)=>e(h).lazy?Ke((s(),u("textarea",{key:0,ref_key:"textarea",ref:a,maxlength:c.maxLength??void 0,"onUpdate:modelValue":x[0]||(x[0]=b=>kt(g)?g.value=b:null),onKeydown:yt(Ye(m,["exact"]),["enter"]),class:pe(e(Me)("flex flex-col items-center h-full w-full grow max-h-52 rounded-md border border-input bg-transparent p-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-hidden focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",c.class))},null,42,CP)),[[Oo,e(g),void 0,{lazy:!0}]]):Ke((s(),u("textarea",{key:1,ref_key:"textarea",ref:a,maxlength:c.maxLength??void 0,"onUpdate:modelValue":x[1]||(x[1]=b=>kt(g)?g.value=b:null),class:pe(e(Me)("flex flex-col items-center h-full w-full grow max-h-52 rounded-md border border-input bg-transparent p-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-hidden focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",c.class))},null,10,DP)),[[Oo,e(g)]])}}),Qi=oe({__name:"Dialog",props:{open:{type:Boolean},defaultOpen:{type:Boolean},modal:{type:Boolean}},emits:["update:open"],setup(n,{emit:l}){const r=$t(n,l);return(p,m)=>(s(),T(e(Cd),At(Ct(e(r))),{default:i(()=>[we(p.$slots,"default")]),_:3},16))}}),IP=oe({__name:"DialogClose",props:{asChild:{type:Boolean},as:{}},setup(n){const l=n;return(a,c)=>(s(),T(e(Jo),At(Ct(l)),{default:i(()=>[we(a.$slots,"default")]),_:3},16))}}),BP={class:"flex items-center justify-end gap-3 absolute top-3 right-3"},Ji=oe({__name:"DialogContent",props:{forceMount:{type:Boolean},trapFocus:{type:Boolean},disableOutsidePointerEvents:{type:Boolean},asChild:{type:Boolean},as:{},class:{},noClose:{type:Boolean}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(n,{emit:l}){const a=n,c=l,r=ne(()=>{const{class:m,...g}=a;return g}),p=$t(r,c);return(m,g)=>(s(),T(e(Bl),null,{default:i(()=>[o(e(Ll),{class:"backdrop-blur-2xs fixed inset-0 z-50 bg-black/80 duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=open]:fade-in data-[state=closed]:fade-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0"}),o(e(Il),He(e(p),{class:e(Me)("fixed left-1/2 top-1/2 z-50 grid w-full max-w-lg -translate-x-1/2 -translate-y-1/2 gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:zoom-in-85 data-[state=closed]:zoom-out-85 sm:rounded-lg dark:bg-stone-900",a.class)}),{default:i(()=>[we(m.$slots,"default"),t("div",BP,[we(m.$slots,"extra-button"),a.noClose?w("",!0):(s(),T(e(Jo),{key:0,class:"rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground"},{default:i(()=>g[0]||(g[0]=[t("i",{class:"bi bi-x"},null,-1),t("span",{class:"sr-only"},"Close",-1)])),_:1,__:[0]}))])]),_:3},16,["class"])]),_:3}))}}),MP=oe({__name:"DialogHeader",props:{class:{}},setup(n){const l=n;return(a,c)=>(s(),u("div",{class:pe(e(Me)("flex flex-col gap-y-1.5 text-center sm:text-left",l.class))},[we(a.$slots,"default")],2))}}),EP=oe({__name:"DialogScrollContent",props:{forceMount:{type:Boolean},trapFocus:{type:Boolean},disableOutsidePointerEvents:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(n,{emit:l}){const a=n,c=l,r=ne(()=>{const{class:m,...g}=a;return g}),p=$t(r,c);return(m,g)=>(s(),T(e(Bl),null,{default:i(()=>[o(e(Ll),{class:"backdrop-blur-2xs fixed inset-0 z-50 grid place-items-center overflow-y-auto bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0"},{default:i(()=>[o(e(Il),He({class:e(Me)("relative z-50 grid w-full max-w-lg my-8 gap-4 border border-border bg-background p-6 shadow-lg duration-200 sm:rounded-lg md:w-full",a.class)},e(p),{onPointerDownOutside:g[0]||(g[0]=h=>{const _=h.detail.originalEvent,x=_.target;(_.offsetX>x.clientWidth||_.offsetY>x.clientHeight)&&h.preventDefault()})}),{default:i(()=>[we(m.$slots,"default"),o(e(Jo),{class:"absolute top-3 right-3 p-0.5 transition-colors rounded-md hover:bg-secondary"},{default:i(()=>g[1]||(g[1]=[t("i",{class:"bi bi-x"},null,-1),t("span",{class:"sr-only"},"Close",-1)])),_:1,__:[1]})]),_:3},16,["class"])]),_:3})]),_:3}))}}),RP=oe({__name:"DialogTitle",props:{asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:r,...p}=l;return p}),c=Pt(a);return(r,p)=>(s(),T(e(Dd),He(e(c),{class:e(Me)("text-lg font-semibold leading-none tracking-tight",l.class)}),{default:i(()=>[we(r.$slots,"default")]),_:3},16,["class"]))}}),FP=oe({__name:"Toggle",props:{defaultValue:{type:Boolean},modelValue:{type:[Boolean,null]},disabled:{type:Boolean,default:!1},asChild:{type:Boolean},as:{},name:{},required:{type:Boolean},class:{},variant:{default:"default"},size:{default:"default"}},emits:["update:modelValue"],setup(n,{emit:l}){const a=n,c=l,r=la(a,"class","size","variant"),p=Da(r,c);return(m,g)=>(s(),T(e(Ld),He({"data-slot":"toggle"},e(p),{class:e(Me)(e(Xi)({variant:m.variant,size:m.size}),a.class)}),{default:i(h=>[we(m.$slots,"default",At(Ct(h)))]),_:3},16,["class"]))}}),Xi=oo("inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium hover:bg-muted hover:text-muted-foreground disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 [&_svg]:shrink-0 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] outline-none transition-[color,box-shadow] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive whitespace-nowrap",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent shadow-xs hover:bg-accent hover:text-accent-foreground"},size:{default:"h-9 px-2 min-w-9",sm:"h-8 px-1.5 min-w-8",lg:"h-10 px-2.5 min-w-10"}},defaultVariants:{variant:"default",size:"default"}}),PP=oe({__name:"ToggleGroup",props:{rovingFocus:{type:Boolean},disabled:{type:Boolean},orientation:{},dir:{},loop:{type:Boolean},asChild:{type:Boolean},as:{},type:{},modelValue:{},defaultValue:{},class:{},variant:{},size:{}},emits:["update:modelValue"],setup(n,{emit:l}){const a=n,c=l;bl("toggleGroup",{variant:a.variant,size:a.size});const r=ne(()=>{const{class:m,...g}=a;return g}),p=$t(r,c);return(m,g)=>(s(),T(e(Id),He(e(p),{class:e(Me)("flex items-center justify-center gap-1",a.class)}),{default:i(()=>[we(m.$slots,"default")]),_:3},16,["class"]))}}),NP=oe({__name:"ToggleGroupItem",props:{value:{},defaultValue:{type:Boolean},pressed:{type:Boolean},disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{},variant:{},size:{}},setup(n){const l=n,a=jo("toggleGroup"),c=ne(()=>{const{class:p,variant:m,size:g,...h}=l;return h}),r=Pt(c);return(p,m)=>{var g,h;return s(),T(e(Bd),He(e(r),{class:e(Me)(e(Xi)({variant:((g=e(a))==null?void 0:g.variant)||p.variant,size:((h=e(a))==null?void 0:h.size)||p.size}),l.class)}),{default:i(()=>[we(p.$slots,"default")]),_:3},16,["class"])}}}),zP=oe({__name:"TagsInput",props:{modelValue:{},defaultValue:{},addOnPaste:{type:Boolean},addOnTab:{type:Boolean},addOnBlur:{type:Boolean},duplicate:{type:Boolean},disabled:{type:Boolean},delimiter:{},dir:{},max:{},required:{type:Boolean},name:{},id:{},convertValue:{type:Function},displayValue:{type:Function},asChild:{type:Boolean},as:{},class:{}},emits:["update:modelValue","invalid"],setup(n,{emit:l}){const a=n,c=l,r=ne(()=>{const{class:m,...g}=a;return g}),p=$t(r,c);return(m,g)=>(s(),T(e(Md),He(e(p),{class:e(Me)("flex flex-wrap gap-2 items-center rounded-md border border-input bg-background px-3 py-2 text-sm",a.class)}),{default:i(()=>[we(m.$slots,"default")]),_:3},16,["class"]))}}),UP=oe({__name:"TagsInputInput",props:{placeholder:{},autoFocus:{type:Boolean},maxLength:{},asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:r,...p}=l;return p}),c=Pt(a);return(r,p)=>(s(),T(e(Ed),He(e(c),{class:e(Me)("text-sm min-h-6 focus:outline-hidden flex-1 bg-transparent px-1",l.class)}),null,16,["class"]))}}),OP=oe({__name:"TagsInputItem",props:{value:{},disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:r,...p}=l;return p}),c=Pt(a);return(r,p)=>(s(),T(e(Rd),He(e(c),{class:e(Me)("flex h-6 items-center rounded bg-secondary data-[state=active]:ring-ring data-[state=active]:ring-2 data-[state=active]:ring-offset-2 ring-offset-background",l.class)}),{default:i(()=>[we(r.$slots,"default")]),_:3},16,["class"]))}}),jP=oe({__name:"TagsInputItemDelete",props:{asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:r,...p}=l;return p}),c=Pt(a);return(r,p)=>(s(),T(e(Fd),He(e(c),{class:e(Me)("flex rounded bg-transparent mr-1",l.class)}),{default:i(()=>[we(r.$slots,"default",{},()=>[o(e(kl),{class:"w-4 h-4"})])]),_:3},16,["class"]))}}),VP=oe({__name:"TagsInputItemText",props:{asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:r,...p}=l;return p}),c=Pt(a);return(r,p)=>(s(),T(e(Pd),He(e(c),{class:e(Me)("py-1 px-2 text-sm rounded bg-transparent",l.class)}),null,16,["class"]))}}),Yi=oe({__name:"Command",props:{modelValue:{default:""},defaultValue:{},open:{type:Boolean,default:!0},defaultOpen:{type:Boolean},searchTerm:{},selectedValue:{},multiple:{type:Boolean},disabled:{type:Boolean},name:{},dir:{},filterFunction:{},displayValue:{},resetSearchTermOnBlur:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["update:modelValue","update:open","update:searchTerm","update:selectedValue"],setup(n,{emit:l}){const a=n,c=l,r=ne(()=>{const{class:m,...g}=a;return g}),p=$t(r,c);return(m,g)=>(s(),T(e(Sl),He(e(p),{class:e(Me)("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",a.class)}),{default:i(()=>[we(m.$slots,"default")]),_:3},16,["class"]))}}),GP=oe({__name:"CommandDialog",props:{open:{type:Boolean},defaultOpen:{type:Boolean},modal:{type:Boolean}},emits:["update:open"],setup(n,{emit:l}){const r=$t(n,l);return(p,m)=>(s(),T(e(Qi),At(Ct(e(r))),{default:i(()=>[o(e(Ji),{class:"overflow-hidden p-0 shadow-lg"},{default:i(()=>[o(Yi,{class:"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5"},{default:i(()=>[we(p.$slots,"default")]),_:3})]),_:3})]),_:3},16))}}),WP=oe({__name:"CommandEmpty",props:{asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:c,...r}=l;return r});return(c,r)=>(s(),T(e(Nd),He(a.value,{class:e(Me)("py-6 text-center text-sm",l.class)}),{default:i(()=>[we(c.$slots,"default")]),_:3},16,["class"]))}}),HP=oe({__name:"CommandGroup",props:{asChild:{type:Boolean},as:{},class:{},heading:{}},setup(n){const l=n,a=ne(()=>{const{class:c,...r}=l;return r});return(c,r)=>(s(),T(e(Ud),He(a.value,{class:e(Me)("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",l.class)}),{default:i(()=>[c.heading?(s(),T(e(zd),{key:0,class:"px-2 py-1.5 text-xs font-medium text-muted-foreground"},{default:i(()=>[me(d(c.heading),1)]),_:1})):w("",!0),we(c.$slots,"default")]),_:3},16,["class"]))}}),KP={class:"flex items-center border px-3 rounded-md","cmdk-input-wrapper":""},qP=oe({inheritAttrs:!1,__name:"CommandInput",props:{type:{},disabled:{type:Boolean},autoFocus:{type:Boolean},asChild:{type:Boolean},as:{},class:{},modelValue:{}},setup(n){const l=n,a=ne(()=>{const{class:r,...p}=l;return p}),c=Pt(a);return(r,p)=>(s(),u("div",KP,[o(e(Od),{class:"mr-2 h-4 w-4 shrink-0 opacity-50"}),o(e(Tl),He({...e(c),...r.$attrs},{value:r.modelValue,onInput:p[0]||(p[0]=m=>r.$emit("update:modelValue",m.target.value)),"auto-focus":"",class:e(Me)("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-hidden placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",l.class)}),null,16,["value","class"])]))}}),QP=oe({__name:"CommandItem",props:{value:{},disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["select"],setup(n,{emit:l}){const a=n,c=l,r=ne(()=>{const{class:m,...g}=a;return g}),p=$t(r,c);return(m,g)=>(s(),T(e(jd),He(e(p),{class:e(Me)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-hidden data-highlighted:bg-accent data-highlighted:text-accent-foreground data-disabled:pointer-events-none data-disabled:opacity-50",a.class)}),{default:i(()=>[we(m.$slots,"default")]),_:3},16,["class"]))}}),JP={role:"presentation"},XP=oe({__name:"CommandList",props:{forceMount:{type:Boolean},position:{},bodyLock:{type:Boolean},dismissable:{type:Boolean,default:!1},side:{},sideOffset:{},align:{},alignOffset:{},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},updatePositionStrategy:{},prioritizePosition:{type:Boolean},asChild:{type:Boolean},as:{},disableOutsidePointerEvents:{type:Boolean},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside"],setup(n,{emit:l}){const a=n,c=l,r=ne(()=>{const{class:m,...g}=a;return g}),p=$t(r,c);return(m,g)=>(s(),T(e(Al),He(e(p),{class:e(Me)("max-h-[300px] overflow-y-auto overflow-x-hidden",a.class)}),{default:i(()=>[t("div",JP,[we(m.$slots,"default")])]),_:3},16,["class"]))}}),YP=oe({__name:"CommandSeparator",props:{asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:c,...r}=l;return r});return(c,r)=>(s(),T(e(Vd),He(a.value,{class:e(Me)("-mx-1 h-px bg-border",l.class)}),{default:i(()=>[we(c.$slots,"default")]),_:3},16,["class"]))}}),ZP=oe({__name:"CommandShortcut",props:{class:{}},setup(n){const l=n;return(a,c)=>(s(),u("span",{class:pe(e(Me)("ml-auto text-xs tracking-widest text-muted-foreground",l.class))},[we(a.$slots,"default")],2))}}),e6=oe({__name:"PaginationEllipsis",props:{asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:c,...r}=l;return r});return(c,r)=>(s(),T(e(Wd),He(a.value,{class:e(Me)("w-9 h-9 flex items-center justify-center",l.class)}),{default:i(()=>[we(c.$slots,"default",{},()=>[o(e(Gd))])]),_:3},16,["class"]))}}),t6=oe({__name:"PaginationFirst",props:{asChild:{type:Boolean,default:!0},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:c,...r}=l;return r});return(c,r)=>(s(),T(e(Kd),At(Ct(a.value)),{default:i(()=>[o(e(ts),{class:pe(e(Me)("w-10 h-10 p-0",l.class)),variant:"outline"},{default:i(()=>[we(c.$slots,"default",{},()=>[o(e(Hd),{class:"h-4 w-4"})])]),_:3},8,["class"])]),_:3},16))}}),s6=oe({__name:"PaginationLast",props:{asChild:{type:Boolean,default:!0},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:c,...r}=l;return r});return(c,r)=>(s(),T(e(Qd),At(Ct(a.value)),{default:i(()=>[o(e(ts),{class:pe(e(Me)("w-10 h-10 p-0",l.class)),variant:"outline"},{default:i(()=>[we(c.$slots,"default",{},()=>[o(e(qd),{class:"h-4 w-4"})])]),_:3},8,["class"])]),_:3},16))}}),a6=oe({__name:"PaginationNext",props:{asChild:{type:Boolean,default:!0},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:c,...r}=l;return r});return(c,r)=>(s(),T(e(Jd),At(Ct(a.value)),{default:i(()=>[o(e(ts),{class:pe(e(Me)("w-10 h-10 p-0",l.class)),variant:"outline"},{default:i(()=>[we(c.$slots,"default",{},()=>[o(e($l),{class:"h-4 w-4"})])]),_:3},8,["class"])]),_:3},16))}}),o6=oe({__name:"PaginationPrev",props:{asChild:{type:Boolean,default:!0},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:c,...r}=l;return r});return(c,r)=>(s(),T(e(Yd),At(Ct(a.value)),{default:i(()=>[o(e(ts),{class:pe(e(Me)("w-10 h-10 p-0",l.class)),variant:"outline"},{default:i(()=>[we(c.$slots,"default",{},()=>[o(e(Xd),{class:"h-4 w-4"})])]),_:3},8,["class"])]),_:3},16))}}),n6=oe({__name:"Stepper",props:{defaultValue:{},orientation:{},dir:{},modelValue:{},linear:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["update:modelValue"],setup(n,{emit:l}){const a=n,c=l,r=ne(()=>{const{class:m,...g}=a;return g}),p=$t(r,c);return(m,g)=>(s(),T(e(Zd),He({class:e(Me)("flex gap-2",a.class)},e(p)),{default:i(h=>[we(m.$slots,"default",At(Ct(h)))]),_:3},16,["class"]))}}),l6=oe({__name:"StepperDescription",props:{asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:r,...p}=l;return p}),c=Pt(a);return(r,p)=>(s(),T(e(eu),He(e(c),{class:e(Me)("text-xs text-muted-foreground",l.class)}),{default:i(m=>[we(r.$slots,"default",At(Ct(m)))]),_:3},16,["class"]))}}),i6=oe({__name:"StepperIndicator",props:{asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:r,...p}=l;return p}),c=Pt(a);return(r,p)=>(s(),T(e(tu),He(e(c),{class:e(Me)("inline-flex items-center justify-center rounded-full text-muted-foreground/50 w-10 h-10","group-data-disabled:text-muted-foreground group-data-disabled:opacity-50","group-data-[state=active]:bg-primary group-data-[state=active]:text-primary-foreground","group-data-[state=completed]:bg-accent group-data-[state=completed]:text-accent-foreground",l.class)}),{default:i(()=>[we(r.$slots,"default")]),_:3},16,["class"]))}}),r6=oe({__name:"StepperItem",props:{step:{},disabled:{type:Boolean},completed:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:r,...p}=l;return p}),c=Pt(a);return(r,p)=>(s(),T(e(su),He(e(c),{class:e(Me)("flex items-center gap-2 group data-disabled:pointer-events-none",l.class)}),{default:i(m=>[we(r.$slots,"default",At(Ct(m)))]),_:3},16,["class"]))}}),c6=oe({__name:"StepperSeparator",props:{orientation:{},decorative:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:r,...p}=l;return p}),c=Pt(a);return(r,p)=>(s(),T(e(au),He(e(c),{class:e(Me)("bg-muted","group-data-disabled:bg-muted group-data-disabled:opacity-50","group-data-[state=completed]:bg-accent-foreground",l.class)}),null,16,["class"]))}}),d6=oe({__name:"StepperTitle",props:{asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:r,...p}=l;return p}),c=Pt(a);return(r,p)=>(s(),T(e(ou),He(e(c),{class:e(Me)("text-md font-semibold whitespace-nowrap",l.class)}),{default:i(()=>[we(r.$slots,"default")]),_:3},16,["class"]))}}),u6=oe({__name:"StepperTrigger",props:{asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:r,...p}=l;return p}),c=Pt(a);return(r,p)=>(s(),T(e(nu),He(e(c),{class:e(Me)("p-2 flex flex-col items-center text-center gap-2 rounded-md",l.class)}),{default:i(()=>[we(r.$slots,"default")]),_:3},16,["class"]))}}),p6={key:0,class:"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border"},m6=oe({__name:"ResizableHandle",props:{id:{},hitAreaMargins:{},tabindex:{},disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{},withHandle:{type:Boolean}},emits:["dragging"],setup(n,{emit:l}){const a=n,c=l,r=ne(()=>{const{class:m,...g}=a;return g}),p=$t(r,c);return(m,g)=>(s(),T(e(iu),He(e(p),{class:e(Me)("relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-hidden focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[orientation=vertical]:h-px data-[orientation=vertical]:w-full data-[orientation=vertical]:after:left-0 data-[orientation=vertical]:after:h-1 data-[orientation=vertical]:after:w-full data-[orientation=vertical]:after:-translate-y-1/2 data-[orientation=vertical]:after:translate-x-0 [&[data-orientation=vertical]>div]:rotate-90",a.class)}),{default:i(()=>[a.withHandle?(s(),u("div",p6,[o(e(lu),{class:"h-2.5 w-2.5"})])):w("",!0)]),_:1},16,["class"]))}}),g6=oe({__name:"ResizablePanelGroup",props:{id:{},autoSaveId:{},direction:{},keyboardResizeBy:{},storage:{},asChild:{type:Boolean},as:{},class:{}},emits:["layout"],setup(n,{emit:l}){const a=n,c=l,r=ne(()=>{const{class:m,...g}=a;return g}),p=$t(r,c);return(m,g)=>(s(),T(e(ru),He(e(p),{class:e(Me)("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",a.class)}),{default:i(()=>[we(m.$slots,"default")]),_:3},16,["class"]))}}),f6=oe({__name:"Checkbox",props:{defaultChecked:{type:Boolean},checked:{type:[Boolean,String]},disabled:{type:Boolean},required:{type:Boolean},name:{},value:{},id:{},asChild:{type:Boolean},as:{},class:{}},emits:["update:checked"],setup(n,{emit:l}){const a=n,c=l,r=ne(()=>{const{class:m,...g}=a;return g}),p=$t(r,c);return(m,g)=>(s(),T(e(uu),He(e(p),{class:e(Me)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a.class)}),{default:i(()=>[o(e(du),{class:"flex h-full w-full items-center justify-center text-current"},{default:i(()=>[we(m.$slots,"default",{},()=>[o(e(cu),{class:"h-4 w-4"})])]),_:3})]),_:3},16,["class"]))}}),v6=oe({__name:"RadioGroup",props:{modelValue:{},defaultValue:{},disabled:{type:Boolean},name:{},required:{type:Boolean},orientation:{},dir:{},loop:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["update:modelValue"],setup(n,{emit:l}){const a=n,c=l,r=ne(()=>{const{class:m,...g}=a;return g}),p=$t(r,c);return(m,g)=>(s(),T(e(pu),He({class:e(Me)("grid gap-2",a.class)},e(p)),{default:i(()=>[we(m.$slots,"default")]),_:3},16,["class"]))}}),h6=oe({__name:"RadioGroupItem",props:{id:{},value:{},disabled:{type:Boolean},required:{type:Boolean},name:{},asChild:{type:Boolean},as:{},class:{}},setup(n){const l=n,a=ne(()=>{const{class:r,...p}=l;return p}),c=Pt(a);return(r,p)=>(s(),T(e(fu),He(e(c),{class:e(Me)("peer aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",l.class)}),{default:i(()=>[o(e(gu),{class:"flex items-center justify-center"},{default:i(()=>[o(e(mu),{class:"h-2.5 w-2.5 fill-current text-current"})]),_:1})]),_:1},16,["class"]))}}),_6=oe({__name:"Switch",props:{defaultChecked:{type:Boolean},checked:{type:Boolean},disabled:{type:Boolean},required:{type:Boolean},name:{},id:{},value:{},asChild:{type:Boolean},as:{},class:{},size:{}},emits:["update:checked"],setup(n,{emit:l}){const a=n,c=l,r=ne(()=>{const{class:h,..._}=a;return _}),p=ne(()=>{switch(a.size){case"sm":return"h-4 w-6";case"base":return"h-5 w-9";case"lg":default:return"h-6 w-11"}}),m=ne(()=>{switch(a.size){case"sm":return"h-3 w-3 data-[state=checked]:translate-x-2";case"base":return"h-4 w-4 data-[state=checked]:translate-x-4";case"lg":default:return"h-5 w-5 data-[state=checked]:translate-x-5"}}),g=$t(r,c);return(h,_)=>(s(),T(e(hu),He(e(g),{class:e(Me)("peer inline-flex shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input data-[state=unchecked]:dark:bg-stone-700 data-[state=unchecked]:dark:outline-stone-500 dark:outline-2 data-[state=checked]:bg-blue-500 data-[state=checked]:dark:bg-sky-500",p.value,a.class)}),{default:i(()=>[o(e(vu),{class:pe(e(Me)("pointer-events-none rounded-full shadow-lg ring-0 transition-transform bg-white",m.value))},{default:i(()=>[we(h.$slots,"thumb")]),_:3},8,["class"])]),_:3},16,["class"]))}}),b6=Pr(),De=Nr(Zp);De.component("Collapsible",Ch);De.component("CollapsibleTrigger",Vo);De.component("CollapsibleContent",Dh);De.component("ChevronDown",xl);De.component("Command",Yi);De.component("CommandDialog",GP);De.component("CommandEmpty",WP);De.component("CommandGroup",HP);De.component("CommandInput",qP);De.component("CommandItem",QP);De.component("CommandList",XP);De.component("CommandSeparator",YP);De.component("CommandShortcut",ZP);De.component("Loader2",zs);De.component("Loader",xa);De.component("AlertDialog",eP);De.component("AlertDialogAction",tP);De.component("AlertDialogCancel",sP);De.component("AlertDialogContent",aP);De.component("AlertDialogDescription",Di);De.component("AlertDialogFooter",oP);De.component("AlertDialogHeader",nP);De.component("AlertDialogTitle",lP);De.component("AlertDialogTrigger",iP);De.component("Avatar",Xl);De.component("AvatarFallback",Yl);De.component("AvatarImage",Zl);De.component("Button",ts);De.component("Badge",wi);De.component("Card",rP);De.component("CardContent",cP);De.component("CardDescription",dP);De.component("CardHeader",uP);De.component("CardTitle",pP);De.component("Checkbox",f6);De.component("DropdownMenu",cn);De.component("DropdownMenuContent",dn);De.component("DropdownMenuItem",ta);De.component("DropdownMenuTrigger",un);De.component("DropdownMenuGroup",ex);De.component("DropdownMenuSub",tx);De.component("DropdownMenuSubContent",sx);De.component("DropdownMenuSubTrigger",ax);De.component("FormControl",mP);De.component("FormDescription",fP);De.component("FormField",tp);De.component("FormItem",vP);De.component("FormLabel",hP);De.component("FormMessage",_P);De.component("Input",$i);De.component("Label",qi);De.component("Popover",bP);De.component("PopoverContent",kP);De.component("PopoverTrigger",yP);De.component("Separator",xP);De.component("Skeleton",Tt);De.component("Tabs",wP);De.component("TabsContent",$P);De.component("TabsList",SP);De.component("TabsTrigger",AP);De.component("Textarea",LP);De.component("Toaster",Dp);De.component("Tooltip",di);De.component("TooltipContent",ui);De.component("TooltipProvider",en);De.component("TooltipTrigger",tn);De.component("Dialog",Qi);De.component("DialogClose",IP);De.component("DialogContent",Ji);De.component("DialogDescription",Bi);De.component("DialogFooter",ri);De.component("DialogHeader",MP);De.component("DialogScrollContent",EP);De.component("DialogTitle",RP);De.component("DialogTrigger",xi);De.component("Table",Si);De.component("TableBody",Ti);De.component("TableCaption",Qy);De.component("TableCell",eo);De.component("TableEmpty",Xy);De.component("TableFooter",Yy);De.component("TableHeader",Ci);De.component("TableHead",Ai);De.component("TableRow",Sa);De.component("Toggle",FP);De.component("ToggleGroup",PP);De.component("ToggleGroupItem",NP);De.component("TagsInput",zP);De.component("TagsInputInput",UP);De.component("TagsInputItem",OP);De.component("TagsInputItemDelete",jP);De.component("TagsInputItemText",VP);De.component("ResizableHandle",m6);De.component("ResizablePanel",_u);De.component("ResizablePanelGroup",g6);De.component("Select",mi);De.component("SelectContent",gi);De.component("SelectGroup",fi);De.component("SelectItem",vi);De.component("SelectLabel",Mv);De.component("SelectTrigger",hi);De.component("SelectValue",_i);De.component("SelectItemText",yl);De.component("PaginationEllipsis",e6);De.component("PaginationFirst",t6);De.component("PaginationLast",s6);De.component("PaginationNext",a6);De.component("PaginationPrev",o6);De.component("RadioGroup",v6);De.component("RadioGroupItem",h6);De.component("Stepper",n6);De.component("StepperDescription",l6);De.component("StepperIndicator",i6);De.component("StepperItem",r6);De.component("StepperSeparator",c6);De.component("StepperTitle",d6);De.component("StepperTrigger",u6);De.component("Switch",_6);De.use(b6);De.use(gn);De.use(Ht);De.use(Yr);De.use(zr,{property:{id:"G-6J73315QDM"}});const k6=Ot();k6.initializeClient();De.mount("#app");
